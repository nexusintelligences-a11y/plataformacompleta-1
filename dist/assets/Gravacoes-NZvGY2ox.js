import{j as e}from"./ui-vendor-mOiQSx9p.js";import{r as o}from"./react-vendor-BGc8cUoI.js";import{an as G,ao as M,ac as E,ap as H,aq as P,ar as z,as as p,ae as v,at as N,au as B,av as R,aj as L,aw as $,ax as Q,ay as K,az as y,aA as s,aB as V,aC as r,W as w,ad as U,aD as I,a7 as u,aE as Z,aF as O,aG as J,aH as W,aI as X,aJ as Y,aK as _,aL as ee,aM as ae,aN as se,aO as re,aP as te,X as le,Y as ie,Z as ne,$ as ce,aQ as i,aR as de,al as b}from"./main-BJKeDExX.js";import{a as x}from"./api-FvCaz4Nt.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=G("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);function je(){M();const{toast:c}=E(),m=H(),[h,d]=o.useState(null),[j,g]=o.useState(null),[C,f]=o.useState(!1),{data:t=[],isLoading:D}=P({queryKey:["gravacoes"],queryFn:async()=>(await x.get("/api/gravacoes")).data}),A=z({mutationFn:async a=>{await x.delete(`/api/gravacoes/${a}`)},onSuccess:()=>{m.invalidateQueries({queryKey:["gravacoes"]}),c({title:"Gravação excluída",description:"A gravação foi excluída com sucesso."})},onError:()=>{c({variant:"destructive",title:"Erro",description:"Não foi possível excluir a gravação."})}}),T=async a=>{d(a),f(!0),g(null);try{const l=await x.get(`/api/gravacoes/${a.id}/url`);g(l.data.url)}catch(l){const n=l.response?.data,q=n?.message||"Não foi possível carregar a gravação.";n?.status==="failed"&&m.invalidateQueries({queryKey:["gravacoes"]}),c({variant:"destructive",title:"Erro",description:q}),d(null)}finally{f(!1)}},S=a=>{switch(a){case"recording":return e.jsxs(i,{className:"bg-red-100 text-red-700 border-red-200 animate-pulse",children:[e.jsx(de,{className:"h-2 w-2 fill-current mr-1"}),"Gravando"]});case"completed":return e.jsx(i,{className:"bg-green-100 text-green-700 border-green-200",children:"Concluída"});case"processing":return e.jsx(i,{className:"bg-yellow-100 text-yellow-700 border-yellow-200",children:"Processando"});case"failed":return e.jsx(i,{className:"bg-red-100 text-red-700 border-red-200",children:"Falhou"});default:return e.jsx(i,{variant:"secondary",children:a})}},k=a=>{if(!a)return"—";const l=Math.floor(a/60),n=a%60;return`${l}:${n.toString().padStart(2,"0")}`},F=a=>a?a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`:"—";return D?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] gap-4",children:[e.jsx(p,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Carregando gravações..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Gravações"}),e.jsx("p",{className:"text-muted-foreground",children:"Visualize e gerencie as gravações das suas reuniões."})]})}),t.length===0?e.jsx(v,{children:e.jsxs(N,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(oe,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Nenhuma gravação encontrada"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center max-w-md",children:"Quando você gravar uma reunião, as gravações aparecerão aqui. Para gravar, clique no botão de gravação durante uma reunião."})]})}):e.jsxs(v,{children:[e.jsxs(B,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Suas Gravações"]}),e.jsxs($,{children:[t.length," gravação",t.length!==1?"ões":""," encontrada",t.length!==1?"s":""]})]}),e.jsx(N,{children:e.jsxs(Q,{children:[e.jsx(K,{children:e.jsxs(y,{children:[e.jsx(s,{children:"Reunião"}),e.jsx(s,{children:"Data"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Duração"}),e.jsx(s,{children:"Tamanho"}),e.jsx(s,{className:"text-right",children:"Ações"})]})}),e.jsx(V,{children:t.map(a=>e.jsxs(y,{children:[e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.reuniao?.titulo||"Reunião sem título"}),a.reuniao?.nome&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.reuniao.nome})]})}),e.jsxs(r,{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),w(new Date(a.startedAt||a.createdAt),"dd/MM/yyyy",{locale:b})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(I,{className:"h-4 w-4"}),w(new Date(a.startedAt||a.createdAt),"HH:mm",{locale:b})]})]}),e.jsx(r,{children:S(a.status)}),e.jsx(r,{children:k(a.duration)}),e.jsx(r,{children:F(a.fileSize)}),e.jsx(r,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>T(a),children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"Assistir"]}),a.fileUrl&&e.jsx(u,{variant:"outline",size:"sm",asChild:!0,children:e.jsx("a",{href:a.fileUrl,download:!0,children:e.jsx(O,{className:"h-4 w-4"})})})]}),a.status==="failed"&&e.jsx("span",{className:"text-sm text-muted-foreground",children:"Gravação muito curta"}),e.jsxs(J,{children:[e.jsx(W,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"sm",children:e.jsx(X,{className:"h-4 w-4 text-red-500"})})}),e.jsxs(Y,{children:[e.jsxs(_,{children:[e.jsx(ee,{children:"Excluir gravação?"}),e.jsx(ae,{children:"Esta ação não pode ser desfeita. A gravação será excluída permanentemente."})]}),e.jsxs(se,{children:[e.jsx(re,{children:"Cancelar"}),e.jsx(te,{onClick:()=>A.mutate(a.id),className:"bg-red-500 hover:bg-red-600",children:"Excluir"})]})]})]})]})})]},a.id))})]})})]}),e.jsx(le,{open:!!h,onOpenChange:a=>!a&&d(null),children:e.jsxs(ie,{className:"max-w-4xl",children:[e.jsx(ne,{children:e.jsx(ce,{children:h?.reuniao?.titulo||"Gravação da Reunião"})}),e.jsx("div",{className:"aspect-video bg-black rounded-lg overflow-hidden",children:C?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-white"})}):j?e.jsx("video",{src:j,controls:!0,autoPlay:!0,className:"w-full h-full"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-white",children:e.jsx("p",{children:"Não foi possível carregar o vídeo"})})})]})})]})}export{je as default};
