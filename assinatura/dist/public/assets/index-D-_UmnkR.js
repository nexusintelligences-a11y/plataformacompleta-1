var zM=Object.defineProperty;var Nb=e=>{throw TypeError(e)};var WM=(e,t,n)=>t in e?zM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Yn=(e,t,n)=>WM(e,typeof t!="symbol"?t+"":t,n),Wp=(e,t,n)=>t.has(e)||Nb("Cannot "+n);var W=(e,t,n)=>(Wp(e,t,"read from private field"),n?n.call(e):t.get(e)),Te=(e,t,n)=>t.has(e)?Nb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),pe=(e,t,n,r)=>(Wp(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),We=(e,t,n)=>(Wp(e,t,"access private method"),n);var hd=(e,t,n,r)=>({set _(o){pe(e,t,o,n)},get _(){return W(e,t,r)}});function $M(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var xY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function bY(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),n}var hE={exports:{}},zh={},pE={exports:{}},Ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fc=Symbol.for("react.element"),UM=Symbol.for("react.portal"),HM=Symbol.for("react.fragment"),GM=Symbol.for("react.strict_mode"),qM=Symbol.for("react.profiler"),KM=Symbol.for("react.provider"),XM=Symbol.for("react.context"),YM=Symbol.for("react.forward_ref"),QM=Symbol.for("react.suspense"),ZM=Symbol.for("react.memo"),JM=Symbol.for("react.lazy"),Tb=Symbol.iterator;function eD(e){return e===null||typeof e!="object"?null:(e=Tb&&e[Tb]||e["@@iterator"],typeof e=="function"?e:null)}var mE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vE=Object.assign,gE={};function Hl(e,t,n){this.props=e,this.context=t,this.refs=gE,this.updater=n||mE}Hl.prototype.isReactComponent={};Hl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Hl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function yE(){}yE.prototype=Hl.prototype;function My(e,t,n){this.props=e,this.context=t,this.refs=gE,this.updater=n||mE}var Dy=My.prototype=new yE;Dy.constructor=My;vE(Dy,Hl.prototype);Dy.isPureReactComponent=!0;var Rb=Array.isArray,xE=Object.prototype.hasOwnProperty,jy={current:null},bE={key:!0,ref:!0,__self:!0,__source:!0};function wE(e,t,n){var r,o={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)xE.call(t,r)&&!bE.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Fc,type:e,key:i,ref:a,props:o,_owner:jy.current}}function tD(e,t){return{$$typeof:Fc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Fy(e){return typeof e=="object"&&e!==null&&e.$$typeof===Fc}function nD(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Pb=/\/+/g;function $p(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nD(""+e.key):t.toString(36)}function lf(e,t,n,r,o){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Fc:case UM:a=!0}}if(a)return a=e,o=o(a),e=r===""?"."+$p(a,0):r,Rb(o)?(n="",e!=null&&(n=e.replace(Pb,"$&/")+"/"),lf(o,t,n,"",function(u){return u})):o!=null&&(Fy(o)&&(o=tD(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(Pb,"$&/")+"/")+e)),t.push(o)),1;if(a=0,r=r===""?".":r+":",Rb(e))for(var s=0;s<e.length;s++){i=e[s];var l=r+$p(i,s);a+=lf(i,t,n,l,o)}else if(l=eD(e),typeof l=="function")for(e=l.call(e),s=0;!(i=e.next()).done;)i=i.value,l=r+$p(i,s++),a+=lf(i,t,n,l,o);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function pd(e,t,n){if(e==null)return e;var r=[],o=0;return lf(e,r,"","",function(i){return t.call(n,i,o++)}),r}function rD(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Hn={current:null},uf={transition:null},oD={ReactCurrentDispatcher:Hn,ReactCurrentBatchConfig:uf,ReactCurrentOwner:jy};function CE(){throw Error("act(...) is not supported in production builds of React.")}Ge.Children={map:pd,forEach:function(e,t,n){pd(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return pd(e,function(){t++}),t},toArray:function(e){return pd(e,function(t){return t})||[]},only:function(e){if(!Fy(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ge.Component=Hl;Ge.Fragment=HM;Ge.Profiler=qM;Ge.PureComponent=My;Ge.StrictMode=GM;Ge.Suspense=QM;Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oD;Ge.act=CE;Ge.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=vE({},e.props),o=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=jy.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)xE.call(t,l)&&!bE.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];r.children=s}return{$$typeof:Fc,type:e.type,key:o,ref:i,props:r,_owner:a}};Ge.createContext=function(e){return e={$$typeof:XM,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:KM,_context:e},e.Consumer=e};Ge.createElement=wE;Ge.createFactory=function(e){var t=wE.bind(null,e);return t.type=e,t};Ge.createRef=function(){return{current:null}};Ge.forwardRef=function(e){return{$$typeof:YM,render:e}};Ge.isValidElement=Fy;Ge.lazy=function(e){return{$$typeof:JM,_payload:{_status:-1,_result:e},_init:rD}};Ge.memo=function(e,t){return{$$typeof:ZM,type:e,compare:t===void 0?null:t}};Ge.startTransition=function(e){var t=uf.transition;uf.transition={};try{e()}finally{uf.transition=t}};Ge.unstable_act=CE;Ge.useCallback=function(e,t){return Hn.current.useCallback(e,t)};Ge.useContext=function(e){return Hn.current.useContext(e)};Ge.useDebugValue=function(){};Ge.useDeferredValue=function(e){return Hn.current.useDeferredValue(e)};Ge.useEffect=function(e,t){return Hn.current.useEffect(e,t)};Ge.useId=function(){return Hn.current.useId()};Ge.useImperativeHandle=function(e,t,n){return Hn.current.useImperativeHandle(e,t,n)};Ge.useInsertionEffect=function(e,t){return Hn.current.useInsertionEffect(e,t)};Ge.useLayoutEffect=function(e,t){return Hn.current.useLayoutEffect(e,t)};Ge.useMemo=function(e,t){return Hn.current.useMemo(e,t)};Ge.useReducer=function(e,t,n){return Hn.current.useReducer(e,t,n)};Ge.useRef=function(e){return Hn.current.useRef(e)};Ge.useState=function(e){return Hn.current.useState(e)};Ge.useSyncExternalStore=function(e,t,n){return Hn.current.useSyncExternalStore(e,t,n)};Ge.useTransition=function(){return Hn.current.useTransition()};Ge.version="18.3.1";pE.exports=Ge;var S=pE.exports;const le=fE(S),Oy=$M({__proto__:null,default:le},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iD=S,aD=Symbol.for("react.element"),sD=Symbol.for("react.fragment"),lD=Object.prototype.hasOwnProperty,uD=iD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cD={key:!0,ref:!0,__self:!0,__source:!0};function SE(e,t,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)lD.call(t,r)&&!cD.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:aD,type:e,key:i,ref:a,props:o,_owner:uD.current}}zh.Fragment=sD;zh.jsx=SE;zh.jsxs=SE;hE.exports=zh;var p=hE.exports,EE={exports:{}},Er={},_E={exports:{}},kE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,j){var R=M.length;M.push(j);e:for(;0<R;){var P=R-1>>>1,z=M[P];if(0<o(z,j))M[P]=j,M[R]=z,R=P;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var j=M[0],R=M.pop();if(R!==j){M[0]=R;e:for(var P=0,z=M.length,G=z>>>1;P<G;){var q=2*(P+1)-1,Y=M[q],J=q+1,X=M[J];if(0>o(Y,R))J<z&&0>o(X,Y)?(M[P]=X,M[J]=R,P=J):(M[P]=Y,M[q]=R,P=q);else if(J<z&&0>o(X,R))M[P]=X,M[J]=R,P=J;else break e}}return j}function o(M,j){var R=M.sortIndex-j.sortIndex;return R!==0?R:M.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var l=[],u=[],c=1,d=null,f=3,h=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var j=n(u);j!==null;){if(j.callback===null)r(u);else if(j.startTime<=M)r(u),j.sortIndex=j.expirationTime,t(l,j);else break;j=n(u)}}function w(M){if(g=!1,b(M),!v)if(n(l)!==null)v=!0,V(C);else{var j=n(u);j!==null&&F(w,j.startTime-M)}}function C(M,j){v=!1,g&&(g=!1,m(N),N=-1),h=!0;var R=f;try{for(b(j),d=n(l);d!==null&&(!(d.expirationTime>j)||M&&!I());){var P=d.callback;if(typeof P=="function"){d.callback=null,f=d.priorityLevel;var z=P(d.expirationTime<=j);j=e.unstable_now(),typeof z=="function"?d.callback=z:d===n(l)&&r(l),b(j)}else r(l);d=n(l)}if(d!==null)var G=!0;else{var q=n(u);q!==null&&F(w,q.startTime-j),G=!1}return G}finally{d=null,f=R,h=!1}}var E=!1,_=null,N=-1,T=5,k=-1;function I(){return!(e.unstable_now()-k<T)}function A(){if(_!==null){var M=e.unstable_now();k=M;var j=!0;try{j=_(!0,M)}finally{j?U():(E=!1,_=null)}}else E=!1}var U;if(typeof x=="function")U=function(){x(A)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,L=B.port2;B.port1.onmessage=A,U=function(){L.postMessage(null)}}else U=function(){y(A,0)};function V(M){_=M,E||(E=!0,U())}function F(M,j){N=y(function(){M(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,V(C))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(M){switch(f){case 1:case 2:case 3:var j=3;break;default:j=f}var R=f;f=j;try{return M()}finally{f=R}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,j){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var R=f;f=M;try{return j()}finally{f=R}},e.unstable_scheduleCallback=function(M,j,R){var P=e.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?P+R:P):R=P,M){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=R+z,M={id:c++,callback:j,priorityLevel:M,startTime:R,expirationTime:z,sortIndex:-1},R>P?(M.sortIndex=R,t(u,M),n(l)===null&&M===n(u)&&(g?(m(N),N=-1):g=!0,F(w,R-P))):(M.sortIndex=z,t(l,M),v||h||(v=!0,V(C))),M},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(M){var j=f;return function(){var R=f;f=j;try{return M.apply(this,arguments)}finally{f=R}}}})(kE);_E.exports=kE;var dD=_E.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fD=S,Sr=dD;function ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NE=new Set,Xu={};function hs(e,t){Pl(e,t),Pl(e+"Capture",t)}function Pl(e,t){for(Xu[e]=t,e=0;e<t.length;e++)NE.add(t[e])}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bv=Object.prototype.hasOwnProperty,hD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ab={},Ib={};function pD(e){return bv.call(Ib,e)?!0:bv.call(Ab,e)?!1:hD.test(e)?Ib[e]=!0:(Ab[e]=!0,!1)}function mD(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vD(e,t,n,r){if(t===null||typeof t>"u"||mD(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gn(e,t,n,r,o,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Cn[e]=new Gn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Cn[t]=new Gn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Cn[e]=new Gn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Cn[e]=new Gn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Cn[e]=new Gn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Cn[e]=new Gn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Cn[e]=new Gn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Cn[e]=new Gn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Cn[e]=new Gn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ly=/[\-:]([a-z])/g;function By(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ly,By);Cn[t]=new Gn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ly,By);Cn[t]=new Gn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ly,By);Cn[t]=new Gn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Cn[e]=new Gn(e,1,!1,e.toLowerCase(),null,!1,!1)});Cn.xlinkHref=new Gn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Cn[e]=new Gn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vy(e,t,n,r){var o=Cn.hasOwnProperty(t)?Cn[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vD(t,n,o,r)&&(n=null),r||o===null?pD(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var mi=fD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,md=Symbol.for("react.element"),Fs=Symbol.for("react.portal"),Os=Symbol.for("react.fragment"),zy=Symbol.for("react.strict_mode"),wv=Symbol.for("react.profiler"),TE=Symbol.for("react.provider"),RE=Symbol.for("react.context"),Wy=Symbol.for("react.forward_ref"),Cv=Symbol.for("react.suspense"),Sv=Symbol.for("react.suspense_list"),$y=Symbol.for("react.memo"),Pi=Symbol.for("react.lazy"),PE=Symbol.for("react.offscreen"),Mb=Symbol.iterator;function su(e){return e===null||typeof e!="object"?null:(e=Mb&&e[Mb]||e["@@iterator"],typeof e=="function"?e:null)}var Dt=Object.assign,Up;function Cu(e){if(Up===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Up=t&&t[1]||""}return`
`+Up+e}var Hp=!1;function Gp(e,t){if(!e||Hp)return"";Hp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var o=u.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var l=`
`+o[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=s);break}}}finally{Hp=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Cu(e):""}function gD(e){switch(e.tag){case 5:return Cu(e.type);case 16:return Cu("Lazy");case 13:return Cu("Suspense");case 19:return Cu("SuspenseList");case 0:case 2:case 15:return e=Gp(e.type,!1),e;case 11:return e=Gp(e.type.render,!1),e;case 1:return e=Gp(e.type,!0),e;default:return""}}function Ev(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Os:return"Fragment";case Fs:return"Portal";case wv:return"Profiler";case zy:return"StrictMode";case Cv:return"Suspense";case Sv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case RE:return(e.displayName||"Context")+".Consumer";case TE:return(e._context.displayName||"Context")+".Provider";case Wy:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $y:return t=e.displayName||null,t!==null?t:Ev(e.type)||"Memo";case Pi:t=e._payload,e=e._init;try{return Ev(e(t))}catch{}}return null}function yD(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ev(t);case 8:return t===zy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function la(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function AE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xD(e){var t=AE(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vd(e){e._valueTracker||(e._valueTracker=xD(e))}function IE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=AE(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Af(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function _v(e,t){var n=t.checked;return Dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Db(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=la(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ME(e,t){t=t.checked,t!=null&&Vy(e,"checked",t,!1)}function kv(e,t){ME(e,t);var n=la(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nv(e,t.type,n):t.hasOwnProperty("defaultValue")&&Nv(e,t.type,la(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jb(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Nv(e,t,n){(t!=="number"||Af(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Su=Array.isArray;function Js(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+la(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Tv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fb(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ie(92));if(Su(n)){if(1<n.length)throw Error(ie(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:la(n)}}function DE(e,t){var n=la(t.value),r=la(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Ob(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function jE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?jE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gd,FE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(gd=gd||document.createElement("div"),gd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=gd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Yu(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Pu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bD=["Webkit","ms","Moz","O"];Object.keys(Pu).forEach(function(e){bD.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Pu[t]=Pu[e]})});function OE(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Pu.hasOwnProperty(e)&&Pu[e]?(""+t).trim():t+"px"}function LE(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=OE(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var wD=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pv(e,t){if(t){if(wD[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ie(62))}}function Av(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Iv=null;function Uy(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mv=null,el=null,tl=null;function Lb(e){if(e=Bc(e)){if(typeof Mv!="function")throw Error(ie(280));var t=e.stateNode;t&&(t=Gh(t),Mv(e.stateNode,e.type,t))}}function BE(e){el?tl?tl.push(e):tl=[e]:el=e}function VE(){if(el){var e=el,t=tl;if(tl=el=null,Lb(e),t)for(e=0;e<t.length;e++)Lb(t[e])}}function zE(e,t){return e(t)}function WE(){}var qp=!1;function $E(e,t,n){if(qp)return e(t,n);qp=!0;try{return zE(e,t,n)}finally{qp=!1,(el!==null||tl!==null)&&(WE(),VE())}}function Qu(e,t){var n=e.stateNode;if(n===null)return null;var r=Gh(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ie(231,t,typeof n));return n}var Dv=!1;if(ai)try{var lu={};Object.defineProperty(lu,"passive",{get:function(){Dv=!0}}),window.addEventListener("test",lu,lu),window.removeEventListener("test",lu,lu)}catch{Dv=!1}function CD(e,t,n,r,o,i,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Au=!1,If=null,Mf=!1,jv=null,SD={onError:function(e){Au=!0,If=e}};function ED(e,t,n,r,o,i,a,s,l){Au=!1,If=null,CD.apply(SD,arguments)}function _D(e,t,n,r,o,i,a,s,l){if(ED.apply(this,arguments),Au){if(Au){var u=If;Au=!1,If=null}else throw Error(ie(198));Mf||(Mf=!0,jv=u)}}function ps(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function UE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Bb(e){if(ps(e)!==e)throw Error(ie(188))}function kD(e){var t=e.alternate;if(!t){if(t=ps(e),t===null)throw Error(ie(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Bb(o),e;if(i===r)return Bb(o),t;i=i.sibling}throw Error(ie(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?e:t}function HE(e){return e=kD(e),e!==null?GE(e):null}function GE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=GE(e);if(t!==null)return t;e=e.sibling}return null}var qE=Sr.unstable_scheduleCallback,Vb=Sr.unstable_cancelCallback,ND=Sr.unstable_shouldYield,TD=Sr.unstable_requestPaint,$t=Sr.unstable_now,RD=Sr.unstable_getCurrentPriorityLevel,Hy=Sr.unstable_ImmediatePriority,KE=Sr.unstable_UserBlockingPriority,Df=Sr.unstable_NormalPriority,PD=Sr.unstable_LowPriority,XE=Sr.unstable_IdlePriority,Wh=null,Po=null;function AD(e){if(Po&&typeof Po.onCommitFiberRoot=="function")try{Po.onCommitFiberRoot(Wh,e,void 0,(e.current.flags&128)===128)}catch{}}var to=Math.clz32?Math.clz32:DD,ID=Math.log,MD=Math.LN2;function DD(e){return e>>>=0,e===0?32:31-(ID(e)/MD|0)|0}var yd=64,xd=4194304;function Eu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function jf(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Eu(s):(i&=a,i!==0&&(r=Eu(i)))}else a=n&~o,a!==0?r=Eu(a):i!==0&&(r=Eu(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,i=t&-t,o>=i||o===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-to(t),o=1<<n,r|=e[n],t&=~o;return r}function jD(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FD(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-to(i),s=1<<a,l=o[a];l===-1?(!(s&n)||s&r)&&(o[a]=jD(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}function Fv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function YE(){var e=yd;return yd<<=1,!(yd&4194240)&&(yd=64),e}function Kp(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Oc(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-to(t),e[t]=n}function OD(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-to(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}function Gy(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-to(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var st=0;function QE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ZE,qy,JE,e_,t_,Ov=!1,bd=[],Xi=null,Yi=null,Qi=null,Zu=new Map,Ju=new Map,Ii=[],LD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zb(e,t){switch(e){case"focusin":case"focusout":Xi=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Qi=null;break;case"pointerover":case"pointerout":Zu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ju.delete(t.pointerId)}}function uu(e,t,n,r,o,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},t!==null&&(t=Bc(t),t!==null&&qy(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function BD(e,t,n,r,o){switch(t){case"focusin":return Xi=uu(Xi,e,t,n,r,o),!0;case"dragenter":return Yi=uu(Yi,e,t,n,r,o),!0;case"mouseover":return Qi=uu(Qi,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Zu.set(i,uu(Zu.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Ju.set(i,uu(Ju.get(i)||null,e,t,n,r,o)),!0}return!1}function n_(e){var t=Da(e.target);if(t!==null){var n=ps(t);if(n!==null){if(t=n.tag,t===13){if(t=UE(n),t!==null){e.blockedOn=t,t_(e.priority,function(){JE(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Lv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Iv=r,n.target.dispatchEvent(r),Iv=null}else return t=Bc(n),t!==null&&qy(t),e.blockedOn=n,!1;t.shift()}return!0}function Wb(e,t,n){cf(e)&&n.delete(t)}function VD(){Ov=!1,Xi!==null&&cf(Xi)&&(Xi=null),Yi!==null&&cf(Yi)&&(Yi=null),Qi!==null&&cf(Qi)&&(Qi=null),Zu.forEach(Wb),Ju.forEach(Wb)}function cu(e,t){e.blockedOn===t&&(e.blockedOn=null,Ov||(Ov=!0,Sr.unstable_scheduleCallback(Sr.unstable_NormalPriority,VD)))}function ec(e){function t(o){return cu(o,e)}if(0<bd.length){cu(bd[0],e);for(var n=1;n<bd.length;n++){var r=bd[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Xi!==null&&cu(Xi,e),Yi!==null&&cu(Yi,e),Qi!==null&&cu(Qi,e),Zu.forEach(t),Ju.forEach(t),n=0;n<Ii.length;n++)r=Ii[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ii.length&&(n=Ii[0],n.blockedOn===null);)n_(n),n.blockedOn===null&&Ii.shift()}var nl=mi.ReactCurrentBatchConfig,Ff=!0;function zD(e,t,n,r){var o=st,i=nl.transition;nl.transition=null;try{st=1,Ky(e,t,n,r)}finally{st=o,nl.transition=i}}function WD(e,t,n,r){var o=st,i=nl.transition;nl.transition=null;try{st=4,Ky(e,t,n,r)}finally{st=o,nl.transition=i}}function Ky(e,t,n,r){if(Ff){var o=Lv(e,t,n,r);if(o===null)om(e,t,r,Of,n),zb(e,r);else if(BD(o,e,t,n,r))r.stopPropagation();else if(zb(e,r),t&4&&-1<LD.indexOf(e)){for(;o!==null;){var i=Bc(o);if(i!==null&&ZE(i),i=Lv(e,t,n,r),i===null&&om(e,t,r,Of,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else om(e,t,r,null,n)}}var Of=null;function Lv(e,t,n,r){if(Of=null,e=Uy(r),e=Da(e),e!==null)if(t=ps(e),t===null)e=null;else if(n=t.tag,n===13){if(e=UE(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Of=e,null}function r_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RD()){case Hy:return 1;case KE:return 4;case Df:case PD:return 16;case XE:return 536870912;default:return 16}default:return 16}}var Ui=null,Xy=null,df=null;function o_(){if(df)return df;var e,t=Xy,n=t.length,r,o="value"in Ui?Ui.value:Ui.textContent,i=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===o[i-r];r++);return df=o.slice(e,1<r?1-r:void 0)}function ff(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wd(){return!0}function $b(){return!1}function _r(e){function t(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wd:$b,this.isPropagationStopped=$b,this}return Dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wd)},persist:function(){},isPersistent:wd}),t}var Gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yy=_r(Gl),Lc=Dt({},Gl,{view:0,detail:0}),$D=_r(Lc),Xp,Yp,du,$h=Dt({},Lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qy,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==du&&(du&&e.type==="mousemove"?(Xp=e.screenX-du.screenX,Yp=e.screenY-du.screenY):Yp=Xp=0,du=e),Xp)},movementY:function(e){return"movementY"in e?e.movementY:Yp}}),Ub=_r($h),UD=Dt({},$h,{dataTransfer:0}),HD=_r(UD),GD=Dt({},Lc,{relatedTarget:0}),Qp=_r(GD),qD=Dt({},Gl,{animationName:0,elapsedTime:0,pseudoElement:0}),KD=_r(qD),XD=Dt({},Gl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),YD=_r(XD),QD=Dt({},Gl,{data:0}),Hb=_r(QD),ZD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ej={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ej[e])?!!t[e]:!1}function Qy(){return tj}var nj=Dt({},Lc,{key:function(e){if(e.key){var t=ZD[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ff(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?JD[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qy,charCode:function(e){return e.type==="keypress"?ff(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ff(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),rj=_r(nj),oj=Dt({},$h,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gb=_r(oj),ij=Dt({},Lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qy}),aj=_r(ij),sj=Dt({},Gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),lj=_r(sj),uj=Dt({},$h,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),cj=_r(uj),dj=[9,13,27,32],Zy=ai&&"CompositionEvent"in window,Iu=null;ai&&"documentMode"in document&&(Iu=document.documentMode);var fj=ai&&"TextEvent"in window&&!Iu,i_=ai&&(!Zy||Iu&&8<Iu&&11>=Iu),qb=" ",Kb=!1;function a_(e,t){switch(e){case"keyup":return dj.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function s_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ls=!1;function hj(e,t){switch(e){case"compositionend":return s_(t);case"keypress":return t.which!==32?null:(Kb=!0,qb);case"textInput":return e=t.data,e===qb&&Kb?null:e;default:return null}}function pj(e,t){if(Ls)return e==="compositionend"||!Zy&&a_(e,t)?(e=o_(),df=Xy=Ui=null,Ls=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return i_&&t.locale!=="ko"?null:t.data;default:return null}}var mj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!mj[e.type]:t==="textarea"}function l_(e,t,n,r){BE(r),t=Lf(t,"onChange"),0<t.length&&(n=new Yy("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Mu=null,tc=null;function vj(e){x_(e,0)}function Uh(e){var t=zs(e);if(IE(t))return e}function gj(e,t){if(e==="change")return t}var u_=!1;if(ai){var Zp;if(ai){var Jp="oninput"in document;if(!Jp){var Yb=document.createElement("div");Yb.setAttribute("oninput","return;"),Jp=typeof Yb.oninput=="function"}Zp=Jp}else Zp=!1;u_=Zp&&(!document.documentMode||9<document.documentMode)}function Qb(){Mu&&(Mu.detachEvent("onpropertychange",c_),tc=Mu=null)}function c_(e){if(e.propertyName==="value"&&Uh(tc)){var t=[];l_(t,tc,e,Uy(e)),$E(vj,t)}}function yj(e,t,n){e==="focusin"?(Qb(),Mu=t,tc=n,Mu.attachEvent("onpropertychange",c_)):e==="focusout"&&Qb()}function xj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Uh(tc)}function bj(e,t){if(e==="click")return Uh(t)}function wj(e,t){if(e==="input"||e==="change")return Uh(t)}function Cj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ao=typeof Object.is=="function"?Object.is:Cj;function nc(e,t){if(ao(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!bv.call(t,o)||!ao(e[o],t[o]))return!1}return!0}function Zb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jb(e,t){var n=Zb(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zb(n)}}function d_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?d_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function f_(){for(var e=window,t=Af();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Af(e.document)}return t}function Jy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Sj(e){var t=f_(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&d_(n.ownerDocument.documentElement,n)){if(r!==null&&Jy(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=Jb(n,i);var a=Jb(n,r);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ej=ai&&"documentMode"in document&&11>=document.documentMode,Bs=null,Bv=null,Du=null,Vv=!1;function ew(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vv||Bs==null||Bs!==Af(r)||(r=Bs,"selectionStart"in r&&Jy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Du&&nc(Du,r)||(Du=r,r=Lf(Bv,"onSelect"),0<r.length&&(t=new Yy("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Bs)))}function Cd(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Vs={animationend:Cd("Animation","AnimationEnd"),animationiteration:Cd("Animation","AnimationIteration"),animationstart:Cd("Animation","AnimationStart"),transitionend:Cd("Transition","TransitionEnd")},em={},h_={};ai&&(h_=document.createElement("div").style,"AnimationEvent"in window||(delete Vs.animationend.animation,delete Vs.animationiteration.animation,delete Vs.animationstart.animation),"TransitionEvent"in window||delete Vs.transitionend.transition);function Hh(e){if(em[e])return em[e];if(!Vs[e])return e;var t=Vs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in h_)return em[e]=t[n];return e}var p_=Hh("animationend"),m_=Hh("animationiteration"),v_=Hh("animationstart"),g_=Hh("transitionend"),y_=new Map,tw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ga(e,t){y_.set(e,t),hs(t,[e])}for(var tm=0;tm<tw.length;tm++){var nm=tw[tm],_j=nm.toLowerCase(),kj=nm[0].toUpperCase()+nm.slice(1);ga(_j,"on"+kj)}ga(p_,"onAnimationEnd");ga(m_,"onAnimationIteration");ga(v_,"onAnimationStart");ga("dblclick","onDoubleClick");ga("focusin","onFocus");ga("focusout","onBlur");ga(g_,"onTransitionEnd");Pl("onMouseEnter",["mouseout","mouseover"]);Pl("onMouseLeave",["mouseout","mouseover"]);Pl("onPointerEnter",["pointerout","pointerover"]);Pl("onPointerLeave",["pointerout","pointerover"]);hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nj=new Set("cancel close invalid load scroll toggle".split(" ").concat(_u));function nw(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,_D(r,t,void 0,e),e.currentTarget=null}function x_(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==i&&o.isPropagationStopped())break e;nw(o,s,u),i=l}else for(a=0;a<r.length;a++){if(s=r[a],l=s.instance,u=s.currentTarget,s=s.listener,l!==i&&o.isPropagationStopped())break e;nw(o,s,u),i=l}}}if(Mf)throw e=jv,Mf=!1,jv=null,e}function yt(e,t){var n=t[Hv];n===void 0&&(n=t[Hv]=new Set);var r=e+"__bubble";n.has(r)||(b_(t,e,2,!1),n.add(r))}function rm(e,t,n){var r=0;t&&(r|=4),b_(n,e,r,t)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function rc(e){if(!e[Sd]){e[Sd]=!0,NE.forEach(function(n){n!=="selectionchange"&&(Nj.has(n)||rm(n,!1,e),rm(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Sd]||(t[Sd]=!0,rm("selectionchange",!1,t))}}function b_(e,t,n,r){switch(r_(t)){case 1:var o=zD;break;case 4:o=WD;break;default:o=Ky}n=o.bind(null,t,n,e),o=void 0,!Dv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function om(e,t,n,r,o){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===o||l.nodeType===8&&l.parentNode===o))return;a=a.return}for(;s!==null;){if(a=Da(s),a===null)return;if(l=a.tag,l===5||l===6){r=i=a;continue e}s=s.parentNode}}r=r.return}$E(function(){var u=i,c=Uy(n),d=[];e:{var f=y_.get(e);if(f!==void 0){var h=Yy,v=e;switch(e){case"keypress":if(ff(n)===0)break e;case"keydown":case"keyup":h=rj;break;case"focusin":v="focus",h=Qp;break;case"focusout":v="blur",h=Qp;break;case"beforeblur":case"afterblur":h=Qp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Ub;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=HD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=aj;break;case p_:case m_:case v_:h=KD;break;case g_:h=lj;break;case"scroll":h=$D;break;case"wheel":h=cj;break;case"copy":case"cut":case"paste":h=YD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Gb}var g=(t&4)!==0,y=!g&&e==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var x=u,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,m!==null&&(w=Qu(x,m),w!=null&&g.push(oc(x,w,b)))),y)break;x=x.return}0<g.length&&(f=new h(f,v,null,n,c),d.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==Iv&&(v=n.relatedTarget||n.fromElement)&&(Da(v)||v[si]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(v=n.relatedTarget||n.toElement,h=u,v=v?Da(v):null,v!==null&&(y=ps(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=u),h!==v)){if(g=Ub,w="onMouseLeave",m="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=Gb,w="onPointerLeave",m="onPointerEnter",x="pointer"),y=h==null?f:zs(h),b=v==null?f:zs(v),f=new g(w,x+"leave",h,n,c),f.target=y,f.relatedTarget=b,w=null,Da(c)===u&&(g=new g(m,x+"enter",v,n,c),g.target=b,g.relatedTarget=y,w=g),y=w,h&&v)t:{for(g=h,m=v,x=0,b=g;b;b=Cs(b))x++;for(b=0,w=m;w;w=Cs(w))b++;for(;0<x-b;)g=Cs(g),x--;for(;0<b-x;)m=Cs(m),b--;for(;x--;){if(g===m||m!==null&&g===m.alternate)break t;g=Cs(g),m=Cs(m)}g=null}else g=null;h!==null&&rw(d,f,h,g,!1),v!==null&&y!==null&&rw(d,y,v,g,!0)}}e:{if(f=u?zs(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var C=gj;else if(Xb(f))if(u_)C=wj;else{C=xj;var E=yj}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=bj);if(C&&(C=C(e,u))){l_(d,C,n,c);break e}E&&E(e,f,u),e==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&Nv(f,"number",f.value)}switch(E=u?zs(u):window,e){case"focusin":(Xb(E)||E.contentEditable==="true")&&(Bs=E,Bv=u,Du=null);break;case"focusout":Du=Bv=Bs=null;break;case"mousedown":Vv=!0;break;case"contextmenu":case"mouseup":case"dragend":Vv=!1,ew(d,n,c);break;case"selectionchange":if(Ej)break;case"keydown":case"keyup":ew(d,n,c)}var _;if(Zy)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ls?a_(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(i_&&n.locale!=="ko"&&(Ls||N!=="onCompositionStart"?N==="onCompositionEnd"&&Ls&&(_=o_()):(Ui=c,Xy="value"in Ui?Ui.value:Ui.textContent,Ls=!0)),E=Lf(u,N),0<E.length&&(N=new Hb(N,e,null,n,c),d.push({event:N,listeners:E}),_?N.data=_:(_=s_(n),_!==null&&(N.data=_)))),(_=fj?hj(e,n):pj(e,n))&&(u=Lf(u,"onBeforeInput"),0<u.length&&(c=new Hb("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=_))}x_(d,t)})}function oc(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Lf(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Qu(e,n),i!=null&&r.unshift(oc(e,i,o)),i=Qu(e,t),i!=null&&r.push(oc(e,i,o))),e=e.return}return r}function Cs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function rw(e,t,n,r,o){for(var i=t._reactName,a=[];n!==null&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&u!==null&&(s=u,o?(l=Qu(n,i),l!=null&&a.unshift(oc(n,l,s))):o||(l=Qu(n,i),l!=null&&a.push(oc(n,l,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var Tj=/\r\n?/g,Rj=/\u0000|\uFFFD/g;function ow(e){return(typeof e=="string"?e:""+e).replace(Tj,`
`).replace(Rj,"")}function Ed(e,t,n){if(t=ow(t),ow(e)!==t&&n)throw Error(ie(425))}function Bf(){}var zv=null,Wv=null;function $v(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Uv=typeof setTimeout=="function"?setTimeout:void 0,Pj=typeof clearTimeout=="function"?clearTimeout:void 0,iw=typeof Promise=="function"?Promise:void 0,Aj=typeof queueMicrotask=="function"?queueMicrotask:typeof iw<"u"?function(e){return iw.resolve(null).then(e).catch(Ij)}:Uv;function Ij(e){setTimeout(function(){throw e})}function im(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),ec(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);ec(t)}function Zi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function aw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ql=Math.random().toString(36).slice(2),Co="__reactFiber$"+ql,ic="__reactProps$"+ql,si="__reactContainer$"+ql,Hv="__reactEvents$"+ql,Mj="__reactListeners$"+ql,Dj="__reactHandles$"+ql;function Da(e){var t=e[Co];if(t)return t;for(var n=e.parentNode;n;){if(t=n[si]||n[Co]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=aw(e);e!==null;){if(n=e[Co])return n;e=aw(e)}return t}e=n,n=e.parentNode}return null}function Bc(e){return e=e[Co]||e[si],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ie(33))}function Gh(e){return e[ic]||null}var Gv=[],Ws=-1;function ya(e){return{current:e}}function St(e){0>Ws||(e.current=Gv[Ws],Gv[Ws]=null,Ws--)}function mt(e,t){Ws++,Gv[Ws]=e.current,e.current=t}var ua={},Ln=ya(ua),ir=ya(!1),ns=ua;function Al(e,t){var n=e.type.contextTypes;if(!n)return ua;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function ar(e){return e=e.childContextTypes,e!=null}function Vf(){St(ir),St(Ln)}function sw(e,t,n){if(Ln.current!==ua)throw Error(ie(168));mt(Ln,t),mt(ir,n)}function w_(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(ie(108,yD(e)||"Unknown",o));return Dt({},n,r)}function zf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ua,ns=Ln.current,mt(Ln,e),mt(ir,ir.current),!0}function lw(e,t,n){var r=e.stateNode;if(!r)throw Error(ie(169));n?(e=w_(e,t,ns),r.__reactInternalMemoizedMergedChildContext=e,St(ir),St(Ln),mt(Ln,e)):St(ir),mt(ir,n)}var Zo=null,qh=!1,am=!1;function C_(e){Zo===null?Zo=[e]:Zo.push(e)}function jj(e){qh=!0,C_(e)}function xa(){if(!am&&Zo!==null){am=!0;var e=0,t=st;try{var n=Zo;for(st=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Zo=null,qh=!1}catch(o){throw Zo!==null&&(Zo=Zo.slice(e+1)),qE(Hy,xa),o}finally{st=t,am=!1}}return null}var $s=[],Us=0,Wf=null,$f=0,Ar=[],Ir=0,rs=null,ni=1,ri="";function ka(e,t){$s[Us++]=$f,$s[Us++]=Wf,Wf=e,$f=t}function S_(e,t,n){Ar[Ir++]=ni,Ar[Ir++]=ri,Ar[Ir++]=rs,rs=e;var r=ni;e=ri;var o=32-to(r)-1;r&=~(1<<o),n+=1;var i=32-to(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,ni=1<<32-to(t)+o|n<<o|r,ri=i+e}else ni=1<<i|n<<o|r,ri=e}function e0(e){e.return!==null&&(ka(e,1),S_(e,1,0))}function t0(e){for(;e===Wf;)Wf=$s[--Us],$s[Us]=null,$f=$s[--Us],$s[Us]=null;for(;e===rs;)rs=Ar[--Ir],Ar[Ir]=null,ri=Ar[--Ir],Ar[Ir]=null,ni=Ar[--Ir],Ar[Ir]=null}var br=null,vr=null,kt=!1,Zr=null;function E_(e,t){var n=jr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function uw(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,br=e,vr=Zi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,br=e,vr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=rs!==null?{id:ni,overflow:ri}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=jr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,br=e,vr=null,!0):!1;default:return!1}}function qv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kv(e){if(kt){var t=vr;if(t){var n=t;if(!uw(e,t)){if(qv(e))throw Error(ie(418));t=Zi(n.nextSibling);var r=br;t&&uw(e,t)?E_(r,n):(e.flags=e.flags&-4097|2,kt=!1,br=e)}}else{if(qv(e))throw Error(ie(418));e.flags=e.flags&-4097|2,kt=!1,br=e}}}function cw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;br=e}function _d(e){if(e!==br)return!1;if(!kt)return cw(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!$v(e.type,e.memoizedProps)),t&&(t=vr)){if(qv(e))throw __(),Error(ie(418));for(;t;)E_(e,t),t=Zi(t.nextSibling)}if(cw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){vr=Zi(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}vr=null}}else vr=br?Zi(e.stateNode.nextSibling):null;return!0}function __(){for(var e=vr;e;)e=Zi(e.nextSibling)}function Il(){vr=br=null,kt=!1}function n0(e){Zr===null?Zr=[e]:Zr.push(e)}var Fj=mi.ReactCurrentBatchConfig;function fu(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,e));var o=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,e))}return e}function kd(e,t){throw e=Object.prototype.toString.call(t),Error(ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function dw(e){var t=e._init;return t(e._payload)}function k_(e){function t(m,x){if(e){var b=m.deletions;b===null?(m.deletions=[x],m.flags|=16):b.push(x)}}function n(m,x){if(!e)return null;for(;x!==null;)t(m,x),x=x.sibling;return null}function r(m,x){for(m=new Map;x!==null;)x.key!==null?m.set(x.key,x):m.set(x.index,x),x=x.sibling;return m}function o(m,x){return m=na(m,x),m.index=0,m.sibling=null,m}function i(m,x,b){return m.index=b,e?(b=m.alternate,b!==null?(b=b.index,b<x?(m.flags|=2,x):b):(m.flags|=2,x)):(m.flags|=1048576,x)}function a(m){return e&&m.alternate===null&&(m.flags|=2),m}function s(m,x,b,w){return x===null||x.tag!==6?(x=hm(b,m.mode,w),x.return=m,x):(x=o(x,b),x.return=m,x)}function l(m,x,b,w){var C=b.type;return C===Os?c(m,x,b.props.children,w,b.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Pi&&dw(C)===x.type)?(w=o(x,b.props),w.ref=fu(m,x,b),w.return=m,w):(w=xf(b.type,b.key,b.props,null,m.mode,w),w.ref=fu(m,x,b),w.return=m,w)}function u(m,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=pm(b,m.mode,w),x.return=m,x):(x=o(x,b.children||[]),x.return=m,x)}function c(m,x,b,w,C){return x===null||x.tag!==7?(x=Qa(b,m.mode,w,C),x.return=m,x):(x=o(x,b),x.return=m,x)}function d(m,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=hm(""+x,m.mode,b),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case md:return b=xf(x.type,x.key,x.props,null,m.mode,b),b.ref=fu(m,null,x),b.return=m,b;case Fs:return x=pm(x,m.mode,b),x.return=m,x;case Pi:var w=x._init;return d(m,w(x._payload),b)}if(Su(x)||su(x))return x=Qa(x,m.mode,b,null),x.return=m,x;kd(m,x)}return null}function f(m,x,b,w){var C=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:s(m,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case md:return b.key===C?l(m,x,b,w):null;case Fs:return b.key===C?u(m,x,b,w):null;case Pi:return C=b._init,f(m,x,C(b._payload),w)}if(Su(b)||su(b))return C!==null?null:c(m,x,b,w,null);kd(m,b)}return null}function h(m,x,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(b)||null,s(x,m,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case md:return m=m.get(w.key===null?b:w.key)||null,l(x,m,w,C);case Fs:return m=m.get(w.key===null?b:w.key)||null,u(x,m,w,C);case Pi:var E=w._init;return h(m,x,b,E(w._payload),C)}if(Su(w)||su(w))return m=m.get(b)||null,c(x,m,w,C,null);kd(x,w)}return null}function v(m,x,b,w){for(var C=null,E=null,_=x,N=x=0,T=null;_!==null&&N<b.length;N++){_.index>N?(T=_,_=null):T=_.sibling;var k=f(m,_,b[N],w);if(k===null){_===null&&(_=T);break}e&&_&&k.alternate===null&&t(m,_),x=i(k,x,N),E===null?C=k:E.sibling=k,E=k,_=T}if(N===b.length)return n(m,_),kt&&ka(m,N),C;if(_===null){for(;N<b.length;N++)_=d(m,b[N],w),_!==null&&(x=i(_,x,N),E===null?C=_:E.sibling=_,E=_);return kt&&ka(m,N),C}for(_=r(m,_);N<b.length;N++)T=h(_,m,N,b[N],w),T!==null&&(e&&T.alternate!==null&&_.delete(T.key===null?N:T.key),x=i(T,x,N),E===null?C=T:E.sibling=T,E=T);return e&&_.forEach(function(I){return t(m,I)}),kt&&ka(m,N),C}function g(m,x,b,w){var C=su(b);if(typeof C!="function")throw Error(ie(150));if(b=C.call(b),b==null)throw Error(ie(151));for(var E=C=null,_=x,N=x=0,T=null,k=b.next();_!==null&&!k.done;N++,k=b.next()){_.index>N?(T=_,_=null):T=_.sibling;var I=f(m,_,k.value,w);if(I===null){_===null&&(_=T);break}e&&_&&I.alternate===null&&t(m,_),x=i(I,x,N),E===null?C=I:E.sibling=I,E=I,_=T}if(k.done)return n(m,_),kt&&ka(m,N),C;if(_===null){for(;!k.done;N++,k=b.next())k=d(m,k.value,w),k!==null&&(x=i(k,x,N),E===null?C=k:E.sibling=k,E=k);return kt&&ka(m,N),C}for(_=r(m,_);!k.done;N++,k=b.next())k=h(_,m,N,k.value,w),k!==null&&(e&&k.alternate!==null&&_.delete(k.key===null?N:k.key),x=i(k,x,N),E===null?C=k:E.sibling=k,E=k);return e&&_.forEach(function(A){return t(m,A)}),kt&&ka(m,N),C}function y(m,x,b,w){if(typeof b=="object"&&b!==null&&b.type===Os&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case md:e:{for(var C=b.key,E=x;E!==null;){if(E.key===C){if(C=b.type,C===Os){if(E.tag===7){n(m,E.sibling),x=o(E,b.props.children),x.return=m,m=x;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Pi&&dw(C)===E.type){n(m,E.sibling),x=o(E,b.props),x.ref=fu(m,E,b),x.return=m,m=x;break e}n(m,E);break}else t(m,E);E=E.sibling}b.type===Os?(x=Qa(b.props.children,m.mode,w,b.key),x.return=m,m=x):(w=xf(b.type,b.key,b.props,null,m.mode,w),w.ref=fu(m,x,b),w.return=m,m=w)}return a(m);case Fs:e:{for(E=b.key;x!==null;){if(x.key===E)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(m,x.sibling),x=o(x,b.children||[]),x.return=m,m=x;break e}else{n(m,x);break}else t(m,x);x=x.sibling}x=pm(b,m.mode,w),x.return=m,m=x}return a(m);case Pi:return E=b._init,y(m,x,E(b._payload),w)}if(Su(b))return v(m,x,b,w);if(su(b))return g(m,x,b,w);kd(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(m,x.sibling),x=o(x,b),x.return=m,m=x):(n(m,x),x=hm(b,m.mode,w),x.return=m,m=x),a(m)):n(m,x)}return y}var Ml=k_(!0),N_=k_(!1),Uf=ya(null),Hf=null,Hs=null,r0=null;function o0(){r0=Hs=Hf=null}function i0(e){var t=Uf.current;St(Uf),e._currentValue=t}function Xv(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function rl(e,t){Hf=e,r0=Hs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(rr=!0),e.firstContext=null)}function Vr(e){var t=e._currentValue;if(r0!==e)if(e={context:e,memoizedValue:t,next:null},Hs===null){if(Hf===null)throw Error(ie(308));Hs=e,Hf.dependencies={lanes:0,firstContext:e}}else Hs=Hs.next=e;return t}var ja=null;function a0(e){ja===null?ja=[e]:ja.push(e)}function T_(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,a0(t)):(n.next=o.next,o.next=n),t.interleaved=n,li(e,r)}function li(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ai=!1;function s0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function R_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function oi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ji(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ze&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,li(e,n)}return o=r.interleaved,o===null?(t.next=t,a0(r)):(t.next=o.next,o.next=t),r.interleaved=t,li(e,n)}function hf(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gy(e,n)}}function fw(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=t:i=i.next=t}else o=i=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Gf(e,t,n,r){var o=e.updateQueue;Ai=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var l=s,u=l.next;l.next=null,a===null?i=u:a.next=u,a=l;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(i!==null){var d=o.baseState;a=0,c=u=l=null,s=i;do{var f=s.lane,h=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=e,g=s;switch(f=t,h=n,g.tag){case 1:if(v=g.payload,typeof v=="function"){d=v.call(h,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,f=typeof v=="function"?v.call(h,d,f):v,f==null)break e;d=Dt({},d,f);break e;case 2:Ai=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(c===null&&(l=d),o.baseState=l,o.firstBaseUpdate=u,o.lastBaseUpdate=c,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else i===null&&(o.shared.lanes=0);is|=a,e.lanes=a,e.memoizedState=d}}function hw(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(ie(191,o));o.call(r)}}}var Vc={},Ao=ya(Vc),ac=ya(Vc),sc=ya(Vc);function Fa(e){if(e===Vc)throw Error(ie(174));return e}function l0(e,t){switch(mt(sc,t),mt(ac,e),mt(Ao,Vc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Rv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Rv(t,e)}St(Ao),mt(Ao,t)}function Dl(){St(Ao),St(ac),St(sc)}function P_(e){Fa(sc.current);var t=Fa(Ao.current),n=Rv(t,e.type);t!==n&&(mt(ac,e),mt(Ao,n))}function u0(e){ac.current===e&&(St(Ao),St(ac))}var Rt=ya(0);function qf(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var sm=[];function c0(){for(var e=0;e<sm.length;e++)sm[e]._workInProgressVersionPrimary=null;sm.length=0}var pf=mi.ReactCurrentDispatcher,lm=mi.ReactCurrentBatchConfig,os=0,Mt=null,Qt=null,dn=null,Kf=!1,ju=!1,lc=0,Oj=0;function Nn(){throw Error(ie(321))}function d0(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ao(e[n],t[n]))return!1;return!0}function f0(e,t,n,r,o,i){if(os=i,Mt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pf.current=e===null||e.memoizedState===null?zj:Wj,e=n(r,o),ju){i=0;do{if(ju=!1,lc=0,25<=i)throw Error(ie(301));i+=1,dn=Qt=null,t.updateQueue=null,pf.current=$j,e=n(r,o)}while(ju)}if(pf.current=Xf,t=Qt!==null&&Qt.next!==null,os=0,dn=Qt=Mt=null,Kf=!1,t)throw Error(ie(300));return e}function h0(){var e=lc!==0;return lc=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?Mt.memoizedState=dn=e:dn=dn.next=e,dn}function zr(){if(Qt===null){var e=Mt.alternate;e=e!==null?e.memoizedState:null}else e=Qt.next;var t=dn===null?Mt.memoizedState:dn.next;if(t!==null)dn=t,Qt=e;else{if(e===null)throw Error(ie(310));Qt=e,e={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},dn===null?Mt.memoizedState=dn=e:dn=dn.next=e}return dn}function uc(e,t){return typeof t=="function"?t(e):t}function um(e){var t=zr(),n=t.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=e;var r=Qt,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,l=null,u=i;do{var c=u.lane;if((os&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=d,a=r):l=l.next=d,Mt.lanes|=c,is|=c}u=u.next}while(u!==null&&u!==i);l===null?a=r:l.next=s,ao(r,t.memoizedState)||(rr=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do i=o.lane,Mt.lanes|=i,is|=i,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function cm(e){var t=zr(),n=t.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=e(i,a.action),a=a.next;while(a!==o);ao(i,t.memoizedState)||(rr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function A_(){}function I_(e,t){var n=Mt,r=zr(),o=t(),i=!ao(r.memoizedState,o);if(i&&(r.memoizedState=o,rr=!0),r=r.queue,p0(j_.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||dn!==null&&dn.memoizedState.tag&1){if(n.flags|=2048,cc(9,D_.bind(null,n,r,o,t),void 0,null),fn===null)throw Error(ie(349));os&30||M_(n,t,o)}return o}function M_(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function D_(e,t,n,r){t.value=n,t.getSnapshot=r,F_(t)&&O_(e)}function j_(e,t,n){return n(function(){F_(t)&&O_(e)})}function F_(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ao(e,n)}catch{return!0}}function O_(e){var t=li(e,1);t!==null&&no(t,e,1,-1)}function pw(e){var t=vo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uc,lastRenderedState:e},t.queue=e,e=e.dispatch=Vj.bind(null,Mt,e),[t.memoizedState,e]}function cc(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function L_(){return zr().memoizedState}function mf(e,t,n,r){var o=vo();Mt.flags|=e,o.memoizedState=cc(1|t,n,void 0,r===void 0?null:r)}function Kh(e,t,n,r){var o=zr();r=r===void 0?null:r;var i=void 0;if(Qt!==null){var a=Qt.memoizedState;if(i=a.destroy,r!==null&&d0(r,a.deps)){o.memoizedState=cc(t,n,i,r);return}}Mt.flags|=e,o.memoizedState=cc(1|t,n,i,r)}function mw(e,t){return mf(8390656,8,e,t)}function p0(e,t){return Kh(2048,8,e,t)}function B_(e,t){return Kh(4,2,e,t)}function V_(e,t){return Kh(4,4,e,t)}function z_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function W_(e,t,n){return n=n!=null?n.concat([e]):null,Kh(4,4,z_.bind(null,t,e),n)}function m0(){}function $_(e,t){var n=zr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&d0(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function U_(e,t){var n=zr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&d0(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function H_(e,t,n){return os&21?(ao(n,t)||(n=YE(),Mt.lanes|=n,is|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,rr=!0),e.memoizedState=n)}function Lj(e,t){var n=st;st=n!==0&&4>n?n:4,e(!0);var r=lm.transition;lm.transition={};try{e(!1),t()}finally{st=n,lm.transition=r}}function G_(){return zr().memoizedState}function Bj(e,t,n){var r=ta(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},q_(e))K_(t,n);else if(n=T_(e,t,n,r),n!==null){var o=Un();no(n,e,r,o),X_(n,t,r)}}function Vj(e,t,n){var r=ta(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(q_(e))K_(t,o);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,ao(s,a)){var l=t.interleaved;l===null?(o.next=o,a0(t)):(o.next=l.next,l.next=o),t.interleaved=o;return}}catch{}finally{}n=T_(e,t,o,r),n!==null&&(o=Un(),no(n,e,r,o),X_(n,t,r))}}function q_(e){var t=e.alternate;return e===Mt||t!==null&&t===Mt}function K_(e,t){ju=Kf=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function X_(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gy(e,n)}}var Xf={readContext:Vr,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},zj={readContext:Vr,useCallback:function(e,t){return vo().memoizedState=[e,t===void 0?null:t],e},useContext:Vr,useEffect:mw,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,mf(4194308,4,z_.bind(null,t,e),n)},useLayoutEffect:function(e,t){return mf(4194308,4,e,t)},useInsertionEffect:function(e,t){return mf(4,2,e,t)},useMemo:function(e,t){var n=vo();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vo();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Bj.bind(null,Mt,e),[r.memoizedState,e]},useRef:function(e){var t=vo();return e={current:e},t.memoizedState=e},useState:pw,useDebugValue:m0,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=pw(!1),t=e[0];return e=Lj.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Mt,o=vo();if(kt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=t(),fn===null)throw Error(ie(349));os&30||M_(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,mw(j_.bind(null,r,i,e),[e]),r.flags|=2048,cc(9,D_.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=vo(),t=fn.identifierPrefix;if(kt){var n=ri,r=ni;n=(r&~(1<<32-to(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=lc++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Oj++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Wj={readContext:Vr,useCallback:$_,useContext:Vr,useEffect:p0,useImperativeHandle:W_,useInsertionEffect:B_,useLayoutEffect:V_,useMemo:U_,useReducer:um,useRef:L_,useState:function(){return um(uc)},useDebugValue:m0,useDeferredValue:function(e){var t=zr();return H_(t,Qt.memoizedState,e)},useTransition:function(){var e=um(uc)[0],t=zr().memoizedState;return[e,t]},useMutableSource:A_,useSyncExternalStore:I_,useId:G_,unstable_isNewReconciler:!1},$j={readContext:Vr,useCallback:$_,useContext:Vr,useEffect:p0,useImperativeHandle:W_,useInsertionEffect:B_,useLayoutEffect:V_,useMemo:U_,useReducer:cm,useRef:L_,useState:function(){return cm(uc)},useDebugValue:m0,useDeferredValue:function(e){var t=zr();return Qt===null?t.memoizedState=e:H_(t,Qt.memoizedState,e)},useTransition:function(){var e=cm(uc)[0],t=zr().memoizedState;return[e,t]},useMutableSource:A_,useSyncExternalStore:I_,useId:G_,unstable_isNewReconciler:!1};function Kr(e,t){if(e&&e.defaultProps){t=Dt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Yv(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Dt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Xh={isMounted:function(e){return(e=e._reactInternals)?ps(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Un(),o=ta(e),i=oi(r,o);i.payload=t,n!=null&&(i.callback=n),t=Ji(e,i,o),t!==null&&(no(t,e,o,r),hf(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Un(),o=ta(e),i=oi(r,o);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ji(e,i,o),t!==null&&(no(t,e,o,r),hf(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Un(),r=ta(e),o=oi(n,r);o.tag=2,t!=null&&(o.callback=t),t=Ji(e,o,r),t!==null&&(no(t,e,r,n),hf(t,e,r))}};function vw(e,t,n,r,o,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!nc(n,r)||!nc(o,i):!0}function Y_(e,t,n){var r=!1,o=ua,i=t.contextType;return typeof i=="object"&&i!==null?i=Vr(i):(o=ar(t)?ns:Ln.current,r=t.contextTypes,i=(r=r!=null)?Al(e,o):ua),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Xh,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function gw(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Xh.enqueueReplaceState(t,t.state,null)}function Qv(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},s0(e);var i=t.contextType;typeof i=="object"&&i!==null?o.context=Vr(i):(i=ar(t)?ns:Ln.current,o.context=Al(e,i)),o.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Yv(e,t,i,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Xh.enqueueReplaceState(o,o.state,null),Gf(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function jl(e,t){try{var n="",r=t;do n+=gD(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:o,digest:null}}function dm(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Zv(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Uj=typeof WeakMap=="function"?WeakMap:Map;function Q_(e,t,n){n=oi(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Qf||(Qf=!0,lg=r),Zv(e,t)},n}function Z_(e,t,n){n=oi(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Zv(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Zv(e,t),typeof r!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function yw(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Uj;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=oF.bind(null,e,t,n),t.then(e,e))}function xw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bw(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=oi(-1,1),t.tag=2,Ji(n,t,1))),n.lanes|=1),e)}var Hj=mi.ReactCurrentOwner,rr=!1;function zn(e,t,n,r){t.child=e===null?N_(t,null,n,r):Ml(t,e.child,n,r)}function ww(e,t,n,r,o){n=n.render;var i=t.ref;return rl(t,o),r=f0(e,t,n,r,i,o),n=h0(),e!==null&&!rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ui(e,t,o)):(kt&&n&&e0(t),t.flags|=1,zn(e,t,r,o),t.child)}function Cw(e,t,n,r,o){if(e===null){var i=n.type;return typeof i=="function"&&!S0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,J_(e,t,i,r,o)):(e=xf(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:nc,n(a,r)&&e.ref===t.ref)return ui(e,t,o)}return t.flags|=1,e=na(i,r),e.ref=t.ref,e.return=t,t.child=e}function J_(e,t,n,r,o){if(e!==null){var i=e.memoizedProps;if(nc(i,r)&&e.ref===t.ref)if(rr=!1,t.pendingProps=r=i,(e.lanes&o)!==0)e.flags&131072&&(rr=!0);else return t.lanes=e.lanes,ui(e,t,o)}return Jv(e,t,n,r,o)}function ek(e,t,n){var r=t.pendingProps,o=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(qs,fr),fr|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(qs,fr),fr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,mt(qs,fr),fr|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,mt(qs,fr),fr|=r;return zn(e,t,o,n),t.child}function tk(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Jv(e,t,n,r,o){var i=ar(n)?ns:Ln.current;return i=Al(t,i),rl(t,o),n=f0(e,t,n,r,i,o),r=h0(),e!==null&&!rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,ui(e,t,o)):(kt&&r&&e0(t),t.flags|=1,zn(e,t,n,o),t.child)}function Sw(e,t,n,r,o){if(ar(n)){var i=!0;zf(t)}else i=!1;if(rl(t,o),t.stateNode===null)vf(e,t),Y_(t,n,r),Qv(t,n,r,o),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=Vr(u):(u=ar(n)?ns:Ln.current,u=Al(t,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||l!==u)&&gw(t,a,r,u),Ai=!1;var f=t.memoizedState;a.state=f,Gf(t,r,a,o),l=t.memoizedState,s!==r||f!==l||ir.current||Ai?(typeof c=="function"&&(Yv(t,n,c,r),l=t.memoizedState),(s=Ai||vw(t,n,s,r,f,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,R_(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:Kr(t.type,s),a.props=u,d=t.pendingProps,f=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=Vr(l):(l=ar(n)?ns:Ln.current,l=Al(t,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==l)&&gw(t,a,r,l),Ai=!1,f=t.memoizedState,a.state=f,Gf(t,r,a,o);var v=t.memoizedState;s!==d||f!==v||ir.current||Ai?(typeof h=="function"&&(Yv(t,n,h,r),v=t.memoizedState),(u=Ai||vw(t,n,u,r,f,v,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),a.props=r,a.state=v,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return eg(e,t,n,r,i,o)}function eg(e,t,n,r,o,i){tk(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return o&&lw(t,n,!1),ui(e,t,i);r=t.stateNode,Hj.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Ml(t,e.child,null,i),t.child=Ml(t,null,s,i)):zn(e,t,s,i),t.memoizedState=r.state,o&&lw(t,n,!0),t.child}function nk(e){var t=e.stateNode;t.pendingContext?sw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&sw(e,t.context,!1),l0(e,t.containerInfo)}function Ew(e,t,n,r,o){return Il(),n0(o),t.flags|=256,zn(e,t,n,r),t.child}var tg={dehydrated:null,treeContext:null,retryLane:0};function ng(e){return{baseLanes:e,cachePool:null,transitions:null}}function rk(e,t,n){var r=t.pendingProps,o=Rt.current,i=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),mt(Rt,o&1),e===null)return Kv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Zh(a,r,0,null),e=Qa(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=ng(n),t.memoizedState=tg,e):v0(t,a));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return Gj(e,t,a,r,s,o,n);if(i){i=r.fallback,a=t.mode,o=e.child,s=o.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=na(o,l),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=na(s,i):(i=Qa(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?ng(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=tg,r}return i=e.child,e=i.sibling,r=na(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function v0(e,t){return t=Zh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Nd(e,t,n,r){return r!==null&&n0(r),Ml(t,e.child,null,n),e=v0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Gj(e,t,n,r,o,i,a){if(n)return t.flags&256?(t.flags&=-257,r=dm(Error(ie(422))),Nd(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=Zh({mode:"visible",children:r.children},o,0,null),i=Qa(i,o,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ml(t,e.child,null,a),t.child.memoizedState=ng(a),t.memoizedState=tg,i);if(!(t.mode&1))return Nd(e,t,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(ie(419)),r=dm(i,r,void 0),Nd(e,t,a,r)}if(s=(a&e.childLanes)!==0,rr||s){if(r=fn,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,li(e,o),no(r,e,o,-1))}return C0(),r=dm(Error(ie(421))),Nd(e,t,a,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=iF.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,vr=Zi(o.nextSibling),br=t,kt=!0,Zr=null,e!==null&&(Ar[Ir++]=ni,Ar[Ir++]=ri,Ar[Ir++]=rs,ni=e.id,ri=e.overflow,rs=t),t=v0(t,r.children),t.flags|=4096,t)}function _w(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Xv(e.return,t,n)}function fm(e,t,n,r,o){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function ok(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(zn(e,t,r.children,n),r=Rt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&_w(e,n,t);else if(e.tag===19)_w(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(mt(Rt,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&qf(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),fm(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&qf(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}fm(t,!0,n,null,i);break;case"together":fm(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ui(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),is|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ie(153));if(t.child!==null){for(e=t.child,n=na(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=na(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function qj(e,t,n){switch(t.tag){case 3:nk(t),Il();break;case 5:P_(t);break;case 1:ar(t.type)&&zf(t);break;case 4:l0(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;mt(Uf,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(mt(Rt,Rt.current&1),t.flags|=128,null):n&t.child.childLanes?rk(e,t,n):(mt(Rt,Rt.current&1),e=ui(e,t,n),e!==null?e.sibling:null);mt(Rt,Rt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return ok(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),mt(Rt,Rt.current),r)break;return null;case 22:case 23:return t.lanes=0,ek(e,t,n)}return ui(e,t,n)}var ik,rg,ak,sk;ik=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rg=function(){};ak=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Fa(Ao.current);var i=null;switch(n){case"input":o=_v(e,o),r=_v(e,r),i=[];break;case"select":o=Dt({},o,{value:void 0}),r=Dt({},r,{value:void 0}),i=[];break;case"textarea":o=Tv(e,o),r=Tv(e,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Bf)}Pv(n,r);var a;n=null;for(u in o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&o[u]!=null)if(u==="style"){var s=o[u];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Xu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(s=o!=null?o[u]:void 0,r.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(a in s)!s.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&s[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Xu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&yt("scroll",e),i||s===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};sk=function(e,t,n,r){n!==r&&(t.flags|=4)};function hu(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Tn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Kj(e,t,n){var r=t.pendingProps;switch(t0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tn(t),null;case 1:return ar(t.type)&&Vf(),Tn(t),null;case 3:return r=t.stateNode,Dl(),St(ir),St(Ln),c0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(_d(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Zr!==null&&(dg(Zr),Zr=null))),rg(e,t),Tn(t),null;case 5:u0(t);var o=Fa(sc.current);if(n=t.type,e!==null&&t.stateNode!=null)ak(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ie(166));return Tn(t),null}if(e=Fa(Ao.current),_d(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Co]=t,r[ic]=i,e=(t.mode&1)!==0,n){case"dialog":yt("cancel",r),yt("close",r);break;case"iframe":case"object":case"embed":yt("load",r);break;case"video":case"audio":for(o=0;o<_u.length;o++)yt(_u[o],r);break;case"source":yt("error",r);break;case"img":case"image":case"link":yt("error",r),yt("load",r);break;case"details":yt("toggle",r);break;case"input":Db(r,i),yt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},yt("invalid",r);break;case"textarea":Fb(r,i),yt("invalid",r)}Pv(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&Ed(r.textContent,s,e),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&Ed(r.textContent,s,e),o=["children",""+s]):Xu.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&yt("scroll",r)}switch(n){case"input":vd(r),jb(r,i,!0);break;case"textarea":vd(r),Ob(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Bf)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=jE(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Co]=t,e[ic]=r,ik(e,t,!1,!1),t.stateNode=e;e:{switch(a=Av(n,r),n){case"dialog":yt("cancel",e),yt("close",e),o=r;break;case"iframe":case"object":case"embed":yt("load",e),o=r;break;case"video":case"audio":for(o=0;o<_u.length;o++)yt(_u[o],e);o=r;break;case"source":yt("error",e),o=r;break;case"img":case"image":case"link":yt("error",e),yt("load",e),o=r;break;case"details":yt("toggle",e),o=r;break;case"input":Db(e,r),o=_v(e,r),yt("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=Dt({},r,{value:void 0}),yt("invalid",e);break;case"textarea":Fb(e,r),o=Tv(e,r),yt("invalid",e);break;default:o=r}Pv(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="style"?LE(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&FE(e,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Yu(e,l):typeof l=="number"&&Yu(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Xu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&yt("scroll",e):l!=null&&Vy(e,i,l,a))}switch(n){case"input":vd(e),jb(e,r,!1);break;case"textarea":vd(e),Ob(e);break;case"option":r.value!=null&&e.setAttribute("value",""+la(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Js(e,!!r.multiple,i,!1):r.defaultValue!=null&&Js(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Bf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tn(t),null;case 6:if(e&&t.stateNode!=null)sk(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ie(166));if(n=Fa(sc.current),Fa(Ao.current),_d(t)){if(r=t.stateNode,n=t.memoizedProps,r[Co]=t,(i=r.nodeValue!==n)&&(e=br,e!==null))switch(e.tag){case 3:Ed(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ed(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Co]=t,t.stateNode=r}return Tn(t),null;case 13:if(St(Rt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&vr!==null&&t.mode&1&&!(t.flags&128))__(),Il(),t.flags|=98560,i=!1;else if(i=_d(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ie(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ie(317));i[Co]=t}else Il(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tn(t),i=!1}else Zr!==null&&(dg(Zr),Zr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Rt.current&1?Jt===0&&(Jt=3):C0())),t.updateQueue!==null&&(t.flags|=4),Tn(t),null);case 4:return Dl(),rg(e,t),e===null&&rc(t.stateNode.containerInfo),Tn(t),null;case 10:return i0(t.type._context),Tn(t),null;case 17:return ar(t.type)&&Vf(),Tn(t),null;case 19:if(St(Rt),i=t.memoizedState,i===null)return Tn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)hu(i,!1);else{if(Jt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=qf(e),a!==null){for(t.flags|=128,hu(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return mt(Rt,Rt.current&1|2),t.child}e=e.sibling}i.tail!==null&&$t()>Fl&&(t.flags|=128,r=!0,hu(i,!1),t.lanes=4194304)}else{if(!r)if(e=qf(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),hu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!kt)return Tn(t),null}else 2*$t()-i.renderingStartTime>Fl&&n!==1073741824&&(t.flags|=128,r=!0,hu(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$t(),t.sibling=null,n=Rt.current,mt(Rt,r?n&1|2:n&1),t):(Tn(t),null);case 22:case 23:return w0(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?fr&1073741824&&(Tn(t),t.subtreeFlags&6&&(t.flags|=8192)):Tn(t),null;case 24:return null;case 25:return null}throw Error(ie(156,t.tag))}function Xj(e,t){switch(t0(t),t.tag){case 1:return ar(t.type)&&Vf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Dl(),St(ir),St(Ln),c0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return u0(t),null;case 13:if(St(Rt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ie(340));Il()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return St(Rt),null;case 4:return Dl(),null;case 10:return i0(t.type._context),null;case 22:case 23:return w0(),null;case 24:return null;default:return null}}var Td=!1,An=!1,Yj=typeof WeakSet=="function"?WeakSet:Set,ye=null;function Gs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Vt(e,t,r)}else n.current=null}function og(e,t,n){try{n()}catch(r){Vt(e,t,r)}}var kw=!1;function Qj(e,t){if(zv=Ff,e=f_(),Jy(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,l=-1,u=0,c=0,d=e,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=a+o),d!==i||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++u===o&&(s=a),f===i&&++c===r&&(l=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||l===-1?null:{start:s,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Wv={focusedElem:e,selectionRange:n},Ff=!1,ye=t;ye!==null;)if(t=ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ye=e;else for(;ye!==null;){t=ye;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,m=t.stateNode,x=m.getSnapshotBeforeUpdate(t.elementType===t.type?g:Kr(t.type,g),y);m.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(w){Vt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ye=e;break}ye=t.return}return v=kw,kw=!1,v}function Fu(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,i!==void 0&&og(t,n,i)}o=o.next}while(o!==r)}}function Yh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ig(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function lk(e){var t=e.alternate;t!==null&&(e.alternate=null,lk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Co],delete t[ic],delete t[Hv],delete t[Mj],delete t[Dj])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function uk(e){return e.tag===5||e.tag===3||e.tag===4}function Nw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||uk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ag(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Bf));else if(r!==4&&(e=e.child,e!==null))for(ag(e,t,n),e=e.sibling;e!==null;)ag(e,t,n),e=e.sibling}function sg(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(sg(e,t,n),e=e.sibling;e!==null;)sg(e,t,n),e=e.sibling}var vn=null,Qr=!1;function Ci(e,t,n){for(n=n.child;n!==null;)ck(e,t,n),n=n.sibling}function ck(e,t,n){if(Po&&typeof Po.onCommitFiberUnmount=="function")try{Po.onCommitFiberUnmount(Wh,n)}catch{}switch(n.tag){case 5:An||Gs(n,t);case 6:var r=vn,o=Qr;vn=null,Ci(e,t,n),vn=r,Qr=o,vn!==null&&(Qr?(e=vn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):vn.removeChild(n.stateNode));break;case 18:vn!==null&&(Qr?(e=vn,n=n.stateNode,e.nodeType===8?im(e.parentNode,n):e.nodeType===1&&im(e,n),ec(e)):im(vn,n.stateNode));break;case 4:r=vn,o=Qr,vn=n.stateNode.containerInfo,Qr=!0,Ci(e,t,n),vn=r,Qr=o;break;case 0:case 11:case 14:case 15:if(!An&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&og(n,t,a),o=o.next}while(o!==r)}Ci(e,t,n);break;case 1:if(!An&&(Gs(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Vt(n,t,s)}Ci(e,t,n);break;case 21:Ci(e,t,n);break;case 22:n.mode&1?(An=(r=An)||n.memoizedState!==null,Ci(e,t,n),An=r):Ci(e,t,n);break;default:Ci(e,t,n)}}function Tw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Yj),t.forEach(function(r){var o=aF.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Ur(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:vn=s.stateNode,Qr=!1;break e;case 3:vn=s.stateNode.containerInfo,Qr=!0;break e;case 4:vn=s.stateNode.containerInfo,Qr=!0;break e}s=s.return}if(vn===null)throw Error(ie(160));ck(i,a,o),vn=null,Qr=!1;var l=o.alternate;l!==null&&(l.return=null),o.return=null}catch(u){Vt(o,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)dk(t,e),t=t.sibling}function dk(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ur(t,e),po(e),r&4){try{Fu(3,e,e.return),Yh(3,e)}catch(g){Vt(e,e.return,g)}try{Fu(5,e,e.return)}catch(g){Vt(e,e.return,g)}}break;case 1:Ur(t,e),po(e),r&512&&n!==null&&Gs(n,n.return);break;case 5:if(Ur(t,e),po(e),r&512&&n!==null&&Gs(n,n.return),e.flags&32){var o=e.stateNode;try{Yu(o,"")}catch(g){Vt(e,e.return,g)}}if(r&4&&(o=e.stateNode,o!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&ME(o,i),Av(s,a);var u=Av(s,i);for(a=0;a<l.length;a+=2){var c=l[a],d=l[a+1];c==="style"?LE(o,d):c==="dangerouslySetInnerHTML"?FE(o,d):c==="children"?Yu(o,d):Vy(o,c,d,u)}switch(s){case"input":kv(o,i);break;case"textarea":DE(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Js(o,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?Js(o,!!i.multiple,i.defaultValue,!0):Js(o,!!i.multiple,i.multiple?[]:"",!1))}o[ic]=i}catch(g){Vt(e,e.return,g)}}break;case 6:if(Ur(t,e),po(e),r&4){if(e.stateNode===null)throw Error(ie(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(g){Vt(e,e.return,g)}}break;case 3:if(Ur(t,e),po(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ec(t.containerInfo)}catch(g){Vt(e,e.return,g)}break;case 4:Ur(t,e),po(e);break;case 13:Ur(t,e),po(e),o=e.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(x0=$t())),r&4&&Tw(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(An=(u=An)||c,Ur(t,e),An=u):Ur(t,e),po(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(ye=e,c=e.child;c!==null;){for(d=ye=c;ye!==null;){switch(f=ye,h=f.child,f.tag){case 0:case 11:case 14:case 15:Fu(4,f,f.return);break;case 1:Gs(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Vt(r,n,g)}}break;case 5:Gs(f,f.return);break;case 22:if(f.memoizedState!==null){Pw(d);continue}}h!==null?(h.return=f,ye=h):Pw(d)}c=c.sibling}e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{o=d.stateNode,u?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=OE("display",a))}catch(g){Vt(e,e.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Vt(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ur(t,e),po(e),r&4&&Tw(e);break;case 21:break;default:Ur(t,e),po(e)}}function po(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(uk(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Yu(o,""),r.flags&=-33);var i=Nw(e);sg(e,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=Nw(e);ag(e,s,a);break;default:throw Error(ie(161))}}catch(l){Vt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Zj(e,t,n){ye=e,fk(e)}function fk(e,t,n){for(var r=(e.mode&1)!==0;ye!==null;){var o=ye,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||Td;if(!a){var s=o.alternate,l=s!==null&&s.memoizedState!==null||An;s=Td;var u=An;if(Td=a,(An=l)&&!u)for(ye=o;ye!==null;)a=ye,l=a.child,a.tag===22&&a.memoizedState!==null?Aw(o):l!==null?(l.return=a,ye=l):Aw(o);for(;i!==null;)ye=i,fk(i),i=i.sibling;ye=o,Td=s,An=u}Rw(e)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ye=i):Rw(e)}}function Rw(e){for(;ye!==null;){var t=ye;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:An||Yh(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!An)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Kr(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&hw(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}hw(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&ec(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}An||t.flags&512&&ig(t)}catch(f){Vt(t,t.return,f)}}if(t===e){ye=null;break}if(n=t.sibling,n!==null){n.return=t.return,ye=n;break}ye=t.return}}function Pw(e){for(;ye!==null;){var t=ye;if(t===e){ye=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ye=n;break}ye=t.return}}function Aw(e){for(;ye!==null;){var t=ye;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Yh(4,t)}catch(l){Vt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(l){Vt(t,o,l)}}var i=t.return;try{ig(t)}catch(l){Vt(t,i,l)}break;case 5:var a=t.return;try{ig(t)}catch(l){Vt(t,a,l)}}}catch(l){Vt(t,t.return,l)}if(t===e){ye=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ye=s;break}ye=t.return}}var Jj=Math.ceil,Yf=mi.ReactCurrentDispatcher,g0=mi.ReactCurrentOwner,Lr=mi.ReactCurrentBatchConfig,Ze=0,fn=null,qt=null,wn=0,fr=0,qs=ya(0),Jt=0,dc=null,is=0,Qh=0,y0=0,Ou=null,er=null,x0=0,Fl=1/0,Qo=null,Qf=!1,lg=null,ea=null,Rd=!1,Hi=null,Zf=0,Lu=0,ug=null,gf=-1,yf=0;function Un(){return Ze&6?$t():gf!==-1?gf:gf=$t()}function ta(e){return e.mode&1?Ze&2&&wn!==0?wn&-wn:Fj.transition!==null?(yf===0&&(yf=YE()),yf):(e=st,e!==0||(e=window.event,e=e===void 0?16:r_(e.type)),e):1}function no(e,t,n,r){if(50<Lu)throw Lu=0,ug=null,Error(ie(185));Oc(e,n,r),(!(Ze&2)||e!==fn)&&(e===fn&&(!(Ze&2)&&(Qh|=n),Jt===4&&Mi(e,wn)),sr(e,r),n===1&&Ze===0&&!(t.mode&1)&&(Fl=$t()+500,qh&&xa()))}function sr(e,t){var n=e.callbackNode;FD(e,t);var r=jf(e,e===fn?wn:0);if(r===0)n!==null&&Vb(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Vb(n),t===1)e.tag===0?jj(Iw.bind(null,e)):C_(Iw.bind(null,e)),Aj(function(){!(Ze&6)&&xa()}),n=null;else{switch(QE(r)){case 1:n=Hy;break;case 4:n=KE;break;case 16:n=Df;break;case 536870912:n=XE;break;default:n=Df}n=bk(n,hk.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function hk(e,t){if(gf=-1,yf=0,Ze&6)throw Error(ie(327));var n=e.callbackNode;if(ol()&&e.callbackNode!==n)return null;var r=jf(e,e===fn?wn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Jf(e,r);else{t=r;var o=Ze;Ze|=2;var i=mk();(fn!==e||wn!==t)&&(Qo=null,Fl=$t()+500,Ya(e,t));do try{nF();break}catch(s){pk(e,s)}while(!0);o0(),Yf.current=i,Ze=o,qt!==null?t=0:(fn=null,wn=0,t=Jt)}if(t!==0){if(t===2&&(o=Fv(e),o!==0&&(r=o,t=cg(e,o))),t===1)throw n=dc,Ya(e,0),Mi(e,r),sr(e,$t()),n;if(t===6)Mi(e,r);else{if(o=e.current.alternate,!(r&30)&&!eF(o)&&(t=Jf(e,r),t===2&&(i=Fv(e),i!==0&&(r=i,t=cg(e,i))),t===1))throw n=dc,Ya(e,0),Mi(e,r),sr(e,$t()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(ie(345));case 2:Na(e,er,Qo);break;case 3:if(Mi(e,r),(r&130023424)===r&&(t=x0+500-$t(),10<t)){if(jf(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){Un(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Uv(Na.bind(null,e,er,Qo),t);break}Na(e,er,Qo);break;case 4:if(Mi(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-to(r);i=1<<a,a=t[a],a>o&&(o=a),r&=~i}if(r=o,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Jj(r/1960))-r,10<r){e.timeoutHandle=Uv(Na.bind(null,e,er,Qo),r);break}Na(e,er,Qo);break;case 5:Na(e,er,Qo);break;default:throw Error(ie(329))}}}return sr(e,$t()),e.callbackNode===n?hk.bind(null,e):null}function cg(e,t){var n=Ou;return e.current.memoizedState.isDehydrated&&(Ya(e,t).flags|=256),e=Jf(e,t),e!==2&&(t=er,er=n,t!==null&&dg(t)),e}function dg(e){er===null?er=e:er.push.apply(er,e)}function eF(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!ao(i(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Mi(e,t){for(t&=~y0,t&=~Qh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-to(t),r=1<<n;e[n]=-1,t&=~r}}function Iw(e){if(Ze&6)throw Error(ie(327));ol();var t=jf(e,0);if(!(t&1))return sr(e,$t()),null;var n=Jf(e,t);if(e.tag!==0&&n===2){var r=Fv(e);r!==0&&(t=r,n=cg(e,r))}if(n===1)throw n=dc,Ya(e,0),Mi(e,t),sr(e,$t()),n;if(n===6)throw Error(ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Na(e,er,Qo),sr(e,$t()),null}function b0(e,t){var n=Ze;Ze|=1;try{return e(t)}finally{Ze=n,Ze===0&&(Fl=$t()+500,qh&&xa())}}function as(e){Hi!==null&&Hi.tag===0&&!(Ze&6)&&ol();var t=Ze;Ze|=1;var n=Lr.transition,r=st;try{if(Lr.transition=null,st=1,e)return e()}finally{st=r,Lr.transition=n,Ze=t,!(Ze&6)&&xa()}}function w0(){fr=qs.current,St(qs)}function Ya(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Pj(n)),qt!==null)for(n=qt.return;n!==null;){var r=n;switch(t0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Vf();break;case 3:Dl(),St(ir),St(Ln),c0();break;case 5:u0(r);break;case 4:Dl();break;case 13:St(Rt);break;case 19:St(Rt);break;case 10:i0(r.type._context);break;case 22:case 23:w0()}n=n.return}if(fn=e,qt=e=na(e.current,null),wn=fr=t,Jt=0,dc=null,y0=Qh=is=0,er=Ou=null,ja!==null){for(t=0;t<ja.length;t++)if(n=ja[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}ja=null}return e}function pk(e,t){do{var n=qt;try{if(o0(),pf.current=Xf,Kf){for(var r=Mt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Kf=!1}if(os=0,dn=Qt=Mt=null,ju=!1,lc=0,g0.current=null,n===null||n.return===null){Jt=1,dc=t,qt=null;break}e:{var i=e,a=n.return,s=n,l=t;if(t=wn,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=xw(a);if(h!==null){h.flags&=-257,bw(h,a,s,i,t),h.mode&1&&yw(i,u,t),t=h,l=u;var v=t.updateQueue;if(v===null){var g=new Set;g.add(l),t.updateQueue=g}else v.add(l);break e}else{if(!(t&1)){yw(i,u,t),C0();break e}l=Error(ie(426))}}else if(kt&&s.mode&1){var y=xw(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),bw(y,a,s,i,t),n0(jl(l,s));break e}}i=l=jl(l,s),Jt!==4&&(Jt=2),Ou===null?Ou=[i]:Ou.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=Q_(i,l,t);fw(i,m);break e;case 1:s=l;var x=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ea===null||!ea.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=Z_(i,s,t);fw(i,w);break e}}i=i.return}while(i!==null)}gk(n)}catch(C){t=C,qt===n&&n!==null&&(qt=n=n.return);continue}break}while(!0)}function mk(){var e=Yf.current;return Yf.current=Xf,e===null?Xf:e}function C0(){(Jt===0||Jt===3||Jt===2)&&(Jt=4),fn===null||!(is&268435455)&&!(Qh&268435455)||Mi(fn,wn)}function Jf(e,t){var n=Ze;Ze|=2;var r=mk();(fn!==e||wn!==t)&&(Qo=null,Ya(e,t));do try{tF();break}catch(o){pk(e,o)}while(!0);if(o0(),Ze=n,Yf.current=r,qt!==null)throw Error(ie(261));return fn=null,wn=0,Jt}function tF(){for(;qt!==null;)vk(qt)}function nF(){for(;qt!==null&&!ND();)vk(qt)}function vk(e){var t=xk(e.alternate,e,fr);e.memoizedProps=e.pendingProps,t===null?gk(e):qt=t,g0.current=null}function gk(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Xj(n,t),n!==null){n.flags&=32767,qt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Jt=6,qt=null;return}}else if(n=Kj(n,t,fr),n!==null){qt=n;return}if(t=t.sibling,t!==null){qt=t;return}qt=t=e}while(t!==null);Jt===0&&(Jt=5)}function Na(e,t,n){var r=st,o=Lr.transition;try{Lr.transition=null,st=1,rF(e,t,n,r)}finally{Lr.transition=o,st=r}return null}function rF(e,t,n,r){do ol();while(Hi!==null);if(Ze&6)throw Error(ie(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ie(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(OD(e,i),e===fn&&(qt=fn=null,wn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Rd||(Rd=!0,bk(Df,function(){return ol(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Lr.transition,Lr.transition=null;var a=st;st=1;var s=Ze;Ze|=4,g0.current=null,Qj(e,n),dk(n,e),Sj(Wv),Ff=!!zv,Wv=zv=null,e.current=n,Zj(n),TD(),Ze=s,st=a,Lr.transition=i}else e.current=n;if(Rd&&(Rd=!1,Hi=e,Zf=o),i=e.pendingLanes,i===0&&(ea=null),AD(n.stateNode),sr(e,$t()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Qf)throw Qf=!1,e=lg,lg=null,e;return Zf&1&&e.tag!==0&&ol(),i=e.pendingLanes,i&1?e===ug?Lu++:(Lu=0,ug=e):Lu=0,xa(),null}function ol(){if(Hi!==null){var e=QE(Zf),t=Lr.transition,n=st;try{if(Lr.transition=null,st=16>e?16:e,Hi===null)var r=!1;else{if(e=Hi,Hi=null,Zf=0,Ze&6)throw Error(ie(331));var o=Ze;for(Ze|=4,ye=e.current;ye!==null;){var i=ye,a=i.child;if(ye.flags&16){var s=i.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(ye=u;ye!==null;){var c=ye;switch(c.tag){case 0:case 11:case 15:Fu(8,c,i)}var d=c.child;if(d!==null)d.return=c,ye=d;else for(;ye!==null;){c=ye;var f=c.sibling,h=c.return;if(lk(c),c===u){ye=null;break}if(f!==null){f.return=h,ye=f;break}ye=h}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ye=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ye=a;else e:for(;ye!==null;){if(i=ye,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Fu(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,ye=m;break e}ye=i.return}}var x=e.current;for(ye=x;ye!==null;){a=ye;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,ye=b;else e:for(a=x;ye!==null;){if(s=ye,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Yh(9,s)}}catch(C){Vt(s,s.return,C)}if(s===a){ye=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,ye=w;break e}ye=s.return}}if(Ze=o,xa(),Po&&typeof Po.onPostCommitFiberRoot=="function")try{Po.onPostCommitFiberRoot(Wh,e)}catch{}r=!0}return r}finally{st=n,Lr.transition=t}}return!1}function Mw(e,t,n){t=jl(n,t),t=Q_(e,t,1),e=Ji(e,t,1),t=Un(),e!==null&&(Oc(e,1,t),sr(e,t))}function Vt(e,t,n){if(e.tag===3)Mw(e,e,n);else for(;t!==null;){if(t.tag===3){Mw(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ea===null||!ea.has(r))){e=jl(n,e),e=Z_(t,e,1),t=Ji(t,e,1),e=Un(),t!==null&&(Oc(t,1,e),sr(t,e));break}}t=t.return}}function oF(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Un(),e.pingedLanes|=e.suspendedLanes&n,fn===e&&(wn&n)===n&&(Jt===4||Jt===3&&(wn&130023424)===wn&&500>$t()-x0?Ya(e,0):y0|=n),sr(e,t)}function yk(e,t){t===0&&(e.mode&1?(t=xd,xd<<=1,!(xd&130023424)&&(xd=4194304)):t=1);var n=Un();e=li(e,t),e!==null&&(Oc(e,t,n),sr(e,n))}function iF(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),yk(e,n)}function aF(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(t),yk(e,n)}var xk;xk=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ir.current)rr=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return rr=!1,qj(e,t,n);rr=!!(e.flags&131072)}else rr=!1,kt&&t.flags&1048576&&S_(t,$f,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;vf(e,t),e=t.pendingProps;var o=Al(t,Ln.current);rl(t,n),o=f0(null,t,r,e,o,n);var i=h0();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ar(r)?(i=!0,zf(t)):i=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,s0(t),o.updater=Xh,t.stateNode=o,o._reactInternals=t,Qv(t,r,e,n),t=eg(null,t,r,!0,i,n)):(t.tag=0,kt&&i&&e0(t),zn(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(vf(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=lF(r),e=Kr(r,e),o){case 0:t=Jv(null,t,r,e,n);break e;case 1:t=Sw(null,t,r,e,n);break e;case 11:t=ww(null,t,r,e,n);break e;case 14:t=Cw(null,t,r,Kr(r.type,e),n);break e}throw Error(ie(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kr(r,o),Jv(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kr(r,o),Sw(e,t,r,o,n);case 3:e:{if(nk(t),e===null)throw Error(ie(387));r=t.pendingProps,i=t.memoizedState,o=i.element,R_(e,t),Gf(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){o=jl(Error(ie(423)),t),t=Ew(e,t,r,n,o);break e}else if(r!==o){o=jl(Error(ie(424)),t),t=Ew(e,t,r,n,o);break e}else for(vr=Zi(t.stateNode.containerInfo.firstChild),br=t,kt=!0,Zr=null,n=N_(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Il(),r===o){t=ui(e,t,n);break e}zn(e,t,r,n)}t=t.child}return t;case 5:return P_(t),e===null&&Kv(t),r=t.type,o=t.pendingProps,i=e!==null?e.memoizedProps:null,a=o.children,$v(r,o)?a=null:i!==null&&$v(r,i)&&(t.flags|=32),tk(e,t),zn(e,t,a,n),t.child;case 6:return e===null&&Kv(t),null;case 13:return rk(e,t,n);case 4:return l0(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ml(t,null,r,n):zn(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kr(r,o),ww(e,t,r,o,n);case 7:return zn(e,t,t.pendingProps,n),t.child;case 8:return zn(e,t,t.pendingProps.children,n),t.child;case 12:return zn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,mt(Uf,r._currentValue),r._currentValue=a,i!==null)if(ao(i.value,a)){if(i.children===o.children&&!ir.current){t=ui(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=oi(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Xv(i.return,n,t),s.lanes|=n;break}l=l.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ie(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Xv(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}zn(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,rl(t,n),o=Vr(o),r=r(o),t.flags|=1,zn(e,t,r,n),t.child;case 14:return r=t.type,o=Kr(r,t.pendingProps),o=Kr(r.type,o),Cw(e,t,r,o,n);case 15:return J_(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Kr(r,o),vf(e,t),t.tag=1,ar(r)?(e=!0,zf(t)):e=!1,rl(t,n),Y_(t,r,o),Qv(t,r,o,n),eg(null,t,r,!0,e,n);case 19:return ok(e,t,n);case 22:return ek(e,t,n)}throw Error(ie(156,t.tag))};function bk(e,t){return qE(e,t)}function sF(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(e,t,n,r){return new sF(e,t,n,r)}function S0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function lF(e){if(typeof e=="function")return S0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wy)return 11;if(e===$y)return 14}return 2}function na(e,t){var n=e.alternate;return n===null?(n=jr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function xf(e,t,n,r,o,i){var a=2;if(r=e,typeof e=="function")S0(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Os:return Qa(n.children,o,i,t);case zy:a=8,o|=8;break;case wv:return e=jr(12,n,t,o|2),e.elementType=wv,e.lanes=i,e;case Cv:return e=jr(13,n,t,o),e.elementType=Cv,e.lanes=i,e;case Sv:return e=jr(19,n,t,o),e.elementType=Sv,e.lanes=i,e;case PE:return Zh(n,o,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case TE:a=10;break e;case RE:a=9;break e;case Wy:a=11;break e;case $y:a=14;break e;case Pi:a=16,r=null;break e}throw Error(ie(130,e==null?e:typeof e,""))}return t=jr(a,n,t,o),t.elementType=e,t.type=r,t.lanes=i,t}function Qa(e,t,n,r){return e=jr(7,e,r,t),e.lanes=n,e}function Zh(e,t,n,r){return e=jr(22,e,r,t),e.elementType=PE,e.lanes=n,e.stateNode={isHidden:!1},e}function hm(e,t,n){return e=jr(6,e,null,t),e.lanes=n,e}function pm(e,t,n){return t=jr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uF(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kp(0),this.expirationTimes=Kp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kp(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function E0(e,t,n,r,o,i,a,s,l){return e=new uF(e,t,n,s,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=jr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},s0(i),e}function cF(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function wk(e){if(!e)return ua;e=e._reactInternals;e:{if(ps(e)!==e||e.tag!==1)throw Error(ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ar(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ie(171))}if(e.tag===1){var n=e.type;if(ar(n))return w_(e,n,t)}return t}function Ck(e,t,n,r,o,i,a,s,l){return e=E0(n,r,!0,e,o,i,a,s,l),e.context=wk(null),n=e.current,r=Un(),o=ta(n),i=oi(r,o),i.callback=t??null,Ji(n,i,o),e.current.lanes=o,Oc(e,o,r),sr(e,r),e}function Jh(e,t,n,r){var o=t.current,i=Un(),a=ta(o);return n=wk(n),t.context===null?t.context=n:t.pendingContext=n,t=oi(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ji(o,t,a),e!==null&&(no(e,o,a,i),hf(e,o,a)),a}function eh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Dw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function _0(e,t){Dw(e,t),(e=e.alternate)&&Dw(e,t)}function dF(){return null}var Sk=typeof reportError=="function"?reportError:function(e){console.error(e)};function k0(e){this._internalRoot=e}ep.prototype.render=k0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ie(409));Jh(e,t,null,null)};ep.prototype.unmount=k0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;as(function(){Jh(null,e,null,null)}),t[si]=null}};function ep(e){this._internalRoot=e}ep.prototype.unstable_scheduleHydration=function(e){if(e){var t=e_();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ii.length&&t!==0&&t<Ii[n].priority;n++);Ii.splice(n,0,e),n===0&&n_(e)}};function N0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function tp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jw(){}function fF(e,t,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var u=eh(a);i.call(u)}}var a=Ck(t,r,e,0,null,!1,!1,"",jw);return e._reactRootContainer=a,e[si]=a.current,rc(e.nodeType===8?e.parentNode:e),as(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var u=eh(l);s.call(u)}}var l=E0(e,0,!1,null,null,!1,!1,"",jw);return e._reactRootContainer=l,e[si]=l.current,rc(e.nodeType===8?e.parentNode:e),as(function(){Jh(t,l,n,r)}),l}function np(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var l=eh(a);s.call(l)}}Jh(t,a,e,o)}else a=fF(n,t,e,o,r);return eh(a)}ZE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Eu(t.pendingLanes);n!==0&&(Gy(t,n|1),sr(t,$t()),!(Ze&6)&&(Fl=$t()+500,xa()))}break;case 13:as(function(){var r=li(e,1);if(r!==null){var o=Un();no(r,e,1,o)}}),_0(e,1)}};qy=function(e){if(e.tag===13){var t=li(e,134217728);if(t!==null){var n=Un();no(t,e,134217728,n)}_0(e,134217728)}};JE=function(e){if(e.tag===13){var t=ta(e),n=li(e,t);if(n!==null){var r=Un();no(n,e,t,r)}_0(e,t)}};e_=function(){return st};t_=function(e,t){var n=st;try{return st=e,t()}finally{st=n}};Mv=function(e,t,n){switch(t){case"input":if(kv(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Gh(r);if(!o)throw Error(ie(90));IE(r),kv(r,o)}}}break;case"textarea":DE(e,n);break;case"select":t=n.value,t!=null&&Js(e,!!n.multiple,t,!1)}};zE=b0;WE=as;var hF={usingClientEntryPoint:!1,Events:[Bc,zs,Gh,BE,VE,b0]},pu={findFiberByHostInstance:Da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pF={bundleType:pu.bundleType,version:pu.version,rendererPackageName:pu.rendererPackageName,rendererConfig:pu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=HE(e),e===null?null:e.stateNode},findFiberByHostInstance:pu.findFiberByHostInstance||dF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pd.isDisabled&&Pd.supportsFiber)try{Wh=Pd.inject(pF),Po=Pd}catch{}}Er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hF;Er.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N0(t))throw Error(ie(200));return cF(e,t,null,n)};Er.createRoot=function(e,t){if(!N0(e))throw Error(ie(299));var n=!1,r="",o=Sk;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=E0(e,1,!1,null,null,n,!1,r,o),e[si]=t.current,rc(e.nodeType===8?e.parentNode:e),new k0(t)};Er.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ie(188)):(e=Object.keys(e).join(","),Error(ie(268,e)));return e=HE(t),e=e===null?null:e.stateNode,e};Er.flushSync=function(e){return as(e)};Er.hydrate=function(e,t,n){if(!tp(t))throw Error(ie(200));return np(null,e,t,!0,n)};Er.hydrateRoot=function(e,t,n){if(!N0(e))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=Sk;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Ck(t,null,e,1,n??null,o,!1,i,a),e[si]=t.current,rc(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new ep(t)};Er.render=function(e,t,n){if(!tp(t))throw Error(ie(200));return np(null,e,t,!1,n)};Er.unmountComponentAtNode=function(e){if(!tp(e))throw Error(ie(40));return e._reactRootContainer?(as(function(){np(null,null,e,!1,function(){e._reactRootContainer=null,e[si]=null})}),!0):!1};Er.unstable_batchedUpdates=b0;Er.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!tp(n))throw Error(ie(200));if(e==null||e._reactInternals===void 0)throw Error(ie(38));return np(e,t,n,!1,r)};Er.version="18.3.1-next-f1338f8080-20240426";function Ek(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ek)}catch(e){console.error(e)}}Ek(),EE.exports=Er;var zc=EE.exports;const _k=fE(zc);var kk,Fw=zc;kk=Fw.createRoot,Fw.hydrateRoot;const mF=1,vF=1e6;let mm=0;function gF(){return mm=(mm+1)%Number.MAX_SAFE_INTEGER,mm.toString()}const vm=new Map,Ow=e=>{if(vm.has(e))return;const t=setTimeout(()=>{vm.delete(e),Bu({type:"REMOVE_TOAST",toastId:e})},vF);vm.set(e,t)},yF=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,mF)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?Ow(n):e.toasts.forEach(r=>{Ow(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},bf=[];let wf={toasts:[]};function Bu(e){wf=yF(wf,e),bf.forEach(t=>{t(wf)})}function xF({...e}){const t=gF(),n=o=>Bu({type:"UPDATE_TOAST",toast:{...o,id:t}}),r=()=>Bu({type:"DISMISS_TOAST",toastId:t});return Bu({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:o=>{o||r()}}}),{id:t,dismiss:r,update:n}}function Wc(){const[e,t]=S.useState(wf);return S.useEffect(()=>(bf.push(t),()=>{const n=bf.indexOf(t);n>-1&&bf.splice(n,1)}),[e]),{...e,toast:xF,dismiss:n=>Bu({type:"DISMISS_TOAST",toastId:n})}}function pt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e==null||e(o),n===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function Lw(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Nk(...e){return t=>{let n=!1;const r=e.map(o=>{const i=Lw(o,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let o=0;o<r.length;o++){const i=r[o];typeof i=="function"?i():Lw(e[o],null)}}}}function Sn(...e){return S.useCallback(Nk(...e),e)}function bF(e,t){const n=S.createContext(t),r=i=>{const{children:a,...s}=i,l=S.useMemo(()=>s,Object.values(s));return p.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function o(i){const a=S.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,o]}function Kl(e,t=[]){let n=[];function r(i,a){const s=S.createContext(a),l=n.length;n=[...n,a];const u=d=>{var m;const{scope:f,children:h,...v}=d,g=((m=f==null?void 0:f[e])==null?void 0:m[l])||s,y=S.useMemo(()=>v,Object.values(v));return p.jsx(g.Provider,{value:y,children:h})};u.displayName=i+"Provider";function c(d,f){var g;const h=((g=f==null?void 0:f[e])==null?void 0:g[l])||s,v=S.useContext(h);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[u,c]}const o=()=>{const i=n.map(a=>S.createContext(a));return function(s){const l=(s==null?void 0:s[e])||i;return S.useMemo(()=>({[`__scope${e}`]:{...s,[e]:l}}),[s,l])}};return o.scopeName=e,[r,wF(o,...t)]}function wF(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:l,scopeName:u})=>{const d=l(i)[`__scope${u}`];return{...s,...d}},{});return S.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function fc(e){const t=SF(e),n=S.forwardRef((r,o)=>{const{children:i,...a}=r,s=S.Children.toArray(i),l=s.find(_F);if(l){const u=l.props.children,c=s.map(d=>d===l?S.Children.count(u)>1?S.Children.only(null):S.isValidElement(u)?u.props.children:null:d);return p.jsx(t,{...a,ref:o,children:S.isValidElement(u)?S.cloneElement(u,void 0,c):null})}return p.jsx(t,{...a,ref:o,children:i})});return n.displayName=`${e}.Slot`,n}var CF=fc("Slot");function SF(e){const t=S.forwardRef((n,r)=>{const{children:o,...i}=n;if(S.isValidElement(o)){const a=NF(o),s=kF(i,o.props);return o.type!==S.Fragment&&(s.ref=r?Nk(r,a):a),S.cloneElement(o,s)}return S.Children.count(o)>1?S.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Tk=Symbol("radix.slottable");function EF(e){const t=({children:n})=>p.jsx(p.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Tk,t}function _F(e){return S.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Tk}function kF(e,t){const n={...t};for(const r in t){const o=e[r],i=t[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...s)=>{const l=i(...s);return o(...s),l}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...e,...n}}function NF(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function TF(e){const t=e+"CollectionProvider",[n,r]=Kl(t),[o,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=g=>{const{scope:y,children:m}=g,x=le.useRef(null),b=le.useRef(new Map).current;return p.jsx(o,{scope:y,itemMap:b,collectionRef:x,children:m})};a.displayName=t;const s=e+"CollectionSlot",l=fc(s),u=le.forwardRef((g,y)=>{const{scope:m,children:x}=g,b=i(s,m),w=Sn(y,b.collectionRef);return p.jsx(l,{ref:w,children:x})});u.displayName=s;const c=e+"CollectionItemSlot",d="data-radix-collection-item",f=fc(c),h=le.forwardRef((g,y)=>{const{scope:m,children:x,...b}=g,w=le.useRef(null),C=Sn(y,w),E=i(c,m);return le.useEffect(()=>(E.itemMap.set(w,{ref:w,...b}),()=>void E.itemMap.delete(w))),p.jsx(f,{[d]:"",ref:C,children:x})});h.displayName=c;function v(g){const y=i(e+"CollectionConsumer",g);return le.useCallback(()=>{const x=y.collectionRef.current;if(!x)return[];const b=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((E,_)=>b.indexOf(E.ref.current)-b.indexOf(_.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:a,Slot:u,ItemSlot:h},v,r]}var RF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Tt=RF.reduce((e,t)=>{const n=fc(`Primitive.${t}`),r=S.forwardRef((o,i)=>{const{asChild:a,...s}=o,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...s,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function Rk(e,t){e&&zc.flushSync(()=>e.dispatchEvent(t))}function Lo(e){const t=S.useRef(e);return S.useEffect(()=>{t.current=e}),S.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function PF(e,t=globalThis==null?void 0:globalThis.document){const n=Lo(e);S.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var AF="DismissableLayer",fg="dismissableLayer.update",IF="dismissableLayer.pointerDownOutside",MF="dismissableLayer.focusOutside",Bw,Pk=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),rp=S.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:a,onDismiss:s,...l}=e,u=S.useContext(Pk),[c,d]=S.useState(null),f=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=S.useState({}),v=Sn(t,_=>d(_)),g=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),m=g.indexOf(y),x=c?g.indexOf(c):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,w=x>=m,C=jF(_=>{const N=_.target,T=[...u.branches].some(k=>k.contains(N));!w||T||(o==null||o(_),a==null||a(_),_.defaultPrevented||s==null||s())},f),E=FF(_=>{const N=_.target;[...u.branches].some(k=>k.contains(N))||(i==null||i(_),a==null||a(_),_.defaultPrevented||s==null||s())},f);return PF(_=>{x===u.layers.size-1&&(r==null||r(_),!_.defaultPrevented&&s&&(_.preventDefault(),s()))},f),S.useEffect(()=>{if(c)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Bw=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),Vw(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Bw)}},[c,f,n,u]),S.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),Vw())},[c,u]),S.useEffect(()=>{const _=()=>h({});return document.addEventListener(fg,_),()=>document.removeEventListener(fg,_)},[]),p.jsx(Tt.div,{...l,ref:v,style:{pointerEvents:b?w?"auto":"none":void 0,...e.style},onFocusCapture:pt(e.onFocusCapture,E.onFocusCapture),onBlurCapture:pt(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:pt(e.onPointerDownCapture,C.onPointerDownCapture)})});rp.displayName=AF;var DF="DismissableLayerBranch",Ak=S.forwardRef((e,t)=>{const n=S.useContext(Pk),r=S.useRef(null),o=Sn(t,r);return S.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),p.jsx(Tt.div,{...e,ref:o})});Ak.displayName=DF;function jF(e,t=globalThis==null?void 0:globalThis.document){const n=Lo(e),r=S.useRef(!1),o=S.useRef(()=>{});return S.useEffect(()=>{const i=s=>{if(s.target&&!r.current){let l=function(){Ik(IF,n,u,{discrete:!0})};const u={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=l,t.addEventListener("click",o.current,{once:!0})):l()}else t.removeEventListener("click",o.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function FF(e,t=globalThis==null?void 0:globalThis.document){const n=Lo(e),r=S.useRef(!1);return S.useEffect(()=>{const o=i=>{i.target&&!r.current&&Ik(MF,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Vw(){const e=new CustomEvent(fg);document.dispatchEvent(e)}function Ik(e,t,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Rk(o,i):o.dispatchEvent(i)}var OF=rp,LF=Ak,ci=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{},BF="Portal",T0=S.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[o,i]=S.useState(!1);ci(()=>i(!0),[]);const a=n||o&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return a?_k.createPortal(p.jsx(Tt.div,{...r,ref:t}),a):null});T0.displayName=BF;function VF(e,t){return S.useReducer((n,r)=>t[n][r]??n,e)}var ms=e=>{const{present:t,children:n}=e,r=zF(t),o=typeof n=="function"?n({present:r.isPresent}):S.Children.only(n),i=Sn(r.ref,WF(o));return typeof n=="function"||r.isPresent?S.cloneElement(o,{ref:i}):null};ms.displayName="Presence";function zF(e){const[t,n]=S.useState(),r=S.useRef(null),o=S.useRef(e),i=S.useRef("none"),a=e?"mounted":"unmounted",[s,l]=VF(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const u=Ad(r.current);i.current=s==="mounted"?u:"none"},[s]),ci(()=>{const u=r.current,c=o.current;if(c!==e){const f=i.current,h=Ad(u);e?l("MOUNT"):h==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&f!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,l]),ci(()=>{if(t){let u;const c=t.ownerDocument.defaultView??window,d=h=>{const g=Ad(r.current).includes(h.animationName);if(h.target===t&&g&&(l("ANIMATION_END"),!o.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",u=c.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},f=h=>{h.target===t&&(i.current=Ad(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{c.clearTimeout(u),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:S.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function Ad(e){return(e==null?void 0:e.animationName)||"none"}function WF(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var $F=Oy[" useInsertionEffect ".trim().toString()]||ci;function R0({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[o,i,a]=UF({defaultProp:t,onChange:n}),s=e!==void 0,l=s?e:o;{const c=S.useRef(e!==void 0);S.useEffect(()=>{const d=c.current;d!==s&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),c.current=s},[s,r])}const u=S.useCallback(c=>{var d;if(s){const f=HF(c)?c(e):c;f!==e&&((d=a.current)==null||d.call(a,f))}else i(c)},[s,e,i,a]);return[l,u]}function UF({defaultProp:e,onChange:t}){const[n,r]=S.useState(e),o=S.useRef(n),i=S.useRef(t);return $F(()=>{i.current=t},[t]),S.useEffect(()=>{var a;o.current!==n&&((a=i.current)==null||a.call(i,n),o.current=n)},[n,o]),[n,r,i]}function HF(e){return typeof e=="function"}var GF=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),qF="VisuallyHidden",op=S.forwardRef((e,t)=>p.jsx(Tt.span,{...e,ref:t,style:{...GF,...e.style}}));op.displayName=qF;var KF=op,P0="ToastProvider",[A0,XF,YF]=TF("Toast"),[Mk,wY]=Kl("Toast",[YF]),[QF,ip]=Mk(P0),Dk=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:i=50,children:a}=e,[s,l]=S.useState(null),[u,c]=S.useState(0),d=S.useRef(!1),f=S.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${P0}\`. Expected non-empty \`string\`.`),p.jsx(A0.Provider,{scope:t,children:p.jsx(QF,{scope:t,label:n,duration:r,swipeDirection:o,swipeThreshold:i,toastCount:u,viewport:s,onViewportChange:l,onToastAdd:S.useCallback(()=>c(h=>h+1),[]),onToastRemove:S.useCallback(()=>c(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:a})})};Dk.displayName=P0;var jk="ToastViewport",ZF=["F8"],hg="toast.viewportPause",pg="toast.viewportResume",Fk=S.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=ZF,label:o="Notifications ({hotkey})",...i}=e,a=ip(jk,n),s=XF(n),l=S.useRef(null),u=S.useRef(null),c=S.useRef(null),d=S.useRef(null),f=Sn(t,d,a.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=a.toastCount>0;S.useEffect(()=>{const y=m=>{var b;r.length!==0&&r.every(w=>m[w]||m.code===w)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),S.useEffect(()=>{const y=l.current,m=d.current;if(v&&y&&m){const x=()=>{if(!a.isClosePausedRef.current){const E=new CustomEvent(hg);m.dispatchEvent(E),a.isClosePausedRef.current=!0}},b=()=>{if(a.isClosePausedRef.current){const E=new CustomEvent(pg);m.dispatchEvent(E),a.isClosePausedRef.current=!1}},w=E=>{!y.contains(E.relatedTarget)&&b()},C=()=>{y.contains(document.activeElement)||b()};return y.addEventListener("focusin",x),y.addEventListener("focusout",w),y.addEventListener("pointermove",x),y.addEventListener("pointerleave",C),window.addEventListener("blur",x),window.addEventListener("focus",b),()=>{y.removeEventListener("focusin",x),y.removeEventListener("focusout",w),y.removeEventListener("pointermove",x),y.removeEventListener("pointerleave",C),window.removeEventListener("blur",x),window.removeEventListener("focus",b)}}},[v,a.isClosePausedRef]);const g=S.useCallback(({tabbingDirection:y})=>{const x=s().map(b=>{const w=b.ref.current,C=[w,...d3(w)];return y==="forwards"?C:C.reverse()});return(y==="forwards"?x.reverse():x).flat()},[s]);return S.useEffect(()=>{const y=d.current;if(y){const m=x=>{var C,E,_;const b=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!b){const N=document.activeElement,T=x.shiftKey;if(x.target===y&&T){(C=u.current)==null||C.focus();return}const A=g({tabbingDirection:T?"backwards":"forwards"}),U=A.findIndex(B=>B===N);gm(A.slice(U+1))?x.preventDefault():T?(E=u.current)==null||E.focus():(_=c.current)==null||_.focus()}};return y.addEventListener("keydown",m),()=>y.removeEventListener("keydown",m)}},[s,g]),p.jsxs(LF,{ref:l,role:"region","aria-label":o.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&p.jsx(mg,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});gm(y)}}),p.jsx(A0.Slot,{scope:n,children:p.jsx(Tt.ol,{tabIndex:-1,...i,ref:f})}),v&&p.jsx(mg,{ref:c,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});gm(y)}})]})});Fk.displayName=jk;var Ok="ToastFocusProxy",mg=S.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=e,i=ip(Ok,n);return p.jsx(op,{"aria-hidden":!0,tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:a=>{var u;const s=a.relatedTarget;!((u=i.viewport)!=null&&u.contains(s))&&r()}})});mg.displayName=Ok;var $c="Toast",JF="toast.swipeStart",e3="toast.swipeMove",t3="toast.swipeCancel",n3="toast.swipeEnd",Lk=S.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:i,...a}=e,[s,l]=R0({prop:r,defaultProp:o??!0,onChange:i,caller:$c});return p.jsx(ms,{present:n||s,children:p.jsx(i3,{open:s,...a,ref:t,onClose:()=>l(!1),onPause:Lo(e.onPause),onResume:Lo(e.onResume),onSwipeStart:pt(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:pt(e.onSwipeMove,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:pt(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:pt(e.onSwipeEnd,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});Lk.displayName=$c;var[r3,o3]=Mk($c,{onClose(){}}),i3=S.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:i,onClose:a,onEscapeKeyDown:s,onPause:l,onResume:u,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...v}=e,g=ip($c,n),[y,m]=S.useState(null),x=Sn(t,B=>m(B)),b=S.useRef(null),w=S.useRef(null),C=o||g.duration,E=S.useRef(0),_=S.useRef(C),N=S.useRef(0),{onToastAdd:T,onToastRemove:k}=g,I=Lo(()=>{var L;(y==null?void 0:y.contains(document.activeElement))&&((L=g.viewport)==null||L.focus()),a()}),A=S.useCallback(B=>{!B||B===1/0||(window.clearTimeout(N.current),E.current=new Date().getTime(),N.current=window.setTimeout(I,B))},[I]);S.useEffect(()=>{const B=g.viewport;if(B){const L=()=>{A(_.current),u==null||u()},V=()=>{const F=new Date().getTime()-E.current;_.current=_.current-F,window.clearTimeout(N.current),l==null||l()};return B.addEventListener(hg,V),B.addEventListener(pg,L),()=>{B.removeEventListener(hg,V),B.removeEventListener(pg,L)}}},[g.viewport,C,l,u,A]),S.useEffect(()=>{i&&!g.isClosePausedRef.current&&A(C)},[i,C,g.isClosePausedRef,A]),S.useEffect(()=>(T(),()=>k()),[T,k]);const U=S.useMemo(()=>y?Hk(y):null,[y]);return g.viewport?p.jsxs(p.Fragment,{children:[U&&p.jsx(a3,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:U}),p.jsx(r3,{scope:n,onClose:I,children:zc.createPortal(p.jsx(A0.ItemSlot,{scope:n,children:p.jsx(OF,{asChild:!0,onEscapeKeyDown:pt(s,()=>{g.isFocusedToastEscapeKeyDownRef.current||I(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:p.jsx(Tt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:x,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:pt(e.onKeyDown,B=>{B.key==="Escape"&&(s==null||s(B.nativeEvent),B.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,I()))}),onPointerDown:pt(e.onPointerDown,B=>{B.button===0&&(b.current={x:B.clientX,y:B.clientY})}),onPointerMove:pt(e.onPointerMove,B=>{if(!b.current)return;const L=B.clientX-b.current.x,V=B.clientY-b.current.y,F=!!w.current,M=["left","right"].includes(g.swipeDirection),j=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,R=M?j(0,L):0,P=M?0:j(0,V),z=B.pointerType==="touch"?10:2,G={x:R,y:P},q={originalEvent:B,delta:G};F?(w.current=G,Id(e3,d,q,{discrete:!1})):zw(G,g.swipeDirection,z)?(w.current=G,Id(JF,c,q,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(L)>z||Math.abs(V)>z)&&(b.current=null)}),onPointerUp:pt(e.onPointerUp,B=>{const L=w.current,V=B.target;if(V.hasPointerCapture(B.pointerId)&&V.releasePointerCapture(B.pointerId),w.current=null,b.current=null,L){const F=B.currentTarget,M={originalEvent:B,delta:L};zw(L,g.swipeDirection,g.swipeThreshold)?Id(n3,h,M,{discrete:!0}):Id(t3,f,M,{discrete:!0}),F.addEventListener("click",j=>j.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),a3=e=>{const{__scopeToast:t,children:n,...r}=e,o=ip($c,t),[i,a]=S.useState(!1),[s,l]=S.useState(!1);return u3(()=>a(!0)),S.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),s?null:p.jsx(T0,{asChild:!0,children:p.jsx(op,{...r,children:i&&p.jsxs(p.Fragment,{children:[o.label," ",n]})})})},s3="ToastTitle",Bk=S.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return p.jsx(Tt.div,{...r,ref:t})});Bk.displayName=s3;var l3="ToastDescription",Vk=S.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return p.jsx(Tt.div,{...r,ref:t})});Vk.displayName=l3;var zk="ToastAction",Wk=S.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?p.jsx(Uk,{altText:n,asChild:!0,children:p.jsx(I0,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${zk}\`. Expected non-empty \`string\`.`),null)});Wk.displayName=zk;var $k="ToastClose",I0=S.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,o=o3($k,n);return p.jsx(Uk,{asChild:!0,children:p.jsx(Tt.button,{type:"button",...r,ref:t,onClick:pt(e.onClick,o.onClose)})})});I0.displayName=$k;var Uk=S.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...o}=e;return p.jsx(Tt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:t})});function Hk(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),c3(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!o)if(i){const a=r.dataset.radixToastAnnounceAlt;a&&t.push(a)}else t.push(...Hk(r))}}),t}function Id(e,t,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Rk(o,i):o.dispatchEvent(i)}var zw=(e,t,n=0)=>{const r=Math.abs(e.x),o=Math.abs(e.y),i=r>o;return t==="left"||t==="right"?i&&r>n:!i&&o>n};function u3(e=()=>{}){const t=Lo(e);ci(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function c3(e){return e.nodeType===e.ELEMENT_NODE}function d3(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function gm(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var f3=Dk,Gk=Fk,qk=Lk,Kk=Bk,Xk=Vk,Yk=Wk,Qk=I0;function Zk(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=Zk(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Jk(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=Zk(e))&&(r&&(r+=" "),r+=t);return r}const Ww=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,$w=Jk,ap=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return $w(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:i}=t,a=Object.keys(o).map(u=>{const c=n==null?void 0:n[u],d=i==null?void 0:i[u];if(c===null)return null;const f=Ww(c)||Ww(d);return o[u][f]}),s=n&&Object.entries(n).reduce((u,c)=>{let[d,f]=c;return f===void 0||(u[d]=f),u},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((u,c)=>{let{class:d,className:f,...h}=c;return Object.entries(h).every(v=>{let[g,y]=v;return Array.isArray(y)?y.includes({...i,...s}[g]):{...i,...s}[g]===y})?[...u,d,f]:u},[]);return $w(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eN=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var p3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=S.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:a,...s},l)=>S.createElement("svg",{ref:l,...p3,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:eN("lucide",o),...s},[...a.map(([u,c])=>S.createElement(u,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=(e,t)=>{const n=S.forwardRef(({className:r,...o},i)=>S.createElement(m3,{ref:i,iconNode:t,className:eN(`lucide-${h3(e)}`,r),...o}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=qe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=qe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=qe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=qe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=qe("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=qe("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=qe("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=qe("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=qe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=qe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=qe("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=qe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=qe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=qe("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=qe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=qe("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=qe("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=qe("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=qe("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=qe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=qe("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=qe("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=qe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=qe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=qe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nh=qe("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=qe("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=qe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=qe("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=qe("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=qe("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=qe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=qe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=qe("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=qe("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=qe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=qe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),F0="-",T3=e=>{const t=P3(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const s=a.split(F0);return s[0]===""&&s.length!==1&&s.shift(),aN(s,t)||R3(a)},getConflictingClassGroupIds:(a,s)=>{const l=n[a]||[];return s&&r[a]?[...l,...r[a]]:l}}},aN=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?aN(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const i=e.join(F0);return(a=t.validators.find(({validator:s})=>s(i)))==null?void 0:a.classGroupId},Kw=/^\[(.+)\]$/,R3=e=>{if(Kw.test(e)){const t=Kw.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},P3=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return I3(Object.entries(e.classGroups),n).forEach(([i,a])=>{xg(a,r,i,t)}),r},xg=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const i=o===""?t:Xw(t,o);i.classGroupId=n;return}if(typeof o=="function"){if(A3(o)){xg(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,a])=>{xg(a,Xw(t,i),n,r)})})},Xw=(e,t)=>{let n=e;return t.split(F0).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},A3=e=>e.isThemeGetter,I3=(e,t)=>t?e.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,s])=>[t+a,s])):i);return[n,o]}):e,M3=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){n.has(i)?n.set(i,a):o(i,a)}}},sN="!",D3=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,o=t[0],i=t.length,a=s=>{const l=[];let u=0,c=0,d;for(let y=0;y<s.length;y++){let m=s[y];if(u===0){if(m===o&&(r||s.slice(y,y+i)===t)){l.push(s.slice(c,y)),c=y+i;continue}if(m==="/"){d=y;continue}}m==="["?u++:m==="]"&&u--}const f=l.length===0?s:s.substring(c),h=f.startsWith(sN),v=h?f.substring(1):f,g=d&&d>c?d-c:void 0;return{modifiers:l,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:g}};return n?s=>n({className:s,parseClassName:a}):a},j3=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},F3=e=>({cache:M3(e.cacheSize),parseClassName:D3(e),...T3(e)}),O3=/\s+/,L3=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=t,i=[],a=e.trim().split(O3);let s="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(u);let v=!!h,g=r(v?f.substring(0,h):f);if(!g){if(!v){s=u+(s.length>0?" "+s:s);continue}if(g=r(f),!g){s=u+(s.length>0?" "+s:s);continue}v=!1}const y=j3(c).join(":"),m=d?y+sN:y,x=m+g;if(i.includes(x))continue;i.push(x);const b=o(g,v);for(let w=0;w<b.length;++w){const C=b[w];i.push(m+C)}s=u+(s.length>0?" "+s:s)}return s};function B3(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=lN(t))&&(r&&(r+=" "),r+=n);return r}const lN=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=lN(e[r]))&&(n&&(n+=" "),n+=t);return n};function V3(e,...t){let n,r,o,i=a;function a(l){const u=t.reduce((c,d)=>d(c),e());return n=F3(u),r=n.cache.get,o=n.cache.set,i=s,s(l)}function s(l){const u=r(l);if(u)return u;const c=L3(l,n);return o(l,c),c}return function(){return i(B3.apply(null,arguments))}}const gt=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},uN=/^\[(?:([a-z-]+):)?(.+)\]$/i,z3=/^\d+\/\d+$/,W3=new Set(["px","full","screen"]),$3=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,U3=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,H3=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,G3=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,q3=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,qo=e=>al(e)||W3.has(e)||z3.test(e),Si=e=>Xl(e,"length",t4),al=e=>!!e&&!Number.isNaN(Number(e)),ym=e=>Xl(e,"number",al),mu=e=>!!e&&Number.isInteger(Number(e)),K3=e=>e.endsWith("%")&&al(e.slice(0,-1)),Be=e=>uN.test(e),Ei=e=>$3.test(e),X3=new Set(["length","size","percentage"]),Y3=e=>Xl(e,X3,cN),Q3=e=>Xl(e,"position",cN),Z3=new Set(["image","url"]),J3=e=>Xl(e,Z3,r4),e4=e=>Xl(e,"",n4),vu=()=>!0,Xl=(e,t,n)=>{const r=uN.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},t4=e=>U3.test(e)&&!H3.test(e),cN=()=>!1,n4=e=>G3.test(e),r4=e=>q3.test(e),o4=()=>{const e=gt("colors"),t=gt("spacing"),n=gt("blur"),r=gt("brightness"),o=gt("borderColor"),i=gt("borderRadius"),a=gt("borderSpacing"),s=gt("borderWidth"),l=gt("contrast"),u=gt("grayscale"),c=gt("hueRotate"),d=gt("invert"),f=gt("gap"),h=gt("gradientColorStops"),v=gt("gradientColorStopPositions"),g=gt("inset"),y=gt("margin"),m=gt("opacity"),x=gt("padding"),b=gt("saturate"),w=gt("scale"),C=gt("sepia"),E=gt("skew"),_=gt("space"),N=gt("translate"),T=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto",Be,t],A=()=>[Be,t],U=()=>["",qo,Si],B=()=>["auto",al,Be],L=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],V=()=>["solid","dashed","dotted","double","none"],F=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],j=()=>["","0",Be],R=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>[al,Be];return{cacheSize:500,separator:":",theme:{colors:[vu],spacing:[qo,Si],blur:["none","",Ei,Be],brightness:P(),borderColor:[e],borderRadius:["none","","full",Ei,Be],borderSpacing:A(),borderWidth:U(),contrast:P(),grayscale:j(),hueRotate:P(),invert:j(),gap:A(),gradientColorStops:[e],gradientColorStopPositions:[K3,Si],inset:I(),margin:I(),opacity:P(),padding:A(),saturate:P(),scale:P(),sepia:j(),skew:P(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",Be]}],container:["container"],columns:[{columns:[Ei]}],"break-after":[{"break-after":R()}],"break-before":[{"break-before":R()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...L(),Be]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",mu,Be]}],basis:[{basis:I()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Be]}],grow:[{grow:j()}],shrink:[{shrink:j()}],order:[{order:["first","last","none",mu,Be]}],"grid-cols":[{"grid-cols":[vu]}],"col-start-end":[{col:["auto",{span:["full",mu,Be]},Be]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[vu]}],"row-start-end":[{row:["auto",{span:[mu,Be]},Be]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Be]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Be]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Be,t]}],"min-w":[{"min-w":[Be,t,"min","max","fit"]}],"max-w":[{"max-w":[Be,t,"none","full","min","max","fit","prose",{screen:[Ei]},Ei]}],h:[{h:[Be,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Be,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Be,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Be,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ei,Si]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ym]}],"font-family":[{font:[vu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Be]}],"line-clamp":[{"line-clamp":["none",al,ym]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",qo,Be]}],"list-image":[{"list-image":["none",Be]}],"list-style-type":[{list:["none","disc","decimal",Be]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[m]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[m]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",qo,Si]}],"underline-offset":[{"underline-offset":["auto",qo,Be]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Be]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Be]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[m]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...L(),Q3]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Y3]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},J3]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[m]}],"border-style":[{border:[...V(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[m]}],"divide-style":[{divide:V()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...V()]}],"outline-offset":[{"outline-offset":[qo,Be]}],"outline-w":[{outline:[qo,Si]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:U()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[m]}],"ring-offset-w":[{"ring-offset":[qo,Si]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ei,e4]}],"shadow-color":[{shadow:[vu]}],opacity:[{opacity:[m]}],"mix-blend":[{"mix-blend":[...F(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ei,Be]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[m]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Be]}],duration:[{duration:P()}],ease:[{ease:["linear","in","out","in-out",Be]}],delay:[{delay:P()}],animate:[{animate:["none","spin","ping","pulse","bounce",Be]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[mu,Be]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Be]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Be]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Be]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[qo,Si,ym]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},i4=V3(o4);function Et(...e){return i4(Jk(e))}const a4=f3,dN=S.forwardRef(({className:e,...t},n)=>p.jsx(Gk,{ref:n,className:Et("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));dN.displayName=Gk.displayName;const s4=ap("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),fN=S.forwardRef(({className:e,variant:t,...n},r)=>p.jsx(qk,{ref:r,className:Et(s4({variant:t}),e),...n}));fN.displayName=qk.displayName;const l4=S.forwardRef(({className:e,...t},n)=>p.jsx(Yk,{ref:n,className:Et("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));l4.displayName=Yk.displayName;const hN=S.forwardRef(({className:e,...t},n)=>p.jsx(Qk,{ref:n,className:Et("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:p.jsx(j0,{className:"h-4 w-4"})}));hN.displayName=Qk.displayName;const pN=S.forwardRef(({className:e,...t},n)=>p.jsx(Kk,{ref:n,className:Et("text-sm font-semibold",e),...t}));pN.displayName=Kk.displayName;const mN=S.forwardRef(({className:e,...t},n)=>p.jsx(Xk,{ref:n,className:Et("text-sm opacity-90",e),...t}));mN.displayName=Xk.displayName;function u4(){const{toasts:e}=Wc();return p.jsxs(a4,{children:[e.map(function({id:t,title:n,description:r,action:o,...i}){return p.jsxs(fN,{...i,children:[p.jsxs("div",{className:"grid gap-1",children:[n&&p.jsx(pN,{children:n}),r&&p.jsx(mN,{children:r})]}),o,p.jsx(hN,{})]},t)}),p.jsx(dN,{})]})}var Yw=["light","dark"],c4="(prefers-color-scheme: dark)",d4=S.createContext(void 0),f4={setTheme:e=>{},themes:[]},h4=()=>{var e;return(e=S.useContext(d4))!=null?e:f4};S.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:o,defaultTheme:i,value:a,attrs:s,nonce:l})=>{let u=i==="system",c=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=o?Yw.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(v,g=!1,y=!0)=>{let m=a?a[v]:v,x=g?v+"|| ''":`'${m}'`,b="";return o&&y&&!g&&Yw.includes(v)&&(b+=`d.style.colorScheme = '${v}';`),n==="class"?g||m?b+=`c.add(${x})`:b+="null":m&&(b+=`d[s](n,${x})`),b},h=e?`!function(){${c}${f(e)}}()`:r?`!function(){try{${c}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${c4}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${c}var e=localStorage.getItem('${t}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${d}}catch(t){}}();`;return S.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:h}})});var p4=e=>{switch(e){case"success":return g4;case"info":return x4;case"warning":return y4;case"error":return b4;default:return null}},m4=Array(12).fill(0),v4=({visible:e,className:t})=>le.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},le.createElement("div",{className:"sonner-spinner"},m4.map((n,r)=>le.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),g4=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),y4=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),x4=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),b4=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),w4=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},le.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),le.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),C4=()=>{let[e,t]=le.useState(document.hidden);return le.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},bg=1,S4=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;let{message:r,...o}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:bg++,a=this.toasts.find(l=>l.id===i),s=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:s,title:r}):l):this.addToast({title:r,...o,dismissible:s,id:i}),i},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:t,dismiss:!0})),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let o=t instanceof Promise?t:t(),i=r!==void 0,a,s=o.then(async u=>{if(a=["resolve",u],le.isValidElement(u))i=!1,this.create({id:r,type:"default",message:u});else if(_4(u)&&!u.ok){i=!1;let c=typeof n.error=="function"?await n.error(`HTTP error! status: ${u.status}`):n.error,d=typeof n.description=="function"?await n.description(`HTTP error! status: ${u.status}`):n.description;this.create({id:r,type:"error",message:c,description:d})}else if(n.success!==void 0){i=!1;let c=typeof n.success=="function"?await n.success(u):n.success,d=typeof n.description=="function"?await n.description(u):n.description;this.create({id:r,type:"success",message:c,description:d})}}).catch(async u=>{if(a=["reject",u],n.error!==void 0){i=!1;let c=typeof n.error=="function"?await n.error(u):n.error,d=typeof n.description=="function"?await n.description(u):n.description;this.create({id:r,type:"error",message:c,description:d})}}).finally(()=>{var u;i&&(this.dismiss(r),r=void 0),(u=n.finally)==null||u.call(n)}),l=()=>new Promise((u,c)=>s.then(()=>a[0]==="reject"?c(a[1]):u(a[1])).catch(c));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{let r=(n==null?void 0:n.id)||bg++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Jn=new S4,E4=(e,t)=>{let n=(t==null?void 0:t.id)||bg++;return Jn.addToast({title:e,...t,id:n}),n},_4=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",k4=E4,N4=()=>Jn.toasts,T4=()=>Jn.getActiveToasts(),xm=Object.assign(k4,{success:Jn.success,info:Jn.info,warning:Jn.warning,error:Jn.error,custom:Jn.custom,message:Jn.message,promise:Jn.promise,dismiss:Jn.dismiss,loading:Jn.loading},{getHistory:N4,getToasts:T4});function R4(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}R4(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Md(e){return e.label!==void 0}var P4=3,A4="32px",I4="16px",Qw=4e3,M4=356,D4=14,j4=20,F4=200;function Hr(...e){return e.filter(Boolean).join(" ")}function O4(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var L4=e=>{var t,n,r,o,i,a,s,l,u,c,d;let{invert:f,toast:h,unstyled:v,interacting:g,setHeights:y,visibleToasts:m,heights:x,index:b,toasts:w,expanded:C,removeToast:E,defaultRichColors:_,closeButton:N,style:T,cancelButtonStyle:k,actionButtonStyle:I,className:A="",descriptionClassName:U="",duration:B,position:L,gap:V,loadingIcon:F,expandByDefault:M,classNames:j,icons:R,closeButtonAriaLabel:P="Close toast",pauseWhenPageIsHidden:z}=e,[G,q]=le.useState(null),[Y,J]=le.useState(null),[X,ee]=le.useState(!1),[oe,ue]=le.useState(!1),[ae,ce]=le.useState(!1),[ne,se]=le.useState(!1),[ve,xe]=le.useState(!1),[Me,Pe]=le.useState(0),[je,Le]=le.useState(0),$e=le.useRef(h.duration||B||Qw),at=le.useRef(null),Qe=le.useRef(null),Je=b===0,dt=b+1<=m,Xe=h.type,Ce=h.dismissible!==!1,lt=h.className||"",zt=h.descriptionClassName||"",Ht=le.useMemo(()=>x.findIndex(Ne=>Ne.toastId===h.id)||0,[x,h.id]),_t=le.useMemo(()=>{var Ne;return(Ne=h.closeButton)!=null?Ne:N},[h.closeButton,N]),ze=le.useMemo(()=>h.duration||B||Qw,[h.duration,B]),rt=le.useRef(0),sn=le.useRef(0),ft=le.useRef(0),ln=le.useRef(null),[Wt,kr]=L.split("-"),Go=le.useMemo(()=>x.reduce((Ne,et,tt)=>tt>=Ht?Ne:Ne+et.height,0),[x,Ht]),sd=C4(),ld=h.invert||f,iu=Xe==="loading";sn.current=le.useMemo(()=>Ht*V+Go,[Ht,Go]),le.useEffect(()=>{$e.current=ze},[ze]),le.useEffect(()=>{ee(!0)},[]),le.useEffect(()=>{let Ne=Qe.current;if(Ne){let et=Ne.getBoundingClientRect().height;return Le(et),y(tt=>[{toastId:h.id,height:et,position:h.position},...tt]),()=>y(tt=>tt.filter(dr=>dr.toastId!==h.id))}},[y,h.id]),le.useLayoutEffect(()=>{if(!X)return;let Ne=Qe.current,et=Ne.style.height;Ne.style.height="auto";let tt=Ne.getBoundingClientRect().height;Ne.style.height=et,Le(tt),y(dr=>dr.find(_n=>_n.toastId===h.id)?dr.map(_n=>_n.toastId===h.id?{..._n,height:tt}:_n):[{toastId:h.id,height:tt,position:h.position},...dr])},[X,h.title,h.description,y,h.id]);let un=le.useCallback(()=>{ue(!0),Pe(sn.current),y(Ne=>Ne.filter(et=>et.toastId!==h.id)),setTimeout(()=>{E(h)},F4)},[h,E,y,sn]);le.useEffect(()=>{if(h.promise&&Xe==="loading"||h.duration===1/0||h.type==="loading")return;let Ne;return C||g||z&&sd?(()=>{if(ft.current<rt.current){let et=new Date().getTime()-rt.current;$e.current=$e.current-et}ft.current=new Date().getTime()})():$e.current!==1/0&&(rt.current=new Date().getTime(),Ne=setTimeout(()=>{var et;(et=h.onAutoClose)==null||et.call(h,h),un()},$e.current)),()=>clearTimeout(Ne)},[C,g,h,Xe,z,sd,un]),le.useEffect(()=>{h.delete&&un()},[un,h.delete]);function ud(){var Ne,et,tt;return R!=null&&R.loading?le.createElement("div",{className:Hr(j==null?void 0:j.loader,(Ne=h==null?void 0:h.classNames)==null?void 0:Ne.loader,"sonner-loader"),"data-visible":Xe==="loading"},R.loading):F?le.createElement("div",{className:Hr(j==null?void 0:j.loader,(et=h==null?void 0:h.classNames)==null?void 0:et.loader,"sonner-loader"),"data-visible":Xe==="loading"},F):le.createElement(v4,{className:Hr(j==null?void 0:j.loader,(tt=h==null?void 0:h.classNames)==null?void 0:tt.loader),visible:Xe==="loading"})}return le.createElement("li",{tabIndex:0,ref:Qe,className:Hr(A,lt,j==null?void 0:j.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,j==null?void 0:j.default,j==null?void 0:j[Xe],(n=h==null?void 0:h.classNames)==null?void 0:n[Xe]),"data-sonner-toast":"","data-rich-colors":(r=h.richColors)!=null?r:_,"data-styled":!(h.jsx||h.unstyled||v),"data-mounted":X,"data-promise":!!h.promise,"data-swiped":ve,"data-removed":oe,"data-visible":dt,"data-y-position":Wt,"data-x-position":kr,"data-index":b,"data-front":Je,"data-swiping":ae,"data-dismissible":Ce,"data-type":Xe,"data-invert":ld,"data-swipe-out":ne,"data-swipe-direction":Y,"data-expanded":!!(C||M&&X),style:{"--index":b,"--toasts-before":b,"--z-index":w.length-b,"--offset":`${oe?Me:sn.current}px`,"--initial-height":M?"auto":`${je}px`,...T,...h.style},onDragEnd:()=>{ce(!1),q(null),ln.current=null},onPointerDown:Ne=>{iu||!Ce||(at.current=new Date,Pe(sn.current),Ne.target.setPointerCapture(Ne.pointerId),Ne.target.tagName!=="BUTTON"&&(ce(!0),ln.current={x:Ne.clientX,y:Ne.clientY}))},onPointerUp:()=>{var Ne,et,tt,dr;if(ne||!Ce)return;ln.current=null;let _n=Number(((Ne=Qe.current)==null?void 0:Ne.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),$r=Number(((et=Qe.current)==null?void 0:et.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ho=new Date().getTime()-((tt=at.current)==null?void 0:tt.getTime()),kn=G==="x"?_n:$r,Nr=Math.abs(kn)/ho;if(Math.abs(kn)>=j4||Nr>.11){Pe(sn.current),(dr=h.onDismiss)==null||dr.call(h,h),J(G==="x"?_n>0?"right":"left":$r>0?"down":"up"),un(),se(!0),xe(!1);return}ce(!1),q(null)},onPointerMove:Ne=>{var et,tt,dr,_n;if(!ln.current||!Ce||((et=window.getSelection())==null?void 0:et.toString().length)>0)return;let $r=Ne.clientY-ln.current.y,ho=Ne.clientX-ln.current.x,kn=(tt=e.swipeDirections)!=null?tt:O4(L);!G&&(Math.abs(ho)>1||Math.abs($r)>1)&&q(Math.abs(ho)>Math.abs($r)?"x":"y");let Nr={x:0,y:0};G==="y"?(kn.includes("top")||kn.includes("bottom"))&&(kn.includes("top")&&$r<0||kn.includes("bottom")&&$r>0)&&(Nr.y=$r):G==="x"&&(kn.includes("left")||kn.includes("right"))&&(kn.includes("left")&&ho<0||kn.includes("right")&&ho>0)&&(Nr.x=ho),(Math.abs(Nr.x)>0||Math.abs(Nr.y)>0)&&xe(!0),(dr=Qe.current)==null||dr.style.setProperty("--swipe-amount-x",`${Nr.x}px`),(_n=Qe.current)==null||_n.style.setProperty("--swipe-amount-y",`${Nr.y}px`)}},_t&&!h.jsx?le.createElement("button",{"aria-label":P,"data-disabled":iu,"data-close-button":!0,onClick:iu||!Ce?()=>{}:()=>{var Ne;un(),(Ne=h.onDismiss)==null||Ne.call(h,h)},className:Hr(j==null?void 0:j.closeButton,(o=h==null?void 0:h.classNames)==null?void 0:o.closeButton)},(i=R==null?void 0:R.close)!=null?i:w4):null,h.jsx||S.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:le.createElement(le.Fragment,null,Xe||h.icon||h.promise?le.createElement("div",{"data-icon":"",className:Hr(j==null?void 0:j.icon,(a=h==null?void 0:h.classNames)==null?void 0:a.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||ud():null,h.type!=="loading"?h.icon||(R==null?void 0:R[Xe])||p4(Xe):null):null,le.createElement("div",{"data-content":"",className:Hr(j==null?void 0:j.content,(s=h==null?void 0:h.classNames)==null?void 0:s.content)},le.createElement("div",{"data-title":"",className:Hr(j==null?void 0:j.title,(l=h==null?void 0:h.classNames)==null?void 0:l.title)},typeof h.title=="function"?h.title():h.title),h.description?le.createElement("div",{"data-description":"",className:Hr(U,zt,j==null?void 0:j.description,(u=h==null?void 0:h.classNames)==null?void 0:u.description)},typeof h.description=="function"?h.description():h.description):null),S.isValidElement(h.cancel)?h.cancel:h.cancel&&Md(h.cancel)?le.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||k,onClick:Ne=>{var et,tt;Md(h.cancel)&&Ce&&((tt=(et=h.cancel).onClick)==null||tt.call(et,Ne),un())},className:Hr(j==null?void 0:j.cancelButton,(c=h==null?void 0:h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,S.isValidElement(h.action)?h.action:h.action&&Md(h.action)?le.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||I,onClick:Ne=>{var et,tt;Md(h.action)&&((tt=(et=h.action).onClick)==null||tt.call(et,Ne),!Ne.defaultPrevented&&un())},className:Hr(j==null?void 0:j.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function Zw(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function B4(e,t){let n={};return[e,t].forEach((r,o)=>{let i=o===1,a=i?"--mobile-offset":"--offset",s=i?I4:A4;function l(u){["top","right","bottom","left"].forEach(c=>{n[`${a}-${c}`]=typeof u=="number"?`${u}px`:u})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(u=>{r[u]===void 0?n[`${a}-${u}`]=s:n[`${a}-${u}`]=typeof r[u]=="number"?`${r[u]}px`:r[u]}):l(s)}),n}var V4=S.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:o=["altKey","KeyT"],expand:i,closeButton:a,className:s,offset:l,mobileOffset:u,theme:c="light",richColors:d,duration:f,style:h,visibleToasts:v=P4,toastOptions:g,dir:y=Zw(),gap:m=D4,loadingIcon:x,icons:b,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:C}=e,[E,_]=le.useState([]),N=le.useMemo(()=>Array.from(new Set([r].concat(E.filter(z=>z.position).map(z=>z.position)))),[E,r]),[T,k]=le.useState([]),[I,A]=le.useState(!1),[U,B]=le.useState(!1),[L,V]=le.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),F=le.useRef(null),M=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=le.useRef(null),R=le.useRef(!1),P=le.useCallback(z=>{_(G=>{var q;return(q=G.find(Y=>Y.id===z.id))!=null&&q.delete||Jn.dismiss(z.id),G.filter(({id:Y})=>Y!==z.id)})},[]);return le.useEffect(()=>Jn.subscribe(z=>{if(z.dismiss){_(G=>G.map(q=>q.id===z.id?{...q,delete:!0}:q));return}setTimeout(()=>{_k.flushSync(()=>{_(G=>{let q=G.findIndex(Y=>Y.id===z.id);return q!==-1?[...G.slice(0,q),{...G[q],...z},...G.slice(q+1)]:[z,...G]})})})}),[]),le.useEffect(()=>{if(c!=="system"){V(c);return}if(c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?V("dark"):V("light")),typeof window>"u")return;let z=window.matchMedia("(prefers-color-scheme: dark)");try{z.addEventListener("change",({matches:G})=>{V(G?"dark":"light")})}catch{z.addListener(({matches:q})=>{try{V(q?"dark":"light")}catch(Y){console.error(Y)}})}},[c]),le.useEffect(()=>{E.length<=1&&A(!1)},[E]),le.useEffect(()=>{let z=G=>{var q,Y;o.every(J=>G[J]||G.code===J)&&(A(!0),(q=F.current)==null||q.focus()),G.code==="Escape"&&(document.activeElement===F.current||(Y=F.current)!=null&&Y.contains(document.activeElement))&&A(!1)};return document.addEventListener("keydown",z),()=>document.removeEventListener("keydown",z)},[o]),le.useEffect(()=>{if(F.current)return()=>{j.current&&(j.current.focus({preventScroll:!0}),j.current=null,R.current=!1)}},[F.current]),le.createElement("section",{ref:t,"aria-label":`${w} ${M}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},N.map((z,G)=>{var q;let[Y,J]=z.split("-");return E.length?le.createElement("ol",{key:z,dir:y==="auto"?Zw():y,tabIndex:-1,ref:F,className:s,"data-sonner-toaster":!0,"data-theme":L,"data-y-position":Y,"data-lifted":I&&E.length>1&&!i,"data-x-position":J,style:{"--front-toast-height":`${((q=T[0])==null?void 0:q.height)||0}px`,"--width":`${M4}px`,"--gap":`${m}px`,...h,...B4(l,u)},onBlur:X=>{R.current&&!X.currentTarget.contains(X.relatedTarget)&&(R.current=!1,j.current&&(j.current.focus({preventScroll:!0}),j.current=null))},onFocus:X=>{X.target instanceof HTMLElement&&X.target.dataset.dismissible==="false"||R.current||(R.current=!0,j.current=X.relatedTarget)},onMouseEnter:()=>A(!0),onMouseMove:()=>A(!0),onMouseLeave:()=>{U||A(!1)},onDragEnd:()=>A(!1),onPointerDown:X=>{X.target instanceof HTMLElement&&X.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},E.filter(X=>!X.position&&G===0||X.position===z).map((X,ee)=>{var oe,ue;return le.createElement(L4,{key:X.id,icons:b,index:ee,toast:X,defaultRichColors:d,duration:(oe=g==null?void 0:g.duration)!=null?oe:f,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:n,visibleToasts:v,closeButton:(ue=g==null?void 0:g.closeButton)!=null?ue:a,interacting:U,position:z,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:P,toasts:E.filter(ae=>ae.position==X.position),heights:T.filter(ae=>ae.position==X.position),setHeights:k,expandByDefault:i,gap:m,loadingIcon:x,expanded:I,pauseWhenPageIsHidden:C,swipeDirections:e.swipeDirections})})):null}))});const z4=({...e})=>{const{theme:t="system"}=h4();return p.jsx(V4,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var W4=Oy[" useId ".trim().toString()]||(()=>{}),$4=0;function bm(e){const[t,n]=S.useState(W4());return ci(()=>{e||n(r=>r??String($4++))},[e]),e||(t?`radix-${t}`:"")}const U4=["top","right","bottom","left"],da=Math.min,pr=Math.max,rh=Math.round,Dd=Math.floor,Io=e=>({x:e,y:e}),H4={left:"right",right:"left",bottom:"top",top:"bottom"},G4={start:"end",end:"start"};function wg(e,t,n){return pr(e,da(t,n))}function di(e,t){return typeof e=="function"?e(t):e}function fi(e){return e.split("-")[0]}function Yl(e){return e.split("-")[1]}function O0(e){return e==="x"?"y":"x"}function L0(e){return e==="y"?"height":"width"}const q4=new Set(["top","bottom"]);function To(e){return q4.has(fi(e))?"y":"x"}function B0(e){return O0(To(e))}function K4(e,t,n){n===void 0&&(n=!1);const r=Yl(e),o=B0(e),i=L0(o);let a=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=oh(a)),[a,oh(a)]}function X4(e){const t=oh(e);return[Cg(e),t,Cg(t)]}function Cg(e){return e.replace(/start|end/g,t=>G4[t])}const Jw=["left","right"],e2=["right","left"],Y4=["top","bottom"],Q4=["bottom","top"];function Z4(e,t,n){switch(e){case"top":case"bottom":return n?t?e2:Jw:t?Jw:e2;case"left":case"right":return t?Y4:Q4;default:return[]}}function J4(e,t,n,r){const o=Yl(e);let i=Z4(fi(e),n==="start",r);return o&&(i=i.map(a=>a+"-"+o),t&&(i=i.concat(i.map(Cg)))),i}function oh(e){return e.replace(/left|right|bottom|top/g,t=>H4[t])}function eO(e){return{top:0,right:0,bottom:0,left:0,...e}}function vN(e){return typeof e!="number"?eO(e):{top:e,right:e,bottom:e,left:e}}function ih(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function t2(e,t,n){let{reference:r,floating:o}=e;const i=To(t),a=B0(t),s=L0(a),l=fi(t),u=i==="y",c=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(l){case"top":h={x:c,y:r.y-o.height};break;case"bottom":h={x:c,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Yl(t)){case"start":h[a]-=f*(n&&u?-1:1);break;case"end":h[a]+=f*(n&&u?-1:1);break}return h}const tO=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:o}),{x:c,y:d}=t2(u,r,l),f=r,h={},v=0;for(let g=0;g<s.length;g++){const{name:y,fn:m}=s[g],{x,y:b,data:w,reset:C}=await m({x:c,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:u,platform:a,elements:{reference:e,floating:t}});c=x??c,d=b??d,h={...h,[y]:{...h[y],...w}},C&&v<=50&&(v++,typeof C=="object"&&(C.placement&&(f=C.placement),C.rects&&(u=C.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:o}):C.rects),{x:c,y:d}=t2(u,f,l)),g=-1)}return{x:c,y:d,placement:f,strategy:o,middlewareData:h}};async function pc(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=di(t,e),v=vN(h),y=s[f?d==="floating"?"reference":"floating":d],m=ih(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:u,rootBoundary:c,strategy:l})),x=d==="floating"?{x:r,y:o,width:a.floating.width,height:a.floating.height}:a.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),w=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},C=ih(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:x,offsetParent:b,strategy:l}):x);return{top:(m.top-C.top+v.top)/w.y,bottom:(C.bottom-m.bottom+v.bottom)/w.y,left:(m.left-C.left+v.left)/w.x,right:(C.right-m.right+v.right)/w.x}}const nO=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:i,platform:a,elements:s,middlewareData:l}=t,{element:u,padding:c=0}=di(e,t)||{};if(u==null)return{};const d=vN(c),f={x:n,y:r},h=B0(o),v=L0(h),g=await a.getDimensions(u),y=h==="y",m=y?"top":"left",x=y?"bottom":"right",b=y?"clientHeight":"clientWidth",w=i.reference[v]+i.reference[h]-f[h]-i.floating[v],C=f[h]-i.reference[h],E=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let _=E?E[b]:0;(!_||!await(a.isElement==null?void 0:a.isElement(E)))&&(_=s.floating[b]||i.floating[v]);const N=w/2-C/2,T=_/2-g[v]/2-1,k=da(d[m],T),I=da(d[x],T),A=k,U=_-g[v]-I,B=_/2-g[v]/2+N,L=wg(A,B,U),V=!l.arrow&&Yl(o)!=null&&B!==L&&i.reference[v]/2-(B<A?k:I)-g[v]/2<0,F=V?B<A?B-A:B-U:0;return{[h]:f[h]+F,data:{[h]:L,centerOffset:B-L-F,...V&&{alignmentOffset:F}},reset:V}}}),rO=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:l,elements:u}=t,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...y}=di(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const m=fi(o),x=To(s),b=fi(s)===s,w=await(l.isRTL==null?void 0:l.isRTL(u.floating)),C=f||(b||!g?[oh(s)]:X4(s)),E=v!=="none";!f&&E&&C.push(...J4(s,g,v,w));const _=[s,...C],N=await pc(t,y),T=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&T.push(N[m]),d){const B=K4(o,a,w);T.push(N[B[0]],N[B[1]])}if(k=[...k,{placement:o,overflows:T}],!T.every(B=>B<=0)){var I,A;const B=(((I=i.flip)==null?void 0:I.index)||0)+1,L=_[B];if(L&&(!(d==="alignment"?x!==To(L):!1)||k.every(M=>M.overflows[0]>0&&To(M.placement)===x)))return{data:{index:B,overflows:k},reset:{placement:L}};let V=(A=k.filter(F=>F.overflows[0]<=0).sort((F,M)=>F.overflows[1]-M.overflows[1])[0])==null?void 0:A.placement;if(!V)switch(h){case"bestFit":{var U;const F=(U=k.filter(M=>{if(E){const j=To(M.placement);return j===x||j==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(j=>j>0).reduce((j,R)=>j+R,0)]).sort((M,j)=>M[1]-j[1])[0])==null?void 0:U[0];F&&(V=F);break}case"initialPlacement":V=s;break}if(o!==V)return{reset:{placement:V}}}return{}}}};function n2(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function r2(e){return U4.some(t=>e[t]>=0)}const oO=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=di(e,t);switch(r){case"referenceHidden":{const i=await pc(t,{...o,elementContext:"reference"}),a=n2(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:r2(a)}}}case"escaped":{const i=await pc(t,{...o,altBoundary:!0}),a=n2(i,n.floating);return{data:{escapedOffsets:a,escaped:r2(a)}}}default:return{}}}}},gN=new Set(["left","top"]);async function iO(e,t){const{placement:n,platform:r,elements:o}=e,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),a=fi(n),s=Yl(n),l=To(n)==="y",u=gN.has(a)?-1:1,c=i&&l?-1:1,d=di(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof v=="number"&&(h=s==="end"?v*-1:v),l?{x:h*c,y:f*u}:{x:f*u,y:h*c}}const aO=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:i,placement:a,middlewareData:s}=t,l=await iO(t,e);return a===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+l.x,y:i+l.y,data:{...l,placement:a}}}}},sO=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:y=>{let{x:m,y:x}=y;return{x:m,y:x}}},...l}=di(e,t),u={x:n,y:r},c=await pc(t,l),d=To(fi(o)),f=O0(d);let h=u[f],v=u[d];if(i){const y=f==="y"?"top":"left",m=f==="y"?"bottom":"right",x=h+c[y],b=h-c[m];h=wg(x,h,b)}if(a){const y=d==="y"?"top":"left",m=d==="y"?"bottom":"right",x=v+c[y],b=v-c[m];v=wg(x,v,b)}const g=s.fn({...t,[f]:h,[d]:v});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[f]:i,[d]:a}}}}}},lO=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:i,middlewareData:a}=t,{offset:s=0,mainAxis:l=!0,crossAxis:u=!0}=di(e,t),c={x:n,y:r},d=To(o),f=O0(d);let h=c[f],v=c[d];const g=di(s,t),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const b=f==="y"?"height":"width",w=i.reference[f]-i.floating[b]+y.mainAxis,C=i.reference[f]+i.reference[b]-y.mainAxis;h<w?h=w:h>C&&(h=C)}if(u){var m,x;const b=f==="y"?"width":"height",w=gN.has(fi(o)),C=i.reference[d]-i.floating[b]+(w&&((m=a.offset)==null?void 0:m[d])||0)+(w?0:y.crossAxis),E=i.reference[d]+i.reference[b]+(w?0:((x=a.offset)==null?void 0:x[d])||0)-(w?y.crossAxis:0);v<C?v=C:v>E&&(v=E)}return{[f]:h,[d]:v}}}},uO=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:i,platform:a,elements:s}=t,{apply:l=()=>{},...u}=di(e,t),c=await pc(t,u),d=fi(o),f=Yl(o),h=To(o)==="y",{width:v,height:g}=i.floating;let y,m;d==="top"||d==="bottom"?(y=d,m=f===(await(a.isRTL==null?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(m=d,y=f==="end"?"top":"bottom");const x=g-c.top-c.bottom,b=v-c.left-c.right,w=da(g-c[y],x),C=da(v-c[m],b),E=!t.middlewareData.shift;let _=w,N=C;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=b),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(_=x),E&&!f){const k=pr(c.left,0),I=pr(c.right,0),A=pr(c.top,0),U=pr(c.bottom,0);h?N=v-2*(k!==0||I!==0?k+I:pr(c.left,c.right)):_=g-2*(A!==0||U!==0?A+U:pr(c.top,c.bottom))}await l({...t,availableWidth:N,availableHeight:_});const T=await a.getDimensions(s.floating);return v!==T.width||g!==T.height?{reset:{rects:!0}}:{}}}};function lp(){return typeof window<"u"}function Ql(e){return yN(e)?(e.nodeName||"").toLowerCase():"#document"}function wr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function zo(e){var t;return(t=(yN(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function yN(e){return lp()?e instanceof Node||e instanceof wr(e).Node:!1}function so(e){return lp()?e instanceof Element||e instanceof wr(e).Element:!1}function Bo(e){return lp()?e instanceof HTMLElement||e instanceof wr(e).HTMLElement:!1}function o2(e){return!lp()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof wr(e).ShadowRoot}const cO=new Set(["inline","contents"]);function Hc(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=lo(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!cO.has(o)}const dO=new Set(["table","td","th"]);function fO(e){return dO.has(Ql(e))}const hO=[":popover-open",":modal"];function up(e){return hO.some(t=>{try{return e.matches(t)}catch{return!1}})}const pO=["transform","translate","scale","rotate","perspective"],mO=["transform","translate","scale","rotate","perspective","filter"],vO=["paint","layout","strict","content"];function V0(e){const t=z0(),n=so(e)?lo(e):e;return pO.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||mO.some(r=>(n.willChange||"").includes(r))||vO.some(r=>(n.contain||"").includes(r))}function gO(e){let t=fa(e);for(;Bo(t)&&!Ol(t);){if(V0(t))return t;if(up(t))return null;t=fa(t)}return null}function z0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const yO=new Set(["html","body","#document"]);function Ol(e){return yO.has(Ql(e))}function lo(e){return wr(e).getComputedStyle(e)}function cp(e){return so(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function fa(e){if(Ql(e)==="html")return e;const t=e.assignedSlot||e.parentNode||o2(e)&&e.host||zo(e);return o2(t)?t.host:t}function xN(e){const t=fa(e);return Ol(t)?e.ownerDocument?e.ownerDocument.body:e.body:Bo(t)&&Hc(t)?t:xN(t)}function mc(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=xN(e),i=o===((r=e.ownerDocument)==null?void 0:r.body),a=wr(o);if(i){const s=Sg(a);return t.concat(a,a.visualViewport||[],Hc(o)?o:[],s&&n?mc(s):[])}return t.concat(o,mc(o,[],n))}function Sg(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function bN(e){const t=lo(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=Bo(e),i=o?e.offsetWidth:n,a=o?e.offsetHeight:r,s=rh(n)!==i||rh(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function W0(e){return so(e)?e:e.contextElement}function sl(e){const t=W0(e);if(!Bo(t))return Io(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=bN(t);let a=(i?rh(n.width):n.width)/r,s=(i?rh(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const xO=Io(0);function wN(e){const t=wr(e);return!z0()||!t.visualViewport?xO:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function bO(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==wr(e)?!1:t}function ss(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),i=W0(e);let a=Io(1);t&&(r?so(r)&&(a=sl(r)):a=sl(e));const s=bO(i,n,r)?wN(i):Io(0);let l=(o.left+s.x)/a.x,u=(o.top+s.y)/a.y,c=o.width/a.x,d=o.height/a.y;if(i){const f=wr(i),h=r&&so(r)?wr(r):r;let v=f,g=Sg(v);for(;g&&r&&h!==v;){const y=sl(g),m=g.getBoundingClientRect(),x=lo(g),b=m.left+(g.clientLeft+parseFloat(x.paddingLeft))*y.x,w=m.top+(g.clientTop+parseFloat(x.paddingTop))*y.y;l*=y.x,u*=y.y,c*=y.x,d*=y.y,l+=b,u+=w,v=wr(g),g=Sg(v)}}return ih({width:c,height:d,x:l,y:u})}function $0(e,t){const n=cp(e).scrollLeft;return t?t.left+n:ss(zo(e)).left+n}function CN(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),o=r.left+t.scrollLeft-(n?0:$0(e,r)),i=r.top+t.scrollTop;return{x:o,y:i}}function wO(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const i=o==="fixed",a=zo(r),s=t?up(t.floating):!1;if(r===a||s&&i)return n;let l={scrollLeft:0,scrollTop:0},u=Io(1);const c=Io(0),d=Bo(r);if((d||!d&&!i)&&((Ql(r)!=="body"||Hc(a))&&(l=cp(r)),Bo(r))){const h=ss(r);u=sl(r),c.x=h.x+r.clientLeft,c.y=h.y+r.clientTop}const f=a&&!d&&!i?CN(a,l,!0):Io(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x+f.x,y:n.y*u.y-l.scrollTop*u.y+c.y+f.y}}function CO(e){return Array.from(e.getClientRects())}function SO(e){const t=zo(e),n=cp(e),r=e.ownerDocument.body,o=pr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=pr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+$0(e);const s=-n.scrollTop;return lo(r).direction==="rtl"&&(a+=pr(t.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}function EO(e,t){const n=wr(e),r=zo(e),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,l=0;if(o){i=o.width,a=o.height;const u=z0();(!u||u&&t==="fixed")&&(s=o.offsetLeft,l=o.offsetTop)}return{width:i,height:a,x:s,y:l}}const _O=new Set(["absolute","fixed"]);function kO(e,t){const n=ss(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,i=Bo(e)?sl(e):Io(1),a=e.clientWidth*i.x,s=e.clientHeight*i.y,l=o*i.x,u=r*i.y;return{width:a,height:s,x:l,y:u}}function i2(e,t,n){let r;if(t==="viewport")r=EO(e,n);else if(t==="document")r=SO(zo(e));else if(so(t))r=kO(t,n);else{const o=wN(e);r={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return ih(r)}function SN(e,t){const n=fa(e);return n===t||!so(n)||Ol(n)?!1:lo(n).position==="fixed"||SN(n,t)}function NO(e,t){const n=t.get(e);if(n)return n;let r=mc(e,[],!1).filter(s=>so(s)&&Ql(s)!=="body"),o=null;const i=lo(e).position==="fixed";let a=i?fa(e):e;for(;so(a)&&!Ol(a);){const s=lo(a),l=V0(a);!l&&s.position==="fixed"&&(o=null),(i?!l&&!o:!l&&s.position==="static"&&!!o&&_O.has(o.position)||Hc(a)&&!l&&SN(e,a))?r=r.filter(c=>c!==a):o=s,a=fa(a)}return t.set(e,r),r}function TO(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const a=[...n==="clippingAncestors"?up(t)?[]:NO(t,this._c):[].concat(n),r],s=a[0],l=a.reduce((u,c)=>{const d=i2(t,c,o);return u.top=pr(d.top,u.top),u.right=da(d.right,u.right),u.bottom=da(d.bottom,u.bottom),u.left=pr(d.left,u.left),u},i2(t,s,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function RO(e){const{width:t,height:n}=bN(e);return{width:t,height:n}}function PO(e,t,n){const r=Bo(t),o=zo(t),i=n==="fixed",a=ss(e,!0,i,t);let s={scrollLeft:0,scrollTop:0};const l=Io(0);function u(){l.x=$0(o)}if(r||!r&&!i)if((Ql(t)!=="body"||Hc(o))&&(s=cp(t)),r){const h=ss(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else o&&u();i&&!r&&o&&u();const c=o&&!r&&!i?CN(o,s):Io(0),d=a.left+s.scrollLeft-l.x-c.x,f=a.top+s.scrollTop-l.y-c.y;return{x:d,y:f,width:a.width,height:a.height}}function wm(e){return lo(e).position==="static"}function a2(e,t){if(!Bo(e)||lo(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return zo(e)===n&&(n=n.ownerDocument.body),n}function EN(e,t){const n=wr(e);if(up(e))return n;if(!Bo(e)){let o=fa(e);for(;o&&!Ol(o);){if(so(o)&&!wm(o))return o;o=fa(o)}return n}let r=a2(e,t);for(;r&&fO(r)&&wm(r);)r=a2(r,t);return r&&Ol(r)&&wm(r)&&!V0(r)?n:r||gO(e)||n}const AO=async function(e){const t=this.getOffsetParent||EN,n=this.getDimensions,r=await n(e.floating);return{reference:PO(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function IO(e){return lo(e).direction==="rtl"}const MO={convertOffsetParentRelativeRectToViewportRelativeRect:wO,getDocumentElement:zo,getClippingRect:TO,getOffsetParent:EN,getElementRects:AO,getClientRects:CO,getDimensions:RO,getScale:sl,isElement:so,isRTL:IO};function _N(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function DO(e,t){let n=null,r;const o=zo(e);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,l){s===void 0&&(s=!1),l===void 0&&(l=1),i();const u=e.getBoundingClientRect(),{left:c,top:d,width:f,height:h}=u;if(s||t(),!f||!h)return;const v=Dd(d),g=Dd(o.clientWidth-(c+f)),y=Dd(o.clientHeight-(d+h)),m=Dd(c),b={rootMargin:-v+"px "+-g+"px "+-y+"px "+-m+"px",threshold:pr(0,da(1,l))||1};let w=!0;function C(E){const _=E[0].intersectionRatio;if(_!==l){if(!w)return a();_?a(!1,_):r=setTimeout(()=>{a(!1,1e-7)},1e3)}_===1&&!_N(u,e.getBoundingClientRect())&&a(),w=!1}try{n=new IntersectionObserver(C,{...b,root:o.ownerDocument})}catch{n=new IntersectionObserver(C,b)}n.observe(e)}return a(!0),i}function jO(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=W0(e),c=o||i?[...u?mc(u):[],...mc(t)]:[];c.forEach(m=>{o&&m.addEventListener("scroll",n,{passive:!0}),i&&m.addEventListener("resize",n)});const d=u&&s?DO(u,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(m=>{let[x]=m;x&&x.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=h)==null||b.observe(t)})),n()}),u&&!l&&h.observe(u),h.observe(t));let v,g=l?ss(e):null;l&&y();function y(){const m=ss(e);g&&!_N(g,m)&&n(),g=m,v=requestAnimationFrame(y)}return n(),()=>{var m;c.forEach(x=>{o&&x.removeEventListener("scroll",n),i&&x.removeEventListener("resize",n)}),d==null||d(),(m=h)==null||m.disconnect(),h=null,l&&cancelAnimationFrame(v)}}const FO=aO,OO=sO,LO=rO,BO=uO,VO=oO,s2=nO,zO=lO,WO=(e,t,n)=>{const r=new Map,o={platform:MO,...n},i={...o.platform,_c:r};return tO(e,t,{...o,platform:i})};var $O=typeof document<"u",UO=function(){},Cf=$O?S.useLayoutEffect:UO;function ah(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!ah(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&e.$$typeof)&&!ah(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function kN(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function l2(e,t){const n=kN(e);return Math.round(t*n)/n}function Cm(e){const t=S.useRef(e);return Cf(()=>{t.current=e}),t}function HO(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:a}={},transform:s=!0,whileElementsMounted:l,open:u}=e,[c,d]=S.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=S.useState(r);ah(f,r)||h(r);const[v,g]=S.useState(null),[y,m]=S.useState(null),x=S.useCallback(M=>{M!==E.current&&(E.current=M,g(M))},[]),b=S.useCallback(M=>{M!==_.current&&(_.current=M,m(M))},[]),w=i||v,C=a||y,E=S.useRef(null),_=S.useRef(null),N=S.useRef(c),T=l!=null,k=Cm(l),I=Cm(o),A=Cm(u),U=S.useCallback(()=>{if(!E.current||!_.current)return;const M={placement:t,strategy:n,middleware:f};I.current&&(M.platform=I.current),WO(E.current,_.current,M).then(j=>{const R={...j,isPositioned:A.current!==!1};B.current&&!ah(N.current,R)&&(N.current=R,zc.flushSync(()=>{d(R)}))})},[f,t,n,I,A]);Cf(()=>{u===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(M=>({...M,isPositioned:!1})))},[u]);const B=S.useRef(!1);Cf(()=>(B.current=!0,()=>{B.current=!1}),[]),Cf(()=>{if(w&&(E.current=w),C&&(_.current=C),w&&C){if(k.current)return k.current(w,C,U);U()}},[w,C,U,k,T]);const L=S.useMemo(()=>({reference:E,floating:_,setReference:x,setFloating:b}),[x,b]),V=S.useMemo(()=>({reference:w,floating:C}),[w,C]),F=S.useMemo(()=>{const M={position:n,left:0,top:0};if(!V.floating)return M;const j=l2(V.floating,c.x),R=l2(V.floating,c.y);return s?{...M,transform:"translate("+j+"px, "+R+"px)",...kN(V.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:j,top:R}},[n,s,V.floating,c.x,c.y]);return S.useMemo(()=>({...c,update:U,refs:L,elements:V,floatingStyles:F}),[c,U,L,V,F])}const GO=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?s2({element:r.current,padding:o}).fn(n):{}:r?s2({element:r,padding:o}).fn(n):{}}}},qO=(e,t)=>({...FO(e),options:[e,t]}),KO=(e,t)=>({...OO(e),options:[e,t]}),XO=(e,t)=>({...zO(e),options:[e,t]}),YO=(e,t)=>({...LO(e),options:[e,t]}),QO=(e,t)=>({...BO(e),options:[e,t]}),ZO=(e,t)=>({...VO(e),options:[e,t]}),JO=(e,t)=>({...GO(e),options:[e,t]});var eL="Arrow",NN=S.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...i}=e;return p.jsx(Tt.svg,{...i,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});NN.displayName=eL;var tL=NN;function TN(e){const[t,n]=S.useState(void 0);return ci(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let a,s;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;a=u.inlineSize,s=u.blockSize}else a=e.offsetWidth,s=e.offsetHeight;n({width:a,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var RN="Popper",[PN,AN]=Kl(RN),[SY,IN]=PN(RN),MN="PopperAnchor",DN=S.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,i=IN(MN,n),a=S.useRef(null),s=Sn(t,a);return S.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:p.jsx(Tt.div,{...o,ref:s})});DN.displayName=MN;var U0="PopperContent",[nL,rL]=PN(U0),jN=S.forwardRef((e,t)=>{var X,ee,oe,ue,ae,ce;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:i="center",alignOffset:a=0,arrowPadding:s=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:v,...g}=e,y=IN(U0,n),[m,x]=S.useState(null),b=Sn(t,ne=>x(ne)),[w,C]=S.useState(null),E=TN(w),_=(E==null?void 0:E.width)??0,N=(E==null?void 0:E.height)??0,T=r+(i!=="center"?"-"+i:""),k=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},I=Array.isArray(u)?u:[u],A=I.length>0,U={padding:k,boundary:I.filter(iL),altBoundary:A},{refs:B,floatingStyles:L,placement:V,isPositioned:F,middlewareData:M}=HO({strategy:"fixed",placement:T,whileElementsMounted:(...ne)=>jO(...ne,{animationFrame:h==="always"}),elements:{reference:y.anchor},middleware:[qO({mainAxis:o+N,alignmentAxis:a}),l&&KO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?XO():void 0,...U}),l&&YO({...U}),QO({...U,apply:({elements:ne,rects:se,availableWidth:ve,availableHeight:xe})=>{const{width:Me,height:Pe}=se.reference,je=ne.floating.style;je.setProperty("--radix-popper-available-width",`${ve}px`),je.setProperty("--radix-popper-available-height",`${xe}px`),je.setProperty("--radix-popper-anchor-width",`${Me}px`),je.setProperty("--radix-popper-anchor-height",`${Pe}px`)}}),w&&JO({element:w,padding:s}),aL({arrowWidth:_,arrowHeight:N}),f&&ZO({strategy:"referenceHidden",...U})]}),[j,R]=LN(V),P=Lo(v);ci(()=>{F&&(P==null||P())},[F,P]);const z=(X=M.arrow)==null?void 0:X.x,G=(ee=M.arrow)==null?void 0:ee.y,q=((oe=M.arrow)==null?void 0:oe.centerOffset)!==0,[Y,J]=S.useState();return ci(()=>{m&&J(window.getComputedStyle(m).zIndex)},[m]),p.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...L,transform:F?L.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Y,"--radix-popper-transform-origin":[(ue=M.transformOrigin)==null?void 0:ue.x,(ae=M.transformOrigin)==null?void 0:ae.y].join(" "),...((ce=M.hide)==null?void 0:ce.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:p.jsx(nL,{scope:n,placedSide:j,onArrowChange:C,arrowX:z,arrowY:G,shouldHideArrow:q,children:p.jsx(Tt.div,{"data-side":j,"data-align":R,...g,ref:b,style:{...g.style,animation:F?void 0:"none"}})})})});jN.displayName=U0;var FN="PopperArrow",oL={top:"bottom",right:"left",bottom:"top",left:"right"},ON=S.forwardRef(function(t,n){const{__scopePopper:r,...o}=t,i=rL(FN,r),a=oL[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(tL,{...o,ref:n,style:{...o.style,display:"block"}})})});ON.displayName=FN;function iL(e){return e!==null}var aL=e=>({name:"transformOrigin",options:e,fn(t){var y,m,x;const{placement:n,rects:r,middlewareData:o}=t,a=((y=o.arrow)==null?void 0:y.centerOffset)!==0,s=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[u,c]=LN(n),d={start:"0%",center:"50%",end:"100%"}[c],f=(((m=o.arrow)==null?void 0:m.x)??0)+s/2,h=(((x=o.arrow)==null?void 0:x.y)??0)+l/2;let v="",g="";return u==="bottom"?(v=a?d:`${f}px`,g=`${-l}px`):u==="top"?(v=a?d:`${f}px`,g=`${r.floating.height+l}px`):u==="right"?(v=`${-l}px`,g=a?d:`${h}px`):u==="left"&&(v=`${r.floating.width+l}px`,g=a?d:`${h}px`),{data:{x:v,y:g}}}});function LN(e){const[t,n="center"]=e.split("-");return[t,n]}var sL=DN,lL=jN,uL=ON,[dp,EY]=Kl("Tooltip",[AN]),H0=AN(),BN="TooltipProvider",cL=700,u2="tooltip.open",[dL,VN]=dp(BN),zN=e=>{const{__scopeTooltip:t,delayDuration:n=cL,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=e,a=S.useRef(!0),s=S.useRef(!1),l=S.useRef(0);return S.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),p.jsx(dL,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:S.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:S.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:s,onPointerInTransitChange:S.useCallback(u=>{s.current=u},[]),disableHoverableContent:o,children:i})};zN.displayName=BN;var WN="Tooltip",[_Y,fp]=dp(WN),Eg="TooltipTrigger",fL=S.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=fp(Eg,n),i=VN(Eg,n),a=H0(n),s=S.useRef(null),l=Sn(t,s,o.onTriggerChange),u=S.useRef(!1),c=S.useRef(!1),d=S.useCallback(()=>u.current=!1,[]);return S.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),p.jsx(sL,{asChild:!0,...a,children:p.jsx(Tt.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:l,onPointerMove:pt(e.onPointerMove,f=>{f.pointerType!=="touch"&&!c.current&&!i.isPointerInTransitRef.current&&(o.onTriggerEnter(),c.current=!0)}),onPointerLeave:pt(e.onPointerLeave,()=>{o.onTriggerLeave(),c.current=!1}),onPointerDown:pt(e.onPointerDown,()=>{o.open&&o.onClose(),u.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:pt(e.onFocus,()=>{u.current||o.onOpen()}),onBlur:pt(e.onBlur,o.onClose),onClick:pt(e.onClick,o.onClose)})})});fL.displayName=Eg;var hL="TooltipPortal",[kY,pL]=dp(hL,{forceMount:void 0}),Ll="TooltipContent",$N=S.forwardRef((e,t)=>{const n=pL(Ll,e.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=e,a=fp(Ll,e.__scopeTooltip);return p.jsx(ms,{present:r||a.open,children:a.disableHoverableContent?p.jsx(UN,{side:o,...i,ref:t}):p.jsx(mL,{side:o,...i,ref:t})})}),mL=S.forwardRef((e,t)=>{const n=fp(Ll,e.__scopeTooltip),r=VN(Ll,e.__scopeTooltip),o=S.useRef(null),i=Sn(t,o),[a,s]=S.useState(null),{trigger:l,onClose:u}=n,c=o.current,{onPointerInTransitChange:d}=r,f=S.useCallback(()=>{s(null),d(!1)},[d]),h=S.useCallback((v,g)=>{const y=v.currentTarget,m={x:v.clientX,y:v.clientY},x=bL(m,y.getBoundingClientRect()),b=wL(m,x),w=CL(g.getBoundingClientRect()),C=EL([...b,...w]);s(C),d(!0)},[d]);return S.useEffect(()=>()=>f(),[f]),S.useEffect(()=>{if(l&&c){const v=y=>h(y,c),g=y=>h(y,l);return l.addEventListener("pointerleave",v),c.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",v),c.removeEventListener("pointerleave",g)}}},[l,c,h,f]),S.useEffect(()=>{if(a){const v=g=>{const y=g.target,m={x:g.clientX,y:g.clientY},x=(l==null?void 0:l.contains(y))||(c==null?void 0:c.contains(y)),b=!SL(m,a);x?f():b&&(f(),u())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,c,a,u,f]),p.jsx(UN,{...e,ref:i})}),[vL,gL]=dp(WN,{isInside:!1}),yL=EF("TooltipContent"),UN=S.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:a,...s}=e,l=fp(Ll,n),u=H0(n),{onClose:c}=l;return S.useEffect(()=>(document.addEventListener(u2,c),()=>document.removeEventListener(u2,c)),[c]),S.useEffect(()=>{if(l.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(l.trigger)&&c()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,c]),p.jsx(rp,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:c,children:p.jsxs(lL,{"data-state":l.stateAttribute,...u,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(yL,{children:r}),p.jsx(vL,{scope:n,isInside:!0,children:p.jsx(KF,{id:l.contentId,role:"tooltip",children:o||r})})]})})});$N.displayName=Ll;var HN="TooltipArrow",xL=S.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=H0(n);return gL(HN,n).isInside?null:p.jsx(uL,{...o,...r,ref:t})});xL.displayName=HN;function bL(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,o,i)){case i:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function wL(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function CL(e){const{top:t,right:n,bottom:r,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:r},{x:o,y:r}]}function SL(e,t){const{x:n,y:r}=e;let o=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const s=t[i],l=t[a],u=s.x,c=s.y,d=l.x,f=l.y;c>r!=f>r&&n<(d-u)*(r-c)/(f-c)+u&&(o=!o)}return o}function EL(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),_L(t)}function _L(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const o=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var kL=zN,GN=$N;const NL=kL,TL=S.forwardRef(({className:e,sideOffset:t=4,...n},r)=>p.jsx(GN,{ref:r,sideOffset:t,className:Et("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));TL.displayName=GN.displayName;var Zl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ls=typeof window>"u"||"Deno"in globalThis;function Wn(){}function RL(e,t){return typeof e=="function"?e(t):e}function _g(e){return typeof e=="number"&&e>=0&&e!==1/0}function qN(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ra(e,t){return typeof e=="function"?e(t):e}function Pr(e,t){return typeof e=="function"?e(t):e}function c2(e,t){const{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:a,stale:s}=e;if(a){if(r){if(t.queryHash!==G0(a,t.options))return!1}else if(!vc(t.queryKey,a))return!1}if(n!=="all"){const l=t.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof s=="boolean"&&t.isStale()!==s||o&&o!==t.state.fetchStatus||i&&!i(t))}function d2(e,t){const{exact:n,status:r,predicate:o,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(us(t.options.mutationKey)!==us(i))return!1}else if(!vc(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||o&&!o(t))}function G0(e,t){return((t==null?void 0:t.queryKeyHashFn)||us)(e)}function us(e){return JSON.stringify(e,(t,n)=>kg(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function vc(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>vc(e[n],t[n])):!1}function KN(e,t){if(e===t)return e;const n=f2(e)&&f2(t);if(n||kg(e)&&kg(t)){const r=n?e:Object.keys(e),o=r.length,i=n?t:Object.keys(t),a=i.length,s=n?[]:{},l=new Set(r);let u=0;for(let c=0;c<a;c++){const d=n?c:i[c];(!n&&l.has(d)||n)&&e[d]===void 0&&t[d]===void 0?(s[d]=void 0,u++):(s[d]=KN(e[d],t[d]),s[d]===e[d]&&e[d]!==void 0&&u++)}return o===a&&u===o?e:s}return t}function sh(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function f2(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function kg(e){if(!h2(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!h2(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function h2(e){return Object.prototype.toString.call(e)==="[object Object]"}function PL(e){return new Promise(t=>{setTimeout(t,e)})}function Ng(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?KN(e,t):t}function AL(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function IL(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var q0=Symbol();function XN(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===q0?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function YN(e,t){return typeof e=="function"?e(...t):!!e}var za,Di,yl,nE,ML=(nE=class extends Zl{constructor(){super();Te(this,za);Te(this,Di);Te(this,yl);pe(this,yl,t=>{if(!ls&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){W(this,Di)||this.setEventListener(W(this,yl))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,Di))==null||t.call(this),pe(this,Di,void 0))}setEventListener(t){var n;pe(this,yl,t),(n=W(this,Di))==null||n.call(this),pe(this,Di,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){W(this,za)!==t&&(pe(this,za,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof W(this,za)=="boolean"?W(this,za):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},za=new WeakMap,Di=new WeakMap,yl=new WeakMap,nE),K0=new ML,xl,ji,bl,rE,DL=(rE=class extends Zl{constructor(){super();Te(this,xl,!0);Te(this,ji);Te(this,bl);pe(this,bl,t=>{if(!ls&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){W(this,ji)||this.setEventListener(W(this,bl))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,ji))==null||t.call(this),pe(this,ji,void 0))}setEventListener(t){var n;pe(this,bl,t),(n=W(this,ji))==null||n.call(this),pe(this,ji,t(this.setOnline.bind(this)))}setOnline(t){W(this,xl)!==t&&(pe(this,xl,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return W(this,xl)}},xl=new WeakMap,ji=new WeakMap,bl=new WeakMap,rE),lh=new DL;function Tg(){let e,t;const n=new Promise((o,i)=>{e=o,t=i});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),e(o)},n.reject=o=>{r({status:"rejected",reason:o}),t(o)},n}function jL(e){return Math.min(1e3*2**e,3e4)}function QN(e){return(e??"online")==="online"?lh.isOnline():!0}var ZN=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Sm(e){return e instanceof ZN}function JN(e){let t=!1,n=0,r=!1,o;const i=Tg(),a=g=>{var y;r||(f(new ZN(g)),(y=e.abort)==null||y.call(e))},s=()=>{t=!0},l=()=>{t=!1},u=()=>K0.isFocused()&&(e.networkMode==="always"||lh.isOnline())&&e.canRun(),c=()=>QN(e.networkMode)&&e.canRun(),d=g=>{var y;r||(r=!0,(y=e.onSuccess)==null||y.call(e,g),o==null||o(),i.resolve(g))},f=g=>{var y;r||(r=!0,(y=e.onError)==null||y.call(e,g),o==null||o(),i.reject(g))},h=()=>new Promise(g=>{var y;o=m=>{(r||u())&&g(m)},(y=e.onPause)==null||y.call(e)}).then(()=>{var g;o=void 0,r||(g=e.onContinue)==null||g.call(e)}),v=()=>{if(r)return;let g;const y=n===0?e.initialPromise:void 0;try{g=y??e.fn()}catch(m){g=Promise.reject(m)}Promise.resolve(g).then(d).catch(m=>{var E;if(r)return;const x=e.retry??(ls?0:3),b=e.retryDelay??jL,w=typeof b=="function"?b(n,m):b,C=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,m);if(t||!C){f(m);return}n++,(E=e.onFail)==null||E.call(e,n,m),PL(w).then(()=>u()?void 0:h()).then(()=>{t?f(m):v()})})};return{promise:i,cancel:a,continue:()=>(o==null||o(),i),cancelRetry:s,continueRetry:l,canStart:c,start:()=>(c()?v():h().then(v),i)}}var FL=e=>setTimeout(e,0);function OL(){let e=[],t=0,n=s=>{s()},r=s=>{s()},o=FL;const i=s=>{t?e.push(s):o(()=>{n(s)})},a=()=>{const s=e;e=[],s.length&&o(()=>{r(()=>{s.forEach(l=>{n(l)})})})};return{batch:s=>{let l;t++;try{l=s()}finally{t--,t||a()}return l},batchCalls:s=>(...l)=>{i(()=>{s(...l)})},schedule:i,setNotifyFunction:s=>{n=s},setBatchNotifyFunction:s=>{r=s},setScheduler:s=>{o=s}}}var Zt=OL(),Wa,oE,eT=(oE=class{constructor(){Te(this,Wa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),_g(this.gcTime)&&pe(this,Wa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ls?1/0:5*60*1e3))}clearGcTimeout(){W(this,Wa)&&(clearTimeout(W(this,Wa)),pe(this,Wa,void 0))}},Wa=new WeakMap,oE),wl,$a,Rr,Ua,Rn,Ic,Ha,Xr,Xo,iE,LL=(iE=class extends eT{constructor(t){super();Te(this,Xr);Te(this,wl);Te(this,$a);Te(this,Rr);Te(this,Ua);Te(this,Rn);Te(this,Ic);Te(this,Ha);pe(this,Ha,!1),pe(this,Ic,t.defaultOptions),this.setOptions(t.options),this.observers=[],pe(this,Ua,t.client),pe(this,Rr,W(this,Ua).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,pe(this,wl,BL(this.options)),this.state=t.state??W(this,wl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=W(this,Rn))==null?void 0:t.promise}setOptions(t){this.options={...W(this,Ic),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&W(this,Rr).remove(this)}setData(t,n){const r=Ng(this.state.data,t,this.options);return We(this,Xr,Xo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){We(this,Xr,Xo).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,o;const n=(r=W(this,Rn))==null?void 0:r.promise;return(o=W(this,Rn))==null||o.cancel(t),n?n.then(Wn).catch(Wn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(W(this,wl))}isActive(){return this.observers.some(t=>Pr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===q0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ra(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!qN(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=W(this,Rn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=W(this,Rn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),W(this,Rr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(W(this,Rn)&&(W(this,Ha)?W(this,Rn).cancel({revert:!0}):W(this,Rn).cancelRetry()),this.scheduleGc()),W(this,Rr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||We(this,Xr,Xo).call(this,{type:"invalidate"})}fetch(t,n){var u,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(W(this,Rn))return W(this,Rn).continueRetry(),W(this,Rn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,o=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(pe(this,Ha,!0),r.signal)})},i=()=>{const f=XN(this.options,n),v=(()=>{const g={client:W(this,Ua),queryKey:this.queryKey,meta:this.meta};return o(g),g})();return pe(this,Ha,!1),this.options.persister?this.options.persister(f,v,this):f(v)},s=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:W(this,Ua),state:this.state,fetchFn:i};return o(f),f})();(u=this.options.behavior)==null||u.onFetch(s,this),pe(this,$a,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=s.fetchOptions)==null?void 0:c.meta))&&We(this,Xr,Xo).call(this,{type:"fetch",meta:(d=s.fetchOptions)==null?void 0:d.meta});const l=f=>{var h,v,g,y;Sm(f)&&f.silent||We(this,Xr,Xo).call(this,{type:"error",error:f}),Sm(f)||((v=(h=W(this,Rr).config).onError)==null||v.call(h,f,this),(y=(g=W(this,Rr).config).onSettled)==null||y.call(g,this.state.data,f,this)),this.scheduleGc()};return pe(this,Rn,JN({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var h,v,g,y;if(f===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(m){l(m);return}(v=(h=W(this,Rr).config).onSuccess)==null||v.call(h,f,this),(y=(g=W(this,Rr).config).onSettled)==null||y.call(g,f,this.state.error,this),this.scheduleGc()},onError:l,onFail:(f,h)=>{We(this,Xr,Xo).call(this,{type:"failed",failureCount:f,error:h})},onPause:()=>{We(this,Xr,Xo).call(this,{type:"pause"})},onContinue:()=>{We(this,Xr,Xo).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),W(this,Rn).start()}},wl=new WeakMap,$a=new WeakMap,Rr=new WeakMap,Ua=new WeakMap,Rn=new WeakMap,Ic=new WeakMap,Ha=new WeakMap,Xr=new WeakSet,Xo=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...tT(r.data,this.options),fetchMeta:t.meta??null};case"success":return pe(this,$a,void 0),{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return Sm(o)&&o.revert&&W(this,$a)?{...W(this,$a),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Zt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),W(this,Rr).notify({query:this,type:"updated",action:t})})},iE);function tT(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:QN(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function BL(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var yo,aE,VL=(aE=class extends Zl{constructor(t={}){super();Te(this,yo);this.config=t,pe(this,yo,new Map)}build(t,n,r){const o=n.queryKey,i=n.queryHash??G0(o,n);let a=this.get(i);return a||(a=new LL({client:t,queryKey:o,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(o)}),this.add(a)),a}add(t){W(this,yo).has(t.queryHash)||(W(this,yo).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=W(this,yo).get(t.queryHash);n&&(t.destroy(),n===t&&W(this,yo).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Zt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return W(this,yo).get(t)}getAll(){return[...W(this,yo).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>c2(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>c2(t,r)):n}notify(t){Zt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Zt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Zt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},yo=new WeakMap,aE),xo,Bn,Ga,bo,Ni,sE,zL=(sE=class extends eT{constructor(t){super();Te(this,bo);Te(this,xo);Te(this,Bn);Te(this,Ga);this.mutationId=t.mutationId,pe(this,Bn,t.mutationCache),pe(this,xo,[]),this.state=t.state||nT(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){W(this,xo).includes(t)||(W(this,xo).push(t),this.clearGcTimeout(),W(this,Bn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){pe(this,xo,W(this,xo).filter(n=>n!==t)),this.scheduleGc(),W(this,Bn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){W(this,xo).length||(this.state.status==="pending"?this.scheduleGc():W(this,Bn).remove(this))}continue(){var t;return((t=W(this,Ga))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,a,s,l,u,c,d,f,h,v,g,y,m,x,b,w,C,E,_,N;const n=()=>{We(this,bo,Ni).call(this,{type:"continue"})};pe(this,Ga,JN({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(T,k)=>{We(this,bo,Ni).call(this,{type:"failed",failureCount:T,error:k})},onPause:()=>{We(this,bo,Ni).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>W(this,Bn).canRun(this)}));const r=this.state.status==="pending",o=!W(this,Ga).canStart();try{if(r)n();else{We(this,bo,Ni).call(this,{type:"pending",variables:t,isPaused:o}),await((a=(i=W(this,Bn).config).onMutate)==null?void 0:a.call(i,t,this));const k=await((l=(s=this.options).onMutate)==null?void 0:l.call(s,t));k!==this.state.context&&We(this,bo,Ni).call(this,{type:"pending",context:k,variables:t,isPaused:o})}const T=await W(this,Ga).start();return await((c=(u=W(this,Bn).config).onSuccess)==null?void 0:c.call(u,T,t,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,T,t,this.state.context)),await((v=(h=W(this,Bn).config).onSettled)==null?void 0:v.call(h,T,null,this.state.variables,this.state.context,this)),await((y=(g=this.options).onSettled)==null?void 0:y.call(g,T,null,t,this.state.context)),We(this,bo,Ni).call(this,{type:"success",data:T}),T}catch(T){try{throw await((x=(m=W(this,Bn).config).onError)==null?void 0:x.call(m,T,t,this.state.context,this)),await((w=(b=this.options).onError)==null?void 0:w.call(b,T,t,this.state.context)),await((E=(C=W(this,Bn).config).onSettled)==null?void 0:E.call(C,void 0,T,this.state.variables,this.state.context,this)),await((N=(_=this.options).onSettled)==null?void 0:N.call(_,void 0,T,t,this.state.context)),T}finally{We(this,bo,Ni).call(this,{type:"error",error:T})}}finally{W(this,Bn).runNext(this)}}},xo=new WeakMap,Bn=new WeakMap,Ga=new WeakMap,bo=new WeakSet,Ni=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Zt.batch(()=>{W(this,xo).forEach(r=>{r.onMutationUpdate(t)}),W(this,Bn).notify({mutation:this,type:"updated",action:t})})},sE);function nT(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Jo,Yr,Mc,lE,WL=(lE=class extends Zl{constructor(t={}){super();Te(this,Jo);Te(this,Yr);Te(this,Mc);this.config=t,pe(this,Jo,new Set),pe(this,Yr,new Map),pe(this,Mc,0)}build(t,n,r){const o=new zL({mutationCache:this,mutationId:++hd(this,Mc)._,options:t.defaultMutationOptions(n),state:r});return this.add(o),o}add(t){W(this,Jo).add(t);const n=jd(t);if(typeof n=="string"){const r=W(this,Yr).get(n);r?r.push(t):W(this,Yr).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(W(this,Jo).delete(t)){const n=jd(t);if(typeof n=="string"){const r=W(this,Yr).get(n);if(r)if(r.length>1){const o=r.indexOf(t);o!==-1&&r.splice(o,1)}else r[0]===t&&W(this,Yr).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=jd(t);if(typeof n=="string"){const r=W(this,Yr).get(n),o=r==null?void 0:r.find(i=>i.state.status==="pending");return!o||o===t}else return!0}runNext(t){var r;const n=jd(t);if(typeof n=="string"){const o=(r=W(this,Yr).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Zt.batch(()=>{W(this,Jo).forEach(t=>{this.notify({type:"removed",mutation:t})}),W(this,Jo).clear(),W(this,Yr).clear()})}getAll(){return Array.from(W(this,Jo))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>d2(n,r))}findAll(t={}){return this.getAll().filter(n=>d2(t,n))}notify(t){Zt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Zt.batch(()=>Promise.all(t.map(n=>n.continue().catch(Wn))))}},Jo=new WeakMap,Yr=new WeakMap,Mc=new WeakMap,lE);function jd(e){var t;return(t=e.options.scope)==null?void 0:t.id}function p2(e){return{onFetch:(t,n)=>{var c,d,f,h,v;const r=t.options,o=(f=(d=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,i=((h=t.state.data)==null?void 0:h.pages)||[],a=((v=t.state.data)==null?void 0:v.pageParams)||[];let s={pages:[],pageParams:[]},l=0;const u=async()=>{let g=!1;const y=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},m=XN(t.options,t.fetchOptions),x=async(b,w,C)=>{if(g)return Promise.reject();if(w==null&&b.pages.length)return Promise.resolve(b);const _=(()=>{const I={client:t.client,queryKey:t.queryKey,pageParam:w,direction:C?"backward":"forward",meta:t.options.meta};return y(I),I})(),N=await m(_),{maxPages:T}=t.options,k=C?IL:AL;return{pages:k(b.pages,N,T),pageParams:k(b.pageParams,w,T)}};if(o&&i.length){const b=o==="backward",w=b?$L:m2,C={pages:i,pageParams:a},E=w(r,C);s=await x(C,E,b)}else{const b=e??i.length;do{const w=l===0?a[0]??r.initialPageParam:m2(r,s);if(l>0&&w==null)break;s=await x(s,w),l++}while(l<b)}return s};t.options.persister?t.fetchFn=()=>{var g,y;return(y=(g=t.options).persister)==null?void 0:y.call(g,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=u}}}function m2(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function $L(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Ot,Fi,Oi,Cl,Sl,Li,El,_l,uE,UL=(uE=class{constructor(e={}){Te(this,Ot);Te(this,Fi);Te(this,Oi);Te(this,Cl);Te(this,Sl);Te(this,Li);Te(this,El);Te(this,_l);pe(this,Ot,e.queryCache||new VL),pe(this,Fi,e.mutationCache||new WL),pe(this,Oi,e.defaultOptions||{}),pe(this,Cl,new Map),pe(this,Sl,new Map),pe(this,Li,0)}mount(){hd(this,Li)._++,W(this,Li)===1&&(pe(this,El,K0.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,Ot).onFocus())})),pe(this,_l,lh.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,Ot).onOnline())})))}unmount(){var e,t;hd(this,Li)._--,W(this,Li)===0&&((e=W(this,El))==null||e.call(this),pe(this,El,void 0),(t=W(this,_l))==null||t.call(this),pe(this,_l,void 0))}isFetching(e){return W(this,Ot).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return W(this,Fi).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=W(this,Ot).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=W(this,Ot).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(ra(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return W(this,Ot).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),o=W(this,Ot).get(r.queryHash),i=o==null?void 0:o.state.data,a=RL(t,i);if(a!==void 0)return W(this,Ot).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(e,t,n){return Zt.batch(()=>W(this,Ot).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=W(this,Ot).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=W(this,Ot);Zt.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=W(this,Ot);return Zt.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=Zt.batch(()=>W(this,Ot).findAll(e).map(o=>o.cancel(n)));return Promise.all(r).then(Wn).catch(Wn)}invalidateQueries(e,t={}){return Zt.batch(()=>(W(this,Ot).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=Zt.batch(()=>W(this,Ot).findAll(e).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let i=o.fetch(void 0,n);return n.throwOnError||(i=i.catch(Wn)),o.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Wn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=W(this,Ot).build(this,t);return n.isStaleByTime(ra(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Wn).catch(Wn)}fetchInfiniteQuery(e){return e.behavior=p2(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Wn).catch(Wn)}ensureInfiniteQueryData(e){return e.behavior=p2(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return lh.isOnline()?W(this,Fi).resumePausedMutations():Promise.resolve()}getQueryCache(){return W(this,Ot)}getMutationCache(){return W(this,Fi)}getDefaultOptions(){return W(this,Oi)}setDefaultOptions(e){pe(this,Oi,e)}setQueryDefaults(e,t){W(this,Cl).set(us(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...W(this,Cl).values()],n={};return t.forEach(r=>{vc(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){W(this,Sl).set(us(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...W(this,Sl).values()],n={};return t.forEach(r=>{vc(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...W(this,Oi).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=G0(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===q0&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...W(this,Oi).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){W(this,Ot).clear(),W(this,Fi).clear()}},Ot=new WeakMap,Fi=new WeakMap,Oi=new WeakMap,Cl=new WeakMap,Sl=new WeakMap,Li=new WeakMap,El=new WeakMap,_l=new WeakMap,uE),Qn,Ke,Dc,Vn,qa,kl,Bi,Vi,jc,Nl,Tl,Ka,Xa,zi,Rl,ot,ku,Rg,Pg,Ag,Ig,Mg,Dg,jg,rT,cE,HL=(cE=class extends Zl{constructor(t,n){super();Te(this,ot);Te(this,Qn);Te(this,Ke);Te(this,Dc);Te(this,Vn);Te(this,qa);Te(this,kl);Te(this,Bi);Te(this,Vi);Te(this,jc);Te(this,Nl);Te(this,Tl);Te(this,Ka);Te(this,Xa);Te(this,zi);Te(this,Rl,new Set);this.options=n,pe(this,Qn,t),pe(this,Vi,null),pe(this,Bi,Tg()),this.options.experimental_prefetchInRender||W(this,Bi).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(W(this,Ke).addObserver(this),v2(W(this,Ke),this.options)?We(this,ot,ku).call(this):this.updateResult(),We(this,ot,Ig).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Fg(W(this,Ke),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Fg(W(this,Ke),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,We(this,ot,Mg).call(this),We(this,ot,Dg).call(this),W(this,Ke).removeObserver(this)}setOptions(t){const n=this.options,r=W(this,Ke);if(this.options=W(this,Qn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Pr(this.options.enabled,W(this,Ke))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");We(this,ot,jg).call(this),W(this,Ke).setOptions(this.options),n._defaulted&&!sh(this.options,n)&&W(this,Qn).getQueryCache().notify({type:"observerOptionsUpdated",query:W(this,Ke),observer:this});const o=this.hasListeners();o&&g2(W(this,Ke),r,this.options,n)&&We(this,ot,ku).call(this),this.updateResult(),o&&(W(this,Ke)!==r||Pr(this.options.enabled,W(this,Ke))!==Pr(n.enabled,W(this,Ke))||ra(this.options.staleTime,W(this,Ke))!==ra(n.staleTime,W(this,Ke)))&&We(this,ot,Rg).call(this);const i=We(this,ot,Pg).call(this);o&&(W(this,Ke)!==r||Pr(this.options.enabled,W(this,Ke))!==Pr(n.enabled,W(this,Ke))||i!==W(this,zi))&&We(this,ot,Ag).call(this,i)}getOptimisticResult(t){const n=W(this,Qn).getQueryCache().build(W(this,Qn),t),r=this.createResult(n,t);return qL(this,r)&&(pe(this,Vn,r),pe(this,kl,this.options),pe(this,qa,W(this,Ke).state)),r}getCurrentResult(){return W(this,Vn)}trackResult(t,n){return new Proxy(t,{get:(r,o)=>(this.trackProp(o),n==null||n(o),Reflect.get(r,o))})}trackProp(t){W(this,Rl).add(t)}getCurrentQuery(){return W(this,Ke)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=W(this,Qn).defaultQueryOptions(t),r=W(this,Qn).getQueryCache().build(W(this,Qn),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return We(this,ot,ku).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),W(this,Vn)))}createResult(t,n){var T;const r=W(this,Ke),o=this.options,i=W(this,Vn),a=W(this,qa),s=W(this,kl),u=t!==r?t.state:W(this,Dc),{state:c}=t;let d={...c},f=!1,h;if(n._optimisticResults){const k=this.hasListeners(),I=!k&&v2(t,n),A=k&&g2(t,r,n,o);(I||A)&&(d={...d,...tT(c.data,t.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:v,errorUpdatedAt:g,status:y}=d;h=d.data;let m=!1;if(n.placeholderData!==void 0&&h===void 0&&y==="pending"){let k;i!=null&&i.isPlaceholderData&&n.placeholderData===(s==null?void 0:s.placeholderData)?(k=i.data,m=!0):k=typeof n.placeholderData=="function"?n.placeholderData((T=W(this,Tl))==null?void 0:T.state.data,W(this,Tl)):n.placeholderData,k!==void 0&&(y="success",h=Ng(i==null?void 0:i.data,k,n),f=!0)}if(n.select&&h!==void 0&&!m)if(i&&h===(a==null?void 0:a.data)&&n.select===W(this,jc))h=W(this,Nl);else try{pe(this,jc,n.select),h=n.select(h),h=Ng(i==null?void 0:i.data,h,n),pe(this,Nl,h),pe(this,Vi,null)}catch(k){pe(this,Vi,k)}W(this,Vi)&&(v=W(this,Vi),h=W(this,Nl),g=Date.now(),y="error");const x=d.fetchStatus==="fetching",b=y==="pending",w=y==="error",C=b&&x,E=h!==void 0,N={status:y,fetchStatus:d.fetchStatus,isPending:b,isSuccess:y==="success",isError:w,isInitialLoading:C,isLoading:C,data:h,dataUpdatedAt:d.dataUpdatedAt,error:v,errorUpdatedAt:g,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>u.dataUpdateCount||d.errorUpdateCount>u.errorUpdateCount,isFetching:x,isRefetching:x&&!b,isLoadingError:w&&!E,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:w&&E,isStale:X0(t,n),refetch:this.refetch,promise:W(this,Bi),isEnabled:Pr(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const k=U=>{N.status==="error"?U.reject(N.error):N.data!==void 0&&U.resolve(N.data)},I=()=>{const U=pe(this,Bi,N.promise=Tg());k(U)},A=W(this,Bi);switch(A.status){case"pending":t.queryHash===r.queryHash&&k(A);break;case"fulfilled":(N.status==="error"||N.data!==A.value)&&I();break;case"rejected":(N.status!=="error"||N.error!==A.reason)&&I();break}}return N}updateResult(){const t=W(this,Vn),n=this.createResult(W(this,Ke),this.options);if(pe(this,qa,W(this,Ke).state),pe(this,kl,this.options),W(this,qa).data!==void 0&&pe(this,Tl,W(this,Ke)),sh(n,t))return;pe(this,Vn,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:o}=this.options,i=typeof o=="function"?o():o;if(i==="all"||!i&&!W(this,Rl).size)return!0;const a=new Set(i??W(this,Rl));return this.options.throwOnError&&a.add("error"),Object.keys(W(this,Vn)).some(s=>{const l=s;return W(this,Vn)[l]!==t[l]&&a.has(l)})};We(this,ot,rT).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&We(this,ot,Ig).call(this)}},Qn=new WeakMap,Ke=new WeakMap,Dc=new WeakMap,Vn=new WeakMap,qa=new WeakMap,kl=new WeakMap,Bi=new WeakMap,Vi=new WeakMap,jc=new WeakMap,Nl=new WeakMap,Tl=new WeakMap,Ka=new WeakMap,Xa=new WeakMap,zi=new WeakMap,Rl=new WeakMap,ot=new WeakSet,ku=function(t){We(this,ot,jg).call(this);let n=W(this,Ke).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Wn)),n},Rg=function(){We(this,ot,Mg).call(this);const t=ra(this.options.staleTime,W(this,Ke));if(ls||W(this,Vn).isStale||!_g(t))return;const r=qN(W(this,Vn).dataUpdatedAt,t)+1;pe(this,Ka,setTimeout(()=>{W(this,Vn).isStale||this.updateResult()},r))},Pg=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(W(this,Ke)):this.options.refetchInterval)??!1},Ag=function(t){We(this,ot,Dg).call(this),pe(this,zi,t),!(ls||Pr(this.options.enabled,W(this,Ke))===!1||!_g(W(this,zi))||W(this,zi)===0)&&pe(this,Xa,setInterval(()=>{(this.options.refetchIntervalInBackground||K0.isFocused())&&We(this,ot,ku).call(this)},W(this,zi)))},Ig=function(){We(this,ot,Rg).call(this),We(this,ot,Ag).call(this,We(this,ot,Pg).call(this))},Mg=function(){W(this,Ka)&&(clearTimeout(W(this,Ka)),pe(this,Ka,void 0))},Dg=function(){W(this,Xa)&&(clearInterval(W(this,Xa)),pe(this,Xa,void 0))},jg=function(){const t=W(this,Qn).getQueryCache().build(W(this,Qn),this.options);if(t===W(this,Ke))return;const n=W(this,Ke);pe(this,Ke,t),pe(this,Dc,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},rT=function(t){Zt.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(W(this,Vn))}),W(this,Qn).getQueryCache().notify({query:W(this,Ke),type:"observerResultsUpdated"})})},cE);function GL(e,t){return Pr(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function v2(e,t){return GL(e,t)||e.state.data!==void 0&&Fg(e,t,t.refetchOnMount)}function Fg(e,t,n){if(Pr(t.enabled,e)!==!1&&ra(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&X0(e,t)}return!1}function g2(e,t,n,r){return(e!==t||Pr(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&X0(e,n)}function X0(e,t){return Pr(t.enabled,e)!==!1&&e.isStaleByTime(ra(t.staleTime,e))}function qL(e,t){return!sh(e.getCurrentResult(),t)}var Wi,$i,Zn,ei,ii,Sf,Og,dE,KL=(dE=class extends Zl{constructor(n,r){super();Te(this,ii);Te(this,Wi);Te(this,$i);Te(this,Zn);Te(this,ei);pe(this,Wi,n),this.setOptions(r),this.bindMethods(),We(this,ii,Sf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var o;const r=this.options;this.options=W(this,Wi).defaultMutationOptions(n),sh(this.options,r)||W(this,Wi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:W(this,Zn),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&us(r.mutationKey)!==us(this.options.mutationKey)?this.reset():((o=W(this,Zn))==null?void 0:o.state.status)==="pending"&&W(this,Zn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=W(this,Zn))==null||n.removeObserver(this)}onMutationUpdate(n){We(this,ii,Sf).call(this),We(this,ii,Og).call(this,n)}getCurrentResult(){return W(this,$i)}reset(){var n;(n=W(this,Zn))==null||n.removeObserver(this),pe(this,Zn,void 0),We(this,ii,Sf).call(this),We(this,ii,Og).call(this)}mutate(n,r){var o;return pe(this,ei,r),(o=W(this,Zn))==null||o.removeObserver(this),pe(this,Zn,W(this,Wi).getMutationCache().build(W(this,Wi),this.options)),W(this,Zn).addObserver(this),W(this,Zn).execute(n)}},Wi=new WeakMap,$i=new WeakMap,Zn=new WeakMap,ei=new WeakMap,ii=new WeakSet,Sf=function(){var r;const n=((r=W(this,Zn))==null?void 0:r.state)??nT();pe(this,$i,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Og=function(n){Zt.batch(()=>{var r,o,i,a,s,l,u,c;if(W(this,ei)&&this.hasListeners()){const d=W(this,$i).variables,f=W(this,$i).context;(n==null?void 0:n.type)==="success"?((o=(r=W(this,ei)).onSuccess)==null||o.call(r,n.data,d,f),(a=(i=W(this,ei)).onSettled)==null||a.call(i,n.data,null,d,f)):(n==null?void 0:n.type)==="error"&&((l=(s=W(this,ei)).onError)==null||l.call(s,n.error,d,f),(c=(u=W(this,ei)).onSettled)==null||c.call(u,void 0,n.error,d,f))}this.listeners.forEach(d=>{d(W(this,$i))})})},dE),oT=S.createContext(void 0),iT=e=>{const t=S.useContext(oT);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},XL=({client:e,children:t})=>(S.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),p.jsx(oT.Provider,{value:e,children:t})),aT=S.createContext(!1),YL=()=>S.useContext(aT);aT.Provider;function QL(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var ZL=S.createContext(QL()),JL=()=>S.useContext(ZL),eB=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},tB=e=>{S.useEffect(()=>{e.clearReset()},[e])},nB=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:o})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(o&&e.data===void 0||YN(n,[e.error,r])),rB=e=>{if(e.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...r)=>t(n(...r)):t(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},oB=(e,t)=>e.isLoading&&e.isFetching&&!t,iB=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,y2=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function aB(e,t,n){var d,f,h,v,g;const r=YL(),o=JL(),i=iT(),a=i.defaultQueryOptions(e);(f=(d=i.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||f.call(d,a),a._optimisticResults=r?"isRestoring":"optimistic",rB(a),eB(a,o),tB(o);const s=!i.getQueryCache().get(a.queryHash),[l]=S.useState(()=>new t(i,a)),u=l.getOptimisticResult(a),c=!r&&e.subscribed!==!1;if(S.useSyncExternalStore(S.useCallback(y=>{const m=c?l.subscribe(Zt.batchCalls(y)):Wn;return l.updateResult(),m},[l,c]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),S.useEffect(()=>{l.setOptions(a)},[a,l]),iB(a,u))throw y2(a,l,o);if(nB({result:u,errorResetBoundary:o,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw u.error;if((v=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||v.call(h,a,u),a.experimental_prefetchInRender&&!ls&&oB(u,r)){const y=s?y2(a,l,o):(g=i.getQueryCache().get(a.queryHash))==null?void 0:g.promise;y==null||y.catch(Wn).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?u:l.trackResult(u)}function sB(e,t){return aB(e,HL)}function lB(e,t){const n=iT(),[r]=S.useState(()=>new KL(n,e));S.useEffect(()=>{r.setOptions(e)},[r,e]);const o=S.useSyncExternalStore(S.useCallback(a=>r.subscribe(Zt.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=S.useCallback((a,s)=>{r.mutate(a,s).catch(Wn)},[r]);if(o.error&&YN(r.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:i,mutateAsync:o.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gc(){return gc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gc.apply(this,arguments)}var Gi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Gi||(Gi={}));const x2="popstate";function uB(e){e===void 0&&(e={});function t(r,o){let{pathname:i,search:a,hash:s}=r.location;return Lg("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:lT(o)}return dB(t,n,null,e)}function en(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function sT(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function cB(){return Math.random().toString(36).substr(2,8)}function b2(e,t){return{usr:e.state,key:e.key,idx:t}}function Lg(e,t,n,r){return n===void 0&&(n=null),gc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Jl(t):t,{state:n,key:t&&t.key||r||cB()})}function lT(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Jl(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function dB(e,t,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=Gi.Pop,l=null,u=c();u==null&&(u=0,a.replaceState(gc({},a.state,{idx:u}),""));function c(){return(a.state||{idx:null}).idx}function d(){s=Gi.Pop;let y=c(),m=y==null?null:y-u;u=y,l&&l({action:s,location:g.location,delta:m})}function f(y,m){s=Gi.Push;let x=Lg(g.location,y,m);u=c()+1;let b=b2(x,u),w=g.createHref(x);try{a.pushState(b,"",w)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;o.location.assign(w)}i&&l&&l({action:s,location:g.location,delta:1})}function h(y,m){s=Gi.Replace;let x=Lg(g.location,y,m);u=c();let b=b2(x,u),w=g.createHref(x);a.replaceState(b,"",w),i&&l&&l({action:s,location:g.location,delta:0})}function v(y){let m=o.location.origin!=="null"?o.location.origin:o.location.href,x=typeof y=="string"?y:lT(y);return x=x.replace(/ $/,"%20"),en(m,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,m)}let g={get action(){return s},get location(){return e(o,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return o.addEventListener(x2,d),l=y,()=>{o.removeEventListener(x2,d),l=null}},createHref(y){return t(o,y)},createURL:v,encodeLocation(y){let m=v(y);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:h,go(y){return a.go(y)}};return g}var w2;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(w2||(w2={}));function fB(e,t,n){return n===void 0&&(n="/"),hB(e,t,n,!1)}function hB(e,t,n,r){let o=typeof t=="string"?Jl(t):t,i=dT(o.pathname||"/",n);if(i==null)return null;let a=uT(e);pB(a);let s=null;for(let l=0;s==null&&l<a.length;++l){let u=_B(i);s=SB(a[l],u,r)}return s}function uT(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let l={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(en(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Za([r,l.relativePath]),c=n.concat(l);i.children&&i.children.length>0&&(en(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),uT(i.children,t,c,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:wB(u,i.index),routesMeta:c})};return e.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let l of cT(i.path))o(i,a,l)}),t}function cT(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=cT(r.join("/")),s=[];return s.push(...a.map(l=>l===""?i:[i,l].join("/"))),o&&s.push(...a),s.map(l=>e.startsWith("/")&&l===""?"/":l)}function pB(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:CB(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const mB=/^:[\w-]+$/,vB=3,gB=2,yB=1,xB=10,bB=-2,C2=e=>e==="*";function wB(e,t){let n=e.split("/"),r=n.length;return n.some(C2)&&(r+=bB),t&&(r+=gB),n.filter(o=>!C2(o)).reduce((o,i)=>o+(mB.test(i)?vB:i===""?yB:xB),r)}function CB(e,t){return e.length===t.length&&e.slice(0,-1).every((r,o)=>r===t[o])?e[e.length-1]-t[t.length-1]:0}function SB(e,t,n){let{routesMeta:r}=e,o={},i="/",a=[];for(let s=0;s<r.length;++s){let l=r[s],u=s===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",d=S2({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),f=l.route;if(!d&&u&&n&&!r[r.length-1].route.index&&(d=S2({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:Za([i,d.pathname]),pathnameBase:AB(Za([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=Za([i,d.pathnameBase]))}return a}function S2(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=EB(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((u,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let g=s[d]||"";a=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=s[d];return h&&!v?u[f]=void 0:u[f]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:e}}function EB(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),sT(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function _B(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return sT(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function dT(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function kB(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:o=""}=typeof e=="string"?Jl(e):e;return{pathname:n?n.startsWith("/")?n:NB(n,t):t,search:IB(r),hash:MB(o)}}function NB(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Em(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function TB(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function RB(e,t){let n=TB(e);return t?n.map((r,o)=>o===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function PB(e,t,n,r){r===void 0&&(r=!1);let o;typeof e=="string"?o=Jl(e):(o=gc({},e),en(!o.pathname||!o.pathname.includes("?"),Em("?","pathname","search",o)),en(!o.pathname||!o.pathname.includes("#"),Em("#","pathname","hash",o)),en(!o.search||!o.search.includes("#"),Em("#","search","hash",o)));let i=e===""||o.pathname==="",a=i?"/":o.pathname,s;if(a==null)s=n;else{let d=t.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;o.pathname=f.join("/")}s=d>=0?t[d]:"/"}let l=kB(o,s),u=a&&a!=="/"&&a.endsWith("/"),c=(i||a===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Za=e=>e.join("/").replace(/\/\/+/g,"/"),AB=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),IB=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,MB=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function DB(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const fT=["post","put","patch","delete"];new Set(fT);const jB=["get",...fT];new Set(jB);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yc(){return yc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yc.apply(this,arguments)}const Y0=S.createContext(null),FB=S.createContext(null),hp=S.createContext(null),pp=S.createContext(null),vs=S.createContext({outlet:null,matches:[],isDataRoute:!1}),hT=S.createContext(null);function mp(){return S.useContext(pp)!=null}function Q0(){return mp()||en(!1),S.useContext(pp).location}function pT(e){S.useContext(hp).static||S.useLayoutEffect(e)}function OB(){let{isDataRoute:e}=S.useContext(vs);return e?QB():LB()}function LB(){mp()||en(!1);let e=S.useContext(Y0),{basename:t,future:n,navigator:r}=S.useContext(hp),{matches:o}=S.useContext(vs),{pathname:i}=Q0(),a=JSON.stringify(RB(o,n.v7_relativeSplatPath)),s=S.useRef(!1);return pT(()=>{s.current=!0}),S.useCallback(function(u,c){if(c===void 0&&(c={}),!s.current)return;if(typeof u=="number"){r.go(u);return}let d=PB(u,JSON.parse(a),i,c.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Za([t,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[t,r,a,i,e])}function BB(){let{matches:e}=S.useContext(vs),t=e[e.length-1];return t?t.params:{}}function VB(e,t){return zB(e,t)}function zB(e,t,n,r){mp()||en(!1);let{navigator:o}=S.useContext(hp),{matches:i}=S.useContext(vs),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=Q0(),c;if(t){var d;let y=typeof t=="string"?Jl(t):t;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||en(!1),c=y}else c=u;let f=c.pathname||"/",h=f;if(l!=="/"){let y=l.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=fB(e,{pathname:h}),g=GB(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},s,y.params),pathname:Za([l,o.encodeLocation?o.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Za([l,o.encodeLocation?o.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,r);return t&&g?S.createElement(pp.Provider,{value:{location:yc({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Gi.Pop}},g):g}function WB(){let e=YB(),t=DB(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),n?S.createElement("pre",{style:o},n):null,null)}const $B=S.createElement(WB,null);class UB extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?S.createElement(vs.Provider,{value:this.props.routeContext},S.createElement(hT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function HB(e){let{routeContext:t,match:n,children:r}=e,o=S.useContext(Y0);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(vs.Provider,{value:t},r)}function GB(e,t,n,r){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,s=(o=n)==null?void 0:o.errors;if(s!=null){let c=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);c>=0||en(!1),a=a.slice(0,Math.min(a.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let d=a[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:f,errors:h}=n,v=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||v){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((c,d,f)=>{let h,v=!1,g=null,y=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,g=d.route.errorElement||$B,l&&(u<0&&f===0?(v=!0,y=null):u===f&&(v=!0,y=d.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,f+1)),x=()=>{let b;return h?b=g:v?b=y:d.route.Component?b=S.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,S.createElement(HB,{match:d,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?S.createElement(UB,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:x(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):x()},null)}var mT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(mT||{}),uh=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(uh||{});function qB(e){let t=S.useContext(Y0);return t||en(!1),t}function KB(e){let t=S.useContext(FB);return t||en(!1),t}function XB(e){let t=S.useContext(vs);return t||en(!1),t}function vT(e){let t=XB(),n=t.matches[t.matches.length-1];return n.route.id||en(!1),n.route.id}function YB(){var e;let t=S.useContext(hT),n=KB(uh.UseRouteError),r=vT(uh.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function QB(){let{router:e}=qB(mT.UseNavigateStable),t=vT(uh.UseNavigateStable),n=S.useRef(!1);return pT(()=>{n.current=!0}),S.useCallback(function(o,i){i===void 0&&(i={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,yc({fromRouteId:t},i)))},[e,t])}function ZB(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Nu(e){en(!1)}function JB(e){let{basename:t="/",children:n=null,location:r,navigationType:o=Gi.Pop,navigator:i,static:a=!1,future:s}=e;mp()&&en(!1);let l=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:l,navigator:i,static:a,future:yc({v7_relativeSplatPath:!1},s)}),[l,s,i,a]);typeof r=="string"&&(r=Jl(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:v="default"}=r,g=S.useMemo(()=>{let y=dT(c,l);return y==null?null:{location:{pathname:y,search:d,hash:f,state:h,key:v},navigationType:o}},[l,c,d,f,h,v,o]);return g==null?null:S.createElement(hp.Provider,{value:u},S.createElement(pp.Provider,{children:n,value:g}))}function e5(e){let{children:t,location:n}=e;return VB(Bg(t),n)}new Promise(()=>{});function Bg(e,t){t===void 0&&(t=[]);let n=[];return S.Children.forEach(e,(r,o)=>{if(!S.isValidElement(r))return;let i=[...t,o];if(r.type===S.Fragment){n.push.apply(n,Bg(r.props.children,i));return}r.type!==Nu&&en(!1),!r.props.index||!r.props.children||en(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Bg(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const t5="6";try{window.__reactRouterVersion=t5}catch{}const n5="startTransition",E2=Oy[n5];function r5(e){let{basename:t,children:n,future:r,window:o}=e,i=S.useRef();i.current==null&&(i.current=uB({window:o,v5Compat:!0}));let a=i.current,[s,l]=S.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},c=S.useCallback(d=>{u&&E2?E2(()=>l(d)):l(d)},[l,u]);return S.useLayoutEffect(()=>a.listen(c),[a,c]),S.useEffect(()=>ZB(r),[r]),S.createElement(JB,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a,future:r})}var _2;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_2||(_2={}));var k2;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(k2||(k2={}));const o5=ap("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90 shadow-md hover:shadow-lg"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ie=S.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...o},i)=>{const a=r?CF:"button";return p.jsx(a,{className:Et(o5({variant:t,size:n,className:e})),ref:i,...o})});Ie.displayName="Button";const fe=S.forwardRef(({className:e,type:t,...n},r)=>p.jsx("input",{type:t,className:Et("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));fe.displayName="Input";var i5="Label",gT=S.forwardRef((e,t)=>p.jsx(Tt.label,{...e,ref:t,onMouseDown:n=>{var o;n.target.closest("button, input, select, textarea")||((o=e.onMouseDown)==null||o.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));gT.displayName=i5;var yT=gT;const a5=ap("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ge=S.forwardRef(({className:e,...t},n)=>p.jsx(yT,{ref:n,className:Et(a5(),e),...t}));ge.displayName=yT.displayName;const ut=S.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Et("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));ut.displayName="Card";const xt=S.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Et("flex flex-col space-y-1.5 p-6",e),...t}));xt.displayName="CardHeader";const bt=S.forwardRef(({className:e,...t},n)=>p.jsx("h3",{ref:n,className:Et("text-2xl font-semibold leading-none tracking-tight",e),...t}));bt.displayName="CardTitle";const wt=S.forwardRef(({className:e,...t},n)=>p.jsx("p",{ref:n,className:Et("text-sm text-muted-foreground",e),...t}));wt.displayName="CardDescription";const Lt=S.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Et("p-6 pt-0",e),...t}));Lt.displayName="CardContent";const s5=S.forwardRef(({className:e,...t},n)=>p.jsx("div",{ref:n,className:Et("flex items-center p-6 pt-0",e),...t}));s5.displayName="CardFooter";const So=S.forwardRef(({className:e,...t},n)=>p.jsx("textarea",{className:Et("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));So.displayName="Textarea";const l5=ap("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function N2({className:e,variant:t,...n}){return p.jsx("div",{className:Et(l5({variant:t}),e),...n})}async function xT(e){if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}async function zu(e,t,n){const r=await fetch(t,{method:e,headers:n?{"Content-Type":"application/json"}:{},body:n?JSON.stringify(n):void 0,credentials:"include"});return await xT(r),r}const u5=({on401:e})=>async({queryKey:t})=>{const n=await fetch(t[0],{credentials:"include"});return e==="returnNull"&&n.status===401?null:(await xT(n),await n.json())},bT=new UL({defaultOptions:{queries:{queryFn:u5({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),Ia={companyName:"Sua Empresa",logoUrl:"",footerText:" 2024 Sua Empresa. Todos os direitos reservados.",contactEmail:"contato@suaempresa.com",contactPhone:"(11) 99999-9999"},ht={pageTitle:"Revise e Assine o Contrato",title:"CONTRATO DE PRESTAO DE SERVIOS",contractorSection:"CONTRATANTE",clausesSection:"CLUSULAS CONTRATUAIS",clauses:[{title:"CLUSULA PRIMEIRA - DO OBJETO",content:"O presente contrato tem por objeto a prestao de servios conforme especificaes acordadas entre as partes, em conformidade com a legislao brasileira vigente."},{title:"CLUSULA SEGUNDA - DO PRAZO",content:"Este contrato ter vigncia de 12 (doze) meses a partir da data de assinatura, podendo ser renovado mediante acordo entre as partes."},{title:"CLUSULA TERCEIRA - DAS OBRIGAES",content:"As partes se comprometem a cumprir fielmente todas as condies estabelecidas neste instrumento, sob pena de resciso contratual e aplicao das penalidades cabveis."},{title:"CLUSULA QUARTA - DA CONFIDENCIALIDADE",content:"As partes se obrigam a manter sigilo sobre todas as informaes confidenciais a que tiverem acesso em razo deste contrato, em conformidade com a Lei Geral de Proteo de Dados (LGPD)."},{title:"CLUSULA QUINTA - DO FORO",content:"Fica eleito o foro da comarca de So Paulo/SP para dirimir quaisquer dvidas oriundas do presente contrato."}],signature:{title:"ASSINATURA ELETRNICA",signedText:"Este contrato foi assinado eletronicamente em",authMethod:"Mtodo de autenticao:",authValue:"GOV.BR (Governo Federal)",securityLevel:"Nvel de segurana:",signedVia:" Assinado eletronicamente via GOV.BR"},agreementText:"Li e concordo com todos os termos e condies do contrato acima. Declaro que as informaes fornecidas so verdadeiras e que estou ciente da validade jurdica desta assinatura digital.",scrollWarning:"Role at o final para continuar",signButton:"Assinar Contrato",signButtonLoading:"Assinando...",toastScrollTitle:"Ao necessria",toastScrollDescription:"Por favor, leia todo o contrato e marque a caixa de concordncia.",toastSuccessTitle:"Contrato assinado!",toastSuccessDescription:"Sua assinatura digital foi registrada com sucesso.",toastErrorTitle:"Erro ao assinar",toastErrorDescription:"Ocorreu um erro ao processar sua assinatura. Tente novamente."},Fd={title:"Contrato Assinado com Sucesso!",subtitle:"Sua assinatura digital foi registrada e validada.",instruction:"Voc receber uma cpia do contrato no seu e-mail cadastrado no GOV.BR.",finalButton:"Voltar ao incio"},c5=e=>{const t=e.replace(/\D/g,"");if(t.length!==11||/^(\d)\1{10}$/.test(t))return!1;let n=0;for(let o=0;o<9;o++)n+=parseInt(t.charAt(o))*(10-o);let r=n*10%11;if((r===10||r===11)&&(r=0),r!==parseInt(t.charAt(9)))return!1;n=0;for(let o=0;o<10;o++)n+=parseInt(t.charAt(o))*(11-o);return r=n*10%11,(r===10||r===11)&&(r=0),r===parseInt(t.charAt(10))},wT=e=>e.replace(/\D/g,"").slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),d5=wT,CT=e=>e.replace(/\D/g,"").slice(0,11).replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2"),f5=CT,h5=()=>{const e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),o=Math.random().toString(36).substring(2,8).toUpperCase();return`CTR-${t}${n}${r}-${o}`},ST=e=>(typeof e=="string"?new Date(e):e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),p5=({progressTitle:e,onProgressTitleChange:t,progressSubtitle:n,onProgressSubtitleChange:r,progressStep1Title:o,onProgressStep1TitleChange:i,progressStep1Description:a,onProgressStep1DescriptionChange:s,progressStep2Title:l,onProgressStep2TitleChange:u,progressStep2Description:c,onProgressStep2DescriptionChange:d,progressStep3Title:f,onProgressStep3TitleChange:h,progressStep3Description:v,onProgressStep3DescriptionChange:g,progressButtonText:y,onProgressButtonTextChange:m,progressCardColor:x,onProgressCardColorChange:b,progressButtonColor:w,onProgressButtonColorChange:C,progressTextColor:E,onProgressTextColorChange:_,progressFontFamily:N,onProgressFontFamilyChange:T,progressFontSize:k,onProgressFontSizeChange:I})=>p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"space-y-6",children:[p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Ttulo e Descrio"}),p.jsx(wt,{children:"Personalize o texto principal"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressTitle",children:"Ttulo Principal"}),p.jsx(fe,{id:"progressTitle",value:e,onChange:A=>t(A.target.value),placeholder:"Ex: Assinatura Digital"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressSubtitle",children:"Subttulo/Descrio"}),p.jsx(So,{id:"progressSubtitle",value:n,onChange:A=>r(A.target.value),placeholder:"Ex: Conclua os passos abaixo...",rows:2})]})]})]}),p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Passo 1: Reconhecimento Facial"}),p.jsx(wt,{children:"Customize o texto do primeiro passo"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep1Title",children:"Ttulo do Passo 1"}),p.jsx(fe,{id:"progressStep1Title",value:o,onChange:A=>i(A.target.value),placeholder:"Ex: 1. Reconhecimento Facial"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep1Description",children:"Descrio do Passo 1"}),p.jsx(So,{id:"progressStep1Description",value:a,onChange:A=>s(A.target.value),placeholder:"Ex: Tire uma selfie para validar sua identidade...",rows:2})]})]})]}),p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Passo 2: Assinatura do Contrato"}),p.jsx(wt,{children:"Customize o texto do segundo passo"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep2Title",children:"Ttulo do Passo 2"}),p.jsx(fe,{id:"progressStep2Title",value:l,onChange:A=>u(A.target.value),placeholder:"Ex: 2. Assinar Contrato"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep2Description",children:"Descrio do Passo 2"}),p.jsx(So,{id:"progressStep2Description",value:c,onChange:A=>d(A.target.value),placeholder:"Ex: Assine digitalmente o contrato...",rows:2})]})]})]}),p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Passo 3: Baixar Aplicativo"}),p.jsx(wt,{children:"Customize o texto do terceiro passo"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep3Title",children:"Ttulo do Passo 3"}),p.jsx(fe,{id:"progressStep3Title",value:f,onChange:A=>h(A.target.value),placeholder:"Ex: 3. Baixar Aplicativo"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep3Description",children:"Descrio do Passo 3"}),p.jsx(So,{id:"progressStep3Description",value:v,onChange:A=>g(A.target.value),placeholder:"Ex: Baixe o app oficial...",rows:2})]})]})]}),p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Passo 3: Baixar Aplicativo"}),p.jsx(wt,{children:"Customize o texto do terceiro passo"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep3Title",children:"Ttulo do Passo 3"}),p.jsx(fe,{id:"progressStep3Title",value:f,onChange:A=>h(A.target.value),placeholder:"Ex: 3. Baixar Aplicativo"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressStep3Description",children:"Descrio do Passo 3"}),p.jsx(So,{id:"progressStep3Description",value:v,onChange:A=>g(A.target.value),placeholder:"Ex: Baixe o app oficial...",rows:2})]})]})]}),p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Boto e Fontes"}),p.jsx(wt,{children:"Customize o texto do boto e tipografia"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressButtonText",children:"Texto do Boto"}),p.jsx(fe,{id:"progressButtonText",value:y,onChange:A=>m(A.target.value),placeholder:"Ex: Complete os passos acima"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressFontFamily",children:"Famlia de Fonte"}),p.jsxs("select",{id:"progressFontFamily",value:N,onChange:A=>T(A.target.value),className:"w-full px-3 py-2 border rounded-md",children:[p.jsx("option",{value:"Arial, sans-serif",children:"Arial"}),p.jsx("option",{value:"Georgia, serif",children:"Georgia"}),p.jsx("option",{value:"'Courier New', monospace",children:"Courier New"}),p.jsx("option",{value:"'Times New Roman', serif",children:"Times New Roman"}),p.jsx("option",{value:"Verdana, sans-serif",children:"Verdana"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressFontSize",children:"Tamanho da Fonte"}),p.jsx(fe,{id:"progressFontSize",value:k,onChange:A=>I(A.target.value),placeholder:"Ex: 16px"})]})]})]}),p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Cores Personalizadas"}),p.jsx(wt,{children:"Escolha as cores do rastreador"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressCardColor",children:"Cor do Card/Fundo"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"progressCardColor",type:"color",value:x,onChange:A=>b(A.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:x,onChange:A=>b(A.target.value),placeholder:"#dbeafe",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressButtonColor",children:"Cor do Boto/Indicadores"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"progressButtonColor",type:"color",value:w,onChange:A=>C(A.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:w,onChange:A=>C(A.target.value),placeholder:"#22c55e",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"progressTextColor",children:"Cor do Texto"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"progressTextColor",type:"color",value:E,onChange:A=>_(A.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:E,onChange:A=>_(A.target.value),placeholder:"#1e40af",className:"flex-1"})]})]})]})]})]}),p.jsx("div",{className:"sticky top-6 h-fit",children:p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{className:"text-base",children:"Preview para Cliente"}),p.jsx(wt,{children:"Visualizao em tempo real"})]}),p.jsx(Lt,{children:p.jsxs("div",{style:{backgroundColor:x,fontFamily:N,padding:"24px",borderRadius:"8px",gap:"16px",display:"flex",flexDirection:"column"},children:[p.jsx("h2",{style:{color:E,fontSize:"20px",fontWeight:"bold",margin:"0 0 1rem 0",padding:0},children:e}),p.jsx("p",{style:{color:E,fontSize:k,margin:0,padding:0},children:n}),p.jsxs("div",{style:{gap:"12px",display:"flex",flexDirection:"column"},children:[p.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px",padding:"16px",borderRadius:"8px",borderColor:w,borderWidth:"2px",borderStyle:"solid",backgroundColor:"rgba(255, 255, 255, 0.2)"},children:[p.jsx("div",{className:"flex-shrink-0 mt-1",children:p.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-sm font-bold",style:{backgroundColor:w},children:"1"})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{style:{color:E,fontSize:k,fontWeight:"bold",margin:"0 0 0.25rem 0",padding:0},children:o}),p.jsx("p",{style:{color:E,fontSize:`calc(${k} - 2px)`,opacity:.9,margin:"0.25rem 0 0 0",padding:0},children:a})]})]}),p.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px",padding:"16px",borderRadius:"8px",borderColor:w,borderWidth:"2px",borderStyle:"solid",backgroundColor:"rgba(255, 255, 255, 0.2)"},children:[p.jsx("div",{className:"flex-shrink-0 mt-1",children:p.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-sm font-bold",style:{backgroundColor:w},children:"2"})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{style:{color:E,fontSize:k,fontWeight:"bold",margin:"0 0 0.25rem 0",padding:0},children:l}),p.jsx("p",{style:{color:E,fontSize:`calc(${k} - 2px)`,opacity:.9,margin:"0.25rem 0 0 0",padding:0},children:c})]})]}),p.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px",padding:"16px",borderRadius:"8px",borderColor:w,borderWidth:"2px",borderStyle:"solid",backgroundColor:"rgba(255, 255, 255, 0.2)"},children:[p.jsx("div",{className:"flex-shrink-0 mt-1",children:p.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-sm font-bold",style:{backgroundColor:w},children:"3"})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{style:{color:E,fontSize:k,fontWeight:"bold",margin:"0 0 0.25rem 0",padding:0},children:f}),p.jsx("p",{style:{color:E,fontSize:`calc(${k} - 2px)`,opacity:.9,margin:"0.25rem 0 0 0",padding:0},children:v})]})]})]}),p.jsx("button",{style:{backgroundColor:w,fontFamily:N,fontSize:k,width:"100%",padding:"12px 0",color:"white",fontWeight:"bold",borderRadius:"8px",border:"none",opacity:.7,cursor:"default"},disabled:!0,children:y})]})})]})})]}),m5="modulepreload",v5=function(e){return"/"+e},T2={},ET=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),s=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(n.map(l=>{if(l=v5(l),l in T2)return;T2[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":m5,u||(d.as="script"),d.crossOrigin="",d.href=l,s&&d.setAttribute("nonce",s),document.head.appendChild(d),u)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return o.then(a=>{for(const s of a||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})};var _m="focusScope.autoFocusOnMount",km="focusScope.autoFocusOnUnmount",R2={bubbles:!1,cancelable:!0},g5="FocusScope",_T=S.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...a}=e,[s,l]=S.useState(null),u=Lo(o),c=Lo(i),d=S.useRef(null),f=Sn(t,g=>l(g)),h=S.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;S.useEffect(()=>{if(r){let g=function(b){if(h.paused||!s)return;const w=b.target;s.contains(w)?d.current=w:Ti(d.current,{select:!0})},y=function(b){if(h.paused||!s)return;const w=b.relatedTarget;w!==null&&(s.contains(w)||Ti(d.current,{select:!0}))},m=function(b){if(document.activeElement===document.body)for(const C of b)C.removedNodes.length>0&&Ti(s)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const x=new MutationObserver(m);return s&&x.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),x.disconnect()}}},[r,s,h.paused]),S.useEffect(()=>{if(s){A2.add(h);const g=document.activeElement;if(!s.contains(g)){const m=new CustomEvent(_m,R2);s.addEventListener(_m,u),s.dispatchEvent(m),m.defaultPrevented||(y5(S5(kT(s)),{select:!0}),document.activeElement===g&&Ti(s))}return()=>{s.removeEventListener(_m,u),setTimeout(()=>{const m=new CustomEvent(km,R2);s.addEventListener(km,c),s.dispatchEvent(m),m.defaultPrevented||Ti(g??document.body,{select:!0}),s.removeEventListener(km,c),A2.remove(h)},0)}}},[s,u,c,h]);const v=S.useCallback(g=>{if(!n&&!r||h.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,m=document.activeElement;if(y&&m){const x=g.currentTarget,[b,w]=x5(x);b&&w?!g.shiftKey&&m===w?(g.preventDefault(),n&&Ti(b,{select:!0})):g.shiftKey&&m===b&&(g.preventDefault(),n&&Ti(w,{select:!0})):m===x&&g.preventDefault()}},[n,r,h.paused]);return p.jsx(Tt.div,{tabIndex:-1,...a,ref:f,onKeyDown:v})});_T.displayName=g5;function y5(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Ti(r,{select:t}),document.activeElement!==n)return}function x5(e){const t=kT(e),n=P2(t,e),r=P2(t.reverse(),e);return[n,r]}function kT(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function P2(e,t){for(const n of e)if(!b5(n,{upTo:t}))return n}function b5(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function w5(e){return e instanceof HTMLInputElement&&"select"in e}function Ti(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&w5(e)&&t&&e.select()}}var A2=C5();function C5(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=I2(e,t),e.unshift(t)},remove(t){var n;e=I2(e,t),(n=e[0])==null||n.resume()}}}function I2(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function S5(e){return e.filter(t=>t.tagName!=="A")}var Nm=0;function E5(){S.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??M2()),document.body.insertAdjacentElement("beforeend",e[1]??M2()),Nm++,()=>{Nm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Nm--}},[])}function M2(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Eo=function(){return Eo=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Eo.apply(this,arguments)};function NT(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function _5(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Ef="right-scroll-bar-position",_f="width-before-scroll-bar",k5="with-scroll-bars-hidden",N5="--removed-body-scroll-bar-size";function Tm(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function T5(e,t){var n=S.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=t,n.facade}var R5=typeof window<"u"?S.useLayoutEffect:S.useEffect,D2=new WeakMap;function P5(e,t){var n=T5(null,function(r){return e.forEach(function(o){return Tm(o,r)})});return R5(function(){var r=D2.get(n);if(r){var o=new Set(r),i=new Set(e),a=n.current;o.forEach(function(s){i.has(s)||Tm(s,null)}),i.forEach(function(s){o.has(s)||Tm(s,a)})}D2.set(n,e)},[e]),n}function A5(e){return e}function I5(e,t){t===void 0&&(t=A5);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(s){return s!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(s){return i(s)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var s=n;n=[],s.forEach(i),a=n}var l=function(){var c=a;a=[],c.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(c){a.push(c),u()},filter:function(c){return a=a.filter(c),n}}}};return o}function M5(e){e===void 0&&(e={});var t=I5(null);return t.options=Eo({async:!0,ssr:!1},e),t}var TT=function(e){var t=e.sideCar,n=NT(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return S.createElement(r,Eo({},n))};TT.isSideCarExport=!0;function D5(e,t){return e.useMedium(t),TT}var RT=M5(),Rm=function(){},vp=S.forwardRef(function(e,t){var n=S.useRef(null),r=S.useState({onScrollCapture:Rm,onWheelCapture:Rm,onTouchMoveCapture:Rm}),o=r[0],i=r[1],a=e.forwardProps,s=e.children,l=e.className,u=e.removeScrollBar,c=e.enabled,d=e.shards,f=e.sideCar,h=e.noRelative,v=e.noIsolation,g=e.inert,y=e.allowPinchZoom,m=e.as,x=m===void 0?"div":m,b=e.gapMode,w=NT(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=f,E=P5([n,t]),_=Eo(Eo({},w),o);return S.createElement(S.Fragment,null,c&&S.createElement(C,{sideCar:RT,removeScrollBar:u,shards:d,noRelative:h,noIsolation:v,inert:g,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:b}),a?S.cloneElement(S.Children.only(s),Eo(Eo({},_),{ref:E})):S.createElement(x,Eo({},_,{className:l,ref:E}),s))});vp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};vp.classNames={fullWidth:_f,zeroRight:Ef};var j5=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function F5(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=j5();return t&&e.setAttribute("nonce",t),e}function O5(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function L5(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var B5=function(){var e=0,t=null;return{add:function(n){e==0&&(t=F5())&&(O5(t,n),L5(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},V5=function(){var e=B5();return function(t,n){S.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},PT=function(){var e=V5(),t=function(n){var r=n.styles,o=n.dynamic;return e(r,o),null};return t},z5={left:0,top:0,right:0,gap:0},Pm=function(e){return parseInt(e||"",10)||0},W5=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[Pm(n),Pm(r),Pm(o)]},$5=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return z5;var t=W5(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},U5=PT(),ll="data-scroll-locked",H5=function(e,t,n,r){var o=e.left,i=e.top,a=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(k5,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(ll,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ef,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(_f,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Ef," .").concat(Ef,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(_f," .").concat(_f,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(ll,`] {
    `).concat(N5,": ").concat(s,`px;
  }
`)},j2=function(){var e=parseInt(document.body.getAttribute(ll)||"0",10);return isFinite(e)?e:0},G5=function(){S.useEffect(function(){return document.body.setAttribute(ll,(j2()+1).toString()),function(){var e=j2()-1;e<=0?document.body.removeAttribute(ll):document.body.setAttribute(ll,e.toString())}},[])},q5=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r;G5();var i=S.useMemo(function(){return $5(o)},[o]);return S.createElement(U5,{styles:H5(i,!t,o,n?"":"!important")})},Vg=!1;if(typeof window<"u")try{var Od=Object.defineProperty({},"passive",{get:function(){return Vg=!0,!0}});window.addEventListener("test",Od,Od),window.removeEventListener("test",Od,Od)}catch{Vg=!1}var Ss=Vg?{passive:!1}:!1,K5=function(e){return e.tagName==="TEXTAREA"},AT=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!K5(e)&&n[t]==="visible")},X5=function(e){return AT(e,"overflowY")},Y5=function(e){return AT(e,"overflowX")},F2=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=IT(e,r);if(o){var i=MT(e,r),a=i[1],s=i[2];if(a>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Q5=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Z5=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},IT=function(e,t){return e==="v"?X5(t):Y5(t)},MT=function(e,t){return e==="v"?Q5(t):Z5(t)},J5=function(e,t){return e==="h"&&t==="rtl"?-1:1},eV=function(e,t,n,r,o){var i=J5(e,window.getComputedStyle(t).direction),a=i*r,s=n.target,l=t.contains(s),u=!1,c=a>0,d=0,f=0;do{if(!s)break;var h=MT(e,s),v=h[0],g=h[1],y=h[2],m=g-y-i*v;(v||m)&&IT(e,s)&&(d+=m,f+=v);var x=s.parentNode;s=x&&x.nodeType===Node.DOCUMENT_FRAGMENT_NODE?x.host:x}while(!l&&s!==document.body||l&&(t.contains(s)||t===s));return(c&&(Math.abs(d)<1||!o)||!c&&(Math.abs(f)<1||!o))&&(u=!0),u},Ld=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},O2=function(e){return[e.deltaX,e.deltaY]},L2=function(e){return e&&"current"in e?e.current:e},tV=function(e,t){return e[0]===t[0]&&e[1]===t[1]},nV=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},rV=0,Es=[];function oV(e){var t=S.useRef([]),n=S.useRef([0,0]),r=S.useRef(),o=S.useState(rV++)[0],i=S.useState(PT)[0],a=S.useRef(e);S.useEffect(function(){a.current=e},[e]),S.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var g=_5([e.lockRef.current],(e.shards||[]).map(L2),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var s=S.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!a.current.allowPinchZoom;var m=Ld(g),x=n.current,b="deltaX"in g?g.deltaX:x[0]-m[0],w="deltaY"in g?g.deltaY:x[1]-m[1],C,E=g.target,_=Math.abs(b)>Math.abs(w)?"h":"v";if("touches"in g&&_==="h"&&E.type==="range")return!1;var N=F2(_,E);if(!N)return!0;if(N?C=_:(C=_==="v"?"h":"v",N=F2(_,E)),!N)return!1;if(!r.current&&"changedTouches"in g&&(b||w)&&(r.current=C),!C)return!0;var T=r.current||C;return eV(T,y,g,T==="h"?b:w,!0)},[]),l=S.useCallback(function(g){var y=g;if(!(!Es.length||Es[Es.length-1]!==i)){var m="deltaY"in y?O2(y):Ld(y),x=t.current.filter(function(C){return C.name===y.type&&(C.target===y.target||y.target===C.shadowParent)&&tV(C.delta,m)})[0];if(x&&x.should){y.cancelable&&y.preventDefault();return}if(!x){var b=(a.current.shards||[]).map(L2).filter(Boolean).filter(function(C){return C.contains(y.target)}),w=b.length>0?s(y,b[0]):!a.current.noIsolation;w&&y.cancelable&&y.preventDefault()}}},[]),u=S.useCallback(function(g,y,m,x){var b={name:g,delta:y,target:m,should:x,shadowParent:iV(m)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(w){return w!==b})},1)},[]),c=S.useCallback(function(g){n.current=Ld(g),r.current=void 0},[]),d=S.useCallback(function(g){u(g.type,O2(g),g.target,s(g,e.lockRef.current))},[]),f=S.useCallback(function(g){u(g.type,Ld(g),g.target,s(g,e.lockRef.current))},[]);S.useEffect(function(){return Es.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Ss),document.addEventListener("touchmove",l,Ss),document.addEventListener("touchstart",c,Ss),function(){Es=Es.filter(function(g){return g!==i}),document.removeEventListener("wheel",l,Ss),document.removeEventListener("touchmove",l,Ss),document.removeEventListener("touchstart",c,Ss)}},[]);var h=e.removeScrollBar,v=e.inert;return S.createElement(S.Fragment,null,v?S.createElement(i,{styles:nV(o)}):null,h?S.createElement(q5,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function iV(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const aV=D5(RT,oV);var DT=S.forwardRef(function(e,t){return S.createElement(vp,Eo({},e,{ref:t,sideCar:aV}))});DT.classNames=vp.classNames;var sV=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},_s=new WeakMap,Bd=new WeakMap,Vd={},Am=0,jT=function(e){return e&&(e.host||jT(e.parentNode))},lV=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=jT(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},uV=function(e,t,n,r){var o=lV(t,Array.isArray(e)?e:[e]);Vd[n]||(Vd[n]=new WeakMap);var i=Vd[n],a=[],s=new Set,l=new Set(o),u=function(d){!d||s.has(d)||(s.add(d),u(d.parentNode))};o.forEach(u);var c=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))c(f);else try{var h=f.getAttribute(r),v=h!==null&&h!=="false",g=(_s.get(f)||0)+1,y=(i.get(f)||0)+1;_s.set(f,g),i.set(f,y),a.push(f),g===1&&v&&Bd.set(f,!0),y===1&&f.setAttribute(n,"true"),v||f.setAttribute(r,"true")}catch(m){console.error("aria-hidden: cannot operate on ",f,m)}})};return c(t),s.clear(),Am++,function(){a.forEach(function(d){var f=_s.get(d)-1,h=i.get(d)-1;_s.set(d,f),i.set(d,h),f||(Bd.has(d)||d.removeAttribute(r),Bd.delete(d)),h||d.removeAttribute(n)}),Am--,Am||(_s=new WeakMap,_s=new WeakMap,Bd=new WeakMap,Vd={})}},cV=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=sV(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),uV(r,o,n,"aria-hidden")):function(){return null}},gp="Dialog",[FT,TY]=Kl(gp),[dV,uo]=FT(gp),OT=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:o,onOpenChange:i,modal:a=!0}=e,s=S.useRef(null),l=S.useRef(null),[u,c]=R0({prop:r,defaultProp:o??!1,onChange:i,caller:gp});return p.jsx(dV,{scope:t,triggerRef:s,contentRef:l,contentId:bm(),titleId:bm(),descriptionId:bm(),open:u,onOpenChange:c,onOpenToggle:S.useCallback(()=>c(d=>!d),[c]),modal:a,children:n})};OT.displayName=gp;var LT="DialogTrigger",fV=S.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=uo(LT,n),i=Sn(t,o.triggerRef);return p.jsx(Tt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":ex(o.open),...r,ref:i,onClick:pt(e.onClick,o.onOpenToggle)})});fV.displayName=LT;var Z0="DialogPortal",[hV,BT]=FT(Z0,{forceMount:void 0}),VT=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:o}=e,i=uo(Z0,t);return p.jsx(hV,{scope:t,forceMount:n,children:S.Children.map(r,a=>p.jsx(ms,{present:n||i.open,children:p.jsx(T0,{asChild:!0,container:o,children:a})}))})};VT.displayName=Z0;var ch="DialogOverlay",zT=S.forwardRef((e,t)=>{const n=BT(ch,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,i=uo(ch,e.__scopeDialog);return i.modal?p.jsx(ms,{present:r||i.open,children:p.jsx(mV,{...o,ref:t})}):null});zT.displayName=ch;var pV=fc("DialogOverlay.RemoveScroll"),mV=S.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=uo(ch,n);return p.jsx(DT,{as:pV,allowPinchZoom:!0,shards:[o.contentRef],children:p.jsx(Tt.div,{"data-state":ex(o.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),cs="DialogContent",WT=S.forwardRef((e,t)=>{const n=BT(cs,e.__scopeDialog),{forceMount:r=n.forceMount,...o}=e,i=uo(cs,e.__scopeDialog);return p.jsx(ms,{present:r||i.open,children:i.modal?p.jsx(vV,{...o,ref:t}):p.jsx(gV,{...o,ref:t})})});WT.displayName=cs;var vV=S.forwardRef((e,t)=>{const n=uo(cs,e.__scopeDialog),r=S.useRef(null),o=Sn(t,n.contentRef,r);return S.useEffect(()=>{const i=r.current;if(i)return cV(i)},[]),p.jsx($T,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:pt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:pt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,s=a.button===0&&a.ctrlKey===!0;(a.button===2||s)&&i.preventDefault()}),onFocusOutside:pt(e.onFocusOutside,i=>i.preventDefault())})}),gV=S.forwardRef((e,t)=>{const n=uo(cs,e.__scopeDialog),r=S.useRef(!1),o=S.useRef(!1);return p.jsx($T,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,s;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(s=n.triggerRef.current)==null||s.focus(),i.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:i=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const a=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&o.current&&i.preventDefault()}})}),$T=S.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:i,...a}=e,s=uo(cs,n),l=S.useRef(null),u=Sn(t,l);return E5(),p.jsxs(p.Fragment,{children:[p.jsx(_T,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:i,children:p.jsx(rp,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":ex(s.open),...a,ref:u,onDismiss:()=>s.onOpenChange(!1)})}),p.jsxs(p.Fragment,{children:[p.jsx(yV,{titleId:s.titleId}),p.jsx(bV,{contentRef:l,descriptionId:s.descriptionId})]})]})}),J0="DialogTitle",UT=S.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=uo(J0,n);return p.jsx(Tt.h2,{id:o.titleId,...r,ref:t})});UT.displayName=J0;var HT="DialogDescription",GT=S.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=uo(HT,n);return p.jsx(Tt.p,{id:o.descriptionId,...r,ref:t})});GT.displayName=HT;var qT="DialogClose",KT=S.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,o=uo(qT,n);return p.jsx(Tt.button,{type:"button",...r,ref:t,onClick:pt(e.onClick,()=>o.onOpenChange(!1))})});KT.displayName=qT;function ex(e){return e?"open":"closed"}var XT="DialogTitleWarning",[RY,YT]=bF(XT,{contentName:cs,titleName:J0,docsSlug:"dialog"}),yV=({titleId:e})=>{const t=YT(XT),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return S.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},xV="DialogDescriptionWarning",bV=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${YT(xV).contentName}}.`;return S.useEffect(()=>{var i;const o=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},wV=OT,CV=VT,QT=zT,ZT=WT,JT=UT,eR=GT,tR=KT;const SV=wV,EV=CV,_V=tR,nR=S.forwardRef(({className:e,...t},n)=>p.jsx(QT,{ref:n,className:Et("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));nR.displayName=QT.displayName;const rR=S.forwardRef(({className:e,children:t,...n},r)=>p.jsxs(EV,{children:[p.jsx(nR,{}),p.jsxs(ZT,{ref:r,className:Et("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,p.jsxs(tR,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[p.jsx(j0,{className:"h-4 w-4"}),p.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));rR.displayName=ZT.displayName;const oR=({className:e,...t})=>p.jsx("div",{className:Et("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});oR.displayName="DialogHeader";const iR=S.forwardRef(({className:e,...t},n)=>p.jsx(JT,{ref:n,className:Et("text-lg font-semibold leading-none tracking-tight",e),...t}));iR.displayName=JT.displayName;const aR=S.forwardRef(({className:e,...t},n)=>p.jsx(eR,{ref:n,className:Et("text-sm text-muted-foreground",e),...t}));aR.displayName=eR.displayName;const kV=({contract:e,open:t,onOpenChange:n})=>{const[r,o]=S.useState(!1),[i,a]=S.useState(null),[s,l]=S.useState(!1);S.useEffect(()=>{t&&(e!=null&&e.id)&&(l(!0),zu("GET",`/api/contracts/by-id/${e.id}`).then(d=>d.json()).then(d=>a(d)).catch(d=>{console.error("Error fetching contract details:",d),a(e)}).finally(()=>l(!1)))},[t,e==null?void 0:e.id]);const u=async()=>{if(!(!i&&!e)){o(!0);try{const d=i||e,f=m=>{const x=m.split(/(<h3[^>]*>.*?<\/h3>)/);let b=0,w="";for(const C of x)w+=C,C.includes("<h3")&&C.includes("CLUSULA")&&(b++,b%4===0&&b>0&&(w+='<div style="page-break-after: always; margin-bottom: 20px;"></div>'));return w},h=document.createElement("div");h.id="pdf-export-element",h.style.width="210mm",h.style.height="auto",h.style.padding="8mm 12mm 12mm 12mm",h.style.margin="0",h.style.boxSizing="border-box",h.style.backgroundColor="#ffffff",h.style.fontSize="11px",h.style.lineHeight="1.4",h.style.color="#333",h.style.fontFamily='"Segoe UI", Arial, sans-serif';let v="";if(v+=`
        <div style="margin: 0 0 15px 0; padding-bottom: 10px; border-bottom: 2px solid #333;">
          <h1 style="font-size: 18px; font-weight: bold; margin: 0 0 5px 0;">Detalhes do Contrato</h1>
          <p style="margin: 0 0 2px 0; font-size: 12px;"><strong>Protocolo:</strong> ${(d==null?void 0:d.protocol_number)||"N/A"}</p>
          <p style="margin: 0; font-size: 12px;"><strong>Empresa:</strong> ${(d==null?void 0:d.company_name)||"Sem empresa"}</p>
        </div>
      `,v+=`
        <div style="margin: 0 0 15px 0; padding-bottom: 10px;">
          <h2 style="font-size: 14px; font-weight: bold; margin: 0 0 8px 0;">Informaes Pessoais</h2>
          <table style="width: 100%; font-size: 12px; border-collapse: collapse;">
            <tr style="display: table-row;">
              <td style="font-weight: 600; color: #666; padding: 3px 0; width: 30%;">Nome:</td>
              <td style="color: #333; padding: 3px 0;">${(d==null?void 0:d.client_name)||"N/A"}</td>
            </tr>
            <tr style="display: table-row;">
              <td style="font-weight: 600; color: #666; padding: 3px 0;">CPF:</td>
              <td style="color: #333; padding: 3px 0;">${(d==null?void 0:d.client_cpf)||"N/A"}</td>
            </tr>
            <tr style="display: table-row;">
              <td style="font-weight: 600; color: #666; padding: 3px 0;">Email:</td>
              <td style="color: #333; padding: 3px 0;">${(d==null?void 0:d.client_email)||"N/A"}</td>
            </tr>
            <tr style="display: table-row;">
              <td style="font-weight: 600; color: #666; padding: 3px 0;">Telefone:</td>
              <td style="color: #333; padding: 3px 0;">${(d==null?void 0:d.client_phone)||"No informado"}</td>
            </tr>
          </table>
        </div>
      `,(d!=null&&d.selfie_photo||d!=null&&d.document_photo)&&(v+='<div style="margin: 0 0 15px 0; padding-bottom: 10px;">',v+='<h2 style="font-size: 14px; font-weight: bold; margin: 0 0 10px 0;">Fotos do Processo</h2>',d!=null&&d.selfie_photo&&(v+=`
            <div style="margin-bottom: 12px;">
              <p style="font-weight: 600; font-size: 11px; color: #666; margin: 0 0 5px 0;">Selfie do Cliente</p>
              <img src="${d.selfie_photo}" style="width: 100%; max-width: 350px; height: auto; border: 1px solid #ddd;" />
            </div>
          `),d!=null&&d.document_photo&&(v+=`
            <div style="margin-bottom: 12px;">
              <p style="font-weight: 600; font-size: 11px; color: #666; margin: 0 0 5px 0;">Documento</p>
              <img src="${d.document_photo}" style="width: 100%; max-width: 350px; height: auto; border: 1px solid #ddd;" />
            </div>
          `),v+="</div>"),d!=null&&d.signed_contract_html){const m=f(d.signed_contract_html);v+=`
          <div style="page-break-before: always; margin: 0; padding-top: 0;">
            <h2 style="font-size: 12px; font-weight: bold; margin: 0 0 6px 0;">Contrato Assinado</h2>
            <div style="font-size: 10px; line-height: 1.3; color: #333;">
              ${m}
            </div>
          </div>
        `}h.innerHTML=v,document.body.appendChild(h);const g=(await ET(async()=>{const{default:m}=await import("./html2pdf-C_jvj8Vs.js").then(x=>x.h);return{default:m}},[])).default,y={margin:0,filename:`contrato-${d==null?void 0:d.client_name}-${new Date().getTime()}.pdf`,image:{type:"jpeg",quality:.95},html2canvas:{scale:3,useCORS:!0,allowTaint:!0,imageTimeout:0,logging:!1,backgroundColor:"#ffffff",windowWidth:794,windowHeight:document.body.scrollHeight},jsPDF:{orientation:"portrait",unit:"mm",format:"a4",compress:!0}};await g().set(y).from(h).save(),document.body.removeChild(h)}catch(d){console.error("Erro ao gerar PDF:",d)}finally{o(!1)}}};if(!e&&!i)return null;const c=i||e;return p.jsx(SV,{open:t,onOpenChange:n,children:p.jsxs(rR,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[p.jsxs(oR,{className:"flex items-start justify-between gap-4",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx(iR,{children:"Detalhes do Contrato"}),p.jsxs(aR,{children:[c==null?void 0:c.protocol_number," - ",(c==null?void 0:c.company_name)||"Sem empresa"]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs(Ie,{onClick:u,disabled:r,size:"sm",className:"gap-2 whitespace-nowrap",children:[p.jsx(M0,{className:"w-4 h-4"}),r?"Gerando...":"PDF"]}),p.jsx(_V,{asChild:!0,children:p.jsx(Ie,{variant:"ghost",size:"icon",className:"h-6 w-6",children:p.jsx(j0,{className:"h-4 w-4"})})})]})]}),p.jsxs("div",{id:"contract-details-content",className:"space-y-6 bg-white p-6",children:[s&&p.jsx("p",{className:"text-sm text-gray-500",children:"Carregando detalhes..."}),!s&&p.jsxs(p.Fragment,{children:[p.jsxs(ut,{className:"p-4",children:[p.jsx("h3",{className:"font-bold text-lg mb-3",children:" Informaes Pessoais"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-gray-600",children:"Nome:"}),p.jsx("p",{className:"text-gray-800",children:c==null?void 0:c.client_name})]}),p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-gray-600",children:"CPF:"}),p.jsx("p",{className:"text-gray-800",children:c==null?void 0:c.client_cpf})]}),p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-gray-600",children:"Email:"}),p.jsx("p",{className:"text-gray-800",children:c==null?void 0:c.client_email})]}),p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-gray-600",children:"Telefone:"}),p.jsx("p",{className:"text-gray-800",children:(c==null?void 0:c.client_phone)||"No informado"})]})]})]}),((c==null?void 0:c.selfie_photo)||(c==null?void 0:c.document_photo))&&p.jsxs(ut,{className:"p-4",children:[p.jsx("h3",{className:"font-bold text-lg mb-3",children:" Fotos do Processo"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(c==null?void 0:c.selfie_photo)&&p.jsxs("div",{className:"space-y-2",children:[p.jsx("p",{className:"font-semibold text-sm text-gray-600",children:"Selfie do Cliente"}),p.jsx("img",{src:c.selfie_photo,alt:"Selfie",className:"w-full rounded border border-gray-200 max-h-64 object-cover"})]}),(c==null?void 0:c.document_photo)&&p.jsxs("div",{className:"space-y-2",children:[p.jsx("p",{className:"font-semibold text-sm text-gray-600",children:"Documento"}),p.jsx("img",{src:c.document_photo,alt:"Documento",className:"w-full rounded border border-gray-200 max-h-64 object-cover"})]})]})]}),(c==null?void 0:c.signed_contract_html)&&p.jsxs(ut,{className:"p-4",children:[p.jsx("h3",{className:"font-bold text-lg mb-3",children:" Contrato Assinado"}),p.jsx("div",{className:"bg-gray-50 p-4 rounded border border-gray-200 max-h-96 overflow-y-auto text-sm",children:p.jsx("div",{dangerouslySetInnerHTML:{__html:c.signed_contract_html},className:"prose prose-sm max-w-none"})})]})]})]}),p.jsx("div",{className:"flex justify-end gap-2 p-6 border-t",children:p.jsx(Ie,{variant:"outline",onClick:()=>n(!1),children:"Fechar"})})]})})},NV=()=>{OB();const{toast:e}=Wc(),[t,n]=S.useState("cliente"),[r,o]=S.useState(null),[i,a]=S.useState(!1),[s,l]=S.useState(null),[u,c]=S.useState(!1),[d,f]=S.useState(""),[h,v]=S.useState(""),[g,y]=S.useState(""),[m,x]=S.useState(""),[b,w]=S.useState(ht.title),[C,E]=S.useState(ht.clauses),[_,N]=S.useState(""),[T,k]=S.useState("medium"),[I,A]=S.useState("center"),[U,B]=S.useState(null),[L,V]=S.useState(!1),[F,M]=S.useState("#2c3e50"),[j,R]=S.useState("#333333"),[P,z]=S.useState("Arial, sans-serif"),[G,q]=S.useState("16px"),[Y,J]=S.useState(Ia.companyName),[X,ee]=S.useState(Ia.footerText),[oe,ue]=S.useState("#dbeafe"),[ae,ce]=S.useState("#22c55e"),[ne,se]=S.useState("#1e40af"),[ve,xe]=S.useState("Parabns, Nova Revendedora! "),[Me,Pe]=S.useState("Bem-vinda  famlia de revendedoras!"),[je,Le]=S.useState("Sua maleta de produtos chegar em breve. Preencha seu endereo para receb-la."),[$e,at]=S.useState("#dbeafe"),[Qe,Je]=S.useState("#f0fdf4"),[dt,Xe]=S.useState("#22c55e"),[Ce,lt]=S.useState("#1e40af"),[zt,Ht]=S.useState("Arial, sans-serif"),[_t,ze]=S.useState("Endereo para Entrega"),[rt,sn]=S.useState("Confirmar Endereo e Continuar"),[ft,ln]=S.useState("#2c3e50"),[Wt,kr]=S.useState("#000000"),[Go,sd]=S.useState("Arial, sans-serif"),[ld,iu]=S.useState("16px"),[un,ud]=S.useState(""),[Ne,et]=S.useState("medium"),[tt,dr]=S.useState("center"),[_n,$r]=S.useState(null),[ho,kn]=S.useState(!1),[Nr,gM]=S.useState("Verificao de Identidade Segura"),[Lp,yM]=S.useState("Verificao de Identidade"),[Bp,xM]=S.useState("Processo seguro e rpido para confirmar sua identidade atravs de reconhecimento facial."),[V1,bM]=S.useState("Suas informaes so processadas de forma segura e criptografada"),[au,wM]=S.useState(""),[cd,z1]=S.useState("#ffffff"),[W1,CM]=S.useState(null),[SM,$1]=S.useState(!1),[dd,U1]=S.useState("#2c3e50"),[Vp,EM]=S.useState(""),[fd,_M]=S.useState("Sua Empresa"),[H1,kM]=S.useState(null),[NM,G1]=S.useState(!1),[q1,K1]=S.useState("#dbeafe"),[X1,Y1]=S.useState("#22c55e"),[Q1,Z1]=S.useState("#1e40af"),[J1,eb]=S.useState("Assinatura Digital"),[tb,nb]=S.useState("Conclua os passos abaixo para desbloquear sua maleta digital. Super rpido! "),[rb,ob]=S.useState("1. Reconhecimento Facial"),[ib,ab]=S.useState("Tire uma selfie para validar sua identidade atravs de reconhecimento facial"),[sb,lb]=S.useState("2. Assinar Contrato"),[ub,cb]=S.useState("Assine digitalmente o contrato para confirmar seu compromisso"),[db,fb]=S.useState("3. Baixar Aplicativo"),[hb,pb]=S.useState("Baixe nosso aplicativo oficial para gerenciar seus contratos"),[mb,vb]=S.useState("Complete os passos acima"),[gb,yb]=S.useState("Arial, sans-serif"),[xb,bb]=S.useState("16px"),[wb,Cb]=S.useState(""),[Sb,Eb]=S.useState(""),{data:_b=[],isLoading:TM}=sB({queryKey:["/api/contracts"]}),zp=lB({mutationFn:async K=>(await zu("POST","/api/contracts",K)).json(),onSuccess:K=>{bT.invalidateQueries({queryKey:["/api/contracts"]});const Oe=`${window.location.origin}/c/${K.access_token}`;o(Oe),n("contratos"),e({title:"Contrato criado!",description:"URL gerada com sucesso. Copie e envie ao cliente."})},onError:()=>{e({title:"Erro",description:"Nao foi possivel criar o contrato. Tente novamente.",variant:"destructive"})}}),RM=K=>{const Oe=d5(K);v(Oe)},PM=K=>{const Oe=f5(K);x(Oe)},AM=()=>{E([...C,{title:"",content:""}])},IM=K=>{E(C.filter((Oe,ct)=>ct!==K))},kb=(K,Oe,ct)=>{const mn=[...C];mn[K][Oe]=ct,E(mn)},MM=async K=>{var mn;const Oe=(mn=K.target.files)==null?void 0:mn[0];if(!Oe)return;V(!0);const ct=new FileReader;ct.onload=qn=>{var Kn,Xn;B((Kn=qn.target)==null?void 0:Kn.result),N((Xn=qn.target)==null?void 0:Xn.result)},ct.readAsDataURL(Oe),V(!1)},DM=K=>{switch(K){case"small":return"max-width: 100px;";case"large":return"max-width: 300px;";default:return"max-width: 200px;"}},jM=K=>{switch(K){case"left":return"text-align: left;";case"right":return"text-align: right;";default:return"text-align: center;"}},FM=()=>{const K=C.map(ct=>`
        <div style="margin-bottom: 20px;">
          <h3 style="font-weight: bold; margin-bottom: 8px; color: ${j};">${ct.title}</h3>
          <p style="text-align: justify; line-height: 1.6; font-size: ${G};">${ct.content}</p>
        </div>
      `).join(""),Oe=_?`<div style="${jM(I)} margin-bottom: 30px;"><img src="${_}" alt="Logo" style="${DM(T)} height: auto;"></div>`:"";return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>${b}</title>
        <style>
          body { font-family: ${P}; max-width: 800px; margin: 0 auto; padding: 40px; color: #333; }
          .header { padding: 30px; border-radius: 8px; margin-bottom: 30px; }
          .header h1 { margin: 0; text-align: center; }
          h1 { color: ${F}; text-align: center; border-bottom: 3px solid ${j}; padding-bottom: 15px; }
          h2 { color: ${F}; margin-top: 30px; font-size: 20px; }
          .contract-section { margin: 20px 0; }
          .signature-section { margin-top: 50px; padding: 20px; border: 2px solid ${F}; border-radius: 4px; }
          .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ccc; text-align: center; font-size: 12px; color: #666; }
        </style>
      </head>
      <body>
        ${Oe}
        <div class="header">
          <h1>${b}</h1>
        </div>
        
        <div class="contract-section">
          <h2>${ht.contractorSection}</h2>
          <p><strong>Nome:</strong> {{CLIENT_NAME}}</p>
          <p><strong>CPF:</strong> {{CLIENT_CPF}}</p>
          <p><strong>E-mail:</strong> {{CLIENT_EMAIL}}</p>
          <p><strong>Telefone:</strong> {{CLIENT_PHONE}}</p>
        </div>

        <div class="contract-section">
          <h2>${ht.clausesSection}</h2>
          ${K}
        </div>

        <div class="signature-section" id="signature-placeholder">
        </div>
        
        <div class="footer">
          ${X}
        </div>
      </body>
      </html>
    `},OM=async()=>{if(!d.trim()){e({title:"Erro",description:"Nome do cliente e obrigatorio",variant:"destructive"});return}const K=h.replace(/\D/g,"");if(!c5(K)){e({title:"Erro",description:"CPF invalido",variant:"destructive"});return}if(!g.trim()||!g.includes("@")){e({title:"Erro",description:"E-mail invalido",variant:"destructive"});return}const Oe=FM(),ct=`CONT-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`;zp.mutate({client_name:d.trim(),client_cpf:K,client_email:g.trim(),client_phone:m.replace(/\D/g,"")||null,contract_html:Oe,protocol_number:ct,status:"pending",logo_url:_||void 0,logo_size:T,logo_position:I,primary_color:F,text_color:j,font_family:P,font_size:G,company_name:Y,footer_text:X,maleta_card_color:oe,maleta_button_color:ae,maleta_text_color:ne,verification_primary_color:ft,verification_text_color:Wt,verification_font_family:Go,verification_font_size:ld,verification_logo_url:un,verification_logo_size:Ne,verification_logo_position:tt,verification_footer_text:Nr,verification_welcome_text:Lp,verification_instructions:Bp,verification_background_image:au,verification_background_color:cd,verification_header_background_color:dd,verification_header_logo_url:Vp||void 0,verification_header_company_name:fd,progress_card_color:q1,progress_button_color:X1,progress_text_color:Q1,progress_title:J1,progress_subtitle:tb,progress_step1_title:rb,progress_step1_description:ib,progress_step2_title:sb,progress_step2_description:ub,progress_step3_title:db,progress_step3_description:hb,progress_button_text:mb,progress_font_family:gb,progress_font_size:xb,app_store_url:wb||void 0,google_play_url:Sb||void 0,parabens_title:ve,parabens_subtitle:Me,parabens_description:je,parabens_card_color:$e,parabens_background_color:Qe,parabens_button_color:dt,parabens_text_color:Ce,parabens_font_family:zt,parabens_form_title:_t,parabens_button_text:rt})},LM=async()=>{r&&(await navigator.clipboard.writeText(r),a(!0),setTimeout(()=>a(!1),2e3),e({title:"Copiado!",description:"URL copiada para a area de transferencia."}))},BM=()=>{f(""),v(""),y(""),x(""),w(ht.title),E(ht.clauses),o(null),N(""),k("medium"),A("center"),B(null),M("#2c3e50"),R("#333333"),z("Arial, sans-serif"),q("16px"),J(Ia.companyName),ee(Ia.footerText),ue("#dbeafe"),ce("#22c55e"),se("#1e40af"),K1("#dbeafe"),Y1("#22c55e"),Z1("#1e40af"),eb("Assinatura Digital"),nb("Conclua os passos abaixo para desbloquear sua maleta digital. Super rpido! "),ob("1. Reconhecimento Facial"),ab("Tire uma selfie para validar sua identidade atravs de reconhecimento facial"),lb("2. Assinar Contrato"),cb("Assine digitalmente o contrato para confirmar seu compromisso"),fb("3. Baixar Aplicativo"),pb("Baixe nosso aplicativo oficial para gerenciar seus contratos"),vb("Complete os passos acima"),yb("Arial, sans-serif"),bb("16px"),Cb(""),Eb(""),xe("Parabns, Nova Revendedora! "),Pe("Bem-vinda  famlia de revendedoras!"),Le("Sua maleta de produtos chegar em breve. Preencha seu endereo para receb-la."),at("#dbeafe"),Je("#f0fdf4"),Xe("#22c55e"),lt("#1e40af"),Ht("Arial, sans-serif"),ze("Endereo para Entrega"),sn("Confirmar Endereo e Continuar"),o(null),a(!1)},VM=K=>{switch(K){case"signed":return p.jsxs(N2,{variant:"default",className:"bg-green-600",children:[p.jsx(tN,{className:"w-3 h-3 mr-1"}),"Assinado"]});case"pending":default:return p.jsxs(N2,{variant:"secondary",children:[p.jsx(Uw,{className:"w-3 h-3 mr-1"}),"Pendente"]})}};return p.jsx("div",{className:"min-h-screen bg-background py-8 px-4",children:p.jsxs("div",{className:"max-w-5xl mx-auto",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-foreground","data-testid":"text-company-name",children:Ia.companyName}),p.jsx("p",{className:"text-muted-foreground mt-2",children:"Gerenciador de Contratos para Assinatura"})]}),r&&p.jsxs(ut,{className:"mb-6 border-green-200 bg-green-50",children:[p.jsxs(xt,{children:[p.jsxs(bt,{className:"flex items-center gap-2 text-green-700",children:[p.jsx(ro,{className:"w-6 h-6"}),"Contrato Criado com Sucesso!"]}),p.jsx(wt,{children:"Copie a URL abaixo e envie para o cliente assinar o contrato."})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{value:r,readOnly:!0,className:"font-mono text-sm","data-testid":"input-generated-url"}),p.jsx(Ie,{onClick:LM,variant:"outline","data-testid":"button-copy-url",children:i?p.jsx(ro,{className:"w-4 h-4"}):p.jsx(vg,{className:"w-4 h-4"})})]}),p.jsxs(Ie,{onClick:BM,className:"w-full","data-testid":"button-new-contract",children:[p.jsx(Gw,{className:"w-4 h-4 mr-2"}),"Criar Novo Contrato"]})]})]}),p.jsxs("div",{className:"flex gap-2 mb-8 border-b",children:[p.jsxs(Ie,{variant:t==="cliente"?"default":"ghost",onClick:()=>n("cliente"),className:"flex items-center gap-2",children:[p.jsx(qw,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Dados Cliente"}),p.jsx("span",{className:"sm:hidden",children:"Cliente"})]}),p.jsxs(Ie,{variant:t==="aparencia"?"default":"ghost",onClick:()=>n("aparencia"),className:"flex items-center gap-2",children:[p.jsx(gg,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Aparncia"}),p.jsx("span",{className:"sm:hidden",children:"Apar"})]}),p.jsxs(Ie,{variant:t==="verificacao"?"default":"ghost",onClick:()=>n("verificacao"),className:"flex items-center gap-2",children:[p.jsx(il,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Verificao"}),p.jsx("span",{className:"sm:hidden",children:"Verif"})]}),p.jsxs(Ie,{variant:t==="contrato"?"default":"ghost",onClick:()=>n("contrato"),className:"flex items-center gap-2",children:[p.jsx(y3,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Contrato"}),p.jsx("span",{className:"sm:hidden",children:"Config"})]}),p.jsxs(Ie,{variant:t==="progresso"?"default":"ghost",onClick:()=>n("progresso"),className:"flex items-center gap-2",children:[p.jsx(Uw,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Progresso"}),p.jsx("span",{className:"sm:hidden",children:"Prog"})]}),p.jsxs(Ie,{variant:t==="parabens"?"default":"ghost",onClick:()=>n("parabens"),className:"flex items-center gap-2",children:[p.jsx(gg,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Parabns"}),p.jsx("span",{className:"sm:hidden",children:"Para"})]}),p.jsxs(Ie,{variant:t==="aplicativos"?"default":"ghost",onClick:()=>n("aplicativos"),className:"flex items-center gap-2",children:[p.jsx(iN,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Links Apps"}),p.jsx("span",{className:"sm:hidden",children:"Apps"})]}),p.jsxs(Ie,{variant:t==="contratos"?"default":"ghost",onClick:()=>n("contratos"),className:"flex items-center gap-2",children:[p.jsx(oo,{className:"w-4 h-4"}),p.jsx("span",{className:"hidden sm:inline",children:"Contratos Criados"}),p.jsx("span",{className:"sm:hidden",children:"Contratos"})]})]}),t==="progresso"&&p.jsx(p5,{progressTitle:J1,onProgressTitleChange:eb,progressSubtitle:tb,onProgressSubtitleChange:nb,progressStep1Title:rb,onProgressStep1TitleChange:ob,progressStep1Description:ib,onProgressStep1DescriptionChange:ab,progressStep2Title:sb,onProgressStep2TitleChange:lb,progressStep2Description:ub,onProgressStep2DescriptionChange:cb,progressStep3Title:db,onProgressStep3TitleChange:fb,progressStep3Description:hb,onProgressStep3DescriptionChange:pb,progressButtonText:mb,onProgressButtonTextChange:vb,progressCardColor:q1,onProgressCardColorChange:K1,progressButtonColor:X1,onProgressButtonColorChange:Y1,progressTextColor:Q1,onProgressTextColorChange:Z1,progressFontFamily:gb,onProgressFontFamilyChange:yb,progressFontSize:xb,onProgressFontSizeChange:bb}),t==="aplicativos"&&p.jsx("div",{className:"space-y-6",children:p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Links de Download dos Aplicativos"}),p.jsx(wt,{children:"Configure as URLs que sero exibidas na ltima pgina do fluxo do cliente."})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"googlePlayUrl",children:"URL Google Play"}),p.jsx(fe,{id:"googlePlayUrl",placeholder:"https://play.google.com/store/apps/details?id=...",value:Sb,onChange:K=>Eb(K.target.value)})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"appStoreUrl",children:"URL Apple App Store"}),p.jsx(fe,{id:"appStoreUrl",placeholder:"https://apps.apple.com/app/...",value:wb,onChange:K=>Cb(K.target.value)})]})]})]})}),t==="contratos"&&p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsxs(bt,{className:"flex items-center gap-2",children:[p.jsx(oo,{className:"w-5 h-5"}),"Contratos Criados"]}),p.jsx(wt,{children:"Historico de contratos gerados e pronto para assinatura"})]}),p.jsx(Lt,{children:TM?p.jsx("p",{className:"text-muted-foreground",children:"Carregando..."}):_b.length===0?p.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Nenhum contrato criado ainda. Crie um novo contrato preenchendo as abas."}):p.jsx("div",{className:"space-y-4",children:_b.map(K=>p.jsx("div",{className:"border rounded-lg overflow-hidden hover:bg-gray-50","data-testid":`contract-row-${K.id}`,children:p.jsxs("div",{className:"flex items-center justify-between gap-4 p-4 flex-wrap",children:[p.jsx("div",{className:"flex-1 min-w-0",children:p.jsxs("p",{className:"font-medium cursor-pointer hover:text-blue-600 hover:underline","data-testid":`text-contract-name-${K.id}`,onClick:()=>{l(K),c(!0)},children:[" ",K.client_name]})}),p.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[VM(K.status),p.jsxs(Ie,{variant:"outline",size:"sm",onClick:()=>{const Oe=`${window.location.origin}/c/${K.access_token}`;navigator.clipboard.writeText(Oe),e({title:"URL copiada!"})},"data-testid":`button-copy-contract-url-${K.id}`,children:[p.jsx(vg,{className:"w-3 h-3 mr-1"}),"Copiar URL"]})]})]})},K.id))})})]}),t==="cliente"&&p.jsxs(ut,{className:"max-w-2xl",children:[p.jsxs(xt,{children:[p.jsxs(bt,{className:"flex items-center gap-2",children:[p.jsx(qw,{className:"w-5 h-5"}),"Dados do Cliente"]}),p.jsx(wt,{children:"Informacoes e dados do cliente que vai assinar o contrato"})]}),p.jsx(Lt,{className:"space-y-6",children:p.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"clientName",children:"Nome Completo *"}),p.jsx(fe,{id:"clientName",value:d,onChange:K=>f(K.target.value),placeholder:"Nome completo do cliente","data-testid":"input-client-name"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"clientCpf",children:"CPF *"}),p.jsx(fe,{id:"clientCpf",value:h,onChange:K=>RM(K.target.value),placeholder:"000.000.000-00",maxLength:14,"data-testid":"input-client-cpf"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"clientEmail",children:"E-mail de Contato *"}),p.jsx(fe,{id:"clientEmail",type:"email",value:g,onChange:K=>y(K.target.value),placeholder:"email@exemplo.com","data-testid":"input-client-email"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"clientPhone",children:"Telefone para Contato"}),p.jsx(fe,{id:"clientPhone",value:m,onChange:K=>PM(K.target.value),placeholder:"(00) 00000-0000",maxLength:15,"data-testid":"input-client-phone"})]})]})})]}),t==="aparencia"&&p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[p.jsx("div",{className:"space-y-6",children:p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Aparncia da Verificao"}),p.jsx(wt,{children:"Fundo e logo como primeira tela"})]}),p.jsxs(Lt,{className:"space-y-6",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationBackgroundFile",children:"Imagem de Fundo"}),p.jsx(fe,{id:"verificationBackgroundFile",type:"file",accept:"image/*",onChange:K=>{var mn;const Oe=(mn=K.target.files)==null?void 0:mn[0];if(!Oe)return;$1(!0);const ct=new FileReader;ct.onload=qn=>{var Kn,Xn;CM((Kn=qn.target)==null?void 0:Kn.result),wM((Xn=qn.target)==null?void 0:Xn.result),$1(!1)},ct.readAsDataURL(Oe)},disabled:SM}),W1&&p.jsx("div",{className:"mt-3 p-3 border rounded-md bg-gray-50",children:p.jsx("img",{src:W1,alt:"Preview",style:{maxWidth:"200px",height:"auto"}})})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationBackgroundColor",children:"Cor de Fundo (se sem imagem)"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"verificationBackgroundColor",type:"color",value:cd,onChange:K=>z1(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:cd,onChange:K=>z1(K.target.value),className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"appearanceLogoFile",children:"Logo para Primeira Tela"}),p.jsx(fe,{id:"appearanceLogoFile",type:"file",accept:"image/*",onChange:K=>{var mn;const Oe=(mn=K.target.files)==null?void 0:mn[0];if(!Oe)return;kn(!0);const ct=new FileReader;ct.onload=qn=>{var Kn,Xn;$r((Kn=qn.target)==null?void 0:Kn.result),ud((Xn=qn.target)==null?void 0:Xn.result),kn(!1)},ct.readAsDataURL(Oe)},disabled:ho}),_n&&p.jsx("div",{className:"mt-3 p-3 border rounded-md bg-gray-50",children:p.jsx("img",{src:_n,alt:"Preview",style:{maxWidth:"150px",height:"auto"}})})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"appearanceLogoSize",children:"Tamanho da Logo"}),p.jsxs("select",{id:"appearanceLogoSize",value:Ne,onChange:K=>et(K.target.value),className:"w-full px-3 py-2 border rounded-md",children:[p.jsx("option",{value:"small",children:"Pequeno (100px)"}),p.jsx("option",{value:"medium",children:"Mdio (200px)"}),p.jsx("option",{value:"large",children:"Grande (280px)"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"appearanceLogoPosition",children:"Posio da Logo"}),p.jsxs("select",{id:"appearanceLogoPosition",value:tt,onChange:K=>dr(K.target.value),className:"w-full px-3 py-2 border rounded-md",children:[p.jsx("option",{value:"center",children:"Centro"}),p.jsx("option",{value:"left",children:"Esquerda"}),p.jsx("option",{value:"right",children:"Direita"})]})]}),p.jsx("hr",{className:"my-6"}),p.jsx("h3",{className:"text-lg font-semibold",children:"Header da Pgina"}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"headerBackgroundColor",children:"Cor de Fundo do Header"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"headerBackgroundColor",type:"color",value:dd,onChange:K=>U1(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:dd,onChange:K=>U1(K.target.value),className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"headerLogoFile",children:"Logo do Header"}),p.jsx(fe,{id:"headerLogoFile",type:"file",accept:"image/*",onChange:K=>{var mn;const Oe=(mn=K.target.files)==null?void 0:mn[0];if(!Oe)return;G1(!0);const ct=new FileReader;ct.onload=qn=>{var Kn,Xn;kM((Kn=qn.target)==null?void 0:Kn.result),EM((Xn=qn.target)==null?void 0:Xn.result),G1(!1)},ct.readAsDataURL(Oe)},disabled:NM}),H1&&p.jsx("div",{className:"mt-3 p-3 border rounded-md bg-gray-50",children:p.jsx("img",{src:H1,alt:"Header Logo",style:{maxWidth:"100px",height:"auto"}})})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"headerCompanyName",children:"Nome da Empresa"}),p.jsx(fe,{id:"headerCompanyName",value:fd,onChange:K=>_M(K.target.value),placeholder:"Nome da sua empresa"})]})]})]})}),p.jsx("div",{className:"sticky top-6 h-[calc(100vh-100px)]",children:p.jsxs(ut,{className:"h-full flex flex-col",children:[p.jsxs(xt,{children:[p.jsx(bt,{className:"text-base",children:"Preview"}),p.jsx(wt,{children:"Tela completa com header"})]}),p.jsxs(Lt,{className:"flex-1 overflow-y-auto flex flex-col",style:{position:"relative",minHeight:"500px"},children:[p.jsxs("div",{style:{backgroundColor:dd,padding:"20px",display:"flex",alignItems:"center",gap:"15px",marginBottom:"20px",borderRadius:"8px"},children:[Vp&&p.jsx("img",{src:Vp,alt:"Header Logo",style:{height:"40px",maxWidth:"100px"}}),fd&&p.jsx("span",{style:{color:"white",fontSize:"18px",fontWeight:"bold"},children:fd})]}),p.jsxs("div",{style:{flex:1,backgroundColor:cd,backgroundImage:au?`url(${au})`:void 0,backgroundSize:"cover",backgroundPosition:"center",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:[au&&p.jsx("div",{className:"absolute inset-0 bg-black/40"}),p.jsxs("div",{style:{position:"relative",zIndex:10,textAlign:"center"},children:[un&&p.jsx("img",{src:un,alt:"Logo",style:{maxWidth:Ne==="small"?"100px":Ne==="large"?"280px":"200px",height:"auto",marginBottom:"24px",filter:au?"drop-shadow(0 4px 12px rgba(0,0,0,0.3))":"none"}}),p.jsx("button",{style:{padding:"12px 32px",backgroundColor:"#2c3e50",color:"white",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Continuar"})]})]})]})]})})]}),t==="verificacao"&&p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[p.jsx("div",{className:"space-y-6",children:p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Personalizaes da Verificao"}),p.jsx(wt,{children:"Logo, cores, fontes e identidade visual"})]}),p.jsx(Lt,{className:"space-y-6",children:p.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationWelcomeText",children:"Ttulo da Pgina"}),p.jsx(fe,{id:"verificationWelcomeText",value:Lp,onChange:K=>yM(K.target.value),placeholder:"Verificao de Identidade"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationInstructions",children:"Instrues"}),p.jsx(So,{id:"verificationInstructions",value:Bp,onChange:K=>xM(K.target.value),placeholder:"Descrio do processo",rows:3})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationLogoFile",children:"Logo (Upload)"}),p.jsx(fe,{id:"verificationLogoFile",type:"file",accept:"image/*",onChange:K=>{var mn;const Oe=(mn=K.target.files)==null?void 0:mn[0];if(!Oe)return;kn(!0);const ct=new FileReader;ct.onload=qn=>{var Kn,Xn;$r((Kn=qn.target)==null?void 0:Kn.result),ud((Xn=qn.target)==null?void 0:Xn.result),kn(!1)},ct.readAsDataURL(Oe)},disabled:ho}),_n&&p.jsx("div",{className:"mt-3 p-3 border rounded-md bg-gray-50",children:p.jsx("img",{src:_n,alt:"Preview",style:{maxWidth:"150px",height:"auto"}})})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationLogoSize",children:"Tamanho do Logo"}),p.jsxs("select",{id:"verificationLogoSize",value:Ne,onChange:K=>et(K.target.value),className:"w-full px-3 py-2 border rounded-md",children:[p.jsx("option",{value:"small",children:"Pequeno (100px)"}),p.jsx("option",{value:"medium",children:"Mdio (200px)"}),p.jsx("option",{value:"large",children:"Grande (300px)"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationPrimaryColor",children:"Cor Primria"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"verificationPrimaryColor",type:"color",value:ft,onChange:K=>ln(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:ft,onChange:K=>ln(K.target.value),placeholder:"#2c3e50",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationTextColor",children:"Cor do Texto"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"verificationTextColor",type:"color",value:Wt,onChange:K=>kr(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:Wt,onChange:K=>kr(K.target.value),placeholder:"#000000",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationFontFamily",children:"Fonte"}),p.jsxs("select",{id:"verificationFontFamily",value:Go,onChange:K=>sd(K.target.value),className:"w-full px-3 py-2 border rounded-md",children:[p.jsx("option",{value:"Arial, sans-serif",children:"Arial"}),p.jsx("option",{value:"Georgia, serif",children:"Georgia"}),p.jsx("option",{value:"Courier New, monospace",children:"Courier New"}),p.jsx("option",{value:"Times New Roman, serif",children:"Times New Roman"}),p.jsx("option",{value:"Verdana, sans-serif",children:"Verdana"}),p.jsx("option",{value:"Trebuchet MS, sans-serif",children:"Trebuchet MS"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationFontSize",children:"Tamanho da Fonte"}),p.jsx(fe,{id:"verificationFontSize",value:ld,onChange:K=>iu(K.target.value),placeholder:"16px"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationFooterText",children:"Texto do Rodap"}),p.jsx(fe,{id:"verificationFooterText",value:Nr,onChange:K=>gM(K.target.value),placeholder:"Texto do rodap"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"verificationSecurityText",children:"Texto de Segurana"}),p.jsx(fe,{id:"verificationSecurityText",value:V1,onChange:K=>bM(K.target.value),placeholder:"Suas informaes so processadas de forma segura e criptografada"})]})]})})]})}),p.jsx("div",{className:"sticky top-6 h-[calc(100vh-100px)]",children:p.jsxs(ut,{className:"h-full flex flex-col",children:[p.jsxs(xt,{children:[p.jsx(bt,{className:"text-base",children:"Preview da Verificao"}),p.jsx(wt,{children:"Exatamente como o cliente ver"})]}),p.jsx(Lt,{className:"flex-1 overflow-y-auto",children:p.jsx("div",{className:"min-h-full bg-white py-8 flex items-center justify-center",style:{fontFamily:Go},children:tt==="right"?p.jsx("div",{className:"w-full flex items-center justify-end px-8",children:un&&p.jsx("img",{src:un,alt:"Logo",style:{maxWidth:Ne==="small"?"80px":Ne==="large"?"150px":"120px",height:"auto"}})}):p.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:tt==="left"?"space-between":"center",alignItems:"flex-start",position:"relative",paddingX:"16px"},children:[tt==="left"&&un&&p.jsx("div",{style:{paddingTop:"8px",paddingRight:"32px",flexShrink:0},children:p.jsx("img",{src:un,alt:"Logo",style:{maxWidth:Ne==="small"?"80px":Ne==="large"?"150px":"120px",height:"auto"}})}),p.jsxs("div",{style:{position:"relative",zIndex:1,width:"100%",maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center"},children:[tt==="center"&&un&&p.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",marginBottom:"24px"},children:p.jsx("img",{src:un,alt:"Logo",style:{maxWidth:Ne==="small"?"80px":Ne==="large"?"150px":"120px",height:"auto"}})}),p.jsx("h1",{style:{fontSize:"28px",fontWeight:"bold",color:Wt,marginBottom:"8px",textAlign:"center"},children:Lp}),p.jsx("p",{style:{fontSize:"14px",color:Wt,textAlign:"center",marginBottom:"32px",maxWidth:"400px",lineHeight:"1.6"},children:Bp}),p.jsxs("div",{style:{width:"100%",maxWidth:"420px",display:"flex",flexDirection:"column",gap:"16px",marginBottom:"24px"},children:[p.jsxs("div",{style:{padding:"16px",borderRadius:"12px",backgroundColor:"#f8f9fa",border:"1px solid #e5e7eb",display:"flex",gap:"16px",alignItems:"flex-start"},children:[p.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",backgroundColor:`${ft}15`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:ft,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),p.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),p.jsxs("div",{style:{flex:1},children:[p.jsx("h3",{style:{margin:"0 0 4px 0",fontWeight:"600",fontSize:"14px",color:Wt},children:"Tire uma selfie"}),p.jsx("p",{style:{margin:"0",fontSize:"13px",color:Wt},children:"Posicione seu rosto na rea indicada"})]})]}),p.jsxs("div",{style:{padding:"16px",borderRadius:"12px",backgroundColor:"#f8f9fa",border:"1px solid #e5e7eb",display:"flex",gap:"16px",alignItems:"flex-start"},children:[p.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",backgroundColor:`${ft}15`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:ft,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),p.jsx("polyline",{points:"14 2 14 8 20 8"}),p.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),p.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]})}),p.jsxs("div",{style:{flex:1},children:[p.jsx("h3",{style:{margin:"0 0 4px 0",fontWeight:"600",fontSize:"14px",color:Wt},children:"Fotografe seu documento"}),p.jsx("p",{style:{margin:"0",fontSize:"13px",color:Wt},children:"CNH, RG ou outro documento com foto"})]})]}),p.jsxs("div",{style:{padding:"16px",borderRadius:"12px",backgroundColor:"#f8f9fa",border:"1px solid #e5e7eb",display:"flex",gap:"16px",alignItems:"flex-start"},children:[p.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",backgroundColor:`${ft}15`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:ft,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),p.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),p.jsxs("div",{style:{flex:1},children:[p.jsx("h3",{style:{margin:"0 0 4px 0",fontWeight:"600",fontSize:"14px",color:Wt},children:"Verificao automtica"}),p.jsx("p",{style:{margin:"0",fontSize:"13px",color:Wt},children:"Comparamos sua foto com o documento"})]})]})]}),p.jsxs("button",{style:{width:"100%",backgroundColor:ft,color:"white",padding:"14px 20px",borderRadius:"8px",border:"none",fontSize:"16px",fontWeight:"600",cursor:"pointer",marginBottom:"24px",transition:"opacity 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseEnter:K=>K.currentTarget.style.opacity="0.9",onMouseLeave:K=>K.currentTarget.style.opacity="1",children:["Iniciar Verificao",p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),p.jsx("polyline",{points:"12 5 19 12 12 19"})]})]}),p.jsx("p",{style:{fontSize:"12px",color:Wt,textAlign:"center"},children:Nr}),p.jsx("p",{style:{fontSize:"11px",color:ft,textAlign:"center",marginTop:"12px",maxWidth:"380px"},children:V1})]})]})})})]})})]}),t==="parabens"&&p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsx("div",{className:"space-y-6 min-h-screen overflow-y-auto pr-2",children:p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Personalizao - Pgina de Parabns"}),p.jsx(wt,{children:"Customize a pgina de congratulaes para novos revendedoras"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensTitle",children:"Ttulo Principal"}),p.jsx(fe,{id:"parabensTitle",value:ve,onChange:K=>xe(K.target.value),placeholder:"Parabns, Nova Revendedora!"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensSubtitle",children:"Subttulo"}),p.jsx(fe,{id:"parabensSubtitle",value:Me,onChange:K=>Pe(K.target.value),placeholder:"Bem-vinda  famlia de revendedoras!"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensDescription",children:"Descrio"}),p.jsx(So,{id:"parabensDescription",value:je,onChange:K=>Le(K.target.value),placeholder:"Sua maleta de produtos chegar em breve..."})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensFormTitle",children:"Ttulo do Formulrio de Endereo"}),p.jsx(fe,{id:"parabensFormTitle",value:_t,onChange:K=>ze(K.target.value),placeholder:"Endereo para Entrega"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensButtonText",children:"Texto do Boto"}),p.jsx(fe,{id:"parabensButtonText",value:rt,onChange:K=>sn(K.target.value),placeholder:"Confirmar Endereo e Continuar"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensCardColor",children:"Cor do Card"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{type:"color",value:$e,onChange:K=>at(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:$e,onChange:K=>at(K.target.value),className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensBackgroundColor",children:"Cor do Fundo da Pgina"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{type:"color",value:Qe,onChange:K=>Je(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:Qe,onChange:K=>Je(K.target.value),className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensButtonColor",children:"Cor do Boto"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{type:"color",value:dt,onChange:K=>Xe(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:dt,onChange:K=>Xe(K.target.value),className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensTextColor",children:"Cor do Texto"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{type:"color",value:Ce,onChange:K=>lt(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:Ce,onChange:K=>lt(K.target.value),className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"parabensFontFamily",children:"Fonte"}),p.jsx(fe,{id:"parabensFontFamily",value:zt,onChange:K=>Ht(K.target.value),placeholder:"Arial, sans-serif"})]})]})]})}),p.jsx("div",{className:"space-y-6 min-h-screen overflow-y-auto pr-2",children:p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Pr-visualizao da Pgina"}),p.jsx(wt,{children:"Como a pgina aparecer para o cliente"})]}),p.jsx(Lt,{children:p.jsxs("div",{className:"p-6 rounded-lg",style:{fontFamily:zt,backgroundColor:Qe},children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-3xl",children:""})}),p.jsx("h1",{className:"text-3xl font-bold mb-3",style:{color:Ce},children:ve}),p.jsx("p",{className:"text-lg mb-2",style:{color:Ce},children:Me}),p.jsx("p",{className:"text-sm",style:{color:Ce},children:je})]}),p.jsxs("div",{className:"grid grid-cols-1 gap-3 mb-6",children:[p.jsx("div",{className:"bg-white rounded p-3 text-sm",children:p.jsx("span",{className:"font-semibold",children:" Entrega Gratuita"})}),p.jsx("div",{className:"bg-white rounded p-3 text-sm",children:p.jsx("span",{className:"font-semibold",children:" Receba em Casa"})})]}),p.jsxs("div",{className:"p-4 rounded",style:{backgroundColor:$e},children:[p.jsx("h2",{className:"font-semibold mb-4 text-sm",style:{color:Ce},children:_t}),p.jsxs("div",{className:"space-y-3 text-xs",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:Ce},children:"Rua *"}),p.jsx("div",{className:"h-7 bg-white rounded border border-gray-200"})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsxs("div",{className:"col-span-2",children:[p.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:Ce},children:"Nmero *"}),p.jsx("div",{className:"h-7 bg-white rounded border border-gray-200"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:Ce},children:"Complemento"}),p.jsx("div",{className:"h-7 bg-white rounded border border-gray-200"})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:Ce},children:"Bairro *"}),p.jsx("div",{className:"h-7 bg-white rounded border border-gray-200"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:Ce},children:"Cidade *"}),p.jsx("div",{className:"h-7 bg-white rounded border border-gray-200"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:Ce},children:"Estado *"}),p.jsx("div",{className:"h-7 bg-white rounded border border-gray-200"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:Ce},children:"CEP *"}),p.jsx("div",{className:"h-7 bg-white rounded border border-gray-200"})]})]}),p.jsx("button",{disabled:!0,className:"w-full py-2 rounded text-white font-semibold mt-4 text-sm",style:{backgroundColor:dt,opacity:.9},children:rt})]}),p.jsxs("div",{className:"text-center mt-6 text-gray-600 text-xs",children:[p.jsxs("p",{children:["Dados do cliente: ",p.jsx("strong",{children:"Nome do Cliente"})]}),p.jsx("p",{children:"Voc poder atualizar este endereo depois"})]})]})})]})})]}),t==="contrato"&&p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"space-y-6 min-h-screen overflow-y-auto pr-2",children:[p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Personalizaes do Contrato"}),p.jsx(wt,{children:"Logo, cores, fontes e identidade visual"})]}),p.jsxs(Lt,{className:"space-y-6",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"companyName",children:"Nome da Empresa"}),p.jsx(fe,{id:"companyName",value:Y,onChange:K=>J(K.target.value),placeholder:"Nome da sua empresa"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"logoFile",children:"Logo (Upload)"}),p.jsx(fe,{id:"logoFile",type:"file",accept:"image/*",onChange:MM,disabled:L}),U&&p.jsx("div",{className:"mt-3 p-3 border rounded-md bg-gray-50",children:p.jsx("img",{src:U,alt:"Preview",style:{maxWidth:"150px",height:"auto"}})})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"logoSize",children:"Tamanho do Logo"}),p.jsxs("select",{id:"logoSize",value:T,onChange:K=>k(K.target.value),className:"w-full px-3 py-2 border rounded-md",children:[p.jsx("option",{value:"small",children:"Pequeno (100px)"}),p.jsx("option",{value:"medium",children:"Mdio (200px)"}),p.jsx("option",{value:"large",children:"Grande (300px)"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{children:"Posio do Logo"}),p.jsxs("div",{className:"flex gap-4 mt-2",children:[p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"logoPosition",value:"left",checked:I==="left",onChange:K=>A(K.target.value)}),p.jsx("span",{children:"Esquerda"})]}),p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"logoPosition",value:"center",checked:I==="center",onChange:K=>A(K.target.value)}),p.jsx("span",{children:"Centro"})]}),p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"logoPosition",value:"right",checked:I==="right",onChange:K=>A(K.target.value)}),p.jsx("span",{children:"Direita"})]})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"primaryColor",children:"Cor Primria"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"primaryColor",type:"color",value:F,onChange:K=>M(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:F,onChange:K=>M(K.target.value),placeholder:"#2c3e50",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"textColor",children:"Cor do Texto"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"textColor",type:"color",value:j,onChange:K=>R(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:j,onChange:K=>R(K.target.value),placeholder:"#333333",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"fontFamily",children:"Fonte"}),p.jsx(fe,{id:"fontFamily",value:P,onChange:K=>z(K.target.value),placeholder:"Arial, sans-serif"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"fontSize",children:"Tamanho da Fonte"}),p.jsx(fe,{id:"fontSize",value:G,onChange:K=>q(K.target.value),placeholder:"16px"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"footerText",children:"Texto do Rodap"}),p.jsx(So,{id:"footerText",value:X,onChange:K=>ee(K.target.value),placeholder:" 2024 Sua Empresa. Todos os direitos reservados.",rows:3})]}),p.jsxs("div",{className:"border-t pt-6",children:[p.jsx("h3",{className:"font-semibold text-sm mb-4",children:'Personalizar Card "Adquirir Maleta"'}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"maletaCardColor",children:"Cor do Card"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"maletaCardColor",type:"color",value:oe,onChange:K=>ue(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:oe,onChange:K=>ue(K.target.value),placeholder:"#dbeafe",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"maletaButtonColor",children:"Cor do Boto"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"maletaButtonColor",type:"color",value:ae,onChange:K=>ce(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:ae,onChange:K=>ce(K.target.value),placeholder:"#22c55e",className:"flex-1"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"maletaTextColor",children:"Cor do Texto"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(fe,{id:"maletaTextColor",type:"color",value:ne,onChange:K=>se(K.target.value),className:"h-10 w-20"}),p.jsx(fe,{value:ne,onChange:K=>se(K.target.value),placeholder:"#1e40af",className:"flex-1"})]})]})]})]})]})]}),p.jsxs(ut,{children:[p.jsxs(xt,{children:[p.jsx(bt,{children:"Contedo do Contrato"}),p.jsx(wt,{children:"Personalize o titulo e as clausulas"})]}),p.jsxs(Lt,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(ge,{htmlFor:"contractTitle",children:"Titulo do Contrato"}),p.jsx(fe,{id:"contractTitle",value:b,onChange:K=>w(K.target.value),placeholder:"Ex: CONTRATO DE PRESTACAO DE SERVICOS","data-testid":"input-contract-title"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[p.jsx(ge,{children:"Clausulas"}),p.jsxs(Ie,{type:"button",variant:"outline",size:"sm",onClick:AM,"data-testid":"button-add-clause",children:[p.jsx(Gw,{className:"w-4 h-4 mr-1"}),"Adicionar Clausula"]})]}),C.map((K,Oe)=>p.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[p.jsxs(ge,{children:["Clausula ",Oe+1]}),C.length>1&&p.jsx(Ie,{type:"button",variant:"ghost",size:"sm",onClick:()=>IM(Oe),"data-testid":`button-remove-clause-${Oe}`,children:p.jsx(_3,{className:"w-4 h-4 text-destructive"})})]}),p.jsx(fe,{value:K.title,onChange:ct=>kb(Oe,"title",ct.target.value),placeholder:"Titulo da clausula","data-testid":`input-clause-title-${Oe}`}),p.jsx(So,{value:K.content,onChange:ct=>kb(Oe,"content",ct.target.value),placeholder:"Conteudo da clausula",rows:3,"data-testid":`input-clause-content-${Oe}`})]},Oe))]})]})]})]}),p.jsx("div",{className:"sticky top-6 h-[calc(100vh-100px)] flex flex-col",children:p.jsxs(ut,{className:"flex-1 flex flex-col overflow-hidden",children:[p.jsxs(xt,{children:[p.jsx(bt,{className:"text-base",children:"Preview do Contrato"}),p.jsx(wt,{children:"Visualizao em tempo real"})]}),p.jsx(Lt,{className:"flex-1 overflow-y-auto",children:p.jsx("div",{className:"border rounded-lg bg-white p-0",style:{fontSize:"12px",height:"100%"},children:p.jsxs("div",{style:{fontFamily:P,color:j,maxWidth:"600px",margin:"0 auto",padding:"20px"},children:[_&&p.jsx("div",{style:{textAlign:I,marginBottom:"20px"},children:p.jsx("img",{src:_,alt:"Logo",style:{maxWidth:T==="small"?"100px":T==="large"?"300px":"200px",height:"auto"}})}),p.jsxs("div",{style:{padding:"15px",borderRadius:"4px",marginBottom:"20px",textAlign:"center",borderBottom:`3px solid ${F}`},children:[p.jsx("h1",{style:{margin:"0",fontSize:"20px",fontWeight:"bold",color:F},children:b}),p.jsxs("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:j},children:["Protocolo: ",p.jsx("strong",{children:"CONT-XXXXX-XXXXX"})]})]}),p.jsxs("div",{style:{fontSize:G,lineHeight:"1.6",marginBottom:"20px",color:j},children:[p.jsx("h3",{style:{color:j,borderBottom:`2px solid ${F}`,paddingBottom:"8px",marginTop:"20px",marginBottom:"10px",fontSize:"14px",fontWeight:"bold"},children:"INFORMAES DO CLIENTE"}),p.jsxs("p",{style:{margin:"5px 0",color:j},children:[p.jsx("strong",{style:{color:F},children:"Nome:"})," [Nome do cliente]"]}),p.jsxs("p",{style:{margin:"5px 0",color:j},children:[p.jsx("strong",{style:{color:F},children:"CPF:"})," [CPF do cliente]"]}),p.jsxs("p",{style:{margin:"5px 0",color:j},children:[p.jsx("strong",{style:{color:F},children:"Email:"})," [Email do cliente]"]}),p.jsxs("p",{style:{margin:"5px 0",color:j},children:[p.jsx("strong",{style:{color:F},children:"Telefone:"})," [Telefone do cliente]"]})]}),p.jsxs("div",{children:[p.jsx("h3",{style:{color:j,borderBottom:`2px solid ${F}`,paddingBottom:"8px",marginTop:"20px",marginBottom:"10px",fontSize:"14px",fontWeight:"bold"},children:"CLUSULAS"}),C.map((K,Oe)=>p.jsxs("div",{style:{marginBottom:"15px"},children:[p.jsx("h4",{style:{color:F,margin:"10px 0 5px 0",fontSize:"13px",fontWeight:"bold"},children:K.title||`Clusula ${Oe+1}`}),p.jsx("p",{style:{margin:"0",textAlign:"justify",fontSize:G,color:j},children:K.content||"[Contedo da clusula]"})]},Oe))]}),X&&p.jsx("div",{style:{marginTop:"20px",paddingTop:"15px",borderTop:`1px solid ${F}`,fontSize:"11px",color:j,textAlign:"center"},children:X})]})})})]})})]}),p.jsx(kV,{contract:s,open:u,onOpenChange:c}),p.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:p.jsxs(Ie,{onClick:OM,disabled:zp.isPending,className:"rounded-full shadow-lg h-14 px-8 gap-2 hover:shadow-xl transition-all",size:"lg","data-testid":"button-create-contract",children:[p.jsx(oo,{className:"w-5 h-5"}),p.jsx("span",{className:"hidden sm:inline",children:zp.isPending?"Criando...":"Criar Contrato"})]})})]})})},sR=S.createContext(void 0),TV=({children:e})=>{const[t,n]=S.useState(0),[r,o]=S.useState(null),[i,a]=S.useState(null),[s,l]=S.useState(null),u=()=>{n(0),o(null),a(null),l(null)};return p.jsx(sR.Provider,{value:{currentStep:t,setCurrentStep:n,govbrData:r,setGovbrData:o,contractData:i,setContractData:a,addressData:s,setAddressData:l,resetFlow:u},children:e})},Gc=()=>{const e=S.useContext(sR);if(e===void 0)throw new Error("useContract must be used within a ContractProvider");return e},tx=S.createContext({});function nx(e){const t=S.useRef(null);return t.current===null&&(t.current=e()),t.current}const rx=typeof window<"u",lR=rx?S.useLayoutEffect:S.useEffect,yp=S.createContext(null);function ox(e,t){e.indexOf(t)===-1&&e.push(t)}function ix(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const hi=(e,t,n)=>n>t?t:n<e?e:n;let dh=()=>{};const pi={},uR=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function cR(e){return typeof e=="object"&&e!==null}const dR=e=>/^0[^.\s]+$/u.test(e);function ax(e){let t;return()=>(t===void 0&&(t=e()),t)}const Br=e=>e,RV=(e,t)=>n=>t(e(n)),qc=(...e)=>e.reduce(RV),xc=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};class sx{constructor(){this.subscriptions=[]}add(t){return ox(this.subscriptions,t),()=>ix(this.subscriptions,t)}notify(t,n,r){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,n,r);else for(let i=0;i<o;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Mo=e=>e*1e3,Fr=e=>e/1e3;function fR(e,t){return t?e*(1e3/t):0}const hR=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,PV=1e-7,AV=12;function IV(e,t,n,r,o){let i,a,s=0;do a=t+(n-t)/2,i=hR(a,r,o)-e,i>0?n=a:t=a;while(Math.abs(i)>PV&&++s<AV);return a}function Kc(e,t,n,r){if(e===t&&n===r)return Br;const o=i=>IV(i,0,1,e,n);return i=>i===0||i===1?i:hR(o(i),t,r)}const pR=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,mR=e=>t=>1-e(1-t),vR=Kc(.33,1.53,.69,.99),lx=mR(vR),gR=pR(lx),yR=e=>(e*=2)<1?.5*lx(e):.5*(2-Math.pow(2,-10*(e-1))),ux=e=>1-Math.sin(Math.acos(e)),xR=mR(ux),bR=pR(ux),MV=Kc(.42,0,1,1),DV=Kc(0,0,.58,1),wR=Kc(.42,0,.58,1),jV=e=>Array.isArray(e)&&typeof e[0]!="number",CR=e=>Array.isArray(e)&&typeof e[0]=="number",B2={linear:Br,easeIn:MV,easeInOut:wR,easeOut:DV,circIn:ux,circInOut:bR,circOut:xR,backIn:lx,backInOut:gR,backOut:vR,anticipate:yR},FV=e=>typeof e=="string",V2=e=>{if(CR(e)){dh(e.length===4);const[t,n,r,o]=e;return Kc(t,n,r,o)}else if(FV(e))return dh(B2[e]!==void 0),B2[e];return e},zd=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],z2={value:null,addProjectionMetrics:null};function OV(e,t){let n=new Set,r=new Set,o=!1,i=!1;const a=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},l=0;function u(d){a.has(d)&&(c.schedule(d),e()),l++,d(s)}const c={schedule:(d,f=!1,h=!1)=>{const g=h&&o?n:r;return f&&a.add(d),g.has(d)||g.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(s=d,o){i=!0;return}o=!0,[n,r]=[r,n],n.forEach(u),t&&z2.value&&z2.value.frameloop[t].push(l),l=0,n.clear(),o=!1,i&&(i=!1,c.process(d))}};return c}const LV=40;function SR(e,t){let n=!1,r=!0;const o={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=zd.reduce((b,w)=>(b[w]=OV(i,t?w:void 0),b),{}),{setup:s,read:l,resolveKeyframes:u,preUpdate:c,update:d,preRender:f,render:h,postRender:v}=a,g=()=>{const b=pi.useManualTiming?o.timestamp:performance.now();n=!1,pi.useManualTiming||(o.delta=r?1e3/60:Math.max(Math.min(b-o.timestamp,LV),1)),o.timestamp=b,o.isProcessing=!0,s.process(o),l.process(o),u.process(o),c.process(o),d.process(o),f.process(o),h.process(o),v.process(o),o.isProcessing=!1,n&&t&&(r=!1,e(g))},y=()=>{n=!0,r=!0,o.isProcessing||e(g)};return{schedule:zd.reduce((b,w)=>{const C=a[w];return b[w]=(E,_=!1,N=!1)=>(n||y(),C.schedule(E,_,N)),b},{}),cancel:b=>{for(let w=0;w<zd.length;w++)a[zd[w]].cancel(b)},state:o,steps:a}}const{schedule:Nt,cancel:ha,state:gn,steps:Im}=SR(typeof requestAnimationFrame<"u"?requestAnimationFrame:Br,!0);let kf;function BV(){kf=void 0}const or={now:()=>(kf===void 0&&or.set(gn.isProcessing||pi.useManualTiming?gn.timestamp:performance.now()),kf),set:e=>{kf=e,queueMicrotask(BV)}},ER=e=>t=>typeof t=="string"&&t.startsWith(e),_R=ER("--"),VV=ER("var(--"),cx=e=>VV(e)?zV.test(e.split("/*")[0].trim()):!1,zV=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,eu={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},bc={...eu,transform:e=>hi(0,1,e)},Wd={...eu,default:1},Wu=e=>Math.round(e*1e5)/1e5,dx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function WV(e){return e==null}const $V=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,fx=(e,t)=>n=>!!(typeof n=="string"&&$V.test(n)&&n.startsWith(e)||t&&!WV(n)&&Object.prototype.hasOwnProperty.call(n,t)),kR=(e,t,n)=>r=>{if(typeof r!="string")return r;const[o,i,a,s]=r.match(dx);return{[e]:parseFloat(o),[t]:parseFloat(i),[n]:parseFloat(a),alpha:s!==void 0?parseFloat(s):1}},UV=e=>hi(0,255,e),Mm={...eu,transform:e=>Math.round(UV(e))},Oa={test:fx("rgb","red"),parse:kR("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+Mm.transform(e)+", "+Mm.transform(t)+", "+Mm.transform(n)+", "+Wu(bc.transform(r))+")"};function HV(e){let t="",n="",r="",o="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),o=e.substring(4,5),t+=t,n+=n,r+=r,o+=o),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:o?parseInt(o,16)/255:1}}const zg={test:fx("#"),parse:HV,transform:Oa.transform},Xc=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ri=Xc("deg"),Do=Xc("%"),Re=Xc("px"),GV=Xc("vh"),qV=Xc("vw"),W2={...Do,parse:e=>Do.parse(e)/100,transform:e=>Do.transform(e*100)},Ks={test:fx("hsl","hue"),parse:kR("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Do.transform(Wu(t))+", "+Do.transform(Wu(n))+", "+Wu(bc.transform(r))+")"},Gt={test:e=>Oa.test(e)||zg.test(e)||Ks.test(e),parse:e=>Oa.test(e)?Oa.parse(e):Ks.test(e)?Ks.parse(e):zg.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Oa.transform(e):Ks.transform(e),getAnimatableNone:e=>{const t=Gt.parse(e);return t.alpha=0,Gt.transform(t)}},KV=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function XV(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(dx))==null?void 0:t.length)||0)+(((n=e.match(KV))==null?void 0:n.length)||0)>0}const NR="number",TR="color",YV="var",QV="var(",$2="${}",ZV=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function wc(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},o=[];let i=0;const s=t.replace(ZV,l=>(Gt.test(l)?(r.color.push(i),o.push(TR),n.push(Gt.parse(l))):l.startsWith(QV)?(r.var.push(i),o.push(YV),n.push(l)):(r.number.push(i),o.push(NR),n.push(parseFloat(l))),++i,$2)).split($2);return{values:n,split:s,indexes:r,types:o}}function RR(e){return wc(e).values}function PR(e){const{split:t,types:n}=wc(e),r=t.length;return o=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],o[a]!==void 0){const s=n[a];s===NR?i+=Wu(o[a]):s===TR?i+=Gt.transform(o[a]):i+=o[a]}return i}}const JV=e=>typeof e=="number"?0:Gt.test(e)?Gt.getAnimatableNone(e):e;function e6(e){const t=RR(e);return PR(e)(t.map(JV))}const pa={test:XV,parse:RR,createTransformer:PR,getAnimatableNone:e6};function Dm(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function t6({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let o=0,i=0,a=0;if(!t)o=i=a=n;else{const s=n<.5?n*(1+t):n+t-n*t,l=2*n-s;o=Dm(l,s,e+1/3),i=Dm(l,s,e),a=Dm(l,s,e-1/3)}return{red:Math.round(o*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function fh(e,t){return n=>n>0?t:e}const At=(e,t,n)=>e+(t-e)*n,jm=(e,t,n)=>{const r=e*e,o=n*(t*t-r)+r;return o<0?0:Math.sqrt(o)},n6=[zg,Oa,Ks],r6=e=>n6.find(t=>t.test(e));function U2(e){const t=r6(e);if(!t)return!1;let n=t.parse(e);return t===Ks&&(n=t6(n)),n}const H2=(e,t)=>{const n=U2(e),r=U2(t);if(!n||!r)return fh(e,t);const o={...n};return i=>(o.red=jm(n.red,r.red,i),o.green=jm(n.green,r.green,i),o.blue=jm(n.blue,r.blue,i),o.alpha=At(n.alpha,r.alpha,i),Oa.transform(o))},Wg=new Set(["none","hidden"]);function o6(e,t){return Wg.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function i6(e,t){return n=>At(e,t,n)}function hx(e){return typeof e=="number"?i6:typeof e=="string"?cx(e)?fh:Gt.test(e)?H2:l6:Array.isArray(e)?AR:typeof e=="object"?Gt.test(e)?H2:a6:fh}function AR(e,t){const n=[...e],r=n.length,o=e.map((i,a)=>hx(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=o[a](i);return n}}function a6(e,t){const n={...e,...t},r={};for(const o in n)e[o]!==void 0&&t[o]!==void 0&&(r[o]=hx(e[o])(e[o],t[o]));return o=>{for(const i in r)n[i]=r[i](o);return n}}function s6(e,t){const n=[],r={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){const i=t.types[o],a=e.indexes[i][r[i]],s=e.values[a]??0;n[o]=s,r[i]++}return n}const l6=(e,t)=>{const n=pa.createTransformer(t),r=wc(e),o=wc(t);return r.indexes.var.length===o.indexes.var.length&&r.indexes.color.length===o.indexes.color.length&&r.indexes.number.length>=o.indexes.number.length?Wg.has(e)&&!o.values.length||Wg.has(t)&&!r.values.length?o6(e,t):qc(AR(s6(r,o),o.values),n):fh(e,t)};function IR(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?At(e,t,n):hx(e)(e,t)}const u6=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>Nt.update(t,n),stop:()=>ha(t),now:()=>gn.isProcessing?gn.timestamp:or.now()}},MR=(e,t,n=10)=>{let r="";const o=Math.max(Math.round(t/n),2);for(let i=0;i<o;i++)r+=Math.round(e(i/(o-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},hh=2e4;function px(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<hh;)t+=n,r=e.next(t);return t>=hh?1/0:t}function c6(e,t=100,n){const r=n({...e,keyframes:[0,t]}),o=Math.min(px(r),hh);return{type:"keyframes",ease:i=>r.next(o*i).value/t,duration:Fr(o)}}const d6=5;function DR(e,t,n){const r=Math.max(t-d6,0);return fR(n-e(r),t-r)}const Bt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Fm=.001;function f6({duration:e=Bt.duration,bounce:t=Bt.bounce,velocity:n=Bt.velocity,mass:r=Bt.mass}){let o,i,a=1-t;a=hi(Bt.minDamping,Bt.maxDamping,a),e=hi(Bt.minDuration,Bt.maxDuration,Fr(e)),a<1?(o=u=>{const c=u*a,d=c*e,f=c-n,h=$g(u,a),v=Math.exp(-d);return Fm-f/h*v},i=u=>{const d=u*a*e,f=d*n+n,h=Math.pow(a,2)*Math.pow(u,2)*e,v=Math.exp(-d),g=$g(Math.pow(u,2),a);return(-o(u)+Fm>0?-1:1)*((f-h)*v)/g}):(o=u=>{const c=Math.exp(-u*e),d=(u-n)*e+1;return-Fm+c*d},i=u=>{const c=Math.exp(-u*e),d=(n-u)*(e*e);return c*d});const s=5/e,l=p6(o,i,s);if(e=Mo(e),isNaN(l))return{stiffness:Bt.stiffness,damping:Bt.damping,duration:e};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:e}}}const h6=12;function p6(e,t,n){let r=n;for(let o=1;o<h6;o++)r=r-e(r)/t(r);return r}function $g(e,t){return e*Math.sqrt(1-t*t)}const m6=["duration","bounce"],v6=["stiffness","damping","mass"];function G2(e,t){return t.some(n=>e[n]!==void 0)}function g6(e){let t={velocity:Bt.velocity,stiffness:Bt.stiffness,damping:Bt.damping,mass:Bt.mass,isResolvedFromDuration:!1,...e};if(!G2(e,v6)&&G2(e,m6))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),o=r*r,i=2*hi(.05,1,1-(e.bounce||0))*Math.sqrt(o);t={...t,mass:Bt.mass,stiffness:o,damping:i}}else{const n=f6(e);t={...t,...n,mass:Bt.mass},t.isResolvedFromDuration=!0}return t}function ph(e=Bt.visualDuration,t=Bt.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:o}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],s={done:!1,value:i},{stiffness:l,damping:u,mass:c,duration:d,velocity:f,isResolvedFromDuration:h}=g6({...n,velocity:-Fr(n.velocity||0)}),v=f||0,g=u/(2*Math.sqrt(l*c)),y=a-i,m=Fr(Math.sqrt(l/c)),x=Math.abs(y)<5;r||(r=x?Bt.restSpeed.granular:Bt.restSpeed.default),o||(o=x?Bt.restDelta.granular:Bt.restDelta.default);let b;if(g<1){const C=$g(m,g);b=E=>{const _=Math.exp(-g*m*E);return a-_*((v+g*m*y)/C*Math.sin(C*E)+y*Math.cos(C*E))}}else if(g===1)b=C=>a-Math.exp(-m*C)*(y+(v+m*y)*C);else{const C=m*Math.sqrt(g*g-1);b=E=>{const _=Math.exp(-g*m*E),N=Math.min(C*E,300);return a-_*((v+g*m*y)*Math.sinh(N)+C*y*Math.cosh(N))/C}}const w={calculatedDuration:h&&d||null,next:C=>{const E=b(C);if(h)s.done=C>=d;else{let _=C===0?v:0;g<1&&(_=C===0?Mo(v):DR(b,C,E));const N=Math.abs(_)<=r,T=Math.abs(a-E)<=o;s.done=N&&T}return s.value=s.done?a:E,s},toString:()=>{const C=Math.min(px(w),hh),E=MR(_=>w.next(C*_).value,C,30);return C+"ms "+E},toTransition:()=>{}};return w}ph.applyToOptions=e=>{const t=c6(e,100,ph);return e.ease=t.ease,e.duration=Mo(t.duration),e.type="keyframes",e};function Ug({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:o=10,bounceStiffness:i=500,modifyTarget:a,min:s,max:l,restDelta:u=.5,restSpeed:c}){const d=e[0],f={done:!1,value:d},h=N=>s!==void 0&&N<s||l!==void 0&&N>l,v=N=>s===void 0?l:l===void 0||Math.abs(s-N)<Math.abs(l-N)?s:l;let g=n*t;const y=d+g,m=a===void 0?y:a(y);m!==y&&(g=m-d);const x=N=>-g*Math.exp(-N/r),b=N=>m+x(N),w=N=>{const T=x(N),k=b(N);f.done=Math.abs(T)<=u,f.value=f.done?m:k};let C,E;const _=N=>{h(f.value)&&(C=N,E=ph({keyframes:[f.value,v(f.value)],velocity:DR(b,N,f.value),damping:o,stiffness:i,restDelta:u,restSpeed:c}))};return _(0),{calculatedDuration:null,next:N=>{let T=!1;return!E&&C===void 0&&(T=!0,w(N),_(N)),C!==void 0&&N>=C?E.next(N-C):(!T&&w(N),f)}}}function y6(e,t,n){const r=[],o=n||pi.mix||IR,i=e.length-1;for(let a=0;a<i;a++){let s=o(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Br:t;s=qc(l,s)}r.push(s)}return r}function x6(e,t,{clamp:n=!0,ease:r,mixer:o}={}){const i=e.length;if(dh(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=y6(t,r,o),l=s.length,u=c=>{if(a&&c<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(c<e[d+1]);d++);const f=xc(e[d],e[d+1],c);return s[d](f)};return n?c=>u(hi(e[0],e[i-1],c)):u}function b6(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const o=xc(0,t,r);e.push(At(n,1,o))}}function w6(e){const t=[0];return b6(t,e.length-1),t}function C6(e,t){return e.map(n=>n*t)}function S6(e,t){return e.map(()=>t||wR).splice(0,e.length-1)}function $u({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const o=jV(r)?r.map(V2):V2(r),i={done:!1,value:t[0]},a=C6(n&&n.length===t.length?n:w6(t),e),s=x6(a,t,{ease:Array.isArray(o)?o:S6(t,o)});return{calculatedDuration:e,next:l=>(i.value=s(l),i.done=l>=e,i)}}const E6=e=>e!==null;function mx(e,{repeat:t,repeatType:n="loop"},r,o=1){const i=e.filter(E6),s=o<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const _6={decay:Ug,inertia:Ug,tween:$u,keyframes:$u,spring:ph};function jR(e){typeof e.type=="string"&&(e.type=_6[e.type])}class vx{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const k6=e=>e/100;class gx extends vx{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,o;const{motionValue:n}=this.options;n&&n.updatedAt!==or.now()&&this.tick(or.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(o=(r=this.options).onStop)==null||o.call(r))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;jR(t);const{type:n=$u,repeat:r=0,repeatDelay:o=0,repeatType:i,velocity:a=0}=t;let{keyframes:s}=t;const l=n||$u;l!==$u&&typeof s[0]!="number"&&(this.mixKeyframes=qc(k6,IR(s[0],s[1])),s=[0,100]);const u=l({...t,keyframes:s});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...s].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=px(u));const{calculatedDuration:c}=u;this.calculatedDuration=c,this.resolvedDuration=c+o,this.totalDuration=this.resolvedDuration*(r+1)-o,this.generator=u}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:o,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:s,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:u=0,keyframes:c,repeat:d,repeatType:f,repeatDelay:h,type:v,onUpdate:g,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-o/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const m=this.currentTime-u*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?m<0:m>o;this.currentTime=Math.max(m,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let b=this.currentTime,w=r;if(d){const N=Math.min(this.currentTime,o)/s;let T=Math.floor(N),k=N%1;!k&&N>=1&&(k=1),k===1&&T--,T=Math.min(T,d+1),!!(T%2)&&(f==="reverse"?(k=1-k,h&&(k-=h/s)):f==="mirror"&&(w=a)),b=hi(0,1,k)*s}const C=x?{done:!1,value:c[0]}:w.next(b);i&&(C.value=i(C.value));let{done:E}=C;!x&&l!==null&&(E=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const _=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return _&&v!==Ug&&(C.value=mx(c,this.options,y,this.speed)),g&&g(C.value),_&&this.finish(),C}then(t,n){return this.finished.then(t,n)}get duration(){return Fr(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Fr(t)}get time(){return Fr(this.currentTime)}set time(t){var n;t=Mo(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(or.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Fr(this.currentTime))}play(){var o,i;if(this.isStopped)return;const{driver:t=u6,startTime:n}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),(i=(o=this.options).onPlay)==null||i.call(o);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(or.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(t=this.options).onComplete)==null||n.call(t)}cancel(){var t,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(t=this.options).onCancel)==null||n.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),t.observe(this)}}function N6(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const La=e=>e*180/Math.PI,Hg=e=>{const t=La(Math.atan2(e[1],e[0]));return Gg(t)},T6={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Hg,rotateZ:Hg,skewX:e=>La(Math.atan(e[1])),skewY:e=>La(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Gg=e=>(e=e%360,e<0&&(e+=360),e),q2=Hg,K2=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),X2=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),R6={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:K2,scaleY:X2,scale:e=>(K2(e)+X2(e))/2,rotateX:e=>Gg(La(Math.atan2(e[6],e[5]))),rotateY:e=>Gg(La(Math.atan2(-e[2],e[0]))),rotateZ:q2,rotate:q2,skewX:e=>La(Math.atan(e[4])),skewY:e=>La(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function qg(e){return e.includes("scale")?1:0}function Kg(e,t){if(!e||e==="none")return qg(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,o;if(n)r=R6,o=n;else{const s=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=T6,o=s}if(!o)return qg(t);const i=r[t],a=o[1].split(",").map(A6);return typeof i=="function"?i(a):a[i]}const P6=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return Kg(n,t)};function A6(e){return parseFloat(e.trim())}const tu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],nu=new Set(tu),Y2=e=>e===eu||e===Re,I6=new Set(["x","y","z"]),M6=tu.filter(e=>!I6.has(e));function D6(e){const t=[];return M6.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Ja={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Kg(t,"x"),y:(e,{transform:t})=>Kg(t,"y")};Ja.translateX=Ja.x;Ja.translateY=Ja.y;const es=new Set;let Xg=!1,Yg=!1,Qg=!1;function FR(){if(Yg){const e=Array.from(es).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const o=D6(r);o.length&&(n.set(r,o),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const o=n.get(r);o&&o.forEach(([i,a])=>{var s;(s=r.getValue(i))==null||s.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Yg=!1,Xg=!1,es.forEach(e=>e.complete(Qg)),es.clear()}function OR(){es.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Yg=!0)})}function j6(){Qg=!0,OR(),FR(),Qg=!1}class yx{constructor(t,n,r,o,i,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=o,this.element=i,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(es.add(this),Xg||(Xg=!0,Nt.read(OR),Nt.resolveKeyframes(FR))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:o}=this;if(t[0]===null){const i=o==null?void 0:o.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const s=r.readValue(n,a);s!=null&&(t[0]=s)}t[0]===void 0&&(t[0]=a),o&&i===void 0&&o.set(t[0])}N6(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),es.delete(this)}cancel(){this.state==="scheduled"&&(es.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const F6=e=>e.startsWith("--");function O6(e,t,n){F6(t)?e.style.setProperty(t,n):e.style[t]=n}const L6=ax(()=>window.ScrollTimeline!==void 0),B6={};function V6(e,t){const n=ax(e);return()=>B6[t]??n()}const LR=V6(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Tu=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,Q2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Tu([0,.65,.55,1]),circOut:Tu([.55,0,1,.45]),backIn:Tu([.31,.01,.66,-.59]),backOut:Tu([.33,1.53,.69,.99])};function BR(e,t){if(e)return typeof e=="function"?LR()?MR(e,t):"ease-out":CR(e)?Tu(e):Array.isArray(e)?e.map(n=>BR(n,t)||Q2.easeOut):Q2[e]}function z6(e,t,n,{delay:r=0,duration:o=300,repeat:i=0,repeatType:a="loop",ease:s="easeOut",times:l}={},u=void 0){const c={[t]:n};l&&(c.offset=l);const d=BR(s,o);Array.isArray(d)&&(c.easing=d);const f={delay:r,duration:o,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return u&&(f.pseudoElement=u),e.animate(c,f)}function VR(e){return typeof e=="function"&&"applyToOptions"in e}function W6({type:e,...t}){return VR(e)&&LR()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class $6 extends vx{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:o,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:s,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,dh(typeof t.type!="string");const u=W6(t);this.animation=z6(n,r,o,u,i),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const c=mx(o,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(c):O6(n,r,c),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Fr(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Fr(t)}get time(){return Fr(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Mo(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&L6()?(this.animation.timeline=t,Br):n(this)}}const zR={anticipate:yR,backInOut:gR,circInOut:bR};function U6(e){return e in zR}function H6(e){typeof e.ease=="string"&&U6(e.ease)&&(e.ease=zR[e.ease])}const Z2=10;class G6 extends $6{constructor(t){H6(t),jR(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:o,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const s=new gx({...a,autoplay:!1}),l=Mo(this.finishedTime??this.time);n.setWithVelocity(s.sample(l-Z2).value,s.sample(l).value,Z2),s.stop()}}const J2=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(pa.test(e)||e==="0")&&!e.startsWith("url("));function q6(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function K6(e,t,n,r){const o=e[0];if(o===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=J2(o,t),s=J2(i,t);return!a||!s?!1:q6(e)||(n==="spring"||VR(n))&&r}function Zg(e){e.duration=0,e.type="keyframes"}const X6=new Set(["opacity","clipPath","filter","transform"]),Y6=ax(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Q6(e){var c;const{motionValue:t,name:n,repeatDelay:r,repeatType:o,damping:i,type:a}=e;if(!(((c=t==null?void 0:t.owner)==null?void 0:c.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return Y6()&&n&&X6.has(n)&&(n!=="transform"||!u)&&!l&&!r&&o!=="mirror"&&i!==0&&a!=="inertia"}const Z6=40;class J6 extends vx{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:o=0,repeatDelay:i=0,repeatType:a="loop",keyframes:s,name:l,motionValue:u,element:c,...d}){var v;super(),this.stop=()=>{var g,y;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(y=this.keyframeResolver)==null||y.cancel()},this.createdAt=or.now();const f={autoplay:t,delay:n,type:r,repeat:o,repeatDelay:i,repeatType:a,name:l,motionValue:u,element:c,...d},h=(c==null?void 0:c.KeyframeResolver)||yx;this.keyframeResolver=new h(s,(g,y,m)=>this.onKeyframesResolved(g,y,f,!m),l,u,c),(v=this.keyframeResolver)==null||v.scheduleResolve()}onKeyframesResolved(t,n,r,o){this.keyframeResolver=void 0;const{name:i,type:a,velocity:s,delay:l,isHandoff:u,onUpdate:c}=r;this.resolvedAt=or.now(),K6(t,i,a,s)||((pi.instantAnimations||!l)&&(c==null||c(mx(t,r,n))),t[0]=t[t.length-1],Zg(r),r.repeat=0);const f={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>Z6?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},h=!u&&Q6(f)?new G6({...f,element:f.motionValue.owner.current}):new gx(f);h.finished.then(()=>this.notifyFinished()).catch(Br),this.pendingTimeline&&(this.stopTimeline=h.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=h}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),j6()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const ez=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function tz(e){const t=ez.exec(e);if(!t)return[,];const[,n,r,o]=t;return[`--${n??r}`,o]}function WR(e,t,n=1){const[r,o]=tz(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return uR(a)?parseFloat(a):a}return cx(o)?WR(o,t,n+1):o}function xx(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const $R=new Set(["width","height","top","left","right","bottom",...tu]),nz={test:e=>e==="auto",parse:e=>e},UR=e=>t=>t.test(e),HR=[eu,Re,Do,Ri,qV,GV,nz],eC=e=>HR.find(UR(e));function rz(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||dR(e):!0}const oz=new Set(["brightness","contrast","saturate","opacity"]);function iz(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(dx)||[];if(!r)return e;const o=n.replace(r,"");let i=oz.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+o+")"}const az=/\b([a-z-]*)\(.*?\)/gu,Jg={...pa,getAnimatableNone:e=>{const t=e.match(az);return t?t.map(iz).join(" "):e}},tC={...eu,transform:Math.round},sz={rotate:Ri,rotateX:Ri,rotateY:Ri,rotateZ:Ri,scale:Wd,scaleX:Wd,scaleY:Wd,scaleZ:Wd,skew:Ri,skewX:Ri,skewY:Ri,distance:Re,translateX:Re,translateY:Re,translateZ:Re,x:Re,y:Re,z:Re,perspective:Re,transformPerspective:Re,opacity:bc,originX:W2,originY:W2,originZ:Re},bx={borderWidth:Re,borderTopWidth:Re,borderRightWidth:Re,borderBottomWidth:Re,borderLeftWidth:Re,borderRadius:Re,radius:Re,borderTopLeftRadius:Re,borderTopRightRadius:Re,borderBottomRightRadius:Re,borderBottomLeftRadius:Re,width:Re,maxWidth:Re,height:Re,maxHeight:Re,top:Re,right:Re,bottom:Re,left:Re,padding:Re,paddingTop:Re,paddingRight:Re,paddingBottom:Re,paddingLeft:Re,margin:Re,marginTop:Re,marginRight:Re,marginBottom:Re,marginLeft:Re,backgroundPositionX:Re,backgroundPositionY:Re,...sz,zIndex:tC,fillOpacity:bc,strokeOpacity:bc,numOctaves:tC},lz={...bx,color:Gt,backgroundColor:Gt,outlineColor:Gt,fill:Gt,stroke:Gt,borderColor:Gt,borderTopColor:Gt,borderRightColor:Gt,borderBottomColor:Gt,borderLeftColor:Gt,filter:Jg,WebkitFilter:Jg},GR=e=>lz[e];function qR(e,t){let n=GR(e);return n!==Jg&&(n=pa),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const uz=new Set(["auto","none","0"]);function cz(e,t,n){let r=0,o;for(;r<e.length&&!o;){const i=e[r];typeof i=="string"&&!uz.has(i)&&wc(i).values.length&&(o=e[r]),r++}if(o&&n)for(const i of t)e[i]=qR(n,o)}class dz extends yx{constructor(t,n,r,o,i){super(t,n,r,o,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let u=t[l];if(typeof u=="string"&&(u=u.trim(),cx(u))){const c=WR(u,n.current);c!==void 0&&(t[l]=c),l===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!$R.has(r)||t.length!==2)return;const[o,i]=t,a=eC(o),s=eC(i);if(a!==s)if(Y2(a)&&Y2(s))for(let l=0;l<t.length;l++){const u=t[l];typeof u=="string"&&(t[l]=parseFloat(u))}else Ja[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let o=0;o<t.length;o++)(t[o]===null||rz(t[o]))&&r.push(o);r.length&&cz(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ja[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const o=n[n.length-1];o!==void 0&&t.getValue(r,o).jump(o,!1)}measureEndState(){var s;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const o=t.getValue(n);o&&o.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=Ja[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(s=this.removedTransforms)!=null&&s.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function fz(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){const o=document.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}const KR=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function XR(e){return cR(e)&&"offsetHeight"in e}const nC=30,hz=e=>!isNaN(parseFloat(e));class pz{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var i;const o=or.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=or.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=hz(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new sx);const r=this.events[t].add(n);return t==="change"?()=>{r(),Nt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=or.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>nC)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,nC);return fR(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,n;(t=this.dependents)==null||t.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Bl(e,t){return new pz(e,t)}const{schedule:wx,cancel:PY}=SR(queueMicrotask,!1),qr={x:!1,y:!1};function YR(){return qr.x||qr.y}function mz(e){return e==="x"||e==="y"?qr[e]?null:(qr[e]=!0,()=>{qr[e]=!1}):qr.x||qr.y?null:(qr.x=qr.y=!0,()=>{qr.x=qr.y=!1})}function QR(e,t){const n=fz(e),r=new AbortController,o={passive:!0,...t,signal:r.signal};return[n,o,()=>r.abort()]}function rC(e){return!(e.pointerType==="touch"||YR())}function vz(e,t,n={}){const[r,o,i]=QR(e,n),a=s=>{if(!rC(s))return;const{target:l}=s,u=t(l,s);if(typeof u!="function"||!l)return;const c=d=>{rC(d)&&(u(d),l.removeEventListener("pointerleave",c))};l.addEventListener("pointerleave",c,o)};return r.forEach(s=>{s.addEventListener("pointerenter",a,o)}),i}const ZR=(e,t)=>t?e===t?!0:ZR(e,t.parentElement):!1,Cx=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,gz=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function yz(e){return gz.has(e.tagName)||e.tabIndex!==-1}const Nf=new WeakSet;function oC(e){return t=>{t.key==="Enter"&&e(t)}}function Om(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const xz=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=oC(()=>{if(Nf.has(n))return;Om(n,"down");const o=oC(()=>{Om(n,"up")}),i=()=>Om(n,"cancel");n.addEventListener("keyup",o,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function iC(e){return Cx(e)&&!YR()}function bz(e,t,n={}){const[r,o,i]=QR(e,n),a=s=>{const l=s.currentTarget;if(!iC(s))return;Nf.add(l);const u=t(l,s),c=(h,v)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",f),Nf.has(l)&&Nf.delete(l),iC(h)&&typeof u=="function"&&u(h,{success:v})},d=h=>{c(h,l===window||l===document||n.useGlobalTarget||ZR(l,h.target))},f=h=>{c(h,!1)};window.addEventListener("pointerup",d,o),window.addEventListener("pointercancel",f,o)};return r.forEach(s=>{(n.useGlobalTarget?window:s).addEventListener("pointerdown",a,o),XR(s)&&(s.addEventListener("focus",u=>xz(u,o)),!yz(s)&&!s.hasAttribute("tabindex")&&(s.tabIndex=0))}),i}function JR(e){return cR(e)&&"ownerSVGElement"in e}function wz(e){return JR(e)&&e.tagName==="svg"}const jn=e=>!!(e&&e.getVelocity),Cz=[...HR,Gt,pa],Sz=e=>Cz.find(UR(e)),Sx=S.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function aC(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Ez(...e){return t=>{let n=!1;const r=e.map(o=>{const i=aC(o,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let o=0;o<r.length;o++){const i=r[o];typeof i=="function"?i():aC(e[o],null)}}}}function _z(...e){return S.useCallback(Ez(...e),e)}class kz extends S.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,o=XR(r)&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=o-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Nz({children:e,isPresent:t,anchorX:n,root:r}){const o=S.useId(),i=S.useRef(null),a=S.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:s}=S.useContext(Sx),l=_z(i,e==null?void 0:e.ref);return S.useInsertionEffect(()=>{const{width:u,height:c,top:d,left:f,right:h}=a.current;if(t||!i.current||!u||!c)return;const v=n==="left"?`left: ${f}`:`right: ${h}`;i.current.dataset.motionPopId=o;const g=document.createElement("style");s&&(g.nonce=s);const y=r??document.head;return y.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${c}px !important;
            ${v}px !important;
            top: ${d}px !important;
          }
        `),()=>{y.contains(g)&&y.removeChild(g)}},[t]),p.jsx(kz,{isPresent:t,childRef:i,sizeRef:a,children:S.cloneElement(e,{ref:l})})}const Tz=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:o,presenceAffectsLayout:i,mode:a,anchorX:s,root:l})=>{const u=nx(Rz),c=S.useId();let d=!0,f=S.useMemo(()=>(d=!1,{id:c,initial:t,isPresent:n,custom:o,onExitComplete:h=>{u.set(h,!0);for(const v of u.values())if(!v)return;r&&r()},register:h=>(u.set(h,!1),()=>u.delete(h))}),[n,u,r]);return i&&d&&(f={...f}),S.useMemo(()=>{u.forEach((h,v)=>u.set(v,!1))},[n]),S.useEffect(()=>{!n&&!u.size&&r&&r()},[n]),a==="popLayout"&&(e=p.jsx(Nz,{isPresent:n,anchorX:s,root:l,children:e})),p.jsx(yp.Provider,{value:f,children:e})};function Rz(){return new Map}function eP(e=!0){const t=S.useContext(yp);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:o}=t,i=S.useId();S.useEffect(()=>{if(e)return o(i)},[e]);const a=S.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const $d=e=>e.key||"";function sC(e){const t=[];return S.Children.forEach(e,n=>{S.isValidElement(n)&&t.push(n)}),t}const Cc=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:o=!0,mode:i="sync",propagate:a=!1,anchorX:s="left",root:l})=>{const[u,c]=eP(a),d=S.useMemo(()=>sC(e),[e]),f=a&&!u?[]:d.map($d),h=S.useRef(!0),v=S.useRef(d),g=nx(()=>new Map),[y,m]=S.useState(d),[x,b]=S.useState(d);lR(()=>{h.current=!1,v.current=d;for(let E=0;E<x.length;E++){const _=$d(x[E]);f.includes(_)?g.delete(_):g.get(_)!==!0&&g.set(_,!1)}},[x,f.length,f.join("-")]);const w=[];if(d!==y){let E=[...d];for(let _=0;_<x.length;_++){const N=x[_],T=$d(N);f.includes(T)||(E.splice(_,0,N),w.push(N))}return i==="wait"&&w.length&&(E=w),b(sC(E)),m(d),null}const{forceRender:C}=S.useContext(tx);return p.jsx(p.Fragment,{children:x.map(E=>{const _=$d(E),N=a&&!u?!1:d===x||f.includes(_),T=()=>{if(g.has(_))g.set(_,!0);else return;let k=!0;g.forEach(I=>{I||(k=!1)}),k&&(C==null||C(),b(v.current),a&&(c==null||c()),r&&r())};return p.jsx(Tz,{isPresent:N,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:o,mode:i,root:l,onExitComplete:N?void 0:T,anchorX:s,children:E},_)})})},tP=S.createContext({strict:!1}),lC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Vl={};for(const e in lC)Vl[e]={isEnabled:t=>lC[e].some(n=>!!t[n])};function Pz(e){for(const t in e)Vl[t]={...Vl[t],...e[t]}}const Az=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function mh(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Az.has(e)}let nP=e=>!mh(e);function Iz(e){typeof e=="function"&&(nP=t=>t.startsWith("on")?!mh(t):e(t))}try{Iz(require("@emotion/is-prop-valid").default)}catch{}function Mz(e,t,n){const r={};for(const o in e)o==="values"&&typeof e.values=="object"||(nP(o)||n===!0&&mh(o)||!t&&!mh(o)||e.draggable&&o.startsWith("onDrag"))&&(r[o]=e[o]);return r}const xp=S.createContext({});function bp(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Sc(e){return typeof e=="string"||Array.isArray(e)}const Ex=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],_x=["initial",...Ex];function wp(e){return bp(e.animate)||_x.some(t=>Sc(e[t]))}function rP(e){return!!(wp(e)||e.variants)}function Dz(e,t){if(wp(e)){const{initial:n,animate:r}=e;return{initial:n===!1||Sc(n)?n:void 0,animate:Sc(r)?r:void 0}}return e.inherit!==!1?t:{}}function jz(e){const{initial:t,animate:n}=Dz(e,S.useContext(xp));return S.useMemo(()=>({initial:t,animate:n}),[uC(t),uC(n)])}function uC(e){return Array.isArray(e)?e.join(" "):e}function cC(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const gu={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Re.test(e))e=parseFloat(e);else return e;const n=cC(e,t.target.x),r=cC(e,t.target.y);return`${n}% ${r}%`}},Fz={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,o=pa.parse(e);if(o.length>5)return r;const i=pa.createTransformer(e),a=typeof o[0]!="number"?1:0,s=n.x.scale*t.x,l=n.y.scale*t.y;o[0+a]/=s,o[1+a]/=l;const u=At(s,l,.5);return typeof o[2+a]=="number"&&(o[2+a]/=u),typeof o[3+a]=="number"&&(o[3+a]/=u),i(o)}},ey={borderRadius:{...gu,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:gu,borderTopRightRadius:gu,borderBottomLeftRadius:gu,borderBottomRightRadius:gu,boxShadow:Fz};function oP(e,{layout:t,layoutId:n}){return nu.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!ey[e]||e==="opacity")}const Oz={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Lz=tu.length;function Bz(e,t,n){let r="",o=!0;for(let i=0;i<Lz;i++){const a=tu[i],s=e[a];if(s===void 0)continue;let l=!0;if(typeof s=="number"?l=s===(a.startsWith("scale")?1:0):l=parseFloat(s)===0,!l||n){const u=KR(s,bx[a]);if(!l){o=!1;const c=Oz[a]||a;r+=`${c}(${u}) `}n&&(t[a]=u)}}return r=r.trim(),n?r=n(t,o?"":r):o&&(r="none"),r}function kx(e,t,n){const{style:r,vars:o,transformOrigin:i}=e;let a=!1,s=!1;for(const l in t){const u=t[l];if(nu.has(l)){a=!0;continue}else if(_R(l)){o[l]=u;continue}else{const c=KR(u,bx[l]);l.startsWith("origin")?(s=!0,i[l]=c):r[l]=c}}if(t.transform||(a||n?r.transform=Bz(t,e.transform,n):r.transform&&(r.transform="none")),s){const{originX:l="50%",originY:u="50%",originZ:c=0}=i;r.transformOrigin=`${l} ${u} ${c}`}}const Nx=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function iP(e,t,n){for(const r in t)!jn(t[r])&&!oP(r,n)&&(e[r]=t[r])}function Vz({transformTemplate:e},t){return S.useMemo(()=>{const n=Nx();return kx(n,t,e),Object.assign({},n.vars,n.style)},[t])}function zz(e,t){const n=e.style||{},r={};return iP(r,n,e),Object.assign(r,Vz(e,t)),r}function Wz(e,t){const n={},r=zz(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const $z={offset:"stroke-dashoffset",array:"stroke-dasharray"},Uz={offset:"strokeDashoffset",array:"strokeDasharray"};function Hz(e,t,n=1,r=0,o=!0){e.pathLength=1;const i=o?$z:Uz;e[i.offset]=Re.transform(-r);const a=Re.transform(t),s=Re.transform(n);e[i.array]=`${a} ${s}`}function aP(e,{attrX:t,attrY:n,attrScale:r,pathLength:o,pathSpacing:i=1,pathOffset:a=0,...s},l,u,c){if(kx(e,s,u),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:f}=e;d.transform&&(f.transform=d.transform,delete d.transform),(f.transform||d.transformOrigin)&&(f.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),f.transform&&(f.transformBox=(c==null?void 0:c.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),o!==void 0&&Hz(d,o,i,a,!1)}const sP=()=>({...Nx(),attrs:{}}),lP=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Gz(e,t,n,r){const o=S.useMemo(()=>{const i=sP();return aP(i,t,lP(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};iP(i,e.style,e),o.style={...i,...o.style}}return o}const qz=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Tx(e){return typeof e!="string"||e.includes("-")?!1:!!(qz.indexOf(e)>-1||/[A-Z]/u.test(e))}function Kz(e,t,n,{latestValues:r},o,i=!1){const s=(Tx(e)?Gz:Wz)(t,r,o,e),l=Mz(t,typeof e=="string",i),u=e!==S.Fragment?{...l,...s,ref:n}:{},{children:c}=t,d=S.useMemo(()=>jn(c)?c.get():c,[c]);return S.createElement(e,{...u,children:d})}function dC(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function Rx(e,t,n,r){if(typeof t=="function"){const[o,i]=dC(r);t=t(n!==void 0?n:e.custom,o,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[o,i]=dC(r);t=t(n!==void 0?n:e.custom,o,i)}return t}function Tf(e){return jn(e)?e.get():e}function Xz({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,o){return{latestValues:Yz(n,r,o,e),renderState:t()}}function Yz(e,t,n,r){const o={},i=r(e,{});for(const f in i)o[f]=Tf(i[f]);let{initial:a,animate:s}=e;const l=wp(e),u=rP(e);t&&u&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),s===void 0&&(s=t.animate));let c=n?n.initial===!1:!1;c=c||a===!1;const d=c?s:a;if(d&&typeof d!="boolean"&&!bp(d)){const f=Array.isArray(d)?d:[d];for(let h=0;h<f.length;h++){const v=Rx(e,f[h]);if(v){const{transitionEnd:g,transition:y,...m}=v;for(const x in m){let b=m[x];if(Array.isArray(b)){const w=c?b.length-1:0;b=b[w]}b!==null&&(o[x]=b)}for(const x in g)o[x]=g[x]}}}return o}const uP=e=>(t,n)=>{const r=S.useContext(xp),o=S.useContext(yp),i=()=>Xz(e,t,r,o);return n?i():nx(i)};function Px(e,t,n){var i;const{style:r}=e,o={};for(const a in r)(jn(r[a])||t.style&&jn(t.style[a])||oP(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(o[a]=r[a]);return o}const Qz=uP({scrapeMotionValuesFromProps:Px,createRenderState:Nx});function cP(e,t,n){const r=Px(e,t,n);for(const o in e)if(jn(e[o])||jn(t[o])){const i=tu.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;r[i]=e[o]}return r}const Zz=uP({scrapeMotionValuesFromProps:cP,createRenderState:sP}),Jz=Symbol.for("motionComponentSymbol");function Xs(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function eW(e,t,n){return S.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):Xs(n)&&(n.current=r))},[t])}const Ax=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),tW="framerAppearId",dP="data-"+Ax(tW),fP=S.createContext({});function nW(e,t,n,r,o){var g,y;const{visualElement:i}=S.useContext(xp),a=S.useContext(tP),s=S.useContext(yp),l=S.useContext(Sx).reducedMotion,u=S.useRef(null);r=r||a.renderer,!u.current&&r&&(u.current=r(e,{visualState:t,parent:i,props:n,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:l}));const c=u.current,d=S.useContext(fP);c&&!c.projection&&o&&(c.type==="html"||c.type==="svg")&&rW(u.current,n,o,d);const f=S.useRef(!1);S.useInsertionEffect(()=>{c&&f.current&&c.update(n,s)});const h=n[dP],v=S.useRef(!!h&&!((g=window.MotionHandoffIsComplete)!=null&&g.call(window,h))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,h)));return lR(()=>{c&&(f.current=!0,window.MotionIsMounted=!0,c.updateFeatures(),c.scheduleRenderMicrotask(),v.current&&c.animationState&&c.animationState.animateChanges())}),S.useEffect(()=>{c&&(!v.current&&c.animationState&&c.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var m;(m=window.MotionHandoffMarkAsComplete)==null||m.call(window,h)}),v.current=!1),c.enteringChildren=void 0)}),c}function rW(e,t,n,r){const{layoutId:o,layout:i,drag:a,dragConstraints:s,layoutScroll:l,layoutRoot:u,layoutCrossfade:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:hP(e.parent)),e.projection.setOptions({layoutId:o,layout:i,alwaysMeasureLayout:!!a||s&&Xs(s),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:c,layoutScroll:l,layoutRoot:u})}function hP(e){if(e)return e.options.allowProjection!==!1?e.projection:hP(e.parent)}function Lm(e,{forwardMotionProps:t=!1}={},n,r){n&&Pz(n);const o=Tx(e)?Zz:Qz;function i(s,l){let u;const c={...S.useContext(Sx),...s,layoutId:oW(s)},{isStatic:d}=c,f=jz(s),h=o(s,d);if(!d&&rx){iW();const v=aW(c);u=v.MeasureLayout,f.visualElement=nW(e,h,c,r,v.ProjectionNode)}return p.jsxs(xp.Provider,{value:f,children:[u&&f.visualElement?p.jsx(u,{visualElement:f.visualElement,...c}):null,Kz(e,s,eW(h,f.visualElement,l),h,d,t)]})}i.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const a=S.forwardRef(i);return a[Jz]=e,a}function oW({layoutId:e}){const t=S.useContext(tx).id;return t&&e!==void 0?t+"-"+e:e}function iW(e,t){S.useContext(tP).strict}function aW(e){const{drag:t,layout:n}=Vl;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function sW(e,t){if(typeof Proxy>"u")return Lm;const n=new Map,r=(i,a)=>Lm(i,a,e,t),o=(i,a)=>r(i,a);return new Proxy(o,{get:(i,a)=>a==="create"?r:(n.has(a)||n.set(a,Lm(a,void 0,e,t)),n.get(a))})}function pP({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function lW({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function uW(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Bm(e){return e===void 0||e===1}function ty({scale:e,scaleX:t,scaleY:n}){return!Bm(e)||!Bm(t)||!Bm(n)}function Ta(e){return ty(e)||mP(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function mP(e){return fC(e.x)||fC(e.y)}function fC(e){return e&&e!=="0%"}function vh(e,t,n){const r=e-n,o=t*r;return n+o}function hC(e,t,n,r,o){return o!==void 0&&(e=vh(e,o,r)),vh(e,n,r)+t}function ny(e,t=0,n=1,r,o){e.min=hC(e.min,t,n,r,o),e.max=hC(e.max,t,n,r,o)}function vP(e,{x:t,y:n}){ny(e.x,t.translate,t.scale,t.originPoint),ny(e.y,n.translate,n.scale,n.originPoint)}const pC=.999999999999,mC=1.0000000000001;function cW(e,t,n,r=!1){const o=n.length;if(!o)return;t.x=t.y=1;let i,a;for(let s=0;s<o;s++){i=n[s],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Qs(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,vP(e,a)),r&&Ta(i.latestValues)&&Qs(e,i.latestValues))}t.x<mC&&t.x>pC&&(t.x=1),t.y<mC&&t.y>pC&&(t.y=1)}function Ys(e,t){e.min=e.min+t,e.max=e.max+t}function vC(e,t,n,r,o=.5){const i=At(e.min,e.max,o);ny(e,t,n,i,r)}function Qs(e,t){vC(e.x,t.x,t.scaleX,t.scale,t.originX),vC(e.y,t.y,t.scaleY,t.scale,t.originY)}function gP(e,t){return pP(uW(e.getBoundingClientRect(),t))}function dW(e,t,n){const r=gP(e,n),{scroll:o}=t;return o&&(Ys(r.x,o.offset.x),Ys(r.y,o.offset.y)),r}const gC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Zs=()=>({x:gC(),y:gC()}),yC=()=>({min:0,max:0}),Yt=()=>({x:yC(),y:yC()}),ry={current:null},yP={current:!1};function fW(){if(yP.current=!0,!!rx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ry.current=e.matches;e.addEventListener("change",t),t()}else ry.current=!1}const hW=new WeakMap;function pW(e,t,n){for(const r in t){const o=t[r],i=n[r];if(jn(o))e.addValue(r,o);else if(jn(i))e.addValue(r,Bl(o,{owner:e}));else if(i!==o)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(o):a.hasAnimated||a.set(o)}else{const a=e.getStaticValue(r);e.addValue(r,Bl(a!==void 0?a:o,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const xC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class mW{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:o,blockInitialAnimation:i,visualState:a},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=yx,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=or.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Nt.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=s,this.blockInitialAnimation=!!i,this.isControllingVariants=wp(n),this.isVariantNode=rP(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in d){const h=d[f];l[f]!==void 0&&jn(h)&&h.set(l[f])}}mount(t){var n;this.current=t,hW.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,o)=>this.bindToMotionValue(o,r)),yP.current||fW(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ry.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),ha(this.notifyUpdate),ha(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const r=this.features[n];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=nu.has(t);r&&this.onBindTransform&&this.onBindTransform();const o=n.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&Nt.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{o(),i&&i(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Vl){const n=Vl[t];if(!n)continue;const{isEnabled:r,Feature:o}=n;if(!this.features[t]&&o&&r(this.props)&&(this.features[t]=new o(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Yt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<xC.length;r++){const o=xC[r];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const i="on"+o,a=t[i];a&&(this.propEventSubscriptions[o]=this.on(o,a))}this.prevMotionValues=pW(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Bl(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(uR(r)||dR(r))?r=parseFloat(r):!Sz(r)&&pa.test(n)&&(r=qR(t,n)),this.setBaseTarget(t,jn(r)?r.get():r)),jn(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=Rx(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!jn(o)?o:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new sx),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){wx.render(this.render)}}class xP extends mW{constructor(){super(...arguments),this.KeyframeResolver=dz}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;jn(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function bP(e,{style:t,vars:n},r,o){const i=e.style;let a;for(a in t)i[a]=t[a];o==null||o.applyProjectionStyles(i,r);for(a in n)i.setProperty(a,n[a])}function vW(e){return window.getComputedStyle(e)}class gW extends xP{constructor(){super(...arguments),this.type="html",this.renderInstance=bP}readValueFromInstance(t,n){var r;if(nu.has(n))return(r=this.projection)!=null&&r.isProjecting?qg(n):P6(t,n);{const o=vW(t),i=(_R(n)?o.getPropertyValue(n):o[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:n}){return gP(t,n)}build(t,n,r){kx(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return Px(t,n,r)}}const wP=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function yW(e,t,n,r){bP(e,t,void 0,r);for(const o in t.attrs)e.setAttribute(wP.has(o)?o:Ax(o),t.attrs[o])}class xW extends xP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Yt}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(nu.has(n)){const r=GR(n);return r&&r.default||0}return n=wP.has(n)?n:Ax(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return cP(t,n,r)}build(t,n,r){aP(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,o){yW(t,n,r,o)}mount(t){this.isSVGTag=lP(t.tagName),super.mount(t)}}const bW=(e,t)=>Tx(e)?new xW(t):new gW(t,{allowProjection:e!==S.Fragment});function ul(e,t,n){const r=e.getProps();return Rx(r,t,n!==void 0?n:r.custom,e)}const oy=e=>Array.isArray(e);function wW(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Bl(n))}function CW(e){return oy(e)?e[e.length-1]||0:e}function SW(e,t){const n=ul(e,t);let{transitionEnd:r={},transition:o={},...i}=n||{};i={...i,...r};for(const a in i){const s=CW(i[a]);wW(e,a,s)}}function EW(e){return!!(jn(e)&&e.add)}function iy(e,t){const n=e.getValue("willChange");if(EW(n))return n.add(t);if(!n&&pi.WillChange){const r=new pi.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function CP(e){return e.props[dP]}const _W=e=>e!==null;function kW(e,{repeat:t,repeatType:n="loop"},r){const o=e.filter(_W),i=t&&n!=="loop"&&t%2===1?0:o.length-1;return!i||r===void 0?o[i]:r}const NW={type:"spring",stiffness:500,damping:25,restSpeed:10},TW=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),RW={type:"keyframes",duration:.8},PW={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},AW=(e,{keyframes:t})=>t.length>2?RW:nu.has(e)?e.startsWith("scale")?TW(t[1]):NW:PW;function IW({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:o,repeat:i,repeatType:a,repeatDelay:s,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const Ix=(e,t,n,r={},o,i)=>a=>{const s=xx(r,e)||{},l=s.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Mo(l);const c={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...s,delay:-u,onUpdate:f=>{t.set(f),s.onUpdate&&s.onUpdate(f)},onComplete:()=>{a(),s.onComplete&&s.onComplete()},name:e,motionValue:t,element:i?void 0:o};IW(s)||Object.assign(c,AW(e,c)),c.duration&&(c.duration=Mo(c.duration)),c.repeatDelay&&(c.repeatDelay=Mo(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let d=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(Zg(c),c.delay===0&&(d=!0)),(pi.instantAnimations||pi.skipAnimations)&&(d=!0,Zg(c),c.delay=0),c.allowFlatten=!s.type&&!s.ease,d&&!i&&t.get()!==void 0){const f=kW(c.keyframes,s);if(f!==void 0){Nt.update(()=>{c.onUpdate(f),c.onComplete()});return}}return s.isSync?new gx(c):new J6(c)};function MW({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function SP(e,t,{delay:n=0,transitionOverride:r,type:o}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...s}=t;r&&(i=r);const l=[],u=o&&e.animationState&&e.animationState.getState()[o];for(const c in s){const d=e.getValue(c,e.latestValues[c]??null),f=s[c];if(f===void 0||u&&MW(u,c))continue;const h={delay:n,...xx(i||{},c)},v=d.get();if(v!==void 0&&!d.isAnimating&&!Array.isArray(f)&&f===v&&!h.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const m=CP(e);if(m){const x=window.MotionHandoffAnimation(m,c,Nt);x!==null&&(h.startTime=x,g=!0)}}iy(e,c),d.start(Ix(c,d,f,e.shouldReduceMotion&&$R.has(c)?{type:!1}:h,e,g));const y=d.animation;y&&l.push(y)}return a&&Promise.all(l).then(()=>{Nt.update(()=>{a&&SW(e,a)})}),l}function EP(e,t,n,r=0,o=1){const i=Array.from(e).sort((u,c)=>u.sortNodePosition(c)).indexOf(t),a=e.size,s=(a-1)*r;return typeof n=="function"?n(i,a):o===1?i*r:s-i*r}function ay(e,t,n={}){var l;const r=ul(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(o=n.transitionOverride);const i=r?()=>Promise.all(SP(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:d,staggerDirection:f}=o;return DW(e,t,u,c,d,f,n)}:()=>Promise.resolve(),{when:s}=o;if(s){const[u,c]=s==="beforeChildren"?[i,a]:[a,i];return u().then(()=>c())}else return Promise.all([i(),a(n.delay)])}function DW(e,t,n=0,r=0,o=0,i=1,a){const s=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),s.push(ay(l,t,{...a,delay:n+(typeof r=="function"?0:r)+EP(e.variantChildren,l,r,o,i)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(s)}function jW(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const o=t.map(i=>ay(e,i,n));r=Promise.all(o)}else if(typeof t=="string")r=ay(e,t,n);else{const o=typeof t=="function"?ul(e,t,n.custom):t;r=Promise.all(SP(e,o,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function _P(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const FW=_x.length;function kP(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?kP(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<FW;n++){const r=_x[n],o=e.props[r];(Sc(o)||o===!1)&&(t[r]=o)}return t}const OW=[...Ex].reverse(),LW=Ex.length;function BW(e){return t=>Promise.all(t.map(({animation:n,options:r})=>jW(e,n,r)))}function VW(e){let t=BW(e),n=bC(),r=!0;const o=l=>(u,c)=>{var f;const d=ul(e,c,l==="exit"?(f=e.presenceContext)==null?void 0:f.custom:void 0);if(d){const{transition:h,transitionEnd:v,...g}=d;u={...u,...g,...v}}return u};function i(l){t=l(e)}function a(l){const{props:u}=e,c=kP(e.parent)||{},d=[],f=new Set;let h={},v=1/0;for(let y=0;y<LW;y++){const m=OW[y],x=n[m],b=u[m]!==void 0?u[m]:c[m],w=Sc(b),C=m===l?x.isActive:null;C===!1&&(v=y);let E=b===c[m]&&b!==u[m]&&w;if(E&&r&&e.manuallyAnimateOnMount&&(E=!1),x.protectedKeys={...h},!x.isActive&&C===null||!b&&!x.prevProp||bp(b)||typeof b=="boolean")continue;const _=zW(x.prevProp,b);let N=_||m===l&&x.isActive&&!E&&w||y>v&&w,T=!1;const k=Array.isArray(b)?b:[b];let I=k.reduce(o(m),{});C===!1&&(I={});const{prevResolvedValues:A={}}=x,U={...A,...I},B=F=>{N=!0,f.has(F)&&(T=!0,f.delete(F)),x.needsAnimating[F]=!0;const M=e.getValue(F);M&&(M.liveStyle=!1)};for(const F in U){const M=I[F],j=A[F];if(h.hasOwnProperty(F))continue;let R=!1;oy(M)&&oy(j)?R=!_P(M,j):R=M!==j,R?M!=null?B(F):f.add(F):M!==void 0&&f.has(F)?B(F):x.protectedKeys[F]=!0}x.prevProp=b,x.prevResolvedValues=I,x.isActive&&(h={...h,...I}),r&&e.blockInitialAnimation&&(N=!1);const L=E&&_;N&&(!L||T)&&d.push(...k.map(F=>{const M={type:m};if(typeof F=="string"&&r&&!L&&e.manuallyAnimateOnMount&&e.parent){const{parent:j}=e,R=ul(j,F);if(j.enteringChildren&&R){const{delayChildren:P}=R.transition||{};M.delay=EP(j.enteringChildren,e,P)}}return{animation:F,options:M}}))}if(f.size){const y={};if(typeof u.initial!="boolean"){const m=ul(e,Array.isArray(u.initial)?u.initial[0]:u.initial);m&&m.transition&&(y.transition=m.transition)}f.forEach(m=>{const x=e.getBaseTarget(m),b=e.getValue(m);b&&(b.liveStyle=!0),y[m]=x??null}),d.push({animation:y})}let g=!!d.length;return r&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(g=!1),r=!1,g?t(d):Promise.resolve()}function s(l,u){var d;if(n[l].isActive===u)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(f=>{var h;return(h=f.animationState)==null?void 0:h.setActive(l,u)}),n[l].isActive=u;const c=a(l);for(const f in n)n[f].protectedKeys={};return c}return{animateChanges:a,setActive:s,setAnimateFunction:i,getState:()=>n,reset:()=>{n=bC()}}}function zW(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!_P(t,e):!1}function Ea(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function bC(){return{animate:Ea(!0),whileInView:Ea(),whileHover:Ea(),whileTap:Ea(),whileDrag:Ea(),whileFocus:Ea(),exit:Ea()}}class ba{constructor(t){this.isMounted=!1,this.node=t}update(){}}class WW extends ba{constructor(t){super(t),t.animationState||(t.animationState=VW(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();bp(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let $W=0;class UW extends ba{constructor(){super(...arguments),this.id=$W++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const o=this.node.animationState.setActive("exit",!t);n&&!t&&o.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const HW={animation:{Feature:WW},exit:{Feature:UW}};function Ec(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function Yc(e){return{point:{x:e.pageX,y:e.pageY}}}const GW=e=>t=>Cx(t)&&e(t,Yc(t));function Uu(e,t,n,r){return Ec(e,t,GW(n),r)}const NP=1e-4,qW=1-NP,KW=1+NP,TP=.01,XW=0-TP,YW=0+TP;function $n(e){return e.max-e.min}function QW(e,t,n){return Math.abs(e-t)<=n}function wC(e,t,n,r=.5){e.origin=r,e.originPoint=At(t.min,t.max,e.origin),e.scale=$n(n)/$n(t),e.translate=At(n.min,n.max,e.origin)-e.originPoint,(e.scale>=qW&&e.scale<=KW||isNaN(e.scale))&&(e.scale=1),(e.translate>=XW&&e.translate<=YW||isNaN(e.translate))&&(e.translate=0)}function Hu(e,t,n,r){wC(e.x,t.x,n.x,r?r.originX:void 0),wC(e.y,t.y,n.y,r?r.originY:void 0)}function CC(e,t,n){e.min=n.min+t.min,e.max=e.min+$n(t)}function ZW(e,t,n){CC(e.x,t.x,n.x),CC(e.y,t.y,n.y)}function SC(e,t,n){e.min=t.min-n.min,e.max=e.min+$n(t)}function gh(e,t,n){SC(e.x,t.x,n.x),SC(e.y,t.y,n.y)}function Tr(e){return[e("x"),e("y")]}const RP=({current:e})=>e?e.ownerDocument.defaultView:null,EC=(e,t)=>Math.abs(e-t);function JW(e,t){const n=EC(e.x,t.x),r=EC(e.y,t.y);return Math.sqrt(n**2+r**2)}class PP{constructor(t,n,{transformPagePoint:r,contextWindow:o=window,dragSnapToOrigin:i=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=zm(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,v=JW(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!h&&!v)return;const{point:g}=f,{timestamp:y}=gn;this.history.push({...g,timestamp:y});const{onStart:m,onMove:x}=this.handlers;h||(m&&m(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Vm(h,this.transformPagePoint),Nt.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:v,onSessionEnd:g,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=zm(f.type==="pointercancel"?this.lastMoveEventInfo:Vm(h,this.transformPagePoint),this.history);this.startEvent&&v&&v(f,m),g&&g(f,m)},!Cx(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=a,this.contextWindow=o||window;const s=Yc(t),l=Vm(s,this.transformPagePoint),{point:u}=l,{timestamp:c}=gn;this.history=[{...u,timestamp:c}];const{onSessionStart:d}=n;d&&d(t,zm(l,this.history)),this.removeListeners=qc(Uu(this.contextWindow,"pointermove",this.handlePointerMove),Uu(this.contextWindow,"pointerup",this.handlePointerUp),Uu(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ha(this.updatePoint)}}function Vm(e,t){return t?{point:t(e.point)}:e}function _C(e,t){return{x:e.x-t.x,y:e.y-t.y}}function zm({point:e},t){return{point:e,delta:_C(e,AP(t)),offset:_C(e,e$(t)),velocity:t$(t,.1)}}function e$(e){return e[0]}function AP(e){return e[e.length-1]}function t$(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const o=AP(e);for(;n>=0&&(r=e[n],!(o.timestamp-r.timestamp>Mo(t)));)n--;if(!r)return{x:0,y:0};const i=Fr(o.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(o.x-r.x)/i,y:(o.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function n$(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?At(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?At(n,e,r.max):Math.min(e,n)),e}function kC(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function r$(e,{top:t,left:n,bottom:r,right:o}){return{x:kC(e.x,n,o),y:kC(e.y,t,r)}}function NC(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function o$(e,t){return{x:NC(e.x,t.x),y:NC(e.y,t.y)}}function i$(e,t){let n=.5;const r=$n(e),o=$n(t);return o>r?n=xc(t.min,t.max-r,e.min):r>o&&(n=xc(e.min,e.max-o,t.min)),hi(0,1,n)}function a$(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const sy=.35;function s$(e=sy){return e===!1?e=0:e===!0&&(e=sy),{x:TC(e,"left","right"),y:TC(e,"top","bottom")}}function TC(e,t,n){return{min:RC(e,t),max:RC(e,n)}}function RC(e,t){return typeof e=="number"?e:e[t]||0}const l$=new WeakMap;class u${constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Yt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const i=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Yc(d).point)},a=(d,f)=>{const{drag:h,dragPropagation:v,onDragStart:g}=this.getProps();if(h&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=mz(h),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Tr(m=>{let x=this.getAxisMotionValue(m).get()||0;if(Do.test(x)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[m];w&&(x=$n(w)*(parseFloat(x)/100))}}this.originPoint[m]=x}),g&&Nt.postRender(()=>g(d,f)),iy(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},s=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f;const{dragPropagation:h,dragDirectionLock:v,onDirectionLock:g,onDrag:y}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:m}=f;if(v&&this.currentDirection===null){this.currentDirection=c$(m),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,m),this.updateAxis("y",f.point,m),this.visualElement.render(),y&&y(d,f)},l=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f,this.stop(d,f),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>Tr(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)==null?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new PP(t,{onSessionStart:i,onStart:a,onMove:s,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:r,contextWindow:RP(this.visualElement)})}stop(t,n){const r=t||this.latestPointerEvent,o=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!o||!r)return;const{velocity:a}=o;this.startAnimation(a);const{onDragEnd:s}=this.getProps();s&&Nt.postRender(()=>s(r,o))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:o}=this.getProps();if(!r||!Ud(t,o,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=n$(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,o=this.constraints;t&&Xs(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=r$(r.layoutBox,t):this.constraints=!1,this.elastic=s$(n),o!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Tr(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=a$(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Xs(t))return!1;const r=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const i=dW(r,o.root,this.visualElement.getTransformPagePoint());let a=o$(o.layout.layoutBox,i);if(n){const s=n(lW(a));this.hasMutatedConstraints=!!s,s&&(a=pP(s))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:o,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:s}=this.getProps(),l=this.constraints||{},u=Tr(c=>{if(!Ud(c,n,this.currentDirection))return;let d=l&&l[c]||{};a&&(d={min:0,max:0});const f=o?200:1e6,h=o?40:1e7,v={type:"inertia",velocity:r?t[c]:0,bounceStiffness:f,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(c,v)});return Promise.all(u).then(s)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return iy(this.visualElement,t),r.start(Ix(t,r,0,n,this.visualElement,!1))}stopAnimation(){Tr(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Tr(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),o=r[n];return o||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Tr(n=>{const{drag:r}=this.getProps();if(!Ud(n,r,this.currentDirection))return;const{projection:o}=this.visualElement,i=this.getAxisMotionValue(n);if(o&&o.layout){const{min:a,max:s}=o.layout.layoutBox[n];i.set(t[n]-At(a,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Xs(n)||!r||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Tr(a=>{const s=this.getAxisMotionValue(a);if(s&&this.constraints!==!1){const l=s.get();o[a]=i$({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Tr(a=>{if(!Ud(a,t,null))return;const s=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];s.set(At(l,u,o[a]))})}addListeners(){if(!this.visualElement.current)return;l$.set(this.visualElement,this);const t=this.visualElement.current,n=Uu(t,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Xs(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,i=o.addEventListener("measure",r);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),Nt.read(r);const a=Ec(window,"resize",()=>this.scalePositionWithinConstraints()),s=o.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Tr(c=>{const d=this.getAxisMotionValue(c);d&&(this.originPoint[c]+=l[c].translate,d.set(d.get()+l[c].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),s&&s()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:o=!1,dragConstraints:i=!1,dragElastic:a=sy,dragMomentum:s=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:o,dragConstraints:i,dragElastic:a,dragMomentum:s}}}function Ud(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function c$(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class d$ extends ba{constructor(t){super(t),this.removeGroupControls=Br,this.removeListeners=Br,this.controls=new u$(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Br}unmount(){this.removeGroupControls(),this.removeListeners()}}const PC=e=>(t,n)=>{e&&Nt.postRender(()=>e(t,n))};class f$ extends ba{constructor(){super(...arguments),this.removePointerDownListener=Br}onPointerDown(t){this.session=new PP(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:RP(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:o}=this.node.getProps();return{onSessionStart:PC(t),onStart:PC(n),onMove:r,onEnd:(i,a)=>{delete this.session,o&&Nt.postRender(()=>o(i,a))}}}mount(){this.removePointerDownListener=Uu(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Rf={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let Wm=!1;class h$ extends S.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:o}=this.props,{projection:i}=t;i&&(n.group&&n.group.add(i),r&&r.register&&o&&r.register(i),Wm&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Rf.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:o,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,Wm=!0,o||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||Nt.postRender(()=>{const s=a.getStack();(!s||!s.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),wx.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:o}=t;Wm=!0,o&&(o.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(o),r&&r.deregister&&r.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function IP(e){const[t,n]=eP(),r=S.useContext(tx);return p.jsx(h$,{...e,layoutGroup:r,switchLayoutGroup:S.useContext(fP),isPresent:t,safeToRemove:n})}function p$(e,t,n){const r=jn(e)?e:Bl(e);return r.start(Ix("",r,t,n)),r.animation}const m$=(e,t)=>e.depth-t.depth;class v${constructor(){this.children=[],this.isDirty=!1}add(t){ox(this.children,t),this.isDirty=!0}remove(t){ix(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(m$),this.isDirty=!1,this.children.forEach(t)}}function g$(e,t){const n=or.now(),r=({timestamp:o})=>{const i=o-n;i>=t&&(ha(r),e(i-t))};return Nt.setup(r,!0),()=>ha(r)}const MP=["TopLeft","TopRight","BottomLeft","BottomRight"],y$=MP.length,AC=e=>typeof e=="string"?parseFloat(e):e,IC=e=>typeof e=="number"||Re.test(e);function x$(e,t,n,r,o,i){o?(e.opacity=At(0,n.opacity??1,b$(r)),e.opacityExit=At(t.opacity??1,0,w$(r))):i&&(e.opacity=At(t.opacity??1,n.opacity??1,r));for(let a=0;a<y$;a++){const s=`border${MP[a]}Radius`;let l=MC(t,s),u=MC(n,s);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||IC(l)===IC(u)?(e[s]=Math.max(At(AC(l),AC(u),r),0),(Do.test(u)||Do.test(l))&&(e[s]+="%")):e[s]=u}(t.rotate||n.rotate)&&(e.rotate=At(t.rotate||0,n.rotate||0,r))}function MC(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const b$=DP(0,.5,xR),w$=DP(.5,.95,Br);function DP(e,t,n){return r=>r<e?0:r>t?1:n(xc(e,t,r))}function DC(e,t){e.min=t.min,e.max=t.max}function Gr(e,t){DC(e.x,t.x),DC(e.y,t.y)}function jC(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function FC(e,t,n,r,o){return e-=t,e=vh(e,1/n,r),o!==void 0&&(e=vh(e,1/o,r)),e}function C$(e,t=0,n=1,r=.5,o,i=e,a=e){if(Do.test(t)&&(t=parseFloat(t),t=At(a.min,a.max,t/100)-a.min),typeof t!="number")return;let s=At(i.min,i.max,r);e===i&&(s-=t),e.min=FC(e.min,t,n,s,o),e.max=FC(e.max,t,n,s,o)}function OC(e,t,[n,r,o],i,a){C$(e,t[n],t[r],t[o],t.scale,i,a)}const S$=["x","scaleX","originX"],E$=["y","scaleY","originY"];function LC(e,t,n,r){OC(e.x,t,S$,n?n.x:void 0,r?r.x:void 0),OC(e.y,t,E$,n?n.y:void 0,r?r.y:void 0)}function BC(e){return e.translate===0&&e.scale===1}function jP(e){return BC(e.x)&&BC(e.y)}function VC(e,t){return e.min===t.min&&e.max===t.max}function _$(e,t){return VC(e.x,t.x)&&VC(e.y,t.y)}function zC(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function FP(e,t){return zC(e.x,t.x)&&zC(e.y,t.y)}function WC(e){return $n(e.x)/$n(e.y)}function $C(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class k${constructor(){this.members=[]}add(t){ox(this.members,t),t.scheduleRender()}remove(t){if(ix(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(o=>t===o);if(n===0)return!1;let r;for(let o=n;o>=0;o--){const i=this.members[o];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function N$(e,t,n){let r="";const o=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((o||i||a)&&(r=`translate3d(${o}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:u,rotate:c,rotateX:d,rotateY:f,skewX:h,skewY:v}=n;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),d&&(r+=`rotateX(${d}deg) `),f&&(r+=`rotateY(${f}deg) `),h&&(r+=`skewX(${h}deg) `),v&&(r+=`skewY(${v}deg) `)}const s=e.x.scale*t.x,l=e.y.scale*t.y;return(s!==1||l!==1)&&(r+=`scale(${s}, ${l})`),r||"none"}const $m=["","X","Y","Z"],T$=1e3;let R$=0;function Um(e,t,n,r){const{latestValues:o}=t;o[e]&&(n[e]=o[e],t.setStaticValue(e,0),r&&(r[e]=0))}function OP(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=CP(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:o,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Nt,!(o||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&OP(r)}function LP({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:o}){return class{constructor(a={},s=t==null?void 0:t()){this.id=R$++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(I$),this.nodes.forEach(F$),this.nodes.forEach(O$),this.nodes.forEach(M$)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new v$)}addEventListener(a,s){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new sx),this.eventHandlers.get(a).add(s)}notifyListeners(a,...s){const l=this.eventHandlers.get(a);l&&l.notify(...s)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=JR(a)&&!wz(a),this.instance=a;const{layoutId:s,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||s)&&(this.isLayoutDirty=!0),e){let c,d=0;const f=()=>this.root.updateBlockedByResize=!1;Nt.read(()=>{d=window.innerWidth}),e(a,()=>{const h=window.innerWidth;h!==d&&(d=h,this.root.updateBlockedByResize=!0,c&&c(),c=g$(f,250),Rf.hasAnimatedSinceResize&&(Rf.hasAnimatedSinceResize=!1,this.nodes.forEach(GC)))})}s&&this.root.registerSharedNode(s,this),this.options.animate!==!1&&u&&(s||l)&&this.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d,hasRelativeLayoutChanged:f,layout:h})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||u.getDefaultTransition()||W$,{onLayoutAnimationStart:g,onLayoutAnimationComplete:y}=u.getProps(),m=!this.targetLayout||!FP(this.targetLayout,h),x=!d&&f;if(this.options.layoutRoot||this.resumeFrom||x||d&&(m||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const b={...xx(v,"layout"),onPlay:g,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(c,x)}else d||GC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=h})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ha(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(L$),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&OP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const d=this.path[c];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:s,layout:l}=this.options;if(s===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(UC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(HC);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(j$),this.nodes.forEach(P$),this.nodes.forEach(A$)):this.nodes.forEach(HC),this.clearAllSnapshots();const s=or.now();gn.delta=hi(0,1e3/60,s-gn.timestamp),gn.timestamp=s,gn.isProcessing=!0,Im.update.process(gn),Im.preRender.process(gn),Im.render.process(gn),gn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,wx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(D$),this.sharedNodes.forEach(B$)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!$n(this.snapshot.measuredBox.x)&&!$n(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Yt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:s}=this.options;s&&s.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let s=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(s=!1),s&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!o)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,s=this.projectionDelta&&!jP(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;a&&this.instance&&(s||Ta(this.latestValues)||c)&&(o(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const s=this.measurePageBox();let l=this.removeElementScroll(s);return a&&(l=this.removeTransform(l)),$$(l),{animationId:this.root.animationId,measuredBox:s,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:a}=this.options;if(!a)return Yt();const s=a.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(U$))){const{scroll:c}=this.root;c&&(Ys(s.x,c.offset.x),Ys(s.y,c.offset.y))}return s}removeElementScroll(a){var l;const s=Yt();if(Gr(s,a),(l=this.scroll)!=null&&l.wasRoot)return s;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:d,options:f}=c;c!==this.root&&d&&f.layoutScroll&&(d.wasRoot&&Gr(s,a),Ys(s.x,d.offset.x),Ys(s.y,d.offset.y))}return s}applyTransform(a,s=!1){const l=Yt();Gr(l,a);for(let u=0;u<this.path.length;u++){const c=this.path[u];!s&&c.options.layoutScroll&&c.scroll&&c!==c.root&&Qs(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),Ta(c.latestValues)&&Qs(l,c.latestValues)}return Ta(this.latestValues)&&Qs(l,this.latestValues),l}removeTransform(a){const s=Yt();Gr(s,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Ta(u.latestValues))continue;ty(u.latestValues)&&u.updateSnapshot();const c=Yt(),d=u.measurePageBox();Gr(c,d),LC(s,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return Ta(this.latestValues)&&LC(s,this.latestValues),s}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==gn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==s;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:c,layoutId:d}=this.options;if(!this.layout||!(c||d))return;this.resolvedRelativeTargetAt=gn.timestamp;const f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Yt(),this.targetWithTransforms=Yt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ZW(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Gr(this.target,this.layout.layoutBox),vP(this.target,this.targetDelta)):Gr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||ty(this.parent.latestValues)||mP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(a,s,l){this.relativeParent=a,this.linkedParentVersion=a.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Yt(),this.relativeTargetOrigin=Yt(),gh(this.relativeTargetOrigin,s,l),Gr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var v;const a=this.getLead(),s=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty)&&(l=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===gn.timestamp&&(l=!1),l)return;const{layout:u,layoutId:c}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||c))return;Gr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;cW(this.layoutCorrected,this.treeScale,this.path,s),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Yt());const{target:h}=a;if(!h){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(jC(this.prevProjectionDelta.x,this.projectionDelta.x),jC(this.prevProjectionDelta.y,this.projectionDelta.y)),Hu(this.projectionDelta,this.layoutCorrected,h,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!$C(this.projectionDelta.x,this.prevProjectionDelta.x)||!$C(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",h))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var s;if((s=this.options.visualElement)==null||s.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Zs(),this.projectionDelta=Zs(),this.projectionDeltaWithTransform=Zs()}setAnimationOrigin(a,s=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},d=Zs();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!s;const f=Yt(),h=l?l.source:void 0,v=this.layout?this.layout.source:void 0,g=h!==v,y=this.getStack(),m=!y||y.members.length<=1,x=!!(g&&!m&&this.options.crossfade===!0&&!this.path.some(z$));this.animationProgress=0;let b;this.mixTargetDelta=w=>{const C=w/1e3;qC(d.x,a.x,C),qC(d.y,a.y,C),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(gh(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),V$(this.relativeTarget,this.relativeTargetOrigin,f,C),b&&_$(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Yt()),Gr(b,this.relativeTarget)),g&&(this.animationValues=c,x$(c,u,this.latestValues,C,x,m)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var s,l,u;this.notifyListeners("animationStart"),(s=this.currentAnimation)==null||s.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(ha(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nt.update(()=>{Rf.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Bl(0)),this.currentAnimation=p$(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),a.onUpdate&&a.onUpdate(c)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(T$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:s,target:l,layout:u,latestValues:c}=a;if(!(!s||!l||!u)){if(this!==a&&this.layout&&u&&BP(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Yt();const d=$n(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const f=$n(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+f}Gr(s,l),Qs(s,c),Hu(this.projectionDeltaWithTransform,this.layoutCorrected,s,c)}}registerSharedNode(a,s){this.sharedNodes.has(a)||this.sharedNodes.set(a,new k$),this.sharedNodes.get(a).add(s);const u=s.options.initialPromotionConfig;s.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(s):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var s;const{layoutId:a}=this.options;return a?((s=this.getStack())==null?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:a}=this.options;return a?(s=this.getStack())==null?void 0:s.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:s,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),s&&this.setOptions({transition:s})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let s=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(s=!0),!s)return;const u={};l.z&&Um("z",a,u,this.animationValues);for(let c=0;c<$m.length;c++)Um(`rotate${$m[c]}`,a,u,this.animationValues),Um(`skew${$m[c]}`,a,u,this.animationValues);a.render();for(const c in u)a.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);a.scheduleRender()}applyProjectionStyles(a,s){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=Tf(s==null?void 0:s.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=Tf(s==null?void 0:s.pointerEvents)||""),this.hasProjected&&!Ta(this.latestValues)&&(a.transform=l?l({},""):"none",this.hasProjected=!1);return}a.visibility="";const c=u.animationValues||u.latestValues;this.applyTransformsToTarget();let d=N$(this.projectionDeltaWithTransform,this.treeScale,c);l&&(d=l(c,d)),a.transform=d;const{x:f,y:h}=this.projectionDelta;a.transformOrigin=`${f.origin*100}% ${h.origin*100}% 0`,u.animationValues?a.opacity=u===this?c.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:c.opacityExit:a.opacity=u===this?c.opacity!==void 0?c.opacity:"":c.opacityExit!==void 0?c.opacityExit:0;for(const v in ey){if(c[v]===void 0)continue;const{correct:g,applyTo:y,isCSSVariable:m}=ey[v],x=d==="none"?c[v]:g(c[v],u);if(y){const b=y.length;for(let w=0;w<b;w++)a[y[w]]=x}else m?this.options.visualElement.renderState.vars[v]=x:a[v]=x}this.options.layoutId&&(a.pointerEvents=u===this?Tf(s==null?void 0:s.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var s;return(s=a.currentAnimation)==null?void 0:s.stop()}),this.root.nodes.forEach(UC),this.root.sharedNodes.clear()}}}function P$(e){e.updateLayout()}function A$(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:o}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Tr(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],h=$n(f);f.min=r[d].min,f.max=f.min+h}):BP(i,t.layoutBox,r)&&Tr(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],h=$n(r[d]);f.max=f.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+h)});const s=Zs();Hu(s,r,t.layoutBox);const l=Zs();a?Hu(l,e.applyTransform(o,!0),t.measuredBox):Hu(l,r,t.layoutBox);const u=!jP(s);let c=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:h}=d;if(f&&h){const v=Yt();gh(v,t.layoutBox,f.layoutBox);const g=Yt();gh(g,r,h.layoutBox),FP(v,g)||(c=!0),d.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=v,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:s,hasLayoutChanged:u,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function I$(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function M$(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function D$(e){e.clearSnapshot()}function UC(e){e.clearMeasurements()}function HC(e){e.isLayoutDirty=!1}function j$(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function GC(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function F$(e){e.resolveTargetDelta()}function O$(e){e.calcProjection()}function L$(e){e.resetSkewAndRotation()}function B$(e){e.removeLeadSnapshot()}function qC(e,t,n){e.translate=At(t.translate,0,n),e.scale=At(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function KC(e,t,n,r){e.min=At(t.min,n.min,r),e.max=At(t.max,n.max,r)}function V$(e,t,n,r){KC(e.x,t.x,n.x,r),KC(e.y,t.y,n.y,r)}function z$(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const W$={duration:.45,ease:[.4,0,.1,1]},XC=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),YC=XC("applewebkit/")&&!XC("chrome/")?Math.round:Br;function QC(e){e.min=YC(e.min),e.max=YC(e.max)}function $$(e){QC(e.x),QC(e.y)}function BP(e,t,n){return e==="position"||e==="preserve-aspect"&&!QW(WC(t),WC(n),.2)}function U$(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const H$=LP({attachResizeListener:(e,t)=>Ec(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Hm={current:void 0},VP=LP({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Hm.current){const e=new H$({});e.mount(window),e.setOptions({layoutScroll:!0}),Hm.current=e}return Hm.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),G$={pan:{Feature:f$},drag:{Feature:d$,ProjectionNode:VP,MeasureLayout:IP}};function ZC(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const o="onHover"+n,i=r[o];i&&Nt.postRender(()=>i(t,Yc(t)))}class q$ extends ba{mount(){const{current:t}=this.node;t&&(this.unmount=vz(t,(n,r)=>(ZC(this.node,r,"Start"),o=>ZC(this.node,o,"End"))))}unmount(){}}class K$ extends ba{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=qc(Ec(this.node.current,"focus",()=>this.onFocus()),Ec(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function JC(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const o="onTap"+(n==="End"?"":n),i=r[o];i&&Nt.postRender(()=>i(t,Yc(t)))}class X$ extends ba{mount(){const{current:t}=this.node;t&&(this.unmount=bz(t,(n,r)=>(JC(this.node,r,"Start"),(o,{success:i})=>JC(this.node,o,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ly=new WeakMap,Gm=new WeakMap,Y$=e=>{const t=ly.get(e.target);t&&t(e)},Q$=e=>{e.forEach(Y$)};function Z$({root:e,...t}){const n=e||document;Gm.has(n)||Gm.set(n,{});const r=Gm.get(n),o=JSON.stringify(t);return r[o]||(r[o]=new IntersectionObserver(Q$,{root:e,...t})),r[o]}function J$(e,t,n){const r=Z$(t);return ly.set(e,n),r.observe(e),()=>{ly.delete(e),r.unobserve(e)}}const eU={some:0,all:1};class tU extends ba{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:o="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof o=="number"?o:eU[o]},s=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),f=u?c:d;f&&f(l)};return J$(this.node.current,a,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(nU(t,n))&&this.startObserver()}unmount(){}}function nU({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const rU={inView:{Feature:tU},tap:{Feature:X$},focus:{Feature:K$},hover:{Feature:q$}},oU={layout:{ProjectionNode:VP,MeasureLayout:IP}},iU={...HW,...rU,...G$,...oU},he=sW(iU,bW),aU=()=>`vs_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sU=()=>{const[e,t]=S.useState(null),[n,r]=S.useState("welcome"),o=S.useCallback(()=>{const c={id:aU(),startedAt:new Date,status:"in_progress"};return t(c),r("welcome"),localStorage.setItem("currentVerificationSession",JSON.stringify(c)),c},[]),i=S.useCallback(c=>{t(d=>{if(!d)return null;const f={...d,selfieImage:c,selfieTimestamp:new Date};return localStorage.setItem("currentVerificationSession",JSON.stringify(f)),f})},[]),a=S.useCallback((c,d)=>{t(f=>{if(!f)return null;const h={...f,documentImage:c,documentType:d,documentTimestamp:new Date};return localStorage.setItem("currentVerificationSession",JSON.stringify(h)),h})},[]),s=S.useCallback((c,d,f)=>{t(h=>{if(!h)return null;const v={...h,completedAt:new Date,similarityScore:c,status:d?"approved":"rejected",result:f};localStorage.setItem("currentVerificationSession",JSON.stringify(v));const g=JSON.parse(localStorage.getItem("verificationHistory")||"[]");return g.push(v),localStorage.setItem("verificationHistory",JSON.stringify(g)),v})},[]),l=S.useCallback(()=>{t(null),r("welcome"),localStorage.removeItem("currentVerificationSession")},[]),u=S.useCallback(c=>{r(c)},[]);return{session:e,currentStep:n,startSession:o,saveSelfie:i,saveDocument:a,completeVerification:s,resetSession:l,goToStep:u}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zP=function(e,t){return(zP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(e,t)};function co(e,t){function n(){this.constructor=e}zP(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function be(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(u){try{l(r.next(u))}catch(c){i(c)}}function s(u){try{l(r.throw(u))}catch(c){i(c)}}function l(u){u.done?o(u.value):new n(function(c){c(u.value)}).then(a,s)}l((r=r.apply(e,[])).next())})}function we(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(d){c=[6,d],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}var lU=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return uU(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],l=a[1];t.urlFlags[s]=function(u,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+u+".")}(s,l)})}},e}();function uU(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function te(){return WP}var WP=null,yh=new Map,uy=new Map;function $P(e,t){var n=HP(e,t);return yh.get(n)}function cU(e){return uy.get(e)}function eS(e){for(var t=yh.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function UP(e){var t=e.kernelName,n=e.backendName,r=HP(t,n);if(yh.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");yh.set(r,e)}function dU(e){var t=e.kernelName;uy.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),uy.set(t,e)}function HP(e,t){return t+"_"+e}function cy(e,t,n){return Math.max(e,Math.min(t,n))}function GP(e){return e%2==0?e:e+1}function fU(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function O(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function it(e,t,n){n===void 0&&(n=""),O(hn(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function ru(e){O(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function zl(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||jo(e)&&!n)for(var r=0;r<e.length;++r)zl(e[r],t,n);else t.push(e);return t}function Se(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function hn(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ut(e){return e%1==0}function hU(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function dy(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function cl(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function tS(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=t(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function pU(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function an(e,t){var n=t.length;return O((e=e==null?t.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),O(e.every(function(r){return Ut(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function Ma(e,t){for(var n=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||o?null:an(t,e).sort(),a=0,s=0;s<e.length;++s){if(i!=null){if(i[a]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(i[a]==null||i[a]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function _c(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function xh(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function mU(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function vU(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function gU(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function jo(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function qP(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function yU(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Mx(e){return typeof e=="string"||e instanceof String}function xU(e){return typeof e=="boolean"}function bU(e){return typeof e=="number"}function Qc(e){return Array.isArray(e)?Qc(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":bU(e)?"float32":Mx(e)?"string":xU(e)?"bool":"float32"}function fy(e){return!!(e&&e.constructor&&e.call&&e.apply)}function hy(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Fo(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function KP(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=zl(e)),n&&mU(e,t),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)Math.round(e[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function nS(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var l=i[0],u=0;u<l;u++)s[u]=a[o+u];else{l=i[0];var c=i.slice(1),d=c.reduce(function(f,h){return f*h});for(u=0;u<l;u++)s[u]=r(o+u*d,c,a)}return s}(0,e,t)}function XP(e,t){for(var n=Zc(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Zc(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function wo(){return te().platform.now()}function YP(e){e.forEach(function(t){O(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function wU(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",te().platform.encode(e,t)}function bh(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",te().platform.decode(e,t)}function rS(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function CU(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}var SU=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new EU)}return e.prototype.profileKernel=function(t,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(l){(function(u,c,d){if(c!=="float32")return!1;for(var f=0;f<u.length;f++){var h=u[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(l,s.dtype,t),a.then(function(u){var c="";u.getExtraProfileInfo!=null&&(c=u.getExtraProfileInfo()),i.logger.logKernelProfile(t,s,l,u.kernelMs,n,c)})})}),o},e}(),EU=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,o,i,a){var s=typeof o=="number"?cl(o+"ms",9):o.error,l=cl(t,25),u=n.rank,c=n.size,d=cl(n.shape.toString(),14),f="";for(var h in i){var v=i[h].shape||n.shape,g=v.length;f+=h+": "+g+"D "+(g>0?v:"")+" "}console.log("%c"+l+"	%c"+s+"	%c"+u+"D "+d+"	%c"+c+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),oS=20,yu=3,qm=7;function _U(e,t,n,r){var o=Fo(t),i=function(u,c,d,f){var h=Se(c),v=f[f.length-1],g=new Array(v).fill(0),y=c.length,m=d==="complex64"?bu(u):u;if(y>1)for(var x=0;x<h/v;x++)for(var b=x*v,w=0;w<v;w++)g[w]=Math.max(g[w],xu(m[b+w],0,d).length);return g}(e,t,n,o),a=t.length,s=function u(c,d,f,h,v,g){g===void 0&&(g=!0);var y=f==="complex64"?2:1,m=d[0],x=d.length;if(x===0)return f==="complex64"?[xu(bu(c)[0],0,f)]:f==="bool"?[QP(c[0])]:[c[0].toString()];if(x===1){if(m>oS){var b=yu*y,w=Array.from(c.slice(0,b)),C=Array.from(c.slice((m-yu)*y,m*y));return f==="complex64"&&(w=bu(w),C=bu(C)),["["+w.map(function(L,V){return xu(L,v[V],f)}).join(", ")+", ..., "+C.map(function(L,V){return xu(L,v[m-yu+V],f)}).join(", ")+"]"]}return["["+(f==="complex64"?bu(c):Array.from(c)).map(function(L,V){return xu(L,v[V],f)}).join(", ")+"]"]}var E=d.slice(1),_=h.slice(1),N=h[0]*y,T=[];if(m>oS){for(var k=0;k<yu;k++){var I=(A=k*N)+N;T.push.apply(T,u(c.slice(A,I),E,f,_,v,!1))}for(T.push("..."),k=m-yu;k<m;k++)I=(A=k*N)+N,T.push.apply(T,u(c.slice(A,I),E,f,_,v,k===m-1))}else for(k=0;k<m;k++){var A;I=(A=k*N)+N,T.push.apply(T,u(c.slice(A,I),E,f,_,v,k===m-1))}var U=x===2?",":"";for(T[0]="["+T[0]+U,k=1;k<T.length-1;k++)T[k]=" "+T[k]+U;var B=`,
`;for(k=2;k<x;k++)B+=`
`;return T[T.length-1]=" "+T[T.length-1]+"]"+(g?"":B),T}(e,t,n,o,i),l=["Tensor"];return r&&(l.push("  dtype: "+n),l.push("  rank: "+a),l.push("  shape: ["+t+"]"),l.push("  values:")),l.push(s.map(function(u){return"    "+u}).join(`
`)),l.join(`
`)}function xu(e,t,n){return cl(Array.isArray(e)?parseFloat(e[0].toFixed(qm))+" + "+parseFloat(e[1].toFixed(qm))+"j":Mx(e)?"'"+e+"'":n==="bool"?QP(e):parseFloat(e.toFixed(qm)).toString(),t)}function QP(e){return e===0?"false":"true"}function bu(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var kc=function(){function e(t,n,r){var o=this;if(this.dtype=n,this.shape=t.slice(),this.size=Se(t),r!=null){var i=r.length;O(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||xh(n,this.size),this.strides=Fo(t)}return e.prototype.set=function(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),O(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,o=0,i=t;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var l=t[t.length-1],u=0;u<t.length-1;++u)l+=this.strides[u]*t[u];return this.values[l]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return _o().makeTensor(this.values,this.shape,this.dtype)},e}(),_o=null,Z=null,ZP=null,Pt=function(){function e(t,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Se(t),this.strides=Fo(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),O(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,o){return this.throwIfDisposed(),this.reshape([t,n,r,o])},e.prototype.as5D=function(t,n,r,o,i){return this.throwIfDisposed(),this.reshape([t,n,r,o,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),Z.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return be(this,void 0,void 0,function(){var t;return we(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Z.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return Z.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return be(this,void 0,void 0,function(){var t;return we(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,nS(this.shape,t)]}})})},e.prototype.arraySync=function(){return nS(this.shape,this.dataSync())},e.prototype.data=function(){return be(this,void 0,void 0,function(){var t,n;return we(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=_o().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(o){return bh(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=_o().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return bh(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return be(this,void 0,void 0,function(){var t;return we(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,_o().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(_o().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),Z.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),Z.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),Z.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),Z.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),Z.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),Z.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),Z.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),_U(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),Z.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Z.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),Z.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),Z.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),Z.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),Z.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),Z.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),Z.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Z.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),Z.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),Z.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),Z.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,o,i){return r===void 0&&(r=.001),ZP("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,o,r)},e.prototype.batchNorm=function(t,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),Z.batchNorm(this,t,n,r,o,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Z.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Z.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Z.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),Z.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),Z.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),Z.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),Z.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),Z.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),Z.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),Z.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),Z.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),Z.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),Z.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),Z.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),Z.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),Z.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),Z.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),Z.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Z.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),Z.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Z.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),Z.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),Z.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Z.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),Z.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),Z.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Z.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),Z.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),Z.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),Z.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),Z.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),Z.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Z.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),Z.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Z.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Z.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Z.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Z.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),Z.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),Z.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),Z.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),Z.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),Z.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),Z.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),Z.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),Z.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),Z.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),Z.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),Z.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),Z.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),Z.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),Z.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),Z.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),Z.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),Z.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),Z.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),Z.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),Z.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),Z.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),Z.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),Z.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),Z.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),Z.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),Z.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),Z.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),Z.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),Z.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),Z.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),Z.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),Z.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),Z.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),Z.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),Z.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),Z.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),Z.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),Z.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),Z.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),Z.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),Z.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),Z.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),Z.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),Z.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),Z.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),Z.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),Z.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Z.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Z.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Z.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Z.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),Z.conv1d(this,t,n,r,o,i,a)},e.prototype.conv2d=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Z.conv2d(this,t,n,r,o,i,a)},e.prototype.conv2dTranspose=function(t,n,r,o,i){return this.throwIfDisposed(),Z.conv2dTranspose(this,t,n,r,o,i)},e.prototype.depthwiseConv2D=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),Z.depthwiseConv2d(this,t,n,r,o,i,a)},e.prototype.separableConv2d=function(t,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),Z.separableConv2d(this,t,n,r,o,i,a)},e.prototype.avgPool=function(t,n,r,o){return this.throwIfDisposed(),Z.avgPool(this,t,n,r,o)},e.prototype.maxPool=function(t,n,r,o){return this.throwIfDisposed(),Z.maxPool(this,t,n,r,o)},e.prototype.localResponseNormalization=function(t,n,r,o){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),Z.localResponseNormalization(this,t,n,r,o)},e.prototype.pool=function(t,n,r,o,i){return this.throwIfDisposed(),Z.pool(this,t,n,r,o,i)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),_o().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),Z.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),Z.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Z.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),Z.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,o,i,a,s,l){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),l===void 0&&(l=0),this.throwIfDisposed(),Z.stridedSlice(this,t,n,r,o,i,a,s,l)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),Z.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),Z.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),Z.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),Z.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),Z.spectral.irfft(this)},e}();Object.defineProperty(Pt,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var iS,py,my,vy,gy,Wl=function(e){function t(n,r,o,i){var a=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return co(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!hn(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");_o().disposeTensor(this),this.dataId=n.dataId,_o().incRef(this,null)},t.prototype.dispose=function(){_o().disposeVariable(this),this.isDisposedInternal=!0},t}(Pt);Object.defineProperty(Wl,Symbol.hasInstance,{value:function(e){return e instanceof Pt&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(iS||(iS={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(py||(py={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(my||(my={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(vy||(vy={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(gy||(gy={}));var kU={float32:vy,int32:py,bool:my,complex64:gy};function xn(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return kU[e][t]}function Km(e){return xn(e,"int32")}function jt(e,t){if(e.dtype===t.dtype)return[e,t];var n=xn(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function NU(e,t){O(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function JP(e){var t=[];return function n(r,o,i){if(r!=null){if(r instanceof Pt)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var l in s){var u=s[l];i.has(u)||(i.add(u),n(u,o,i))}}}}(e,t,new Set),t}var Xm,aS=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),TU=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new aS}return e.prototype.ready=function(){return be(this,void 0,void 0,function(){var t,n,r;return we(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,o.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return be(this,void 0,void 0,function(){var n,r,o;return we(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new SU(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;eS(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;eS(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=t,t.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,o=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var o=r();return n(),o}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,o,i){return this.runKernelFunc(null,n,null,t,r,o,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(l){i+=l.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,o,i,a,s){var l,u=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(x){d&&(c=x.map(function(b){return u.keep(u.clone(b))}))},v=this.state.numBytes,g=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var y,m=$P(o,this.backendName);return f=m!=null?function(){var x=u.backend.numDataIds();y=m.kernelFunc({inputs:n,attrs:i,backend:u.backend});var b=Array.isArray(y)?y:[y];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(o,x,b);var w=b.map(function(E){var _=E.dataId,N=E.shape,T=E.dtype;return u.makeTensorFromDataId(_,N,T)}),C=w.filter(function(E,_){return s[_]});return h((a||[]).slice().concat(C)),w}:function(){var x=u.backend.numDataIds();y=u.tidy(function(){return t(u.backend,h)});var b=Array.isArray(y)?y:[y];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(o,x,b),b},this.scopedRun(function(){return u.state.kernelDepth++},function(){return u.state.kernelDepth--},function(){l=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,l,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-v,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-g,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(x){return n[x].shape}),outputShapes:l.map(function(x){return x.shape})}),Array.isArray(y)?l:l[0]},e.prototype.makeTensor=function(t,n,r,o){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=t;r==="string"&&Mx(t[0])&&(i=t.map(function(c){return wU(c)}));var a=o.write(i,n,r),s=new Pt(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var l=this.state.tensorInfo.get(a),u=yU(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return s},e.prototype.makeTensorFromDataId=function(t,n,r,o){var i=new Pt(n,r=r||"float32",t,this.nextTensorId());return this.incRef(i,o),i},e.prototype.makeVariable=function(t,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==t.dtype&&(t=t.asType(o));var i=new Wl(t,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(o=t.size*qP(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Wl||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return be(this,void 0,void 0,function(){var n,r;return we(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:i},l=cU(t);l!=null&&(o=l.gradFunc),o!=null&&(s.gradient=function(u){return u=u.map(function(c,d){if(c==null){var f=r[d],h=Zc(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return c}),o(u.length>1?u:u[0],i)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=JP(t),o=new Set(r.map(function(l){return l.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(l){l.kept||l.scopeId!==s.id||n.track(l)})},e.prototype.gradients=function(t,n,r,o){var i=this;if(o===void 0&&(o=!1),O(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});O(a instanceof Pt,function(){return"The result y returned by f() must be a tensor."});var s=function(l,u,c){for(var d={},f={},h=0;h<u.length;h++)d[u[h].id]=!0;for(h=0;h<l.length;h++){var v=(E=l[h]).inputs;for(var g in v){for(var y=v[g],m=!1,x=0;x<u.length;x++)if(d[y.id]){E.outputs.forEach(function(k){return d[k.id]=!0}),m=!0,f[E.id]=!0;break}if(m)break}}var b={};b[c.id]=!0;var w={};for(h=l.length-1;h>=0;h--)for(v=(E=l[h]).inputs,x=0;x<E.outputs.length;x++)if(b[E.outputs[x].id]){for(var g in v)b[v[g].id]=!0,w[E.id]=!0;break}var C=[];for(h=0;h<l.length;h++){var E;if(f[(E=l[h]).id]&&w[E.id]){var _={};for(var g in E.inputs){var N=E.inputs[g];d[N.id]&&(_[g]=N)}var T=Object.assign({},E);T.inputs=_,T.outputs=E.outputs,C.push(T)}}return C}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var l,u,c={};c[a.id]=r??(l=a.shape,u=XP(Se(l),"float32"),H.makeTensor(u,l,"float32")),function(f,h,v){for(var g=function(m){var x=h[m],b=[];if(x.outputs.forEach(function(_){var N=f[_.id];N!=null?b.push(N):b.push(null)}),x.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+x.kernelName+".");var w=x.gradient(b),C=function(_){if(!(_ in w))throw new Error("Cannot backprop through input "+_+". Available gradients found: "+Object.keys(w)+".");var N=v(function(){return w[_]()});if(N.dtype!=="float32")throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input "+_+" must have 'float32' dtype, but has '"+N.dtype+"'");var T=x.inputs[_];if(!hn(N.shape,T.shape))throw new Error("Error in gradient for op "+x.kernelName+". The gradient of input '"+_+"' has shape '"+N.shape+"', which does not match the shape of the input '"+T.shape+"'");if(f[T.id]==null)f[T.id]=N;else{var k=f[T.id];f[T.id]=k.add(N),k.dispose()}};for(var E in x.inputs)C(E)},y=h.length-1;y>=0;y--)g(y)}(c,s,function(f){return i.tidy(f)});var d=n.map(function(f){return c[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var h=0,v=f.saved;h<v.length;h++)v[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},e.prototype.customGrad=function(t){var n=this;return O(fy(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];O(o.every(function(s){return s instanceof Pt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,l){a[l]=s}),n.runKernelFunc(function(s,l){return O((r=t.apply(void 0,o.concat([l]))).value instanceof Pt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),O(fy(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,l){var u=r.gradFunc(s,l),c=Array.isArray(u)?u:[u];O(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),O(c.every(function(f){return f instanceof Pt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,h){d[h]=function(){return f}}),d})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return be(this,void 0,void 0,function(){var n,r;return we(this,function(o){switch(o.label){case 0:return n=wo(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=wo()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new aS,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),H=function(){var e=function(){if(Xm==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}Xm=n}return Xm}();if(e._tfengine==null){var t=new lU(e);e._tfengine=new TU(t)}return function(n){WP=n}(e._tfengine.ENV),_o=function(){return e._tfengine},e._tfengine}();function eA(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Ko=te();Ko.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ko.registerFlag("IS_BROWSER",function(){return eA()}),Ko.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Ko.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Ko.registerFlag("PROD",function(){return!1}),Ko.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Ko.getBool("DEBUG")}),Ko.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Ko.registerFlag("IS_TEST",function(){return!1});var Nc,gr,mr,Ra={},Ym={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function RU(e,t){Ra[e]=t}function Wo(e){e in Ra||(Ra[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Ra[n]},!1),n===1?r.getContext("webgl",Ym)||r.getContext("experimental-webgl",Ym):r.getContext("webgl2",Ym)}(e));var t=Ra[e];return t.isContextLost()?(delete Ra[e],Wo(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ra[e])}function Cp(e,t){return[t,e]}function Gu(e){var t=Se(e);return dy(Math.ceil(t/4))}function Jc(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Dx(e,t){var n,r,o,i,a,s,l,u,c,d=e;return te().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,l=1,u=d.HALF_FLOAT,c=d.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=d.RGBA,a=e.RGBA,s=4,l=4,u=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:l,textureTypeHalfFloat:u,textureTypeFloat:c}}function ke(e,t,n){var r=n();return t&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+MU(o,i))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Nc||(Nc={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(gr||(gr={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(mr||(mr={}));var PU=596e-10,AU=65504;function IU(e){return!!(te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||PU<Math.abs(e)&&Math.abs(e)<AU)}function MU(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Hd(e,t,n){return vi(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function DU(e,t,n){var r=vi(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ke(e,t,function(){return e.shaderSource(r,n)}),ke(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function jU(e,t,n){var r=vi(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ke(e,t,function(){return e.shaderSource(r,n)}),ke(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(o,i){var a=FU.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],l=o.split(`
`),u=l.length.toString().length+2,c=l.map(function(y,m){return cl((m+1).toString(),u)+y}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var h=c.slice(0,s-1),v=c.slice(s-1,s),g=c.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+cl(v[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Qm,Zm,FU=/ERROR: [0-9]+:([0-9]+):/g;function OU(e,t){return vi(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function LU(e,t,n){if(ke(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Jm(e,t,n){if(ke(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function BU(e,t,n){var r=vi(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ke(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ke(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function VU(e,t,n){var r=vi(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ke(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),ke(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function zU(e,t){return vi(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function WU(e,t){var n=te().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function $U(e,t){return vi(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function sS(e,t,n,r,o,i,a,s){var l=e.getAttribLocation(n,r);return l!==-1&&(ke(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),ke(e,t,function(){return e.vertexAttribPointer(l,i,e.FLOAT,!1,a,s)}),ke(e,t,function(){return e.enableVertexAttribArray(l)}),!0)}function UU(e,t,n,r){XU(e,r),ke(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function HU(e,t,n,r){return vi(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function GU(e,t,n){return e.getUniformLocation(t,n)}function qU(e,t,n,r,o,i){ke(e,t,function(){return UU(e,t,r,i)}),ke(e,t,function(){return e.uniform1i(o,i)})}function ev(e,t,n,r){ke(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),ke(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function lS(e,t,n){ke(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ke(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function Gd(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+KU(e,t))}function KU(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function vi(e,t,n,r){var o=ke(e,t,function(){return n()});if(o==null)throw new Error(r);return o}function XU(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function wh(e,t){return t===void 0&&(t=2),Se(e.slice(0,e.length-t))}function Ch(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function tv(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[wh(e)].concat(Ch(e))),t}function YU(e,t){var n;t===void 0&&(t=!1);var r=te().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(u,c){return c>=e.length-2?GP(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var o=Ma(e);e=o.newShape}var i=Se(e);if(e.length<=1&&i<=r)return[1,i];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=wh(e),s=2,l=2;return e.length&&(s=(n=Ch(e))[0],l=n[1]),dy(i=a*(s/2)*(l/2)).map(function(u){return 2*u})}return dy(i)}function qd(e){return e%2==0}function Kd(e,t){if(hn(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||qd(n)&&qd(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&qd(e[0])&&qd(t[0])}function QU(e){if(Qm==null){var t=Wo(e);Qm=t.getParameter(t.MAX_TEXTURE_SIZE)}return Qm}function ZU(e){if(Zm==null){var t=Wo(e);Zm=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Zm)}function JU(e){if(e===0)return 0;var t=Wo(e);return Or(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Or(t,"EXT_disjoint_timer_query")?1:0}function Or(e,t){return e.getExtension(t)!=null}function uS(e){try{if(Wo(e)!=null)return!0}catch{return!1}return!1}function e8(e){if(e===0)return!1;var t=Wo(e);if(e===1){if(!Or(t,"OES_texture_float"))return!1}else if(!Or(t,"EXT_color_buffer_float"))return!1;return yy(t)}function t8(e){if(e===0)return!1;var t=Wo(e);if(e!==1){if(Or(t,"EXT_color_buffer_float"))return yy(t);if(Or(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=Dx(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var l=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),l}(t,n)}return!1}return!!Or(t,"OES_texture_float")&&!!Or(t,"WEBGL_color_buffer_float")&&yy(t)}function yy(e){var t=Dx(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function n8(e){return e===2&&Wo(e).fenceSync!=null}var Ae=te();function tA(e){te().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function me(e,t){return H.tidy(e,t)}function lr(e){JP(e).forEach(function(t){return t.dispose()})}function r8(e){return H.keep(e)}function Sh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];te().getBool("IS_TEST")||console.warn.apply(console,e)}function wa(e,t){var n=e;if(jo(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||jo(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&te().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!jo(i))return void O(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});O(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),O(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var l=a.slice(1),u=0;u<i.length;++u)o(i[u],l,s.concat(u))}(e,r,[]),r}function cS(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function D(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof Pt)return cS(r,e.dtype,t,n),e;var o=Qc(e);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),cS(r,o,t,n),e==null||!jo(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=wa(e,o);jo(e)||Array.isArray(e)||(e=[e]);var s=o!=="string"?KP(e,o,te().getBool("DEBUG")):zl(e,[],!0);return H.makeTensor(s,a,o)}function Eh(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,i){return D(o,t+"["+i+"]",n)},r)}function nA(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function o8(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(e[i++]):o.push(t[a++]);return o}function Pn(e,t){for(var n=[],r=e.length,o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);return[n,t.map(function(i){return e[i]})]}function ur(e,t){return o8(e,t.map(function(n){return 1}),t)}function hr(e,t,n){O(nA(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function $o(e,t){if(nA(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(o){return n.push(o)}),n}function jx(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Uo(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function i8(e,t){var n=e[0].length;e.forEach(function(o,i){O(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),O(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(o,i){for(var a=0;a<n;a++)O(a===t||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function $l(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function $(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];H.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),H.endScope(s),s}catch(l){throw H.endScope(null),l}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}Ae.registerFlag("HAS_WEBGL",function(){return Ae.getNumber("WEBGL_VERSION")>0}),Ae.registerFlag("WEBGL_VERSION",function(){return uS(2)?2:uS(1)?1:0}),Ae.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ae.get("WEBGL_VERSION")===2}),Ae.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ae.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ae.registerFlag("WEBGL_PACK",function(){return Ae.getBool("HAS_WEBGL")}),Ae.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_PACK_CLIP",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ae.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_PACK_REDUCE",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_CONV_IM2COL",function(){return Ae.getBool("WEBGL_PACK")}),Ae.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return QU(Ae.getNumber("WEBGL_VERSION"))}),Ae.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return ZU(Ae.getNumber("WEBGL_VERSION"))}),Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Ae.getNumber("WEBGL_VERSION");return e===0?0:JU(e)}),Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ae.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Ae.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return e8(Ae.getNumber("WEBGL_VERSION"))}),Ae.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ae.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ae.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ae.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return t8(Ae.getNumber("WEBGL_VERSION"))}),Ae.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return n8(Ae.getNumber("WEBGL_VERSION"))}),Ae.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ae.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),ZP=tA;var yn=$({complex_:function(e,t){var n=D(e,"real","complex"),r=D(t,"imag","complex");return it(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),H.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),Dr=$({real_:function(e){var t=D(e,"input","real");return H.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),ko=$({imag_:function(e){var t=D(e,"input","imag");return H.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function bn(e,t,n){return Ca(e,t,wa(e,n),n)}function Ca(e,t,n,r){if(r==null&&(r=Qc(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!jo(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){YP(t);var o=Se(t),i=Se(n);O(o===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],l=a!==n.length-1||s!==Se(t.slice(a));O(n[a]===t[a]||!l,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return jo(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?KP(e,r,te().getBool("DEBUG")):zl(e,[],!0),H.makeTensor(e,t,r)}function de(e,t){if((jo(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&jo(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ca(e,[],[],t)}function Kt(e,t){ru(e);var n=wa(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ca(e,null,n,t)}function oa(e,t,n){if(ru(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=wa(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ca(e,t,r,n)}function Fx(e,t,n){if(ru(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=wa(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ca(e,t,r,n)}function tr(e,t,n){if(ru(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=wa(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ca(e,t,r,n)}function a8(e,t,n){if(ru(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=wa(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ca(e,t,r,n)}function s8(e,t,n){if(ru(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=wa(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ca(e,t=t||r,r,n)}function l8(e,t,n,r){return t===void 0&&(t=!0),H.makeVariable(e,t,n,r)}function ou(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=ou(e,"float32"),r=Ct(e,"float32");return yn(n,r)}var o=XP(Se(e),t);return H.makeTensor(o,e,t)}function Ct(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Ct(e,"float32"),r=Ct(e,"float32");return yn(n,r)}var o=Zc(Se(e),t);return H.makeTensor(o,e,t)}function Oo(e,t,n){return H.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function u8(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return H.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function _h(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Ct([0],r);var o=Zc(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return Kt(o,r)}var rA=$({onesLike_:function(e){var t=D(e,"x","onesLike");if(t.dtype==="complex64"){var n=rA(Dr(t)),r=Ye(ko(t));return yn(n,r)}return H.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,i){return{$x:function(){return Ye(o)}}})}}),Ye=$({zerosLike_:function(e){var t=D(e,"x","zerosLike");return H.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return Ye(n)}}})}}),tn=$({concat_:function(e,t){t===void 0&&(t=0),O(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Eh(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=an(t,n[0].shape)[0];var r=$l(n.map(function(s){return s.shape}),t);if(Se(r)===0)return bn([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});i8(o,t);var i=n,a={axis:t};return H.runKernelFunc(function(s){return s.concat(n,t)},i,function(s){var l=o.map(function(u){return u[t]});return Ox(s,l,t).map(function(u){return function(){return u}})},"Concat",a)}}),c8=$({concat1d_:function(e){return tn(e,0)}}),d8=$({concat2d_:function(e,t){return tn(e,t)}}),f8=$({concat3d_:function(e,t){return tn(e,t)}}),h8=$({concat4d_:function(e,t){return tn(e,t)}}),Ox=$({split_:function(e,t,n){n===void 0&&(n=0);var r,o=D(e,"x","split");return n=an(n,o.shape)[0],typeof t=="number"?(O(o.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[n]/t)):(O(o.shape[n]===t.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),H.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return tn(i,n)}}})}});function gs(e,t){return e(t={exports:{}},t.exports),t.exports}var p8=gs(function(e){(function(t,n,r){function o(s){var l,u=this,c=(l=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(l+=d.charCodeAt(f));h-=l=h>>>0,l=(h*=l)>>>0,l+=4294967296*(h-=l)}return 23283064365386963e-26*(l>>>0)});u.next=function(){var d=2091639*u.s0+23283064365386963e-26*u.c;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=0|d)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(s),u.s0<0&&(u.s0+=1),u.s1-=c(s),u.s1<0&&(u.s1+=1),u.s2-=c(s),u.s2<0&&(u.s2+=1),c=null}function i(s,l){return l.c=s.c,l.s0=s.s0,l.s1=s.s1,l.s2=s.s2,l}function a(s,l){var u=new o(s),c=l&&l.state,d=u.next;return d.int32=function(){return 4294967296*u.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=a:this.alea=a})(0,e)}),m8=gs(function(e){(function(t,n,r){function o(s){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},s===(0|s)?l.x=s:u+=s;for(var c=0;c<u.length+64;c++)l.x^=0|u.charCodeAt(c),l.next()}function i(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l}function a(s,l){var u=new o(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(0,e)}),v8=gs(function(e){(function(t,n,r){function o(s){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^d^d<<1)|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,s===(0|s)?l.x=s:u+=s;for(var c=0;c<u.length+64;c++)l.x^=0|u.charCodeAt(c),c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l.v=s.v,l.d=s.d,l}function a(s,l){var u=new o(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(0,e)}),g8=gs(function(e){(function(t,n,r){function o(s){var l=this;l.next=function(){var u,c,d=l.x,f=l.i;return u=d[f],c=(u^=u>>>7)^u<<24,c^=(u=d[f+1&7])^u>>>10,c^=(u=d[f+3&7])^u>>>3,c^=(u=d[f+4&7])^u<<7,u=d[f+7&7],c^=(u^=u<<13)^u<<9,d[f]=c,l.i=f+1&7,c},function(u,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],u.x=f,u.i=0,d=256;d>0;--d)u.next()}(l,s)}function i(s,l){return l.x=s.x.slice(),l.i=s.i,l}function a(s,l){s==null&&(s=+new Date);var u=new o(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.x&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(0,e)}),y8=gs(function(e){(function(t,n,r){function o(s){var l=this;l.next=function(){var u,c,d=l.w,f=l.X,h=l.i;return l.w=d=d+1640531527|0,c=f[h+34&127],u=f[h=h+1&127],c^=c<<13,u^=u<<17,c^=c>>>15,u^=u>>>12,c=f[h]=c^u,l.i=h,c+(d^d>>>16)|0},function(u,c){var d,f,h,v,g,y=[],m=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,m=Math.max(m,c.length)),h=0,v=-32;v<m;++v)c&&(f^=c.charCodeAt((v+32)%c.length)),v===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(g=g+1640531527|0,h=(d=y[127&v]^=f+g)==0?h+1:0);for(h>=128&&(y[127&(c&&c.length||0)]=-1),h=127,v=512;v>0;--v)f=y[h+34&127],d=y[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,y[h]=f^d;u.w=g,u.X=y,u.i=h}(l,s)}function i(s,l){return l.i=s.i,l.w=s.w,l.X=s.X.slice(),l}function a(s,l){s==null&&(s=+new Date);var u=new o(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.X&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(0,e)}),x8=gs(function(e){(function(t,n,r){function o(s){var l=this,u="";l.next=function(){var d=l.b,f=l.c,h=l.d,v=l.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^v,v=v-d|0,l.b=d=d<<20^d>>>12^f,l.c=f=f-h|0,l.d=h<<16^f>>>16^v,l.a=v-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,s===Math.floor(s)?(l.a=s/4294967296|0,l.b=0|s):u+=s;for(var c=0;c<u.length+20;c++)l.b^=0|u.charCodeAt(c),l.next()}function i(s,l){return l.a=s.a,l.b=s.b,l.c=s.c,l.d=s.d,l}function a(s,l){var u=new o(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(0,e)}),Pa=gs(function(e){(function(t,n){var r,o=this,i=256,a=6,s="random",l=n.pow(i,a),u=n.pow(2,52),c=2*u,d=i-1;function f(m,x,b){var w=[],C=g(function N(T,k){var I,A=[],U=typeof T;if(k&&U=="object")for(I in T)try{A.push(N(T[I],k-1))}catch{}return A.length?A:U=="string"?T:T+"\0"}((x=x==1?{entropy:!0}:x||{}).entropy?[m,y(t)]:m??function(){try{var N;return r&&(N=r.randomBytes)?N=N(i):(N=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(N)),y(N)}catch{var T=o.navigator,k=T&&T.plugins;return[+new Date,o,k,o.screen,y(t)]}}(),3),w),E=new h(w),_=function(){for(var N=E.g(a),T=l,k=0;N<u;)N=(N+k)*i,T*=i,k=E.g(1);for(;N>=c;)N/=2,T/=2,k>>>=1;return(N+k)/T};return _.int32=function(){return 0|E.g(4)},_.quick=function(){return E.g(4)/4294967296},_.double=_,g(y(E.S),t),(x.pass||b||function(N,T,k,I){return I&&(I.S&&v(I,E),N.state=function(){return v(E,{})}),k?(n[s]=N,T):N})(_,C,"global"in x?x.global:this==n,x.state)}function h(m){var x,b=m.length,w=this,C=0,E=w.i=w.j=0,_=w.S=[];for(b||(m=[b++]);C<i;)_[C]=C++;for(C=0;C<i;C++)_[C]=_[E=d&E+m[C%b]+(x=_[C])],_[E]=x;(w.g=function(N){for(var T,k=0,I=w.i,A=w.j,U=w.S;N--;)T=U[I=d&I+1],k=k*i+U[d&(U[I]=U[A=d&A+T])+(U[A]=T)];return w.i=I,w.j=A,k})(i)}function v(m,x){return x.i=m.i,x.j=m.j,x.S=m.S.slice(),x}function g(m,x){for(var b,w=m+"",C=0;C<w.length;)x[d&C]=d&(b^=19*x[d&C])+w.charCodeAt(C++);return y(x)}function y(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=f,g(n.random(),t),e.exports){e.exports=f;try{r=require("crypto")}catch{}}})([],Math)});Pa.alea=p8,Pa.xor128=m8,Pa.xorwow=v8,Pa.xorshift7=g8,Pa.xor4096=y8,Pa.tychei=x8;var Sp=Pa.alea,Lx=function(){function e(t,n,r,o,i){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Sp(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var l=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*l,r=this.mean+this.stdDev*a*l,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),b8=function(){function e(t,n,r,o){this.alpha=t,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=Sp(i.toString()),this.randn=new Lx(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),w8=function(){function e(t,n,r,o){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Sp(o)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Fe(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",YP(e),new kc(e,t,n)}function C8(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var oA=$({batchToSpaceND_:function(e,t,n){var r=D(e,"x","batchToSpaceND"),o=t.reduce(function(i,a){return i*a});return O(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),O(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),O(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),H.runKernelFunc(function(i){return i.batchToSpaceND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),S8=$({broadcastTo_:function(e,t){var n=D(e,"broadcastTo","x"),r=n.shape;if(t.some(function(l){return!(l>0)||l%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(l,u){return l>1?u:-1}).filter(function(l){return l>=0});return s.length===0?n.clone():H.runKernelFunc(function(l){return l.tile(n,i)},{input:n},function(l){return{input:function(){return l.sum(s,!0)}}})}}),E8=$({cast_:function(e,t){var n=D(e,"x","cast");if(!vU(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return H.runKernelFunc(function(o){return o.cast(n,t)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),_8=$({clone_:function(e){var t=D(e,"x","clone",null);return H.runKernelFunc(function(){return H.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),k8=$({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=D(e,"x","cumsum"),i=$o([t|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Uo(1,o.rank)[0],l=H.runKernelFunc(function(u){return u.cumsum(a,s,n,r)},{permutedX:a},function(u){return{permutedX:function(){return u.cumsum(t,n,!r)}}});return i!=null&&(l=l.transpose(i)),l}}),N8=$({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=D(e,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return O(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),O(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),O(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),H.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Mr=$({expandDims_:function(e,t){t===void 0&&(t=0);var n=D(e,"x","expandDims",null);O(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(O(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),eo(n,r)}}),iA=$({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var o=Fe([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return dl(Mr(s,0),[n[0],1,1]);if(n.length===2)return dl(Mr(Mr(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return dl(Mr(Mr(Mr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),T8=$({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var o=D(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,l=H.runKernelFunc(function(u){return u.multinomial(s,r,t,n)},{logits2D:s});return a===1?l.as1D():l}}),xy=$({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=D(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),H.runKernelFunc(function(a){return a.oneHot(o,t,n,r)},{$indices:o},function(a){return{$indices:function(){return Ct(o.shape,"float32")}}}).reshape(i)}}),ys=$({pad_:function(e,t,n){n===void 0&&(n=0);var r=D(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return H.runKernelFunc(function(i){return i.pad(r,t,n)},{x:r},function(i){var a=t.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),R8=$({pad1d_:function(e,t,n){return n===void 0&&(n=0),O(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),ys(e,[t],n)}}),P8=$({pad2d_:function(e,t,n){return n===void 0&&(n=0),O(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ys(e,t,n)}}),A8=$({pad3d_:function(e,t,n){return n===void 0&&(n=0),O(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ys(e,t,n)}}),I8=$({pad4d_:function(e,t,n){return n===void 0&&(n=0),O(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ys(e,t,n)}}),M8=$({rand_:function(e,t,n){var r=Se(e),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return H.makeTensor(o,e,n)}}),D8=$({randomNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Lx(t,n,r,!1,o),a=Fe(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),j8=$({randomGamma_:function(e,t,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new b8(t,n,r,o),a=Fe(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),aA=$({randomUniform_:function(e,t,n,r,o){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=Fe(e,r),a=new w8(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),eo=$({reshape_:function(e,t){var n=D(e,"x","reshape",null);t=pU(t,n.size),O(n.size===Se(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return H.runKernelFunc(function(o){return o.reshape(n,t)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),sA=$({spaceToBatchND_:function(e,t,n){var r=D(e,"x","spaceToBatchND");return O(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),O(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),O(r.shape.reduce(function(o,i,a){return a>0&&a<=t.length?o&&(i+n[a-1][0]+n[a-1][1])%t[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),H.runKernelFunc(function(o){return o.spaceToBatchND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,n)}}})}}),lA=$({squeeze_:function(e,t){var n=D(e,"x","squeeze");return eo(n,Ma(n.shape,t).newShape)}}),Cr=$({stack_:function(e,t){t===void 0&&(t=0);var n=Eh(e,"tensors","stack");if(O(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;O(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){it(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){O(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(t)});return tn(a,t)}}),dl=$({tile_:function(e,t){var n=D(e,"x","tile",null);O(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],o={reps:t};return H.runKernelFunc(function(i,a){var s=i.tile(n,t);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var l=Ye(s);if(s.rank===1)for(var u=0;u<t[0];++u)l=l.add(i.slice([u*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(u=0;u<t[0];++u)for(var c=0;c<t[1];++c)l=l.add(i.slice([u*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(u=0;u<t[0];++u)for(c=0;c<t[1];++c)for(var d=0;d<t[2];++d)l=l.add(i.slice([u*s.shape[0],c*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(u=0;u<t[0];++u)for(c=0;c<t[1];++c)for(d=0;d<t[2];++d)for(var f=0;f<t[3];++f)l=l.add(i.slice([u*s.shape[0],c*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return l}}},"Tile",o,r)}}),F8=$({truncatedNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Lx(t,n,r,!0,o),a=Fe(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),nn=$({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=D(e,"x","unstack");O(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return H.runKernelFunc(function(o){return o.unstack(n,t)},{x:n},function(o){return{x:function(){return Cr(o,t)}}},"Unpack",r)}}),O8=function(e,t){return be(this,void 0,void 0,function(){var n,r,o,i,a,s,l,u,c,d;return we(this,function(f){switch(f.label){case 0:return n=D(e,"x","setdiff1d"),r=D(t,"y","setdiff1d"),O(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),O(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),O(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(l=new kc([s],n.dtype),u=new kc([s],"int32"),c=0,d=0;c<o.length;c++)a.has(o[c])||(l.values[d]=o[c],u.values[d]=c,d++);return[2,[l.toTensor(),u.toTensor()]]}})})};function kh(e,t,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function Nh(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Th(e,t,n,r){r===void 0&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function uA(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function cA(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function dA(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var l=1;for(i=r;i<e.rank;++i)l*=a[i],s.push(a[i]);var u=Fo(e.shape).map(function(c){return c/l}).concat([1]).slice(0,r);return[s,o,l,u]}var fA=30;function nv(e){return e<=fA?e:hy(e,Math.floor(Math.sqrt(e)))}function L8(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function B8(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}L8(n,t,e)}function Rh(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var l=o<1?1:o;return{sliceRank:o,numUpdates:Se(t.shape)/l,sliceSize:a,strides:Fo(n.slice(0,o)).concat([1]),outputSize:Se(n)}}function V8(e,t,n){O(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),O(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){O(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},o=0;o<e.rank;++o)r(o)}function dS(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Bx(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function z8(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=cy(0,i,s-1)}function W8(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?cy(0,i,s):cy(-1,i,s-1)}function hA(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function pA(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function $8(e,t){O(fy(e),function(){return"The f passed in variableGrads(f) must be a function"}),O(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof Wl}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],H.registeredVariables)t.push(H.registeredVariables[r]);var o=n?t.filter(function(c){return!c.trainable}):null,i=t.length;O((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=H.gradients(e,t,null,!0),s=a.value,l=a.grads;O(l.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),O(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var u={};return t.forEach(function(c,d){l[d]!=null&&(u[c.name]=l[d])}),o!=null&&o.forEach(function(c){return u[c.name]=null}),{value:s,grads:u}}function Ep(e){return H.customGrad(e)}var gi=$({softmax_:function(e,t){t===void 0&&(t=-1);var n=D(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return H.runKernelFunc(function(r,o){var i=r.softmax(n,t);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),U8=$({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=D(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Ep(function(r,o){var i=r.max(t,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(t,!0).log());return o([s]),{value:s,gradFunc:function(l,u){var c=u[0].exp();return l.sub(l.sum(t,!0).mul(c))}}})(n)}}),mA=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),vA=function(){function e(){}return e.prototype.time=function(t){return Q("time")},e.prototype.read=function(t){return Q("read")},e.prototype.readSync=function(t){return Q("readSync")},e.prototype.numDataIds=function(){return Q("numDataIds")},e.prototype.disposeData=function(t){return Q("disposeData")},e.prototype.write=function(t,n,r){return Q("write")},e.prototype.move=function(t,n,r,o){return Q("move")},e.prototype.memory=function(){return Q("memory")},e.prototype.floatPrecision=function(){return Q("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,o){return Q("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,Q("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return Q("slice")},e.prototype.stridedSlice=function(t,n,r,o){return Q("stridedSlice")},e.prototype.unstack=function(t,n){return Q("unstack")},e.prototype.reverse=function(t,n){return Q("reverse")},e.prototype.concat=function(t,n){return Q("concat")},e.prototype.neg=function(t){return Q("neg")},e.prototype.add=function(t,n){return Q("add")},e.prototype.addN=function(t){return Q("addN")},e.prototype.subtract=function(t,n){return Q("subtract")},e.prototype.multiply=function(t,n){return Q("multiply")},e.prototype.realDivide=function(t,n){return Q("realDivide")},e.prototype.floorDiv=function(t,n){return Q("floorDiv")},e.prototype.sum=function(t,n){return Q("sum")},e.prototype.prod=function(t,n){return Q("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return Q("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return Q("argMin")},e.prototype.argMax=function(t,n){return Q("argMax")},e.prototype.equal=function(t,n){return Q("equal")},e.prototype.notEqual=function(t,n){return Q("notEqual")},e.prototype.less=function(t,n){return Q("less")},e.prototype.lessEqual=function(t,n){return Q("lessEqual")},e.prototype.greater=function(t,n){return Q("greater")},e.prototype.greaterEqual=function(t,n){return Q("greaterEqual")},e.prototype.logicalNot=function(t){return Q("logicalNot")},e.prototype.logicalAnd=function(t,n){return Q("logicalAnd")},e.prototype.logicalOr=function(t,n){return Q("logicalOr")},e.prototype.where=function(t){return Q("where")},e.prototype.select=function(t,n,r){return Q("select")},e.prototype.topk=function(t,n,r){return Q("topk")},e.prototype.min=function(t,n){return Q("min")},e.prototype.minimum=function(t,n){return Q("minimum")},e.prototype.mod=function(t,n){return Q("mod")},e.prototype.max=function(t,n){return Q("max")},e.prototype.maximum=function(t,n){return Q("maximum")},e.prototype.all=function(t,n){return Q("all")},e.prototype.any=function(t,n){return Q("any")},e.prototype.squaredDifference=function(t,n){return Q("squaredDifference")},e.prototype.ceil=function(t){return Q("ceil")},e.prototype.floor=function(t){return Q("floor")},e.prototype.round=function(t){return Q("round")},e.prototype.sign=function(t){return Q("sign")},e.prototype.isNaN=function(t){return Q("isNaN")},e.prototype.isInf=function(t){return Q("isInf")},e.prototype.isFinite=function(t){return Q("isFinite")},e.prototype.pow=function(t,n){return Q("pow")},e.prototype.exp=function(t){return Q("exp")},e.prototype.expm1=function(t){return Q("expm1")},e.prototype.softmax=function(t,n){return Q("softmax")},e.prototype.log=function(t){return Q("log")},e.prototype.log1p=function(t){return Q("log1p")},e.prototype.sqrt=function(t){return Q("sqrt")},e.prototype.rsqrt=function(t){return Q("rsqrt")},e.prototype.square=function(t){return Q("square")},e.prototype.reciprocal=function(t){return Q("reciprocal")},e.prototype.relu=function(t){return Q("relu")},e.prototype.relu6=function(t){return Q("relu6")},e.prototype.prelu=function(t,n){return Q("prelu")},e.prototype.elu=function(t){return Q("elu")},e.prototype.eluDer=function(t,n){return Q("eluDer")},e.prototype.selu=function(t){return Q("selu")},e.prototype.int=function(t){return Q("int")},e.prototype.clip=function(t,n,r){return Q("clip")},e.prototype.abs=function(t){return Q("abs")},e.prototype.complexAbs=function(t){return Q("complexAbs")},e.prototype.sigmoid=function(t){return Q("sigmoid")},e.prototype.softplus=function(t){return Q("softplus")},e.prototype.sin=function(t){return Q("sin")},e.prototype.cos=function(t){return Q("cos")},e.prototype.tan=function(t){return Q("tan")},e.prototype.asin=function(t){return Q("asin")},e.prototype.acos=function(t){return Q("acos")},e.prototype.atan=function(t){return Q("atan")},e.prototype.atan2=function(t,n){return Q("atan2")},e.prototype.sinh=function(t){return Q("sinh")},e.prototype.cosh=function(t){return Q("cosh")},e.prototype.tanh=function(t){return Q("tanh")},e.prototype.asinh=function(t){return Q("asinh")},e.prototype.acosh=function(t){return Q("acosh")},e.prototype.atanh=function(t){return Q("atanh")},e.prototype.erf=function(t){return Q("erf")},e.prototype.step=function(t,n){return Q("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Q("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return Q("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return Q("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return Q("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Q("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return Q("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return Q("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return Q("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return Q("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return Q("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return Q("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return Q("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,o){return Q("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return Q("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return Q("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return Q("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return Q("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return Q("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,o){return Q("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return Q("reshape")},e.prototype.cast=function(t,n){return Q("cast")},e.prototype.tile=function(t,n){return Q("tile")},e.prototype.pad=function(t,n,r){return Q("pad")},e.prototype.transpose=function(t,n){return Q("transpose")},e.prototype.gather=function(t,n,r){return Q("gather")},e.prototype.gatherND=function(t,n){return Q("gatherND")},e.prototype.scatterND=function(t,n,r){return Q("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return Q("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return Q("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,o){return Q("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return Q("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,o){return Q("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return Q("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,o,i,a){return Q("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,o,i){return Q("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,o,i,a,s){return Q("LRNGrad")},e.prototype.multinomial=function(t,n,r,o){return Q("multinomial")},e.prototype.oneHot=function(t,n,r,o){return Q("oneHot")},e.prototype.cumsum=function(t,n,r,o){return Q("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,o,i){return Q("nonMaxSuppression")},e.prototype.fft=function(t){return Q("fft")},e.prototype.ifft=function(t){return Q("ifft")},e.prototype.complex=function(t,n){return Q("complex")},e.prototype.real=function(t){return Q("real")},e.prototype.imag=function(t){return Q("imag")},e.prototype.cropAndResize=function(t,n,r,o,i,a){return Q("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return Q("depthToSpace")},e.prototype.split=function(t,n,r){return Q("split")},e.prototype.sparseToDense=function(t,n,r,o){return Q("sparseToDense")},e.prototype.diag=function(t){return Q("diag")},e.prototype.fill=function(t,n,r){return Q("fill")},e.prototype.onesLike=function(t){return Q("onesLike")},e.prototype.zerosLike=function(t){return Q("zerosLike")},e.prototype.linspace=function(t,n,r){return Q("linspace")},e.prototype.dispose=function(){return Q("dispose")},e}();function Q(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function qi(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function rn(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function He(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];i==null&&(i=1);var a=t[t.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function Tc(e,t,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,l=Ih(t),u=l[0],c=l[1];if(a==="channelsLast")s=[u,c,e[3],e[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[u,c,e[1],e[1]]}return xs(e,s,n,r,o,i,!1,a)}function Ph(e,t,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,l,u=by(t),c=u[0],d=u[1],f=u[2];if(a==="NDHWC")l="channelsLast",s=[c,d,f,e[4],e[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);l="channelsFirst",s=[c,d,f,e[1],e[1]]}return Ah(e,s,n,r,o,!1,l,i)}function xs(e,t,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var l=[-1,-1,-1,-1],u=l[0],c=l[1],d=l[2],f=l[3];if(s==="channelsLast")u=e[0],c=e[1],d=e[2],f=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);u=e[0],f=e[1],c=e[2],d=e[3]}var h,v=t[0],g=t[1],y=t[3],m=Ih(n),x=m[0],b=m[1],w=Ih(r),C=w[0],E=w[1],_=fl(v,C),N=fl(g,E),T=function(B,L,V,F,M,j,R,P){var z,G,q;if(typeof B=="number"){z={top:B,bottom:B,left:B,right:B,type:B===0?"VALID":"NUMBER"};var Y=function(ae,ce,ne,se,ve){se==null&&(se=gA(ae,ce,ne));var xe=ae[0],Me=ae[1],Pe=qu((xe-ce+2*se)/ne+1,ve);O(Ut(Pe),function(){return"The output # of rows ("+Pe+") must be an integer. Change the stride and/or zero pad parameters"});var je=qu((Me-ce+2*se)/ne+1,ve);return O(Ut(je),function(){return"The output # of columns ("+je+") must be an integer. Change the stride and/or zero pad parameters"}),[Pe,je]}([L,V],j,F,B,P);G=Y[0],q=Y[1]}else if(B==="same"){G=Math.ceil(L/F),q=Math.ceil(V/M);var J=Math.max(0,(G-1)*F+j-L),X=Math.max(0,(q-1)*M+R-V),ee=Math.floor(J/2),oe=J-ee,ue=Math.floor(X/2);z={top:ee,bottom:oe,left:ue,right:X-ue,type:"SAME"}}else{if(B!=="valid")throw Error("Unknown padding parameter: "+B);z={top:0,bottom:0,left:0,right:0,type:"VALID"},G=Math.ceil((L-j+1)/F),q=Math.ceil((V-R+1)/M)}return{padInfo:z,outHeight:G,outWidth:q}}(o,c,d,x,b,_,N,i),k=T.padInfo,I=T.outHeight,A=T.outWidth,U=a?y*f:y;return s==="channelsFirst"?h=[u,U,I,A]:s==="channelsLast"&&(h=[u,I,A,U]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:d,inChannels:f,outHeight:I,outWidth:A,outChannels:U,padInfo:k,strideHeight:x,strideWidth:b,filterHeight:v,filterWidth:g,effectiveFilterHeight:_,effectiveFilterWidth:N,dilationHeight:C,dilationWidth:E,inShape:e,outShape:h,filterShape:t}}function Ah(e,t,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var l=[-1,-1,-1,-1,-1],u=l[0],c=l[1],d=l[2],f=l[3],h=l[4];if(a==="channelsLast")u=e[0],c=e[1],d=e[2],f=e[3],h=e[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);u=e[0],h=e[1],c=e[2],d=e[3],f=e[4]}var v,g=t[0],y=t[1],m=t[2],x=t[4],b=by(n),w=b[0],C=b[1],E=b[2],_=by(r),N=_[0],T=_[1],k=_[2],I=fl(g,N),A=fl(y,T),U=fl(m,k),B=function(R,P,z,G,q,Y,J,X,ee,oe,ue){var ae,ce,ne,se;if(typeof R=="number"){ae={top:R,bottom:R,left:R,right:R,front:R,back:R,type:R===0?"VALID":"NUMBER"};var ve=function(Je,dt,Xe,Ce,lt,zt){lt==null&&(lt=gA(Je,dt,Ce));var Ht=Je[0],_t=Je[1],ze=Je[2],rt=qu((Ht-dt+2*lt)/Ce+1,zt);O(Ut(rt),function(){return"The output # of depths ("+rt+") must be an integer. Change the stride and/or zero pad parameters"});var sn=qu((_t-dt+2*lt)/Ce+1,zt);O(Ut(sn),function(){return"The output # of rows ("+sn+") must be an integer. Change the stride and/or zero pad parameters"});var ft=qu((ze-dt+2*lt)/Ce+1,zt);return O(Ut(ft),function(){return"The output # of columns ("+ft+") must be an integer. Change the stride and/or zero pad parameters"}),[rt,sn,ft,Xe]}([P,z,G,1],X,1,q,R,ue);ce=ve[0],ne=ve[1],se=ve[2]}else if(R==="same"){ce=Math.ceil(P/q),ne=Math.ceil(z/Y),se=Math.ceil(G/J);var xe=(ce-1)*q+X-P,Me=(ne-1)*Y+ee-z,Pe=(se-1)*J+oe-G,je=Math.floor(xe/2),Le=xe-je,$e=Math.floor(Me/2),at=Me-$e,Qe=Math.floor(Pe/2);ae={top:$e,bottom:at,left:Qe,right:Pe-Qe,front:je,back:Le,type:"SAME"}}else{if(R!=="valid")throw Error("Unknown padding parameter: "+R);ae={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},ce=Math.ceil((P-X+1)/q),ne=Math.ceil((z-ee+1)/Y),se=Math.ceil((G-oe+1)/J)}return{padInfo:ae,outDepth:ce,outHeight:ne,outWidth:se}}(o,c,d,f,w,C,E,I,A,U,s),L=B.padInfo,V=B.outDepth,F=B.outHeight,M=B.outWidth,j=i?x*h:x;return a==="channelsFirst"?v=[u,j,V,F,M]:a==="channelsLast"&&(v=[u,V,F,M,j]),{batchSize:u,dataFormat:a,inDepth:c,inHeight:d,inWidth:f,inChannels:h,outDepth:V,outHeight:F,outWidth:M,outChannels:j,padInfo:L,strideDepth:w,strideHeight:C,strideWidth:E,filterDepth:g,filterHeight:y,filterWidth:m,effectiveFilterDepth:I,effectiveFilterHeight:A,effectiveFilterWidth:U,dilationDepth:N,dilationHeight:T,dilationWidth:k,inShape:e,outShape:v,filterShape:t}}function gA(e,t,n,r){r===void 0&&(r=1);var o=fl(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function Ih(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function by(e){return typeof e=="number"?[e,e,e]:e}function fl(e,t){return t<=1?e:e+(e-1)*(t-1)}function qu(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Ul(e){var t=Ih(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function cr(e,t){return Ul(e)||Ul(t)}function Vx(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function yA(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Ct(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!gU(e.dtype,t))return H.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var s=de(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function wy(e,t){return H.makeTensorFromDataId(e.dataId,t,e.dtype)}function xA(e,t,n){var r=(t-e)/(n-1),o=Zc(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return Kt(o,"float32")}function Cy(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function fS(e,t){return{real:e[2*t],imag:e[2*t+1]}}function H8(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function G8(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function q8(e,t,n){var r=function(i,a,s){return function(l,u,c){for(var d=0,f=l.length,h=0,v=!1;d<f;){var g=c(u,l[h=d+(f-d>>>1)]);g>0?d=h+1:(f=h,v=!g)}return v?d:-d-1}(i,a,s||K8)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function K8(e,t){return e>t?1:e<t?-1:0}function zx(e,t,n,r,o){return bA(e,t,n,r,o,0).selectedIndices}function Wx(e,t,n,r,o,i){var a=bA(e,t,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function bA(e,t,n,r,o,i,a,s){s===void 0&&(s=!1);for(var l=Array.from(t).map(function(w,C){return{score:w,boxIndex:C,suppressBeginIndex:0}}).filter(function(w){return w.score>o}).sort(hS),u=i>0?-.5/i:0,c=[],d=[];c.length<n&&l.length>0;){var f=l.pop(),h=f.score,v=f.boxIndex,g=f.suppressBeginIndex;if(h<o)break;for(var y=!1,m=c.length-1;m>=g;--m){var x=X8(e,v,c[m]);if(x>=r){y=!0;break}if(f.score=f.score*Y8(r,u,x),f.score<=o)break}f.suppressBeginIndex=c.length,y||(f.score===h?(c.push(v),d.push(f.score)):f.score>o&&q8(l,f,hS))}var b=c.length;return s&&(c.fill(0,b),d.fill(0,b)),{selectedIndices:Kt(c,"int32"),selectedScores:Kt(d,"float32"),numValidOutputs:de(b,"int32")}}function X8(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(l-a),v=(d-u)*(f-c);if(h<=0||v<=0)return 0;var g=Math.max(i,u),y=Math.max(a,c),m=Math.min(s,d),x=Math.min(l,f),b=Math.max(m-g,0)*Math.max(x-y,0);return b/(h+v-b)}function Y8(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function hS(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function wA(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map(function(i){o[n]=i;var a=e.slice(r,o);return r[n]+=i,a})}function CA(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=Fe(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var l=e.locToIndex(a);o.values[r]=e.values[l]}return o.toTensor()}function SA(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],l=a[1],u=_c(n,s*r),c=_c("int32",s*r),d=0;d<s;d++){for(var f=d*l,h=e.subarray(f,f+l),v=[],g=0;g<h.length;g++)v.push({value:h[g],index:g});v.sort(function(w,C){return C.value-w.value});var y=d*r,m=u.subarray(y,y+r),x=c.subarray(y,y+r);for(g=0;g<r;g++)m[g]=v[g].value,x[g]=v[g].index}var b=t.slice();return b[b.length-1]=r,[bn(u,b,n),bn(c,b,"int32")]}function $x(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=Fe(e,"int32"),i=Fe([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var Q8=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},Z8=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},J8=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=t==="max"?">":"<",l=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+l+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function EA(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function nr(e,t){return t===1?[e]:EA(e,t)}function Mn(){var e,t,n,r,o,i,a,s,l,u;return te().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:l,defineRound:u}}function Ba(e,t,n){n===void 0&&(n="index");var r=Fo(t);return r.map(function(o,i){return"int "+e[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+o:"index -= "+e[i]+" * "+o)+";"}).join("")}function Ux(e){var t=Fo(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var _A=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function eH(e,t,n,r){var o=[];e.forEach(function(h){var v=Se(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(v>1?"["+v+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),l=e.map(function(h){return function(v,g,y){y===void 0&&(y=!1);var m="";m+=y?kA(v):As(v);var x=v.shapeInfo.logicalShape,b=g.logicalShape;return x.length<=b.length&&(m+=y?function(w,C){var E,_=w.name,N=_.charAt(0).toUpperCase()+_.slice(1),T="get"+N+"AtOutCoords",k=w.shapeInfo.logicalShape.length,I=C.logicalShape.length,A=qi(w.shapeInfo.logicalShape,C.logicalShape),U=vt(I),B=I-k,L=["x","y","z","w","u","v"];E=k===0?"":I<2&&A.length>=1?"coords = 0;":A.map(function(z){return"coords."+L[z+B]+" = 0;"}).join(`
`);var V="";V=I<2&&k>0?"coords":w.shapeInfo.logicalShape.map(function(z,G){return"coords."+L[G+B]}).join(", ");var F="return outputValue;",M=Se(w.shapeInfo.logicalShape)===1,j=Se(C.logicalShape)===1;if(k!==1||M||j){if(M&&!j)F=I===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(A.length){var R=k-2,P=k-1;A.indexOf(R)>-1&&A.indexOf(P)>-1?F="return vec4(outputValue.x);":A.indexOf(R)>-1?F="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":A.indexOf(P)>-1&&(F="return vec4(outputValue.xx, outputValue.zz);")}}else F=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+T+`() {
      `+U+` coords = getOutputCoords();
      `+E+`
      vec4 outputValue = get`+N+"("+V+`);
      `+F+`
    }
  `}(v,g):function(w,C){var E=w.name,_=E.charAt(0).toUpperCase()+E.slice(1),N="get"+_+"AtOutCoords",T=C.texShape,k=w.shapeInfo.texShape,I=w.shapeInfo.logicalShape.length,A=C.logicalShape.length;if(!w.shapeInfo.isUniform&&I===A&&w.shapeInfo.flatOffset==null&&hn(k,T))return`
      float `+N+`() {
        return sampleTexture(`+E+`, resultUV);
      }
    `;var U,B=vt(A),L=qi(w.shapeInfo.logicalShape,C.logicalShape),V=A-I,F=["x","y","z","w","u","v"];U=I===0?"":A<2&&L.length>=1?"coords = 0;":L.map(function(j){return"coords."+F[j+V]+" = 0;"}).join(`
`);var M="";return M=A<2&&I>0?"coords":w.shapeInfo.logicalShape.map(function(j,R){return"coords."+F[R+V]}).join(", "),`
    float `+N+`() {
      `+B+` coords = getOutputCoords();
      `+U+`
      return get`+_+"("+M+`);
    }
  `}(v,g)),m}(h,t,r)}).join(`
`),u=t.texShape,c=Mn(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+tH+`
    `+nH+`
    `+rH+`
  `}(c);return t.isPacked?(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,C){var E=[Math.ceil(C[0]/2),Math.ceil(C[1]/2)];return E[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+E[1]+`.0);
      }
    `:E[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+E[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      return 2 * (resTexRC.x * `+E[1]+` + resTexRC.y);
    }
  `}(0,v);case 2:return function(w,C){var E=[Math.ceil(C[0]/2),Math.ceil(C[1]/2)];if(hn(w,C))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+E[0]+", "+E[1]+`));
      }
    `;var _=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));

      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec2(r, c);
    }
  `}(h,v);case 3:return g=h,y=v,m=[Math.ceil(y[0]/2),Math.ceil(y[1]/2)],x=Math.ceil(g[2]/2),b=x*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+x+`);
      int c = imod(index, `+x+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,C){for(var E=[Math.ceil(C[0]/2),Math.ceil(C[1]/2)],_=Math.ceil(w[w.length-1]/2),N=_*Math.ceil(w[w.length-2]/2),T=N,k="",I="b, r, c",A=2;A<w.length-1;A++)T*=w[w.length-A-1],k=`
      int b`+A+" = index / "+T+`;
      index -= b`+A+" * "+T+`;
    `+k,I="b"+A+", "+I;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+k+`

      int b = index / `+N+`;
      index -= b * `+N+`;

      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec`+w.length+"("+I+`);
    }
  `}(h,v)}var g,y,m,x,b}(t.logicalShape,u),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,x){return x[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+x[1]+`.0);
      }
    `:x[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+x[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      return resTexRC.x * `+x[1]+` + resTexRC.y;
    }
  `}(0,v);case 2:return function(m,x){return hn(m,x)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+x[0]+", "+x[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+x[0]+", "+x[1]+`));
        int index = resTexRC.x * `+x[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(h,v);case 3:return g=v,y=Ba(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+y+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,x){var b=Ba(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,v);case 5:return function(m,x){var b=Ba(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+x[0]+`,
                             `+x[1]+`));

      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,v);case 6:return function(m,x){var b=Ba(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,v);default:throw new Error(h.length+"-D output sampling is not yet supported")}var g,y}(t.logicalShape,u),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=oH),[f,d,a,s,i,l,n].join(`
`)}function As(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var l=n.shapeInfo.texShape,u=l[0],c=l[1],d=_a(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+u+", "+c+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+ks(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var l=_a(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+l+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+l+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+l+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&hn(r,a)){var s=a[0],l=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+l+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var u=Ma(r),c=u.newShape,d=u.keptDims,f=c;if(f.length<r.length){var h=Is(n,f);return`
      `+As(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Ms(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+ks(n)+`
      }
    `;var v=a[0],g=a[1],y=_a(o);return g===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:v===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+y+`;
    vec2 uv = uvFromFlat(`+v+", "+g+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],l=Ma(r),u=l.newShape,c=l.keptDims,d=u;if(d.length<r.length){var f=Is(n,d);return`
        `+As(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Ms(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+ks(n)+`
      }
    `;var h=n.shapeInfo.texShape,v=h[0],g=h[1],y=n.shapeInfo.flatOffset;if(g===a&&y==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+v+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(g===s&&y==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var m=_a(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+v+", "+g+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,l=r[1]*s,u=Ma(r),c=u.newShape,d=u.keptDims;if(c.length<r.length){var f=Is(n,c);return`
      `+As(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Ms(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+l+", "+s+", "+a+`, 1)));
        `+ks(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,v=n.shapeInfo.texShape,g=v[0],y=v[1];if(y===l&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var m=_a(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+y+", index + "+m+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,l=r[2]*s,u=r[1]*l,c=Ma(r),d=c.newShape,f=c.keptDims;if(d.length<r.length){var h=Is(n,d);return`
      `+As(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Ms(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+u+", "+l+", "+s+", "+a+`)) +
          depth3;
        `+ks(n)+`
      }
    `;var v=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,y=g[0],m=g[1];if(m===u&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+l+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+y+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(m===a&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+y+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=_a(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+l+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+x+`;
      vec2 uv = uvFromFlat(`+y+", "+m+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=Ma(r),s=a.newShape,l=a.keptDims;if(s.length<r.length){var u=Is(n,s);return`
      `+As(u)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Ms(["row","col","depth","depth2","depth3","depth4"],l)+`);
      }
    `}var c=r[5],d=r[4]*c,f=r[3]*d,h=r[2]*f,v=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+v+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+ks(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,y=n.shapeInfo.texShape,m=y[0],x=y[1];if(x===v&&g==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(x===c&&g==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var b=_a(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+v+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+m+", "+x+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function kA(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Mn(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Mn();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+l[0]+", "+l[1]+`, index);
      return `+u.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),l=o.shapeInfo.texShape,u=l[0],c=l[1],d=Mn();if(l!=null&&hn(i,l))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+u+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(e);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),l=o.shapeInfo.texShape,u=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];if(i[0]===1){var c=i.slice(1),d=Is(o,c);return`
        `+kA(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Ms(["b","row","col"],[1,2])+`);
        }
      `}var f=u[0],h=u[1],v=Math.ceil(i[2]/2),g=v*Math.ceil(i[1]/2),y=Mn();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+g+", "+v+`, b, row, col);
      return `+y.texture2D+"("+a+`, uv);
    }
  `}(e);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),u=o.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],d=c[0],f=c[1],h=Math.ceil(i[a-1]/2),v=h*Math.ceil(i[a-2]/2),g="int b, int row, int col",y="b * "+v+" + (row / 2) * "+h+" + (col / 2)",m=2;m<a-1;m++)g="int b"+m+", "+g,v*=i[a-m-1],y="b"+m+" * "+v+" + "+y;var x=Mn();return`
    vec4 `+l+"("+g+`) {
      int index = `+y+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+x.texture2D+"("+s+`, uv);
    }
  `}(e)}}var tH=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,nH=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rH=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,oH=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function _a(e){return"offset"+e}function ks(e){var t=e.name,n=Se(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function vt(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Is(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Ms(e,t){return t.map(function(n){return e[n]}).join(", ")}var iH=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,O(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,l=this.outputShape,u=l.length,c=vt(u),d=nr("coords",u);if(i===1){var f=vt(s=u+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[u-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[u-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[u-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[u-2]+";"}else s=u,a=`
        `+c+` sourceLocR = coords;
        ++`+d[u-1]+`;
        `+c+` sourceLocG = coords;
        ++`+d[u-2]+`;
        `+c+` sourceLocA = coords;
        --`+d[u-1]+`;
        `+c+` sourceLocB = coords;
        --`+d[u-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),v="."+h[s-1],g=h.map(function(N){return"int "+N}),y=nr("sourceLocR",s-1).concat("inIdx.r"),m=nr("sourceLocG",s-1).concat("inIdx.g"),x=nr("sourceLocB",s-1).concat("inIdx.b"),b=nr("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",C=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",E=`vec4(
            getAChannel(`+y.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+x.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",_=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+_+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+d[u-1]+" < "+(l[u-1]-1)+`;
        bool hasNextRow = `+d[u-2]+" < "+(l[u-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+v+", sourceLocG"+v+`,
          sourceLocB`+v+", sourceLocA"+v+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+E+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+C+`
          vec4 candidate = `+E+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},aH=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=s-1-e.padInfo.top,c=l-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+c+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+l+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},sH=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=c-1-e.padInfo.front,v=d-1-e.padInfo.top,g=f-1-e.padInfo.left,y=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+v+", "+g+`);
      const float avgMultiplier = float(`+y+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+l+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+u+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},lH=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],He(e,t),He(e,n);var a="0.0";r!=null&&(He(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(He(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},uH=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],He(e,t),He(e,n);var a="vec4(0.0)";r!=null&&(He(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(He(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},cH="return areal * breal - aimag * bimag;",dH="return areal * bimag + aimag * breal;",pS=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=He(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},rv="return a + b;",ov="return a - b;",mS="return a * b;",NA="return (a < 0.) ? b * a : a;",Ft=function(e,t,n){this.variableNames=["A","B"],this.outputShape=He(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},TA=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Yo=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=He(t,n);var o=this.outputShape.length,i="";if(r)if(o===0||Se(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+vt(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=nr("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},fH=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),hH=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),pH=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},mH=function(e){this.outputShape=[],this.outputShape=$l(e,1),this.variableNames=e.map(function(s,l){return"T"+l});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},vH=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=$l(e,t);var n=this.outputShape,r=n.length,o=vt(r),i=nr("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(y,m){return"T"+m});var s=new Array(e.length-1);s[0]=e[0][t];for(var l=1;l<s.length;l++)s[l]=s[l-1]+e[l][t];var u=a[t],c=a.slice(-2),d=a.join(),f="if ("+u+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+c.join()+`));
        }`;for(l=1;l<s.length;l++){var h=s[l-1];f+=`
        if (`+u+" < "+s[l]+"  && "+u+" >= "+s[l-1]+`) {
          return getChannel(
            getT`+l+"("+Xd(a,u,h)+`),
            vec2(`+Xd(c,u,h)+`));
        }`}var v=s.length,g=s[s.length-1];f+=`
        return getChannel(
          getT`+v+"("+Xd(a,u,g)+`),
          vec2(`+Xd(c,u,g)+"));",this.userCode=`
      float getValue(`+a.map(function(y){return"int "+y})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Xd(e,t,n){var r=e.indexOf(t);return e.map(function(o,i){return i===r?o+" - "+n:o}).join()}var gH=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},yH=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,l=i?1:2,u=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+l+"], coords["+u+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},xH=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+o+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},bH=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,l=n-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+l+", "+u+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},wH=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},CH=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},vS=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),h=e.inChannels%4,v=e.dataFormat==="channelsLast",g=v?1:2,y=v?2:3,m=v?3:1,x="",b="";n&&(x=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+y+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+l+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+u+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+v+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+v+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+v+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+v+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+b+`
        setOutput(result);
      }
    `},SH=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+l+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+u+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(v===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(v===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(v===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},gS=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,v=e.outChannels/e.inChannels,g="",y="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,y="result = activation(result);");var m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+l+", "+u+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+v+`;
        int q = d2 - d1 * `+v+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+y+`
        setOutput(result);
      }
    `},yS=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,v=h,g="int xR; int xC; int xCOffset;",y=0;y<f;y++)for(var m=0;m<h;m++)g+=`
          vec4 xTexelR`+y+"C"+2*m+` = vec4(0.);
          vec4 wR`+y+"C"+m+` = vec4(0.);
          vec4 xR`+y+"C"+m+" = vec4(0.);";for(y=0;y<f;y++)for(var x=0;x<v;x++){if(g+=`
          xR = xRCorner + `+y*c+`;
          xC = xCCorner + `+(m=2*x)*d+`;
        `,u===1){if(m<h&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+y+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+y+"C"+m+" = vec4(previous.zw, xTexelR"+y+"C"+m+`.xy);
                } else {
                  xR`+y+"C"+m+" = vec4(0, 0, xTexelR"+y+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xR`+y+"C"+m+" = xTexelR"+y+"C"+m+`;
              `,m+1<h)){var b=s%2==0?GP(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+y+"C"+m+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+y+"C"+(m+1)+` = vec4(
                    xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+y+"C"+(m+1)+" = xTexelR"+y+"C"+(m+2)+`;
                `}}else m<h&&(g+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+u+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+y+"C"+(m+2)+` = vec4(0.);
                }

                xR`+y+"C"+m+` = vec4(
                  xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.zw);
              `,m+1<h&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+u+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+y+"C"+(m+1)+" = vec4(xTexelR"+y+"C"+(m+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+y+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+u+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+(m+2)+` = vec4(0.);
                }

                xR`+y+"C"+m+` = vec4(
                  xTexelR`+y+"C"+m+".xy, xTexelR"+y+"C"+(m+2)+`.xy);
              `,m+1<h&&(g+=`
                  xR`+y+"C"+(m+1)+` = vec4(
                    xTexelR`+y+"C"+m+".zw, xTexelR"+y+"C"+(m+2)+`.zw);
                `)),g+="}");m<h&&(g+=`
            vec4 wTexelR`+y+"C"+m+" = getW("+y+", "+m+`, d1, q);
            wR`+y+"C"+m+" = vec4(wTexelR"+y+"C"+m+".xz, wTexelR"+y+"C"+m+`.xz);
          `,m+1<h&&(g+=`
              vec4 wTexelR`+y+"C"+(m+1)+" = getW("+y+", "+(m+1)+`, d1, q);
              wR`+y+"C"+(m+1)+` =
                vec4(wTexelR`+y+"C"+(m+1)+".xz, wTexelR"+y+"C"+(m+1)+".xz);"))}for(y=0;y<f;y++)for(m=0;m<h;m++)g+="dotProd += xR"+y+"C"+m+" * wR"+y+"C"+m+";";var w="",C="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,C="result = activation(result);");var E=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+l+", "+u+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+E+`
        `+C+`
        setOutput(result);
      }
    `},EH=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],l=e[3],u=t[0],c=n[0],d=n[1];this.outputShape=[u,c,d,l];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],v=h[0],g=h[1],y=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+v+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+v],m=y[0],x=y[1],b=y[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],C=w[0],E=w[1],_=w[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+C+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+x+`;
        float width_scale = `+E+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+v+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+_+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},_H=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+vt(r)+` coords = getOutputCoords();
        int end = `+xS(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+xS(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function xS(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var kH=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Nc.DENSE;var t=Gu(e),n=Mn();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ba(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},NH=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Nc.DENSE;var t=Gu(e),n=Mn();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ba(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},TH=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),RH=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},PH=function(e){this.variableNames=["A"],this.outTexUsage=gr.DOWNLOAD;var t=Mn();this.outputShape=e,this.userCode=`
      `+_A+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},AH=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=gr.DOWNLOAD;var t=Mn();this.outputShape=e,this.userCode=`
      `+_A+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},IH=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Mn(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+Ux(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},MH=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Mn(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var u=0;u<=1;u++){var c=2*l+u;a+=`
          localCoords = coords;
          if(localCoords[2] + `+u+" < "+e[2]+`) {
            localCoords[2] += `+u+`;
            if(localCoords[1] + `+l+" < "+e[1]+`) {
              localCoords[1] += `+l+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Ux(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},DH="return real * expR - imag * expI;",jH="return real * expI + imag * expR;",bS=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},FH=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),OH=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=vt(this.rank),i=function(a,s){var l=a.length;if(l>4)throw Error("Gather for rank "+l+" is not yet supported");if(l===1)return"int(getIndices(resRC))";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<a.length;d++)d===s?c.push("int(getIndices("+u[d]+"))"):c.push(""+u[d]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},LH=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=vt(t.length),o=vt(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function BH(e,t){var n=Mn();return DU(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function VH(e,t){return BU(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function zH(e,t){return VU(e,t,new Uint16Array([0,1,2,2,1,3]))}function ed(e,t,n,r,o,i,a){WU(n,r);var s=zU(e,t),l=e.TEXTURE_2D;return ke(e,t,function(){return e.bindTexture(l,s)}),ke(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ke(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ke(e,t,function(){return e.texParameteri(l,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ke(e,t,function(){return e.texParameteri(l,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ke(e,t,function(){return e.texImage2D(l,0,o,n,r,0,i,a,null)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function WH(e,t,n,r,o){var i=Cp(n,r);return ed(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function $H(e,t,n,r,o){var i=Cp(n,r);return ed(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function UH(e,t,n,r,o){var i=Cp(n,r);return ed(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function HH(e,t,n,r,o){var i=Jc(n,r);return ed(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function GH(e,t,n,r,o){var i=Jc(n,r);return ed(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function qH(e,t,n,r){return ke(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),sS(e,t,n,"clipSpacePos",r,3,20,0)&&sS(e,t,n,"uv",r,2,20,12)}function KH(e,t,n,r,o,i,a){var s,l,u;ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),l=e.UNSIGNED_BYTE,u=e.RGBA):(s=new Float32Array(r*o*4),l=e.FLOAT,u=a.internalFormatPackedFloat),s.set(i),ke(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,u,r,o,0,e.RGBA,l,s)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function XH(e,t,n,r){ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ke(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):ke(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),ke(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function YH(e,t,n,r,o){var i=e.createBuffer();ke(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return ke(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),ke(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),ke(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function QH(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function ZH(e,t,n,r,o){var i=Cp(n,r),a=i[0],s=i[1],l=new Uint8Array(n*r*4);return ke(e,t,function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,l)}),new Float32Array(l.buffer)}function JH(e,t,n,r,o,i,a,s){var l=e,u=new Float32Array(function(c,d){var f=Jc(c,d);return f[0]*f[1]*4}(i,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function eG(e,t,n,r){var o=new Float32Array(n*r*4);return ke(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)}),o}var tG=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=te().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,RU(n,t)):this.gl=Wo(n);var r="WEBGL_color_buffer_float";if(te().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Hd(this.gl,this.debug,"OES_texture_float"),Or(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Hd(this.gl,this.debug,"OES_texture_half_float");else if(te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Or(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Hd(this.gl,this.debug,"EXT_color_buffer_half_float");else if(te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Or(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Or(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=VH(this.gl,this.debug),this.indexBuffer=zH(this.gl,this.debug),this.framebuffer=$U(this.gl,this.debug),this.textureConfig=Dx(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return te().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ke(n,this.debug,function(){return n.finish()}),ke(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ke(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ke(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ke(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ke(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),WH(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),$H(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),UH(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),XH(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,o){this.throwIfDisposed(),KH(this.gl,this.debug,t,n,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),GH(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),HH(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(lS(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ke(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return ZH(o.gl,o.debug,n,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,o,i,a){return JH(this.gl,t,0,0,0,i,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return QH(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var o=YH(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,o=this;if(te().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return eG(o.gl,o.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=jU(n,this.debug,t),o=BH(n,this.debug),i=OU(n,this.debug);return ke(n,this.debug,function(){return n.attachShader(i,o)}),ke(n,this.debug,function(){return n.attachShader(i,r)}),LU(n,this.debug,i),this.debug&&Jm(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=qH(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ke(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Jm(this.gl,this.debug,this.program),ke(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?HU(this.gl,this.debug,t,n):GU(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),ke(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),qU(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var o=Jc(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(t,i,a)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&Jm(this.gl,this.debug,this.program),Gd(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ke(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ke(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Hd(this.gl,this.debug,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return be(this,void 0,void 0,function(){var n=this;return we(this,function(r){switch(r.label){case 0:return[4,tS(function(){return n.disposed||n.isQueryAvailable(t,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||tS(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),ev(this.gl,this.debug,t,this.framebuffer),this.debug&&Gd(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(ev(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Gd(this.gl)):lS(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var o=this.gl;ev(o,this.debug,t,this.framebuffer),this.debug&&Gd(o),this.outputTexture=t,ke(o,this.debug,function(){return o.viewport(0,0,n,r)}),ke(o,this.debug,function(){return o.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,o){var i=this;this.throwIfDisposed(),ke(this.gl,this.debug,function(){return i.gl.scissor(t,n,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function wS(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var o=n.logicalShape,i=t[r],a=i.shape;if(!hn(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!hn(s,l))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+l+" must match")}})}var nG=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,l=n.outWidth,u=n.dilationWidth,c=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,v=o*r,g=Mn(),y=d==="channelsLast",m=y?0:1,x=y?1:2,b="",w=0;w<=1;w++)for(var C=0;C<=1;C++)b+=`
          blockIndex = rc.y + `+C+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+l+")) * "+a+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+v+`);

            if(d0 < `+t[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+l+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+u+" * (int(mod(float(pos), "+v+".) / "+o+`.));

              if(d1 < `+t[x]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+y+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+C)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+C)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+g.output+` = result;
      }
    `},rG=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+l+")":o===1?"1.0/("+l+")":"exp(log("+l+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},oG=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},iG=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+l+")":o===1?"1.0/("+l+")":"exp(log("+l+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},aG=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,l=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+l+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},sG=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.front,d=l-1-e.padInfo.top,f=u-1-e.padInfo.left,h=s*l*u-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+l+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+u+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+l+" * "+u+` +
                  wR * `+u+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},iv=function(e,t,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],l=Math.ceil(s/2),u=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",v="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,v="result = activation(result);");var g=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+l+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+l+`; i++) {
          vec4 a = getMatrixA(rc.x, `+u+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+v+`

        setOutput(result);
      }
    `},lG=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),uG=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},cG=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=nr("rc",t),r=vt(t),o=function(s,l,u){if(s===1)return"rc > "+l[0];for(var c="",d=s-2;d<s;d++)c+=u[d]+" >= "+l[d],d<s-1&&(c+="||");return c}(t,e,n),i=function(s,l,u,c){if(s===1)return"";var d=c.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+l+`;
    bool rEdge = rp1 >= `+u+`;
  `}(t,e[e.length-1],e[e.length-2],n),a=function(s,l){var u=s.length,c=function(d,f){for(var h=[],v=0;v<=1;v++)for(var g=0;g<=1;g++){for(var y=(v===0?"r":"rp1")+", "+(g===0?"c":"cp1"),m=2;m<d;m++)y=f[f.length-1-m]+","+y;h.push(y)}return h}(u,l);return u===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},dG=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(l,u){return l[0]+e[u]+l[1]});var r=e.length,o=vt(r),i=t.map(function(l){return l[0]}).join(","),a=t.map(function(l,u){return l[0]+e[u]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},fG=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(y,m){return y[0]+e[m]+y[1]});for(var r=e.length,o=vt(r),i=t.map(function(y){return y[0]}).join(","),a=t.map(function(y,m){return y[0]+e[m]}).join(","),s=nr("rc",r),l=nr("source",r),u=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+l.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+u+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+u+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",v=0,g=r===1?2:4;v<g;v++)h+=`
        `+d[v]+`
        if (`+f+`) {
          result[`+v+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+v+"] = getChannel(getX("+l.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},av=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+l+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+u+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+u+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var v=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(v="avgValue / count");var g=4*Math.floor(r/4),y=r%4,m=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+l+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+g+`;
          if (`+(y===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(y===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(y===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+v+`);
      }
    `}},sv=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,v=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",m="0.0";if(y||(m="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+v+", "+g+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+l+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+u+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var b=4*Math.floor(r/4),w=r%4,C=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+v+", "+g+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+l+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+u+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+u+`, ch)
              );

              `+C+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                initializationValue
              );

              `+C+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},hG=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",s="min"):t==="max"&&(a="-1.0 / 1e-20",s="max");var l=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");var u=4*Math.floor(n/4),c=n%4,d=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+u+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+u+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+l+`);
      }
    `},pG=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Ba(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Ux(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},mG=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],l=a[2],u=[n&&s>1?o-1:o,n&&l>1?i-1:i],c=[n&&s>1?s-1:s,n&&l>1?l-1:l],d=u[0]/c[0],f=u[1]/c[1],h=1/d,v=1/f,g=2*Math.ceil(h)+2,y=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+l+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},vG=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?a-1:a],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+l[0]/u[0]+`,
          `+l[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},gG=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?a-1:a],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+l[0]/u[0]+`,
          `+l[1]/u[1]+`,
          `+l[1]/u[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},yG=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],l=a[2],u=[n&&s>1?o-1:o,n&&l>1?i-1:i],c=[n&&s>1?s-1:s,n&&l>1?l-1:l],d=u[0]/c[0],f=u[1]/c[1],h=1/d,v=1/f,g=2*Math.ceil(h)+2,y=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+l+`) {
              continue;
            }

            float sourceFracRow =
              float(`+u[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+u[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},xG=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?a-1:a],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+l[0]/u[0]+`,
          `+l[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},bG=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(i,a){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=vt(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},wG=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=nr("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=vt(n);function s(l){var u=e.map(function(c,d){return function(f,h){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+h[f]+" - 1":""+h[f]}(d,l)});return"getChannel(getX("+u.join(",")+"), vec2("+u.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(l){return s(l)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(l){return l[n-1]="("+l[n-1]+" + 1)",s(l)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(l){return l[n-2]="("+l[n-2]+" + 1)",s(l)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(l){return l[n-1]="("+l[n-1]+" + 1)",l[n-2]="("+l[n-2]+" + 1)",s(l)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},CS=function(e,t,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=vt(o.length),l=vt(i.length),u="";n===1?u="i":n===2&&(u="i, j");var c="getIndices("+u+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+l+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},CG=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),l=n%4,u=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+u+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(l===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+u+`
        } else if (`+(l===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+u+`
        } else if (`+(l===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+u+`
        }
        setOutput(sumValue);
      }
    `},SG=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],l=0;l<t.length;l++)s.push(""+i[l]),l<e&&a.push(""+i[l]);r=a.join(),o=s.join()}var u=vt(n);this.userCode=`
      void main() {
        `+u+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},EG=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=vt(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return lv.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(a,s){return"sourceLoc."+lv[s]+" = start["+s+"] + coords."+lv[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),lv=["x","y","z","w","u","v"],_G=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=vt(this.rank),r=nr("coords",this.rank),o=nr("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,l=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,d){return"start["+d+"]"}).join()+");":t.map(function(c,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+u+`
        vec4 result = vec4(0.);
        `+s+`
        `+l+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),kG=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=vt(n.length),i=vt(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(l,u){return s++,n.length===1?"coords * strides["+u+"] + begin["+u+"]":"coords["+(s-1)+"] * strides["+u+"] + begin["+u+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+e+`);
      `+o+" strides = "+o+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},NG=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var o,i=SS(n,r),a=ES(t,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===mr.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===mr.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===mr.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===mr.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===mr.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),o},e.prototype.releaseTexture=function(t,n,r,o){if(this.freeTextures!=null){var i=ES(n,SS(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function SS(e,t){if(e===gr.UPLOAD)return mr.PACKED_2X2_FLOAT32;if(e===gr.RENDER||e==null)return function(n){return te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?mr.PACKED_2X2_FLOAT32:mr.UNPACKED_FLOAT32:n?mr.PACKED_2X2_FLOAT16:mr.UNPACKED_FLOAT16}(t);if(e===gr.DOWNLOAD||e===gr.PIXELS)return mr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function ES(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var TG=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=vt(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],u=[],c=0;c<a.length;c++)u.push("imod("+l[c]+", "+a[c]+")");return u.join()}(e);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},RG=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=vt(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var l=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],u=new Array(s),c=0;c<a.length;c++)u[a[c]]=l[c];return u.join()}(t);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},PG=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=vt(this.rank),i=EA("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",l="++"+i[this.rank-1]+" < "+n[this.rank-1],u="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+u+`;
      if(`+l+`) {
        result[1] = `+u+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+u+`;
        if(`+l+`) {
          result[3] = `+u+`;
        }
      }
      setOutput(result);
    }
    `},Hx=1.7580993408473768,Gx=1.0507009873554805,Ve=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},fo="if (isnan(x)) return x;",AG="return x;",_S="return abs(x);",RA=fo+`
  return (x < 0.0) ? 0.0 : x;
`,PA=fo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,AA="return (x >= 0.0) ? x : (exp(x) - 1.0);",IG=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Hx+`;
  float scale = `+Gx+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,kS="return -x;",NS="return ceil(x);",TS="return floor(x);",RS="return exp(x);",PS="return exp(x) - 1.0;",MG=fo+`
  return sin(x);
`,DG=fo+`
  return cos(x);
`,jG=fo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,FG=fo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,OG=fo+`
  return atan(x);
`,LG=fo+"return log(x + sqrt(x * x + 1.0));",BG=fo+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,VG=fo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Yd="return x;",zG="return x;",IA=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,MA=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,DA=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,wu=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},WG=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=nr("rc",t),r=vt(t),o=function(s,l){if(s===1)return"rc";for(var u="",c=0;c<s;c++)u+=l[c],c<s-1&&(u+=",");return u}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},Qd={};function Zd(e,t){if(t===void 0&&(t=!1),e==="linear")return t?zG:AG;if(e==="relu")return t?IA:RA;if(e==="elu")return t?DA:AA;if(e==="relu6")return t?MA:PA;if(e==="prelu")return t?TA:NA;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var $G=600,UG=function(e){function t(n){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!te().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Wo(te().getNumber("WEBGL_VERSION"));o.binaryCache=((r=te().getNumber("WEBGL_VERSION"))in Qd||(Qd[r]={}),Qd[r]),o.gpgpu=new tG(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new NG(o.gpgpu),o.numMBBeforeWarning=te().global.screen==null?1024:te().global.screen.height*te().global.screen.width*window.devicePixelRatio*$G/1024/1024,o.texData=new mA(o,H),o}return co(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,o){if(te().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:gr.UPLOAD}),i},t.prototype.move=function(n,r,o,i){if(te().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:gr.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,l=r.shape,u=r.isPacked;if(s!=null){var c=void 0;c=u?new wu(l,Yd):new Ve(l,Yd);var d=this.runWebGLProgram(c,[{dataId:n,shape:l,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,v,g=this.activeTimers!=null;return g&&(h=wo()),i==="complex64"?v=Cy(a.real.dataSync(),a.imag.dataSync()):v=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=wo()-h),this.convertAndCacheOnCPU(n,v)},t.prototype.read=function(n){return be(this,void 0,void 0,function(){var r,o,i,a,s,l,u,c,d,f,h,v,g,y,m,x,b,w,C,E,_,N;return we(this,function(T){switch(T.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(k){return r.push(k)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,l=o.dtype,u=o.complexTensors,c=o.isPacked,s!=null)return d=void 0,d=c?new wu(a,Yd):new Ve(a,Yd),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:l}],l),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&te().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return v=null,l!=="complex64"&&te().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),y=this.texData.get(g.dataId),v=(N=this.gpgpu).createBufferFromTexture.apply(N,[y.texture].concat(Gu(a)))),this.pendingRead.set(n,[]),l==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:T.sent(),T.label=2;case 2:return l!=="complex64"?[3,4]:[4,Promise.all([u.real.data(),u.imag.data()])];case 3:return x=T.sent(),b=x[0],w=x[1],m=Cy(b,w),[3,5];case 4:v==null?m=this.getValuesFromTexture(n):(C=Se(a),m=this.gpgpu.downloadFloat32MatrixFromBuffer(v,C)),T.label=5;case 5:return g!=null&&this.disposeData(g.dataId),E=this.convertAndCacheOnCPU(n,m),_=this.pendingRead.get(n),this.pendingRead.delete(n),_.forEach(function(k){return k(E)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,E]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!IU(o))throw te().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,l=Se(i);if(te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(n),c=this.texData.get(u.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Gu(i))).subarray(0,l);return this.disposeData(u.dataId),d}var f=te().getBool("WEBGL_PACK")&&s===!0,h=f?tv(i):i,v=f?new AH(h):new PH(h),g=this.runWebGLProgram(v,[{shape:h,dtype:a,dataId:n}],"float32"),y=this.texData.get(g.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(y.texture,y.texShape[0],y.texShape[1]).subarray(0,l);return this.disposeData(g.dataId),m},t.prototype.time=function(n){return be(this,void 0,void 0,function(){var r,o,i,a,s,l,u;return we(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=zl(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=zl(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return u=c.sent(),l.kernelMs=fU(u),l.getExtraProfileInfo=function(){return u.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:l.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,l]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:wo(),endMs:null}},t.prototype.endTimer=function(n){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=wo(),n)},t.prototype.getQueryTime=function(n){return be(this,void 0,void 0,function(){var r;return we(this,function(o){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,l=r.isPacked,u=r.slice,c=u&&u.origDataId||n,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,l)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return te().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=H.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:H.keep(n.clone()),imag:H.keep(r.clone())},o},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(Se(o)===0)return bn([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=hA(n.shape,r,o);if(i||!a){var s=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _G(o):new EG(o),l=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,l)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},t.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var l=pA(r,n.strides);i.slice&&(l+=i.slice.flatOffset),s.slice={flatOffset:l,origDataId:i.slice&&i.slice.origDataId||n.dataId};var u=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,u+1),a},t.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=Bx(r,o,i);if(a.some(function(l){return l===0}))return bn([],a);var s=new kG(r,i,a);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var o=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wG(n.shape,r):new bG(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return Dr(h)}),i=n.map(function(h){return ko(h)});return yn(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>te().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),l=this.concat(n.slice(a),r);return this.concat([s,l],r)}if(te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var u=new vH(n.map(function(h){return h.shape}),r);return this.compileAndRun(u,n)}var c=$l(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,Se(h.shape.slice(r)))}),f=new mH(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,kS,n.dtype);var r=new Ve(n.shape,kS);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],l=o?n.shape[1]:n.shape[2],u=n.shape[0];if((a===1||s===1)&&l>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(u,l,1),d=s===1?2:1,f=s===1?r.as3D(u,1,l):r;return this.multiply(c,f).sum(d,!0)}var h=xn(n.dtype,r.dtype),v=new iv(n.shape,[u,a,s],o,i);return this.compileAndRun(v,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,l=n.activation,u=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=xn(r.dtype,o.dtype),v=s!=null,g=u!=null,y=l?Zd(l,!0):null,m=new iv(r.shape,[f,c,d],i,a,v,y,g),x=[r,o];return s&&x.push(s),u&&x.push(u),this.compileAndRun(m,x,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new pS(cH,n.shape,r.shape),s=new pS(dH,n.shape,r.shape),l=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],u=this.compileAndRun(a,l),c=this.compileAndRun(s,l),d=this.complex(u,c);return u.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,mS,n.dtype);var f=new Ft(mS,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){var l=[n,r,o],u=null;s!=null&&(u=s.shape,l.push(s));var c=null;if(a!=null&&(c=a.shape,l.push(a)),te().getBool("WEBGL_PACK_NORMALIZATION")){var d=new uH(n.shape,r.shape,o.shape,u,c,i);return this.compileAndRun(d,l)}var f=new lH(n.shape,r.shape,o.shape,u,c,i);return this.compileAndRun(f,l)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=te().getBool("WEBGL_PACK_NORMALIZATION")?new iG(n.shape,r,o,i,a):new rG(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,o,i,a,s,l){var u=new oG(r.shape,i,a,s,l);return this.compileAndRun(u,[r,o,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return bh(a)});return CA(Fe(n.shape,n.dtype,o),r)}var i=new TG(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,r,o){var i=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fG(n.shape,r,o):new dG(n.shape,r,o);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new PG(n.shape,r):new RG(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new OH(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},t.prototype.batchToSpaceND=function(n,r,o){O(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=kh(n.shape,r,i),s=Nh(a.length,r.length),l=Th(n.shape,r,i),u=uA(o,r.length),c=cA(l,o,r.length);return n.reshape(a).transpose(s).reshape(l).slice(u,c)},t.prototype.spaceToBatchND=function(n,r,o){O(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var l=n.pad(a),u=kh(l.shape,r,i,!1),c=Nh(u.length,r.length,!1),d=Th(l.shape,r,i,!1);return l.reshape(u).transpose(c).reshape(d)},t.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=nv(a),l=new hG({windowSize:s,inSize:a,batchSize:i},r),u=this.compileAndRun(l,[n],o);return u.shape[1]===1?u:this.reduce(u,r,o)},t.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=nv(a),l=new J8({windowSize:s,inSize:a,batchSize:i},r,o==null),u=[n];o!=null&&u.push(o);var c=this.compileAndRun(l,u,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=nv(i[i.length-1]),s=new iH(i,a,r,o==null),l=o==null?[n]:[n,o],u=this.compileAndRun(s,l,"int32");return u.rank===n.rank?this.argReducePacked(n,r,u):u},t.prototype.sum=function(n,r){hr("sum",r,n.rank);var o=Pn(n.shape,r),i=o[0],a=Se(o[1]),s=n.as2D(-1,a),l=Km(n.dtype);return this.reduce(s,"sum",l).reshape(i)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Pn(n.shape,r),i=o[0],a=Se(o[1]),s=n.as2D(-1,a),l=Km(n.dtype);return this.reduce(s,"prod",l).reshape(i)},t.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=$o([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Uo(1,n.rank)[0]);var l=function(h,v,g){for(var y=[],m=h.length,x=0;x<m;x++)x!==v?y.push(h[x]):y.push(g);return y}(s.shape,i,o),u=Se([s.shape[i]]),c=s.as2D(-1,u),d=Km(n.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,o).reshape(l);return a!=null&&(f=f.transpose(jx(a))),f},t.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],l=n.shape[1],u=function(f,h){var v,g=!1;for(f<=fA?(v=f,g=!0):v=hy(f,Math.floor(Math.sqrt(f)));!g;)v>h||v===f?g=!0:v=hy(f,v+1);return v}(l,a),c=new CG({windowSize:u,inSize:l,batchSize:s,numSegments:a}),d=this.compileAndRun(c,[n,o],i);return d.shape[1]===a?d:(o=_h(0,a).tile([l/u]),this.segOpCompute(d,r,o,i,a))},t.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(hr("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!te().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Pn(n.shape,i),s=a[0],l=Se(a[1]),u=n.as2D(-1,l);return this.argReduce(u,o).reshape(s)}return this.argReducePacked(n,o)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new _H(n.shape,o,i);return this.compileAndRun(a,[n])},t.prototype.equal=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new Ft("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new Ft("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new Ft("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new Ft("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new Ft("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new Ft("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Ve(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new Ft("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new Ft("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.select=function(n,r,o){var i=new SG(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],xn(r.dtype,o.dtype))},t.prototype.where=function(n){Sh("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return $x(n.shape,r)},t.prototype.topk=function(n,r,o){return SA(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){hr("min",r,n.rank);var o=Pn(n.shape,r),i=o[0],a=Se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ft(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.mod=function(n,r){var o=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ft(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);hr("max",r,n.rank);var o=Pn(n.shape,r),i=o[0],a=Se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ft(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.all=function(n,r){hr("all",r,n.rank);var o=Pn(n.shape,r),i=o[0],a=Se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},t.prototype.any=function(n,r){hr("any",r,n.rank);var o=Pn(n.shape,r),i=o[0],a=Se(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},t.prototype.realDivide=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new Ft(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new Ft(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,rv);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=xn(n.dtype,r.dtype);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,rv,o);var i=new Ft(rv,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.packedUnaryOp=function(n,r,o){var i=new wu(n.shape,r);return this.compileAndRun(i,[n],o)},t.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new Yo(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},t.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),l=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],v=f[1],g=i.makeComplexComponentTensorInfo(n,h),y=i.makeComplexComponentTensorInfo(r,v),m=new Ft(o,n.shape,r.shape);return i.compileAndRun(m,[g,y],xn(h.dtype,v.dtype))}),u=l[0],c=l[1],d=this.complex(u,c);return u.dispose(),c.dispose(),d},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>te().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(u){return u.dtype}).reduce(function(u,c){return xn(u,c)}),s=n.map(function(u){return u.shape}),l=te().getBool("WEBGL_PACK")?new Z8(n[0].shape,s):new Q8(n[0].shape,s);return this.compileAndRun(l,n,a)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,ov);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=xn(n.dtype,r.dtype);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,ov,n.dtype);var i=new Ft(ov,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.pow=function(n,r){var o=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ft(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=xn(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,NS,n.dtype);var r=new Ve(n.shape,NS);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,TS,n.dtype);var r=new Ve(n.shape,TS);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Ve(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Ve(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Ve(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Ve(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Ve(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,RS,n.dtype);var r=new Ve(n.shape,RS);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,PS,n.dtype);var r=new Ve(n.shape,PS);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var o=an([r],n.shape),i=this.max(n,o),a=ur(i.shape,o),s=this.subtract(n,i.reshape(a)),l=this.exp(s),u=this.sum(l,o).reshape(a);return this.realDivide(l,u)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Ve(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Ve(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Ve(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Ve(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Ve(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=te().getBool("WEBGL_PACK")?new wu(n.shape,IA):new Ve(n.shape,RA),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=te().getBool("WEBGL_PACK")?new wu(n.shape,MA):new Ve(n.shape,PA),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var o=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo(TA,n.shape,r.shape):new Ft(NA,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.elu=function(n){if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,DA,n.dtype);var r=new Ve(n.shape,AA);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var o=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new Ft("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.selu=function(n){var r=new Ve(n.shape,IG);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Ve(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,o){var i,a=(i=te().getBool("WEBGL_PACK_CLIP")?new hH(n.shape):new fH(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,_S,n.dtype);var r=new Ve(n.shape,_S);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new pH(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},t.prototype.sigmoid=function(n){var r=new Ve(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Ve(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Ve(n.shape,MG);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Ve(n.shape,DG);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Ve(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Ve(n.shape,jG);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Ve(n.shape,FG);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Ve(n.shape,OG);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var o=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ft(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.sinh=function(n){var r=new Ve(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Ve(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Ve(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Ve(n.shape,LG);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Ve(n.shape,BG);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Ve(n.shape,VG);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Ve(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var o=new Ve(n.shape,function(i){return i===void 0&&(i=0),fo+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},t.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var l=n.shape,u=this.texData.get(n.dataId),c=o.inChannels,d=l[0]*l[1]*l[2],f=o.outChannels,h=o.dataFormat==="channelsLast",v=(d===1||f===1)&&c>1e3,g=l[2]%2!=0&&!!u.isPacked;if(v||!te().getBool("WEBGL_LAZILY_UNPACK")||!te().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var y=h?l[0]*l[1]*l[2]:l[0]*l[2]*l[3],m=this.reshape(n,[1,y,o.inChannels]),x=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:x,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var b=h?l[0]*l[1]*(l[2]+1):l[0]*l[2]*(l[3]+1),w={dataId:n.dataId,shape:[1,b,o.inChannels],dtype:n.dtype},C=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,O(Kd(u.shape,w.shape),function(){return"packed reshape "+u.shape+" to "+w.shape+" isn't free"});var E=this.reshape(r,[1,o.inChannels,o.outChannels]),_=this.fusedBatchMatMul({a:w,b:E,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),N=this.texData.get(_.dataId);return O(N.isPacked,function(){return"batchMatMul result is expected to be packed"}),u.shape=C,N.shape=o.outShape,H.makeTensorFromDataId(_.dataId,o.outShape,_.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var l=o.filterWidth,u=o.filterHeight,c=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",v=l*u*c,g=f*d,y=[v,g],m=n.squeeze([0]),x=r.reshape([1,v,-1]),b=new nG(y,m.shape,o),w=this.compileAndRun(b,[m]).reshape([1,y[0],y[1]]),C=i!=null,E=s!=null,_=a?Zd(a,!0):null,N=new iv(w.shape,[1,g,o.outChannels],!0,!1,C,_,E),T=[w,x];i&&T.push(i),E&&T.push(s);var k=this.compileAndRun(N,T);return h?k.reshape([1,f,d,o.outChannels]):k.reshape([1,o.outChannels,f,d])},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,l=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,l);if(te().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,l);var u=a!=null,c=l!=null,d=s?Zd(s,!1):null,f=new vS(i,u,d,c),h=[r,o];return a&&h.push(a),l&&h.push(l),this.compileAndRun(f,h)},t.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(te().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new vS(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerInput=function(n,r,o){var i=new yH(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerFilter=function(n,r,o){var i=new gH(o);return this.compileAndRun(i,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,l=n.activation,u=n.preluActivationWeights,c=te().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=l?Zd(l,c):null,f=[o,i],h=s!=null,v=u!=null;return h&&f.push(s),v&&f.push(u),c?(r=new yS(a,h,d,v),this.compileAndRun(r,f)):(r=new gS(a,h,d,v),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(n,r,o){var i;return te().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new yS(o),this.compileAndRun(i,[n,r])):(i=new gS(o),this.compileAndRun(i,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new CH(o);return this.compileAndRun(i,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new wH(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3d=function(n,r,o){var i=new SH(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerInput=function(n,r,o){var i=new bH(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerFilter=function(n,r,o){var i=new xH(o);return this.compileAndRun(i,[n,r])},t.prototype.maxPool=function(n,r){var o=new av(r,"max",!1);return this.compileAndRun(o,[n])},t.prototype.avgPool=function(n,r){var o=new av(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,o,i){var a=new av(i,"max",!0),s=this.compileAndRun(a,[r]),l=new aG(i),u=this.compileAndRun(l,[n,s],r.dtype);return s.dispose(),u},t.prototype.avgPoolBackprop=function(n,r,o){var i=new aH(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.cast=function(n,r){return yA(n,r,this)},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var l=new Array(n.rank).fill(0),u=n.shape.slice();u[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)l[r]=s,c[s]=this.slice(n,l,u).reshape(i);return c},t.prototype.avgPool3d=function(n,r){var o=new sv(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,o){var i=new sH(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var o=new sv(r,"max",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new sv(i,"max",!0),s=this.compileAndRun(a,[r]),l=new sG(i),u=this.compileAndRun(l,[n,s],r.dtype);return s.dispose(),u},t.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!Kd(n.shape,r)&&(o.texture===null||!Kd(o.shape,r))){var i=this.packedReshape(n,r);return H.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return wy(n,r)},t.prototype.resizeBilinear=function(n,r,o,i){var a=te().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new gG(n.shape,r,o,i):new vG(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,o){var i=new mG(n,r,o);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new xG(n.shape,r,o,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new yG(n,r,o);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,r,o,i){var a=r?n:gi(n),s=a.shape[0],l=a.shape[1],u=new lG(s,l,o),c=u.getCustomSetupFunc(i);return this.compileAndRun(u,[a],"int32",c)},t.prototype.oneHot=function(n,r,o,i){var a=new uG(n.size,r,o,i);return this.compileAndRun(a,[n])},t.prototype.diag=function(n){var r=new RH(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return Sh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),zx(n.dataSync(),r.dataSync(),o,i,a)},t.prototype.cropAndResize=function(n,r,o,i,a,s){var l=new EH(n.shape,r.shape,i,a,s);return this.compileAndRun(l,[n,r,o],"float32")},t.prototype.depthToSpace=function(n,r,o){O(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],l=o==="NHWC"?n.shape[3]:n.shape[1],u=a*r,c=s*r,d=l/(r*r),f=new TH(o==="NHWC"?[i,u,c,d]:[i,d,u,c],r,o);return this.compileAndRun(f,[n])},t.prototype.split=function(n,r,o){return wA(n,r,o)},t.prototype.scatterND=function(n,r,o){var i=Rh(0,n,o),a=i.sliceRank,s=i.numUpdates,l=i.sliceSize,u=i.strides,c=i.outputSize,d=[c/l,l],f=n.reshape([s,a]),h=r.reshape([s,l]);if(c===0)return wy(bn([]),o);var v=de(0),g=new CS(s,a,f.rank,h.rank,u,d);return this.compileAndRun(g,[h,f,v]).reshape(o)},t.prototype.sparseToDense=function(n,r,o,i){var a=Rh(0,n,o),s=a.sliceRank,l=a.numUpdates,u=a.strides,c=a.outputSize,d=new CS(l,s,n.rank,r.rank,u,[c,1]);return this.compileAndRun(d,[r,n,i]).reshape(o)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new bS(DH,n.shape,r),a=new bS(jH,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],l=this.compileAndRun(i,s),u=this.compileAndRun(a,s),c=this.complex(l,u).as2D(n.shape[0],n.shape[1]);return l.dispose(),u.dispose(),c},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=dA(n,r),s=a[0],l=a[1],u=a[2],c=a[3],d=r.reshape([l,i]),f=n.reshape([n.size/u,u]),h=new LH(i,c,[l,u]);return this.compileAndRun(h,[f,d]).reshape(s)},t.prototype.fill=function(n,r,o){if((o=o||Qc(r))==="string"){var i=xh(o,Se(n));return i.fill(r),H.makeTensor(i,n,o,this)}var a=new FH(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,o){return xA(n,r,o)},t.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return H.makeTensorFromDataId(o,n,r,this)},t.prototype.unpackTensor=function(n){var r=new WG(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new cG(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var o=[wh(n.shape)].concat(Ch(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[wh(r)].concat(Ch(r)),s=new pG(a,o),l=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:l.dataId,shape:r,dtype:l.dtype}},t.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,l=tv(a);return r=i?new NH(l):new kH(l),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:l,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var l=this.makeTensorInfo(n.outputShape,o),u=this.texData.get(l.dataId);if(n.packedOutput&&(u.isPacked=!0),n.outPackingScheme===Nc.DENSE){var c=Gu(n.outputShape);u.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(u.usage=n.outTexUsage),Se(l.shape)===0)return u.values=_c(l.dtype,0),l;var d=[],f=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(b.dataId);if(w.texture==null){if(!n.packedInputs&&Se(b.shape)<=te().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=b.shape)}else if(!!w.isPacked!=!!n.packedInputs)b=w.isPacked?s.unpackTensor(b):s.packTensor(b),d.push(b),w=s.texData.get(b.dataId);else if(w.isPacked&&!Kd(w.shape,b.shape)){var C=b,E=b.shape;b.shape=w.shape,b=s.packedReshape(b,E),d.push(b),w=s.texData.get(b.dataId),C.shape=E}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:w,isUniform:!1}});this.uploadToGPU(l.dataId);var h,v={shape:l.shape,texData:u,isUniform:!1},g=function(b,w,C){var E="";w.concat(C).forEach(function(T){var k=T.texData!=null&&T.texData.slice!=null&&T.texData.slice.flatOffset>0,I=T.isUniform?"uniform":T.texData.texShape;E+=T.shape+"_"+I+"_"+k});var _=b.userCode,N=b.constructor.name;return N+="_"+E+"_"+_}(n,f,v),y=this.getAndSaveBinary(g,function(){return function(b,w,C,E){var _=w.userCode,N=C.map(function(M,j){var R={logicalShape:M.shape,texShape:M.isUniform?null:M.texData.texShape,isUniform:M.isUniform,isPacked:!M.isUniform&&M.texData.isPacked,flatOffset:null};return M.texData!=null&&M.texData.slice!=null&&M.texData.slice.flatOffset>0&&(R.flatOffset=M.texData.slice.flatOffset),{name:w.variableNames[j],shapeInfo:R}}),T=N.map(function(M){return M.shapeInfo}),k={logicalShape:E.shape,texShape:E.texData.texShape,isUniform:!1,isPacked:E.texData.isPacked,flatOffset:null},I=eH(N,k,_,w.packedInputs),A=b.createProgram(I),U=null,B=b.getUniformLocation(A,"NAN",!1);te().getNumber("WEBGL_VERSION")===1&&(U=b.getUniformLocation(A,"INFINITY",!1));for(var L={},V=0;V<w.variableNames.length;V++){var F=w.variableNames[V];L[F]=b.getUniformLocation(A,F,!1),L["offset"+F]=b.getUniformLocation(A,"offset"+F,!1)}return{program:w,source:I,webGLProgram:A,uniformLocations:L,inShapeInfos:T,outShapeInfo:k,infLoc:U,nanLoc:B}}(s.gpgpu,n,f,v)}),m=this.activeTimers!=null;if(m&&(h=this.startTimer()),function(b,w,C,E,_){wS(w.inShapeInfos,C),wS([w.outShapeInfo],[E]);var N=E.texData.texture,T=E.texData.texShape;E.texData.isPacked?b.setOutputPackedMatrixTexture(N,T[0],T[1]):b.setOutputMatrixTexture(N,T[0],T[1]),b.setProgram(w.webGLProgram),te().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&b.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&b.gl.uniform1f(w.nanLoc,NaN),C.forEach(function(k,I){var A=w.program.variableNames[I],U=w.uniformLocations[A],B=w.uniformLocations["offset"+A];if(U!=null)if(k.isUniform)if(Se(k.shape)<2)b.gl.uniform1f(U,k.uniformValues[0]);else{var L=k.uniformValues;L instanceof Float32Array||(L=new Float32Array(L)),b.gl.uniform1fv(U,L)}else k.texData.slice!=null&&B!=null&&b.gl.uniform1i(B,k.texData.slice.flatOffset),b.setInputMatrixTexture(k.texData.texture,U,I)}),_!=null&&_(b,w.webGLProgram),b.executeProgram()}(this.gpgpu,y,f,v,i),d.forEach(function(b){return s.disposeData(b.dataId)}),m&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!te().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&a===!1){var x=this.unpackTensor(l);return this.disposeData(l.dataId),x}return l},t.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return H.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(te().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=me(function(){if(!te().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=te().getBool("DEBUG");te().set("DEBUG",!1);var o=n.abs(de(1e-8)).dataSync()[0];if(te().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,l=o.texture,u=o.usage,c=o.isPacked;if(l==null){var d,f=this.activeTimers!=null;f&&(d=wo());var h=o.texShape;if(h==null&&(h=YU(i,c),o.texShape=h),s!=null){var v=tv(i),g=void 0,y=h[1],m=h[0],x=s instanceof Uint8Array;c?(y=(r=Jc(h[0],h[1]))[0],m=r[1],g=new MH(v,[m,y],x)):g=new IH(v,[m,y],x);var b=this.makeTensorInfo([m,y],a);this.texData.get(b.dataId).usage=x?gr.PIXELS:gr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),y,m,s);var w=this.runWebGLProgram(g,[b],a,null,!0),C=this.texData.get(w.dataId);o.texture=C.texture,o.texShape=C.texShape,o.isPacked=C.isPacked,o.usage=C.usage,this.disposeData(b.dataId),this.texData.delete(w.dataId),o.values=null,f&&(this.uploadWaitMs+=wo()-d)}else{var E=this.acquireTexture(h,u,a,c);o.texture=E}}},t.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var l=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),u=0;u<l.length;++u)l[u]=Math.round(a[u]);return l}throw new Error("Unknown dtype "+s)}(r,i)),o.values},t.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*qP(r)},t}(vA);eA()&&H.registerBackend("webgl",function(){return new UG},2);var HG=$({square_:function(e){var t=D(e,"x","square"),n=[t];return H.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),Rc="SquaredDifference",jA=$({squaredDifference_:function(e,t){var n,r=D(e,"a","squaredDifference"),o=D(t,"b","squaredDifference");n=jt(r,o),r=n[0],o=n[1],He(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return H.runKernelFunc(function(s,l){var u=s.squaredDifference(r,o);return l([r,o]),u},i,function(s,l){var u=l[0],c=l[1],d=de(2);return{a:function(){return s.mul(u.sub(c).mul(d))},b:function(){return s.mul(c.sub(u).mul(d))}}},Rc,{},a,[])}}),GG=$({abs_:function(e){var t=D(e,"x","abs");return t.dtype==="complex64"?H.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):H.runKernelFunc(function(n,r){var o=n.abs(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),qG=$({acos_:function(e){var t=D(e,"x","acos");return H.runKernelFunc(function(n,r){var o=n.acos(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(de(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),KG=$({acosh_:function(e){var t=D(e,"x","acosh");return H.runKernelFunc(function(n,r){var o=n.acosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),XG=$({asin_:function(e){var t=D(e,"x","asin");return H.runKernelFunc(function(n,r){var o=n.asin(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(de(1).sub(o.toFloat().square()).sqrt())}}})}}),YG=$({asinh_:function(e){var t=D(e,"x","asinh");return H.runKernelFunc(function(n,r){var o=n.asinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(de(1).add(o.toFloat().square()).sqrt())}}})}}),QG=$({atan_:function(e){var t=D(e,"x","atan");return H.runKernelFunc(function(n,r){var o=n.atan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),ZG=$({atanh_:function(e){var t=D(e,"x","atanh");return H.runKernelFunc(function(n,r){var o=n.atanh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(de(1).sub(o.toFloat().square()))}}})}}),JG=$({ceil_:function(e){var t=D(e,"x","ceil");return H.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Ye(n)}}})}}),qx=$({clipByValue_:function(e,t,n){var r=D(e,"x","clipByValue");O(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var o=[r],i={min:t,max:n};return H.runKernelFunc(function(a,s){var l=a.clip(r,t,n);return s([r]),l},{x:r},function(a,s){var l=s[0];return{x:function(){return a.where(l.greaterEqual(t).logicalAnd(l.lessEqual(n)),Ye(a))}}},"ClipByValue",i,o)}}),e7=$({cos_:function(e){var t=D(e,"x","cos"),n=[t];return H.runKernelFunc(function(r,o){var i=r.cos(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),t7=$({cosh_:function(e){var t=D(e,"x","cosh");return H.runKernelFunc(function(n,r){var o=n.cosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),n7=$({erf_:function(e){var t=D(e,"x","erf");return O(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),H.runKernelFunc(function(n,r){var o=n.erf(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Sy=$({exp_:function(e){var t=D(e,"x","exp");return H.runKernelFunc(function(n,r){var o=n.exp(t);return r([o]),o},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),r7=$({expm1_:function(e){var t=D(e,"x","expm1");return H.runKernelFunc(function(n,r){var o=n.expm1(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),o7=$({floor_:function(e){var t=D(e,"x","floor");return H.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Ye(n)}}})}}),i7=$({log_:function(e){var t=D(e,"x","log"),n=[t];return H.runKernelFunc(function(r,o){var i=r.log(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),a7=$({log1p_:function(e){var t=D(e,"x","log1p");return H.runKernelFunc(function(n,r){var o=n.log1p(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),s7=$({logSigmoid_:function(e){var t=D(e,"x","logSigmoid");return H.runKernelFunc(function(n,r){var o=n.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),Mh=$({neg_:function(e){var t=D(e,"x","neg"),n=[t];return H.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),l7=$({reciprocal_:function(e){var t=D(e,"x","reciprocal");return H.runKernelFunc(function(n,r){var o=n.reciprocal(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),u7=$({round_:function(e){var t=D(e,"x","round");return H.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Ye(n)}}})}}),FA=$({rsqrt_:function(e){var t=D(e,"x","rsqrt"),n=[t];return H.runKernelFunc(function(r,o){var i=r.rsqrt(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),OA=$({sigmoid_:function(e){var t=D(e,"x","sigmoid");return H.runKernelFunc(function(n,r){var o=n.sigmoid(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(de(1).sub(o)))}}},"Sigmoid")}}),c7=$({sign_:function(e){var t=D(e,"x","sign");return H.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Ye(n)}}})}}),d7=$({isNaN_:function(e){var t=D(e,"x","isNaN");return H.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Ye(n)}}})}}),f7=$({isInf_:function(e){var t=D(e,"x","isInf");return H.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Ye(n)}}})}}),h7=$({isFinite_:function(e){var t=D(e,"x","isFinite");return H.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Ye(n)}}})}}),p7=$({sin_:function(e){var t=D(e,"x","sin"),n=[t];return H.runKernelFunc(function(r,o){var i=r.sin(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),m7=$({sinh_:function(e){var t=D(e,"x","sinh");return H.runKernelFunc(function(n,r){var o=n.sinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),v7=$({softplus_:function(e){var t=D(e,"x","softplus");return H.runKernelFunc(function(n,r){var o=n.softplus(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),g7=$({sqrt_:function(e){var t=D(e,"x","sqrt");return H.runKernelFunc(function(n,r){var o=n.sqrt(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),y7=$({step_:function(e,t){t===void 0&&(t=0);var n=D(e,"x","step");return H.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return Ye(r)}}})}}),x7=$({tan_:function(e){var t=D(e,"x","tan");return H.runKernelFunc(function(n,r){var o=n.tan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),b7=$({tanh_:function(e){var t=D(e,"x","tanh");return H.runKernelFunc(function(n,r){var o=n.tanh(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return de(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function LA(e,t,n,r,o,i){var a,s,l=D(e,"x","batchNorm"),u=D(t,"mean","batchNorm"),c=D(n,"variance","batchNorm");return o!=null&&(a=D(o,"scale","batchNorm")),r!=null&&(s=D(r,"offset","batchNorm")),O(l.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),O(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+u.rank+"."}),O(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&O(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&O(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),td(l,u,c,s,a,i)}function BA(e,t,n,r,o,i){var a,s,l=D(e,"x","batchNorm"),u=D(t,"mean","batchNorm"),c=D(n,"variance","batchNorm");return o!=null&&(a=D(o,"scale","batchNorm")),r!=null&&(s=D(r,"offset","batchNorm")),O(l.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),O(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+u.rank+"."}),O(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&O(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&O(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),td(l,u,c,s,a,i)}function VA(e,t,n,r,o,i){var a,s,l=D(e,"x","batchNorm"),u=D(t,"mean","batchNorm"),c=D(n,"variance","batchNorm");return o!=null&&(a=D(o,"scale","batchNorm")),r!=null&&(s=D(r,"offset","batchNorm")),O(l.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+l.rank+"."}),O(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+u.rank+"."}),O(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&O(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&O(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),td(l,u,c,s,a,i)}function td(e,t,n,r,o,i){i==null&&(i=.001);var a,s,l,u=D(e,"x","batchNorm"),c=D(t,"mean","batchNorm"),d=D(n,"variance","batchNorm");o!=null&&(a=D(o,"scale","batchNorm")),r!=null&&(s=D(r,"offset","batchNorm")),O(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),O(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),O(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),l=u.rank===0||u.rank===1?u.as4D(1,1,1,u.size):u.rank===2?u.as4D(1,1,u.shape[0],u.shape[1]):u.rank===3?u.as4D(1,u.shape[0],u.shape[1],u.shape[2]):u;var f=[u,c,d,a];return H.runKernelFunc(function(h,v){var g=h.batchNormalization(l,Jd(c),Jd(d),i,Jd(a),Jd(s));return v([u,c,d,a]),g},{x:u,mean:c,variance:d,scale:a,offset:s},function(h,v){var g=v,y=g[0],m=g[1],x=g[2],b=g[3],w=b??de(1),C=rn(m.shape,l.shape),E=[];if(m.rank===1){for(var _=0;_<l.shape.length-1;++_)E.push(l.shape[_]);E.push(1)}var N=y.sub(m),T=h.mul(w),k=FA(x.add(de(i))),I=k.mul(k).mul(k).mul(de(-.5));return{x:function(){return m.rank===1?h.mul(dl(k.as4D(1,1,1,m.shape[0]),E)).mul(w).reshape(y.shape):h.mul(k).mul(w).reshape(y.shape)},mean:function(){var A=k.mul(de(-1)).mul(T);return m.rank===1&&(A=A.sum(C)),A.reshape(m.shape)},variance:function(){var A=I.mul(N).mul(T);return m.rank===1&&(A=A.sum(C)),A.reshape(m.shape)},scale:function(){var A=N.mul(k),U=h.mul(A);return m.rank===1&&(U=U.sum(C)),U.reshape(m.shape)},offset:function(){var A=h;return m.rank===1&&(A=A.sum(C)),A.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(u.shape)}function Jd(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function _p(){tA("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var w7=$({batchNormalization2d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),_p(),LA(e,t,n,i,o,r)}}),C7=$({batchNormalization3d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),_p(),BA(e,t,n,i,o,r)}}),S7=$({batchNormalization4d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),_p(),VA(e,t,n,i,o,r)}}),E7=$({batchNormalization_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),_p(),td(e,t,n,i,o,r)}}),zA=$({batchNorm_:td}),_7=$({batchNorm2d_:LA}),k7=$({batchNorm3d_:BA}),N7=$({batchNorm4d_:VA}),kp=$({logicalAnd_:function(e,t){var n=D(e,"a","logicalAnd","bool"),r=D(t,"b","logicalAnd","bool");return He(n.shape,r.shape),H.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),T7=$({logicalNot_:function(e){var t=D(e,"x","logicalNot","bool");return H.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),WA=$({logicalOr_:function(e,t){var n=D(e,"a","logicalOr","bool"),r=D(t,"b","logicalOr","bool");return He(n.shape,r.shape),H.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),R7=$({logicalXor_:function(e,t){var n=D(e,"a","logicalXor","bool"),r=D(t,"b","logicalXor","bool");return He(n.shape,r.shape),WA(e,t).logicalAnd(kp(e,t).logicalNot())}}),ds=$({where_:function(e,t,n){var r=D(t,"a","where"),o=D(n,"b","where"),i=D(e,"condition","where","bool");return it(r.shape,o.shape,"Error in where: "),i.rank===1?O(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):it(i.shape,o.shape,"Error in where: "),H.runKernelFunc(function(a,s){var l=a.select(i,r,o);return s([i]),l},{$condition:i,$a:r,$b:o},function(a,s){var l=s[0];return{$condition:function(){return Ye(l).toFloat()},$a:function(){return a.mul(l.cast(a.dtype))},$b:function(){return a.mul(l.logicalNot().cast(a.dtype))}}})}}),$A=function(e){return be(this,void 0,void 0,function(){var t,n,r;return we(this,function(o){switch(o.label){case 0:return[4,(t=D(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=$x(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Ue=$({add_:function(e,t){var n,r=D(e,"a","add"),o=D(t,"b","add");n=jt(r,o),r=n[0],o=n[1];var i=He(r.shape,o.shape);return H.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,l=rn(r.shape,i);return l.length>0&&(s=s.sum(l)),s.reshape(r.shape)},b:function(){var s=a,l=rn(o.shape,i);return l.length>0&&(s=s.sum(l)),s.reshape(o.shape)}}},"Add")}}),P7=$({addN_:function(e){O(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),O(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(o,i){return D(o,"tensors"+i,"addN")}),n=t[0];t.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!hn(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return H.runKernelFunc(function(o){return o.addN(t)},r,function(o){var i={};return t.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),A7=$({addStrict_:function(e,t){var n=D(e,"a","addStrict"),r=D(t,"b","addStrict");return it(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),I7=$({atan2_:function(e,t){var n,r=D(e,"a","atan2"),o=D(t,"b","atan2");n=jt(r,o),r=n[0],o=n[1];var i=He(r.shape,o.shape);return H.runKernelFunc(function(a,s){var l=a.atan2(r,o);return s([r,o]),l},{$a:r,$b:o},function(a,s){var l=s[0],u=s[1];return{$a:function(){var c=Ue(l.square(),u.square()),d=a.mul(u.div(c)),f=rn(l.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)},$b:function(){var c=Ue(l.square(),u.square()),d=Mh(a.mul(l.div(c))),f=rn(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)}}})}}),Jr=$({div_:function(e,t){var n,r=D(e,"a","div"),o=D(t,"b","div");if(n=jt(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return UA(r,o);var i=He(r.shape,o.shape);return H.runKernelFunc(function(a,s){var l=a.realDivide(r,o);return s([r,o]),l},{a:r,b:o},function(a,s){var l=s[0],u=s[1];return{a:function(){var c=a.div(u.toFloat()),d=rn(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c},b:function(){var c=a.mul(l.toFloat()),d=rn(u.shape,i);d.length>0&&(c=c.sum(d).reshape(u.shape));var f=u.square();return c.div(f.toFloat()).neg()}}},"Div")}}),M7=$({divNoNan_:function(e,t){var n,r=D(e,"a","div"),o=D(t,"b","div");r=(n=jt(r,o))[0],o=n[1];var i=Jr(r,o),a=Ye(i),s=o.equal(a);return ds(s,a,i)}}),D7=$({divStrict_:function(e,t){var n=D(e,"a","div"),r=D(t,"b","div");return it(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),UA=$({floorDiv_:function(e,t){var n,r=D(e,"a","floorDiv"),o=D(t,"b","floorDiv");n=jt(r,o),r=n[0],o=n[1];var i=He(r.shape,o.shape);return H.runKernelFunc(function(a,s){var l=a.floorDiv(r,o);return s([r,o]),l},{a:r,b:o},function(a,s){var l=s[0],u=s[1];return{a:function(){var c=a.div(u.toFloat()),d=rn(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c},b:function(){var c=a.mul(l.toFloat()),d=rn(u.shape,i);d.length>0&&(c=c.sum(d).reshape(u.shape));var f=u.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),Kx=$({maximum_:function(e,t){var n,r=D(e,"a","maximum"),o=D(t,"b","maximum");return n=jt(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),He(r.shape,o.shape),H.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],l=a[1];return{a:function(){return i.mul(s.greaterEqual(l).toFloat())},b:function(){return i.mul(s.less(l).toFloat())}}},"Maximum")}}),j7=$({maximumStrict_:function(e,t){var n=D(e,"a","maximumStrict"),r=D(t,"b","maximumStrict");return it(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),HA=$({minimum_:function(e,t){var n,r=D(e,"a","minimum"),o=D(t,"b","minimum");return n=jt(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),He(r.shape,o.shape),H.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],l=a[1];return{a:function(){return i.mul(s.lessEqual(l).toFloat())},b:function(){return i.mul(s.greater(l).toFloat())}}},"Minimum")}}),F7=$({minimumStrict_:function(e,t){var n=D(e,"a","minimumStrict"),r=D(t,"b","minimumStrict");return it(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),O7=$({mod_:function(e,t){var n,r=D(e,"a","mod"),o=D(t,"b","mod");n=jt(r,o),r=n[0],o=n[1];var i=He(r.shape,o.shape);return H.runKernelFunc(function(a,s){var l=a.mod(r,o);return s([r,o]),l},{$a:r,$b:o},function(a,s){var l=s[0],u=s[1];return{$a:function(){var c=rn(l.shape,i);return c.length>0?a.sum(c).reshape(l.shape):a},$b:function(){var c=a.mul(l.div(u).floor().neg()),d=rn(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c}}})}}),L7=$({modStrict_:function(e,t){var n=D(e,"a","modStrict"),r=D(t,"b","modStrict");return it(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Fn=$({mul_:function(e,t){var n,r=D(e,"a","mul"),o=D(t,"b","mul");n=jt(r,o),r=n[0],o=n[1];var i=He(r.shape,o.shape);return H.runKernelFunc(function(a,s){var l=a.multiply(r,o);return s([r,o]),l},{a:r,b:o},function(a,s){var l=s[0],u=s[1];return{a:function(){var c=a.mul(u.toFloat()),d=rn(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c},b:function(){var c=a.mul(l.toFloat()),d=rn(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c}}},"Mul")}}),B7=$({mulStrict_:function(e,t){var n=D(e,"a","mul"),r=D(t,"b","mul");return it(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Dh=$({pow_:function(e,t){var n,r=D(e,"base","pow"),o=D(t,"exp","pow");n=jt(r,o),r=n[0],o=n[1];var i=He(r.shape,o.shape),a=[r,o];return H.runKernelFunc(function(s,l){var u=s.pow(r,o);return l([r,o,u]),u},{a:r,b:o},function(s,l){var u=l[0],c=l[1],d=l[2];return{a:function(){var f=c.toFloat(),h=s.mul(f.mul(u.pow(f.sub(de(1))))),v=rn(u.shape,i);return v.length>0&&(h=h.sum(v)),h.reshape(u.shape)},b:function(){var f=u.greater(0),h=u.log().where(f,Ye(u)),v=s.mul(d.mul(h)),g=rn(c.shape,i);return g.length>0&&(v=v.sum(g)),v.reshape(c.shape)}}},"Pow",{},a,[!0])}}),V7=$({powStrict_:function(e,t){return it(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),z7=$({squaredDifferenceStrict_:function(e,t){var n=D(e,"a","squaredDifferenceStrict"),r=D(t,"b","squaredDifferenceStrict");return it(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),on=$({sub_:function(e,t){var n,r=D(e,"a","sub"),o=D(t,"b","sub");n=jt(r,o),r=n[0],o=n[1];var i=He(r.shape,o.shape);return H.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,l=rn(r.shape,i);return l.length>0&&(s=s.sum(l)),s.reshape(r.shape)},b:function(){var s=a,l=rn(o.shape,i);return l.length>0&&(s=s.sum(l)),s.neg().reshape(o.shape)}}},"Sub")}}),W7=$({subStrict_:function(e,t){var n=D(e,"a","subStrict"),r=D(t,"b","subStrict");return it(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),GA=$({equal_:function(e,t){var n,r=D(e,"a","equal"),o=D(t,"b","equal");return n=jt(r,o),r=n[0],o=n[1],He(r.shape,o.shape),H.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),$7=$({equalStrict_:function(e,t){var n=D(e,"a","equalStrict"),r=D(t,"b","equalStrict");return it(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),U7=$({greater_:function(e,t){var n,r=D(e,"a","greater"),o=D(t,"b","greater");return n=jt(r,o),r=n[0],o=n[1],He(r.shape,o.shape),H.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),qA=$({greaterEqual_:function(e,t){var n,r=D(e,"a","greaterEqual"),o=D(t,"b","greaterEqual");return n=jt(r,o),r=n[0],o=n[1],He(r.shape,o.shape),H.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],l=a[1];return{a:function(){return Ye(s)},b:function(){return Ye(l)}}},"GreaterEqual")}}),H7=$({greaterEqualStrict_:function(e,t){var n=D(e,"a","greaterEqualStrict"),r=D(t,"b","greaterEqualStrict");return it(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),G7=$({greaterStrict_:function(e,t){var n=D(e,"a","greaterStrict"),r=D(t,"b","greaterStrict");return it(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),q7=$({less_:function(e,t){var n,r=D(e,"a","less"),o=D(t,"b","less");return n=jt(r,o),r=n[0],o=n[1],He(r.shape,o.shape),H.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),K7=$({lessEqual_:function(e,t){var n,r=D(e,"a","lessEqual"),o=D(t,"b","lessEqual");return n=jt(r,o),r=n[0],o=n[1],He(r.shape,o.shape),H.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),X7=$({lessEqualStrict_:function(e,t){var n=D(e,"a","lessEqualStrict"),r=D(t,"b","lessEqualStrict");return it(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Y7=$({lessStrict_:function(e,t){var n=D(e,"a","lessStrict"),r=D(t,"b","lessStrict");return it(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Q7=$({notEqual_:function(e,t){var n,r=D(e,"a","notEqual"),o=D(t,"b","notEqual");return n=jt(r,o),r=n[0],o=n[1],He(r.shape,o.shape),H.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),Z7=$({notEqualStrict_:function(e,t){var n=D(e,"a","notEqualStrict"),r=D(t,"b","notEqualStrict");return it(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function AS(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function IS(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Xx=$({gather_:function(e,t,n){n===void 0&&(n=0);var r=D(e,"x","gather"),o=D(t,"indices","gather","int32");n=an(n,r.shape)[0];var i=function(a,s,l){for(var u=a.shape[l],c=[],d=1,f=1,h=0;h<l;h++)c.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=l+1;h<a.rank;h++)c.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:u,outputShape:c}}(r,o,n);return H.runKernelFunc(function(a,s){var l=a.gather(r,o.flatten(),n);return s([o]),l},{x:r,indices:o},function(a,s){var l=s[0];return{x:function(){var u=r.shape,c=l.size,d=u.slice(0,n),f=d.length,h=u.slice(n,u.length).slice(1),v=h.length,g=AS(0,f),y=AS(f+1,f+1+v),m=IS([d,[c],h]),x=a.reshape(m),b=l.reshape([c]),w=IS([[f],g,y]),C=x.transpose(w),E=KA(C,b,r.shape[n]),_=jx(w);return E=E.transpose(_)},indices:function(){return l}}},"Gather",{axis:n}).reshape(i.outputShape)}}),KA=$({unsortedSegmentSum_:function(e,t,n){var r=D(e,"x","unsortedSegmentSum"),o=D(t,"segmentIds","unsortedSegmentSum","int32");return O(Ut(n),function(){return"numSegments must be of dtype int"}),H.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(l,u){for(var c=Kx(u,Ye(u)),d=Xx(l,c),f=qA(u,de(0,"int32")),h=d.rank-f.rank,v=0;v<h;++v)f=Mr(f,v+1);f=kp(f,ou(d.shape,"bool"));var g=Ye(d);return ds(f,d,g)}(i,s)}}})}}),J7=function(e,t,n){return be(this,void 0,void 0,function(){var r,o,i,a,s,l,u,c,d,f,h,v,g;return we(this,function(y){switch(y.label){case 0:for(r=D(e,"tensor","boolMask"),o=D(t,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,O(a>0,function(){return"mask cannot be scalar"}),it(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,u=i;u<i+a;u++)l*=s[u];return c=s.slice(0,i).concat([l],s.slice(i+a)),d=r.reshape(c),f=o.reshape([-1]),[4,$A(f)];case 1:return h=y.sent(),v=h.squeeze([1]),g=Xx(d,v,i),e!==r&&r.dispose(),t!==o&&o.dispose(),v.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,g]}})})};function XA(e,t,n,r,o,i,a){i===void 0&&(i="NHWC"),O(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,l=t,u=!1;t.rank===3&&(u=!0,l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),O(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),O(l.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank}),O(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?l.shape[3]:l.shape[1];O(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),O(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&O(Ut(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=Vx(i),h=xs(s,n.shape,r,1,o,a,!1,f),v=H.runKernelFunc(function(g,y){var m=g.conv2dDerInput(l,n,h);return y([n,l]),m},{dy4D:l,filter:n},function(g,y){var m=y[0],x=y[1];return{dy4D:function(){return Wr(g,m,r,o,i,1,a)},filter:function(){return Yx(g,x,m.shape,r,o,i,a)}}});return u?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function uv(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function YA(e,t,n,r,o){O(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,a=t,s=!1;t.rank===4&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var l=i[4],u=a.shape[4];O(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),O(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),O(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),O(l===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[3]+"."}),O(u===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+u+") must match output depth for filter "+n.shape[4]+"."});var c=Ah(i,n.shape,r,1,o),d=H.runKernelFunc(function(f){return f.conv3dDerInput(a,n,c)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var e9=$({conv1d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=D(e,"x","conv1d"),l=D(t,"filter","conv1d"),u=s,c=!1;s.rank===2&&(c=!0,u=s.as3D(1,s.shape[0],s.shape[1])),O(u.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+u.rank+"."}),O(l.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+l.rank+"."}),a!=null&&O(Ut(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),O(u.shape[2]===l.shape[1],function(){return"Error in conv1d: depth of input ("+u.shape[2]+") must match input depth for filter "+l.shape[1]+"."}),O(cr(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),O(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2]),f=u.as4D(u.shape[0],1,u.shape[1],u.shape[2]),h=Wr(f,d,[1,n],r,"NHWC",[1,i],a);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Wr=$({conv2d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=D(e,"x","conv2d"),l=D(t,"filter","conv2d"),u=s,c=!1;s.rank===3&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),O(u.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+u.rank+"."}),O(l.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+l.rank+"."}),a!=null&&O(Ut(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=o==="NHWC"?u.shape[3]:u.shape[1];O(d===l.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+l.shape[2]+"."}),O(cr(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=Vx(o),h=xs(u.shape,l.shape,n,i,r,a,!1,f),v=[l,u],g=H.runKernelFunc(function(y,m){var x=y.conv2d(u,l,h);return m([l,u]),x},{x:u,filter:l},function(y,m){var x=m,b=x[0],w=x[1];return O(Ul(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return QA(w.shape,y,b,n,r,o)},filter:function(){return Yx(w,y,b.shape,n,r,o)}}},"Conv2D",h,v);return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),t9=$({conv3d_:function(e,t,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=D(e,"x","conv3d"),s=D(t,"filter","conv3d"),l=a,u=!1;a.rank===4&&(u=!0,l=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),O(l.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+l.rank+"."}),O(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),O(l.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+l.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),O(function(f,h){return uv(f)||uv(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),O(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=Ah(l.shape,s.shape,n,i,r),d=H.runKernelFunc(function(f,h){var v=f.conv3d(l,s,c);return h([l,s]),v},{x:l,$filter:s},function(f,h){O(uv(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var v=h[0],g=h[1];return{x:function(){return YA(v.shape,f,g,n,r)},$filter:function(){return function(y,m,x,b,w){var C=y;y.rank===4&&(C=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3]));var E=m;E.rank===4&&(E=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),O(C.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+C.shape+"."}),O(E.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+E.shape+"."}),O(x.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+x+"."}),O(C.shape[4]===x[3],function(){return"Error in conv3dDerFilter: depth of input "+C.shape[4]+") must match input depth in filter ("+x[3]+"."}),O(E.shape[4]===x[4],function(){return"Error in conv3dDerFilter: depth of dy ("+E.shape[4]+") must match output depth for filter ("+x[4]+")."});var _=Ah(C.shape,x,b,1,w);return H.runKernelFunc(function(N){return N.conv3dDerFilter(C,E,_)},{x5D:C,dy5D:E})}(v,f,g.shape,n,r)}}});return u?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Yx=$({conv2dDerFilter_:function(e,t,n,r,o,i,a){i===void 0&&(i="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var l=t;l.rank===3&&(l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),O(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),O(l.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+"."}),O(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var u=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];O(u===n[2],function(){return"Error in conv2dDerFilter: depth of input "+u+") must match input depth in filter ("+n[2]+"."}),O(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&O(Ut(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=Vx(i),f=xs(s.shape,n,r,1,o,a,!1,d);return H.runKernelFunc(function(h){return h.conv2dDerFilter(s,l,f)},{x4D:s,dy4D:l})}}),QA=$({conv2dDerInput_:XA}),Np=$({depthwiseConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=D(e,"x","depthwiseConv2d"),l=D(t,"filter","depthwiseConv2d"),u=s,c=!1;s.rank===3&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),O(u.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+u.rank+"."}),O(l.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+"."}),O(u.shape[3]===l.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+u.shape[3]+") must match the inChannels dimension in filter "+l.shape[2]+"."}),i==null&&(i=[1,1]),O(cr(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&O(Ut(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=xs(u.shape,l.shape,n,i,r,a,!0),f=[u,l],h=H.runKernelFunc(function(v,g){var y=v.depthwiseConv2D(u,l,d);return g([u,l]),y},{x:u,filter:l},function(v,g){O(Ul(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var y=g[0],m=g[1];return{x:function(){return ZA(y.shape,v,m,d)},filter:function(){return JA(y,v,m.shape,d)}}},"DepthwiseConv2dNative",d,f);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),ZA=$({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;t.rank===3&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=H.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),JA=$({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),H.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Qx=$({separableConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=D(e,"x","separableConv2d"),l=D(t,"depthwiseFilter","separableConv2d"),u=D(n,"pointwiseFilter","separableConv2d"),c=s,d=!1;if(s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");O(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),O(l.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+l.rank+"."}),O(u.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+l.rank+"."}),O(u.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+u.shape[0]+"."}),O(u.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+u.shape[1]+"."});var f=l.shape[2],h=l.shape[3];O(u.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+u.shape[2]+"."});var v=Np(c,l,r,o,a,i),g=Wr(v,u,1,"valid",a);return d?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),n9=$({conv2dTranspose_:function(e,t,n,r,o,i){return XA(n,D(e,"x","conv2dTranspose"),D(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),r9=$({conv3dTranspose_:function(e,t,n,r,o){return YA(n,D(e,"x","conv3dTranspose"),D(t,"filter","conv3dTranspose"),r,o)}}),Tp=$({matMul_:function(e,t,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=D(e,"a","matMul"),a=D(t,"b","matMul");o=jt(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],l=r?a.shape[a.rank-1]:a.shape[a.rank-2],u=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=Se(d),v=Se(f);O(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),O(hn(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),O(s===l,function(){return"Error in matMul: inner shapes ("+s+") and ("+l+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=i.shape.slice(0,-2).concat([u,c]),y=n?i.as3D(h,s,u):i.as3D(h,u,s),m=r?a.as3D(v,c,l):a.as3D(v,l,c),x={transposeA:n,transposeB:r};return H.runKernelFunc(function(b,w){var C=b.batchMatMul(y,m,n,r);return w([y,m]),C},{a:y,b:m},function(b,w){var C=w,E=C[0],_=C[1];return n||r?!n&&r?{a:function(){return b.matMul(_,!1,!1)},b:function(){return b.matMul(E,!0,!1)}}:n&&!r?{a:function(){return _.matMul(b,!1,!0)},b:function(){return E.matMul(b,!1,!1)}}:{a:function(){return _.matMul(b,!0,!0)},b:function(){return b.matMul(E,!0,!0)}}:{a:function(){return b.matMul(_,!1,!0)},b:function(){return E.matMul(b,!0,!1)}}},"BatchMatMul",x).reshape(g)}}),o9=$({dot_:function(e,t){var n=D(e,"t1","dot"),r=D(t,"t2","dot");O(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return O(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),i9=$({outerProduct_:function(e,t){var n=D(e,"v1","outerProduct"),r=D(t,"v2","outerProduct");return O(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),nd=$({reverse_:function(e,t){var n=D(e,"x","reverse");if(n.rank===0)return n.clone();var r=an(t,n.shape);return H.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),a9=$({reverse1d_:function(e){var t=D(e,"x","reverse");return O(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),nd(t,0)}}),s9=$({reverse2d_:function(e,t){var n=D(e,"x","reverse");return O(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),nd(n,t)}}),l9=$({reverse3d_:function(e,t){var n=D(e,"x","reverse");return O(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),nd(n,t)}}),u9=$({reverse4d_:function(e,t){var n=D(e,"x","reverse");return O(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),nd(n,t)}});function eI(e,t,n,r,o,i){var a=D(e,"x","maxPool"),s=a,l=!1;a.rank===3&&(l=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),O(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),O(cr(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&O(Ut(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var u=Tc(s.shape,t,n,r,o,i);if(u.filterWidth===1&&u.filterHeight===1&&hn(u.inShape,u.outShape))return a.clone();var c=[s],d=H.runKernelFunc(function(f,h){var v=f.maxPool(s,u);return h([s,v]),v},{x:s},function(f,h){var v=h[0],g=h[1];return{x:function(){return function(y,m,x,b,w,C,E,_){var N=D(y,"dy","maxPoolBackprop"),T=D(m,"input","maxPoolBackprop"),k=D(x,"output","maxPoolBackprop");O(T.rank===N.rank,function(){return"Rank of input ("+T.rank+") does not match rank of dy ("+N.rank+")"}),O(cr(w,C),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+C+"'"}),O(N.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+N.rank+"."}),O(T.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+T.rank+"."});var I=Tc(T.shape,b,w,C,E,_);return H.runKernelFunc(function(A){return A.maxPoolBackprop(N,T,k,I)},{$dy:N,$input:T})}(f,v,g,t,n,r,o)}}},"MaxPool",u,c);return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function tI(e,t,n,r,o,i){var a=D(e,"x","avgPool","float32");O(cr(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,l=!1;a.rank===3&&(l=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),O(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&O(Ut(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var u=Tc(s.shape,t,n,r,o,i);if(u.filterWidth===1&&u.filterHeight===1&&hn(u.inShape,u.outShape))return a.clone();var c=H.runKernelFunc(function(d){return d.avgPool(s,u)},{x:s},function(d){return{x:function(){return function(f,h,v,g,y,m){var x=D(f,"dy","avgPoolBackprop"),b=D(h,"input","avgPoolBackprop");O(b.rank===x.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+x.rank+")"}),O(cr(g,y),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+y+"'"});var w=b,C=x,E=!1;b.rank===3&&(E=!0,w=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),C=x.as4D(1,x.shape[0],x.shape[1],x.shape[2])),O(C.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+C.rank+"."}),O(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var _=Tc(w.shape,v,g,y,m),N=H.runKernelFunc(function(T){return T.avgPoolBackprop(C,w,_)},{dy4D:C,input4D:w});return E?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}(d,s,t,n,r,o)}}},"AvgPool",u);return c=c.cast(a.dtype),l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var cn=$({maxPool_:function(e,t,n,r,o){return eI(e,t,n,1,r,o)}}),rd=$({avgPool_:function(e,t,n,r,o){return tI(e,t,n,1,r,o)}}),c9=$({pool_:function(e,t,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=D(e,"x","maxPool"),s=a,l=!1;a.rank===3&&(l=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),O(cr(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var u,c=Tc(s.shape,t,i,o,r),d=[c.dilationHeight,c.dilationWidth];u=r==="same"?function(w,C){var E=w.map(function(T,k){return T+(T-1)*(C[k]-1)}).map(function(T){return T-1}),_=E.map(function(T){return Math.floor(T/2)}),N=E.map(function(T,k){return T-_[k]});return E.map(function(T,k){return[_[k],N[k]]})}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(w,C,E){var _=E.map(function(B){return B[0]}),N=E.map(function(B){return B[1]}),T=w.concat(_,N),k=C.map(function(B,L){return(B-T[L]%B)%B}),I=N.map(function(B,L){return B+k[L]}),A=C.map(function(B,L){return[_[L],I[L]]}),U=C.map(function(B,L){return[0,k[L]]});return[A,U]}([c.inHeight,c.inWidth],d,u),v=h[0],g=h[1],y=f?r:"valid",m=f?s:sA(s,d,v),x=(n==="avg"?function(){return tI(m,t,i,1,y)}:function(){return eI(m,t,i,1,y)})(),b=f?x:oA(x,d,g);return l?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),d9=$({maxPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=D(e,"x","maxPool3d"),l=s,u=!1;s.rank===4&&(u=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),O(l.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+l.rank+"."}),O(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),O(cr(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&O(Ut(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Ph(l.shape,t,n,a,r,o,i),d=H.runKernelFunc(function(f,h){var v=f.maxPool3d(l,c);return h([l,v]),v},{x:l},function(f,h){var v=h[0],g=h[1];return{x:function(){return function(y,m,x,b,w,C,E,_){var N=D(y,"dy","maxPool3dBackprop"),T=D(m,"input","maxPool3dBackprop"),k=D(x,"output","maxPool3dBackprop"),I=N,A=T,U=k,B=!1;T.rank===4&&(B=!0,I=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),A=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3]),U=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3])),O(I.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+I.rank+"."}),O(A.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+A.rank+"."}),O(U.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+U.rank+"."}),C==null&&(C=[1,1,1]),O(cr(w,C),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+C+"'"}),_!=null&&O(Ut(E),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+_+" but got pad "+E+"."});var L=Ph(A.shape,b,w,C,E,_),V=H.runKernelFunc(function(F){return F.maxPool3dBackprop(I,A,U,L)},{dy5D:I,input5D:A});return B?V.as4D(V.shape[1],V.shape[2],V.shape[3],V.shape[4]):V}(f,v,g,t,n,a,r,o)}}});return u?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),f9=$({avgPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=D(e,"x","avgPool3d","float32"),l=s,u=!1;s.rank===4&&(u=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),O(l.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+l.rank+"."}),O(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),O(cr(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&O(Ut(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Ph(l.shape,t,n,a,r,o,i),d=H.runKernelFunc(function(f){return f.avgPool3d(l,c)},{x:l},function(f){return{x:function(){return function(h,v,g,y,m,x,b){var w=D(h,"dy","avgPool3dBackprop"),C=D(v,"input","avgPool3dBackprop"),E=w,_=C,N=!1;C.rank===4&&(N=!0,E=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),_=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3])),O(E.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+E.rank+"."}),O(_.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+_.rank+"."}),m==null&&(m=[1,1,1]),O(cr(y,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+m+"'"}),b!=null&&O(Ut(x),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+x+"."});var T=Ph(_.shape,g,y,m,x,b),k=H.runKernelFunc(function(I){return I.avgPool3dBackprop(E,_,T)},{dy5D:E,input5D:_});return N?k.as4D(k.shape[1],k.shape[2],k.shape[3],k.shape[4]):k}(f,l,t,n,a,r,o)}}});return d=d.cast(l.dtype),u?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Vo=$({slice_:function(e,t,n){var r,o,i=D(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(l){O(l!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(l,u){return l>=0?l:(O(l===-1,function(){return"Negative size values should be exactly -1 but got "+l+" for the slice() size at index "+u+"."}),i.shape[u]-r[u])}),V8(i,r,o);var a=i.shape,s={begin:r,size:o};return H.runKernelFunc(function(l){return l.slice(i,r,o)},{x:i},function(l){for(var u=[],c=0;c<l.rank;c++)u.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return l.pad(u)}}},"Slice",s)}}),h9=$({slice1d_:function(e,t,n){var r=D(e,"x","slice1d");return O(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Vo(r,[t],[n])}}),p9=$({slice2d_:function(e,t,n){var r=D(e,"x","slice2d");return O(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Vo(r,t,n)}}),nI=$({slice3d_:function(e,t,n){var r=D(e,"x","slice3d");return O(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Vo(r,t,n)}}),m9=$({slice4d_:function(e,t,n){var r=D(e,"x","slice4d");return O(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Vo(r,t,n)}});function rI(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(ur(t.shape,r))),e.rank<n.rank&&(e=e.reshape(ur(e.shape,r))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return o==null?i:i.transpose(o)}}}var v9=$({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","all","bool"),o=an(t,r.shape),i=o,a=$o(i,r.rank);a!=null&&(r=r.transpose(a),i=Uo(i.length,r.rank));var s=H.runKernelFunc(function(u){return u.all(r,i)},{$x:r});if(n){var l=ur(s.shape,o);return s.reshape(l)}return s}}),g9=$({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","any","bool"),o=an(t,r.shape),i=o,a=$o(i,r.rank);a!=null&&(r=r.transpose(a),i=Uo(i.length,r.rank));var s=H.runKernelFunc(function(u){return u.any(r,i)},{$x:r});if(n){var l=ur(s.shape,o);return s.reshape(l)}return s}}),y9=$({argMax_:function(e,t){t===void 0&&(t=0);var n=D(e,"x","argMax");t==null&&(t=0);var r=an(t,n.shape),o=$o(r,n.rank);o!=null&&(n=n.transpose(o),r=Uo(r.length,n.rank));var i={axis:r[0]},a=[n];return H.runKernelFunc(function(s,l){var u=s.argMax(n,r[0]);return l([n]),u},{x:n},function(s,l){var u=l[0];return{x:function(){return Ye(u)}}},"ArgMax",i,a)}}),x9=$({argMin_:function(e,t){t===void 0&&(t=0);var n=D(e,"x","argMin");t==null&&(t=0);var r=an(t,n.shape),o=$o(r,n.rank);return o!=null&&(n=n.transpose(o),r=Uo(r.length,n.rank)),H.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Ye(s)}}})}}),b9=$({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","logSumExp"),o=an(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var l=ur(s.shape,o);return s.reshape(l)}return s}}),Rp=$({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","max"),o=r,i=an(t,r.shape),a=i,s=$o(a,r.rank);s!=null&&(r=r.transpose(s),a=Uo(a.length,r.rank));var l=[r],u=H.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return rI(d,f[1],f[0],i,s)},"Max",{axes:a},l,[!0]);if(n){var c=ur(u.shape,i);u=u.reshape(c)}return u}}),w9=$({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","mean"),o=an(t,r.shape),i=Se(Pn(r.shape,o)[1]);return Ep(function(a){var s=de(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(l){var u=a.shape.slice();return o.forEach(function(c){u[c]=1}),l.reshape(u).mul(ou(a.shape,"float32")).div(i)}}})(r)}}),C9=$({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","min"),o=r,i=an(t,r.shape),a=i,s=$o(a,r.rank);s!=null&&(r=r.transpose(s),a=Uo(a.length,r.rank));var l=[r],u=H.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return rI(d,f[1],f[0],i,s)},"Min",{axes:a},l,[!0]);if(n){var c=ur(u.shape,i);u=u.reshape(c)}return u}}),S9=$({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=an(t,(e=D(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=ur(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),oI=$({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=an(t,r.shape);return Ep(function(i){var a=$o(o,i.rank),s=o,l=i;a!=null&&(l=i.transpose(a),s=Uo(s.length,i.rank));var u=function(h){var v=i.shape.slice();return o.forEach(function(g){v[g]=1}),h.reshape(v).mul(ou(i.shape,"float32"))},c={axes:s},d=H.runKernelFunc(function(h){return h.sum(l,s)},{x:l},function(h){return{x:function(){return u(h)}}},"Sum",c);if(n){var f=ur(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:u}})(r)}}),E9=$({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=D(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=an(t,r.shape),i=$o(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Uo(a.length,r.rank));var l=H.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var u=ur(l.shape,o);l=l.reshape(u)}return l}}),iI=$({elu_:function(e){var t=D(e,"x","elu");return H.runKernelFunc(function(n,r){var o=n.elu(t);return r([o]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return H.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),_9=$({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=D(e,"x","leakyRelu");return Kx(de(t).mul(n),n)}}),aI=$({prelu_:function(e,t){var n=D(e,"x","prelu"),r=D(t,"alpha","prelu");return H.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],l=a.greater(0);return{x:function(){return ds(l,o,o.mul(s))},alpha:function(){var u=ds(l,Ye(o),o.mul(a)),c=rn(s.shape,o.shape);return c.length>0&&(u=u.sum(c)),u.reshape(s.shape)}}},"Prelu")}}),It=$({relu_:function(e){var t=D(e,"x","relu");return t.dtype==="bool"?t.toInt():H.runKernelFunc(function(n,r){var o=n.relu(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),sI=$({relu6_:function(e){var t=D(e,"x","relu6");return t.dtype==="bool"?t.toInt():H.runKernelFunc(function(n,r){var o=n.relu6(t);return r([t]),o},{x:t},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),k9=$({selu_:function(e){var t=D(e,"x","selu");return H.runKernelFunc(function(n,r){var o=n.selu(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(de(0)),a=de(Hx),s=de(Gx),l=n.mul(s),u=n.mul(a).mul(o.toFloat().exp());return ds(i,l,u)}}})}}),ma=$({transpose_:function(e,t){var n=D(e,"x","transpose");if(t==null&&(t=n.shape.map(function(o,i){return i}).reverse()),O(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(o){O(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return H.runKernelFunc(function(o){return o.transpose(n,t)},{x:n},function(o){var i=jx(t);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),N9=$({localResponseNormalization_:function(e,t,n,r,o){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=D(e,"x","localResponseNormalization");O(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),O(Ut(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var l=H.runKernelFunc(function(u,c){var d=u.localResponseNormalization4D(a,t,n,r,o);return c([a,d]),d},{x4D:a},function(u,c){var d=c[0],f=c[1];return{x4D:function(){return H.runKernelFunc(function(h){return h.LRNGrad(u,d,f,t,n,r,o)},{})}}});return s?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),lI=$({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(l,u,c){if(c===void 0&&(c=null),l.rank===0)return l.abs();if(l.rank!==1&&c===null)return s(l.reshape([-1]),u,c);if(l.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(u===1)return l.abs().sum(c);if(u===1/0)return l.abs().max(c);if(u===-1/0)return l.abs().min(c);if(u==="euclidean"||u===2)return l.abs().pow(de(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}if(Array.isArray(c)&&c.length===2){if(u===1)return l.abs().sum(c[0]).max(c[1]-1);if(u===1/0)return l.abs().sum(c[1]).max(c[0]);if(u===-1/0)return l.abs().sum(c[1]).min(c[0]);if(u==="fro"||u==="euclidean")return l.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}throw new Error("Error in norm: invalid axis: "+c)}(e=D(e,"x","norm"),t,n),i=o.shape;if(r){var a=an(n,e.shape);i=ur(o.shape,a)}return o.reshape(i)}}),T9=$({basicLSTMCell_:function(e,t,n,r,o,i){var a=D(e,"forgetBias","basicLSTMCell"),s=D(t,"lstmKernel","basicLSTMCell"),l=D(n,"lstmBias","basicLSTMCell"),u=D(r,"data","basicLSTMCell"),c=D(o,"c","basicLSTMCell"),d=D(i,"h","basicLSTMCell"),f=u.concat(d,1).matMul(s).add(l),h=f.shape[0],v=f.shape[1]/4,g=[h,v],y=f.slice([0,0],g),m=f.slice([0,v],g),x=f.slice([0,2*v],g),b=f.slice([0,3*v],g),w=y.sigmoid().mulStrict(m.tanh()).addStrict(c.mulStrict(a.add(x).sigmoid())),C=w.tanh().mulStrict(b.sigmoid());return[w,C]}}),R9=$({multiRNNCell_:function(e,t,n,r){for(var o=D(t,"data","multiRNNCell"),i=Eh(n,"c","multiRNNCell"),a=Eh(r,"h","multiRNNCell"),s=o,l=[],u=0;u<e.length;u++){var c=e[u](s,i[u],a[u]);l.push(c[0]),l.push(c[1]),s=c[1]}var d=[],f=[];for(u=0;u<l.length;u+=2)d.push(l[u]),f.push(l[u+1]);return[d,f]}}),P9=$({movingAverage_:function(e,t,n,r,o){o===void 0&&(o=!0);var i=D(e,"v","movingAverage"),a=D(t,"x","movingAverage"),s=D(n,"decay","movingAverage");NU(i,a),O(hn(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var l=de(1),u=l.sub(s),c=a.sub(i).mul(u);if(o){O(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=D(r,"step","movingAverage");c=c.div(l.sub(Dh(s,d)))}return i.add(c)}}),A9=$({stridedSlice_:function(e,t,n,r,o,i,a,s,l){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),l===void 0&&(l=0),r==null&&(r=new Array(t.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var u=D(e,"x","stridedSlice"),c=dS(s),d=u.shape.slice();c.forEach(function(y){t[y]=0,n[y]=1,d.splice(y,0,1)}),u=u.reshape(d);for(var f=0;f<u.rank;f++)t[f]=z8(o,t,r,u.shape,f),n[f]=W8(i,n,r,u.shape,f),r[f]=r[f]||1;var h=dS(l);h.forEach(function(y){n[y]=t[y]+1,r[y]=1});var v=Bx(t,n,r),g=v.filter(function(y,m){return h.indexOf(m)===-1});return r.every(function(y){return y===1})?Vo(u,t,v).reshape(g):H.runKernelFunc(function(y){return y.stridedSlice(u,t,n,r)},{$x:u}).reshape(g)}}),I9=$({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=D(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=H.runKernelFunc(function(a){return a.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),M9=$({scatterND_:function(e,t,n){var r=D(e,"indices","scatterND","int32"),o=D(t,"updates","scatterND");return B8(o,r,n),H.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Zx=$({fft_:function(e){O(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return H.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),jh=$({ifft_:function(e){O(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return H.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),Jx=$({rfft_:function(e,t){O(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],o=e.size/r;if(t!=null&&t<r){var i=e.shape.map(function(m){return 0}),a=e.shape.map(function(m){return m});a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(m){return m});s[e.shape.length-1]=t-r,n=e.concat(Ct(s),e.shape.length-1),r=t}else n=e;var l=n.zerosLike(),u=yn(n,l).as2D(o,r),c=Zx(u),d=Math.floor(r/2)+1,f=Dr(c),h=ko(c),v=f.split([d,r-d],f.shape.length-1),g=h.split([d,r-d],h.shape.length-1),y=n.shape.slice();return y[n.shape.length-1]=d,yn(v[0],g[0]).reshape(y)}}),uI=$({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=jh(r);return Dr(o)}var i=[n,2*(t-1)],a=Dr(e).as2D(n,t),s=ko(e).as2D(n,t),l=a.slice([0,1],[n,t-2]).reverse(1),u=s.slice([0,1],[n,t-2]).reverse(1).mul(de(-1)),c=a.concat(l,1),d=s.concat(u,1);return r=yn(c,d).as2D(i[0],i[1]),o=jh(r),Dr(o)}}),D9=Object.freeze({fft:Zx,ifft:jh,rfft:Jx,irfft:uI}),j9=$({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var o=D(e,"sparseIndices","sparseToDense","int32"),i=D(t,"sparseValues","sparseToDense"),a=D(r,"defaultValue","sparseToDense",i.dtype);return function(s,l,u,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(u.length!==f)throw new Error("outputShape has incorrect number of elements:, "+u.length+", should be: "+f+".");var h=l.size;if(l.rank!==0&&(l.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+l.shape+", should be [] or ["+d+"]");if(l.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),H.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),F9=$({gatherND_:function(e,t){var n=D(t,"indices","gatherND","int32"),r=D(e,"x","gatherND");return H.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),O9=$({diag_:function(e){var t=D(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return H.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),L9=$({dropout_:function(e,t,n,r){var o=D(e,"x","dropout");if(O(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),O(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Pt?o.clone():o;var i=function(l,u){if(u==null)return l.shape.slice();if(hn(l.shape,u))return u;if(l.shape.length===u.length){for(var c=[],d=0;d<l.shape.length;d++)u[d]==null&&l.shape[d]!=null?c.push(l.shape[d]):c.push(u[d]);return c}return u}(o,n),a=1-t,s=aA(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function cI(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return Kt(o,"float32")}var e1=$({hannWindow_:function(e){return cI(e,.5,.5)}}),dI=$({hammingWindow_:function(e){return cI(e,.54,.46)}}),t1=$({frame_:function(e,t,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Vo(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,l=tn([Vo(e,i,t-s),Oo([s],o)]);a.push(l),i+=n}return a.length===0?oa([],[0,t]):tn(a).as2D(a.length,t)}}),fI=$({stft_:function(e,t,n,r,o){var i;o===void 0&&(o=e1),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=t1(e,t,n),s=Fn(a,o(t)),l=[],u=0;u<a.shape[0];u++)l.push(Jx(s.slice([u,0],[1,t]),r));return tn(l)}}),B9=Object.freeze({hannWindow:e1,hammingWindow:dI,frame:t1,stft:fI}),Dn,V9=function(e,t,n){return n===void 0&&(n=1),be(this,void 0,void 0,function(){var r,o,i,a,s,l,u,c,d,f,h,v,g,y;return we(this,function(m){switch(m.label){case 0:return r=D(e,"predictions","inTopK"),o=D(t,"targets","inTopK"),O(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),O(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),it(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],O(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=m.sent(),[4,o.data()];case 2:for(s=m.sent(),l=[a.length/i,i],c=l[1],d=_c("bool",u=l[0]),f=0;f<u;f++){for(h=f*c,v=a.subarray(h,h+c),g=[],y=0;y<v.length;y++)g.push({value:v[y],index:y});for(g.sort(function(x,b){return b.value-x.value}),d[f]=0,y=0;y<n;y++)if(g[y].index===s[f]){d[f]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,bn(d,o.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Dn||(Dn={}));var z9=$({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Dn.SUM_BY_NONZERO_WEIGHTS);var o=D(e,"labels","absoluteDifference"),i=D(t,"predictions","absoluteDifference"),a=null;n!=null&&(a=D(n,"weights","absoluteDifference")),it(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return yi(s,a,r)}}),yi=$({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Dn.SUM_BY_NONZERO_WEIGHTS);var r=D(e,"losses","computeWeightedLoss"),o=null;t!=null&&(o=D(t,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===Dn.NONE)return i;if(n===Dn.SUM)return i.sum();if(n===Dn.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(de(a)):s}if(n===Dn.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(de(r.size));var l=o.mul(ou(r.shape)).notEqual(de(0)).sum().toFloat();return i.sum().div(l)}throw Error("Unknown reduction: "+n)}}),W9=$({cosineDistance_:function(e,t,n,r,o){o===void 0&&(o=Dn.SUM_BY_NONZERO_WEIGHTS);var i=D(e,"labels","cosineDistance"),a=D(t,"predictions","cosineDistance"),s=null;r!=null&&(s=D(r,"weights","cosineDistance")),it(i.shape,a.shape,"Error in cosineDistance: ");var l=de(1).sub(i.mul(a).sum(n,!0));return yi(l,s,o)}}),$9=$({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Dn.SUM_BY_NONZERO_WEIGHTS);var o=D(e,"labels","hingeLoss"),i=D(t,"predictions","hingeLoss"),a=null;n!=null&&(a=D(n,"weights","hingeLoss")),it(o.shape,i.shape,"Error in hingeLoss: ");var s=de(1);o=de(2).mul(o).sub(s);var l=s.sub(o.mul(i)).relu();return yi(l,a,r)}}),U9=$({huberLoss_:function(e,t,n,r,o){r===void 0&&(r=1),o===void 0&&(o=Dn.SUM_BY_NONZERO_WEIGHTS);var i=D(e,"labels","huberLoss"),a=D(t,"predictions","huberLoss"),s=null;n!=null&&(s=D(n,"weights","huberLoss")),it(i.shape,a.shape,"Error in huberLoss: ");var l=de(r),u=a.sub(i).abs(),c=HA(u,l),d=u.sub(c),f=de(.5).mul(c.square()).add(l.mul(d));return yi(f,s,o)}}),H9=$({logLoss_:function(e,t,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=Dn.SUM_BY_NONZERO_WEIGHTS);var i=D(e,"labels","logLoss"),a=D(t,"predictions","logLoss"),s=null;n!=null&&(s=D(n,"weights","logLoss")),it(i.shape,a.shape,"Error in logLoss: ");var l=de(1),u=de(r),c=i.mul(a.add(u).log()).neg().sub(l.sub(i).mul(l.sub(a).add(u).log()));return yi(c,s,o)}}),G9=$({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Dn.SUM_BY_NONZERO_WEIGHTS);var o=D(e,"labels","meanSquaredError"),i=D(t,"predictions","meanSquaredError"),a=null;n!=null&&(a=D(n,"weights","meanSquaredError")),it(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return yi(s,a,r)}}),q9=$({sigmoidCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Dn.SUM_BY_NONZERO_WEIGHTS);var i=D(e,"multiClassLabels","sigmoidCrossEntropy"),a=D(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=D(n,"weights","sigmoidCrossEntropy")),it(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var l=de(r),u=de(1),c=de(.5);i=i.mul(u.sub(l)).add(c.mul(l))}var d=function(f,h){var v=D(f,"labels","sigmoidCrossEntropyWithLogits"),g=D(h,"logits","sigmoidCrossEntropyWithLogits");it(v.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var y=g.relu(),m=g.mul(v),x=g.abs().neg().exp().log1p();return y.sub(m).add(x)}(i,a);return yi(d,s,o)}}),K9=$({softmaxCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Dn.SUM_BY_NONZERO_WEIGHTS);var i=D(e,"onehotLabels","softmaxCrossEntropy"),a=D(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=D(n,"weights","softmaxCrossEntropy")),it(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var l=de(r),u=de(1),c=de(i.shape[1]);i=i.mul(u.sub(l)).add(l.div(c))}var d=function(f,h,v){if(v===void 0&&(v=-1),v===-1&&(v=h.rank-1),v!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+v);return Ep(function(g,y,m){var x=y.logSumExp([v],!0),b=y.toFloat().sub(x);return m([g,b]),{value:b.mul(g).neg().sum([v]),gradFunc:function(w,C){var E=C[0],_=C[1],N=ur(w.shape,[v]);return[w.reshape(N).mul(E.toFloat().sub(_.exp())),w.reshape(N).mul(_.exp().sub(E.toFloat()))]}}})(f,h)}(i,a);return yi(d,s,o)}}),X9=Object.freeze({get Reduction(){return Dn},absoluteDifference:z9,computeWeightedLoss:yi,cosineDistance:W9,hingeLoss:$9,huberLoss:U9,logLoss:H9,meanSquaredError:G9,sigmoidCrossEntropy:q9,softmaxCrossEntropy:K9});function MS(e,t){return t===void 0&&(t=!1),H.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=iA(n),i=e.clone(),a=oa([[1]],[1,1]),s=a.clone(),l=n>=r?r:n,u=function(d){var f,h=i,v=s,g=o;f=H.tidy(function(){var y=i.slice([d,d],[n-d,1]),m=y.norm(),x=i.slice([d,d],[1,1]),b=oa([[-1]]).where(x.greater(0),oa([[1]])),w=x.sub(b.mul(m)),C=y.div(w);s=C.shape[0]===1?a.clone():a.concat(C.slice([1,0],[C.shape[0]-1,C.shape[1]]),0);var E=b.matMul(w).div(m).neg(),_=i.slice([d,0],[n-d,r]),N=E.mul(s);if(d===0)i=_.sub(N.matMul(s.transpose().matMul(_)));else{var T=_.sub(N.matMul(s.transpose().matMul(_)));i=i.slice([0,0],[d,r]).concat(T,0)}var k=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=k.sub(k.matMul(s).matMul(N.transpose()));else{var I=k.sub(k.matMul(s).matMul(N.transpose()));o=o.slice([0,0],[n,d]).concat(I,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],lr([h,v,g])},c=0;c<l;++c)u(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var Y9=$({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=D(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var l=_h(0,a,1,"int32").reshape([-1,1]),u=_h(0,s,1,"int32"),c=on(l,u),d=kp(c.lessEqual(de(+t,"int32")),c.greaterEqual(de(-n,"int32"))),f=Ct([a,s],r.dtype);return Cr(nn(r.reshape([-1,a,s])).map(function(h){return ds(d,h,f)})).reshape(o)}}),Q9=$({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,O(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(l){O(e[l].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[l].shape[0]+" vs. "+n+")"})},o=1;o<e.length;++o)r(o)}else t=!0,e=Ox(e,e.shape[0],0).map(function(l){return lA(l,[0])});O(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],a=e,s=function(l){i.push(H.tidy(function(){var u=a[l];if(l>0)for(var c=0;c<l;++c){var d=oI(i[c].mulStrict(u)).mul(i[c]);u=u.sub(d)}return u.div(lI(u,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return t?Cr(i,0):i}}),Z9=$({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return MS(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=nn(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=MS(a,t),l=s[0],u=s[1];o.push(l),i.push(u)}),[Cr(o,0).reshape(e.shape),Cr(i,0).reshape(e.shape)]}}),J9=Object.freeze({bandPart:Y9,gramSchmidt:Q9,qr:Z9});function Pp(e,t,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=e.shape[0];return n=Math.min(n,a),O(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),O(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),O(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),O(t.rank===1,function(){return"scores must be a 1D tensor"}),O(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),O(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var eq=$({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=D(e,"images","resizeBilinear");O(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),O(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],l=H.runKernelFunc(function(u,c){return c([o]),u.resizeBilinear(o,a,s,n)},{x:o},function(u,c){return{x:function(){return H.runKernelFunc(function(d){return d.resizeBilinearBackprop(u,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),tq=$({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=D(e,"images","resizeNearestNeighbor");O(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),O(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),O(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],l=H.runKernelFunc(function(u,c){return c([o]),u.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(u,c){return{batchImages:function(){return H.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(u,c[0],n)},{})}}});return i?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),nq=$({nonMaxSuppression_:function(e,t,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=D(e,"boxes","nonMaxSuppression"),a=D(t,"scores","nonMaxSuppression"),s=Pp(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var l={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return H.runKernelFunc(function(u){return u.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",l)}}),rq=function(e,t,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),be(this,void 0,void 0,function(){var i,a,s,l,u,c,d;return we(this,function(f){switch(f.label){case 0:return i=D(e,"boxes","nonMaxSuppressionAsync"),a=D(t,"scores","nonMaxSuppressionAsync"),s=Pp(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return l=f.sent(),u=l[0],c=l[1],d=zx(u,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,d]}})})},oq=$({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=D(e,"boxes","nonMaxSuppression"),s=D(t,"scores","nonMaxSuppression"),l=Pp(a,s,n,r,o,i),u={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:o=l.scoreThreshold,softNmsSigma:i=l.softNmsSigma},c=H.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},u);return{selectedIndices:c[0],selectedScores:c[1]}}}),iq=function(e,t,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),be(this,void 0,void 0,function(){var a,s,l,u,c,d,f;return we(this,function(h){switch(h.label){case 0:return a=D(e,"boxes","nonMaxSuppressionAsync"),s=D(t,"scores","nonMaxSuppressionAsync"),l=Pp(a,s,n,r,o,i),n=l.maxOutputSize,r=l.iouThreshold,o=l.scoreThreshold,i=l.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return u=h.sent(),c=u[0],d=u[1],f=Wx(c,d,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,f]}})})},aq=$({cropAndResize_:function(e,t,n,r,o,i){var a=D(e,"image","cropAndResize"),s=D(t,"boxes","cropAndResize","float32"),l=D(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var u=s.shape[0];return O(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),O(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+u+",4] but had shape "+s.shape+"."}),O(l.rank===1&&l.shape[0]===u,function(){return"Error in cropAndResize: boxInd must be have size ["+u+"] but had shape "+s.shape+"."}),O(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),O(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),O(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),H.runKernelFunc(function(c,d){return c.cropAndResize(a,s,l,r,o,i)},{images:a,boxes:s,boxInd:l},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),n1=Object.freeze({resizeBilinear:eq,resizeNearestNeighbor:tq,nonMaxSuppression:nq,nonMaxSuppressionAsync:rq,nonMaxSuppressionWithScore:oq,nonMaxSuppressionWithScoreAsync:iq,cropAndResize:aq}),r1=function(e,t){return!(e>0)||t==="linear"},o1=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},i1=function(e,t){var n=t,r=rn(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},a1=function(e,t,n){if(t==="linear")return e;if(t==="relu")return It(e);if(t==="elu")return iI(e);if(t==="relu6")return sI(e);if(t==="prelu")return aI(e,n);throw new Error("Unknown fused activation "+t+".")},sq=$({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=o!==void 0&&o,a=e.transposeB,s=a!==void 0&&a,l=e.bias,u=e.activation,c=u===void 0?"linear":u,d=e.preluActivationWeights;if(r1(H.state.gradientDepth,c)===!1){var f=Tp(n,r,i,s);return l!=null&&(f=Ue(f,l)),a1(f,c,d)}var h=D(n,"a","fused matMul"),v=D(r,"b","fused matMul");t=jt(h,v),h=t[0],v=t[1];var g=i?h.shape[h.rank-2]:h.shape[h.rank-1],y=s?v.shape[v.rank-1]:v.shape[v.rank-2],m=i?h.shape[h.rank-1]:h.shape[h.rank-2],x=s?v.shape[v.rank-2]:v.shape[v.rank-1],b=h.shape.slice(0,-2),w=v.shape.slice(0,-2),C=Se(b),E=Se(w);O(h.rank>=2&&v.rank>=2&&h.rank===v.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+v.rank+"."}),O(hn(b,w),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+h.shape+" and "+v.shape+" must match."}),O(g===y,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+y+") of Tensors with shapes "+h.shape+" and "+v.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var _,N,T=h.shape.slice(0,-2).concat([m,x]),k=i?h.as3D(C,g,m):h.as3D(C,m,g),I=s?v.as3D(E,x,y):v.as3D(E,y,x);l!=null&&He(T,(_=jt(_=D(l,"bias","fused matMul"),h)[0]).shape),d!=null&&(N=D(d,"prelu weights","fused matMul"));var A={a:k,b:I};l!=null&&(A.bias=_),d!=null&&(A.preluActivationWeights=N);var U=[k,I];return H.runKernelFunc(function(B,L){var V=B.fusedBatchMatMul({a:k,b:I,transposeA:i,transposeB:s,bias:_,activation:c,preluActivationWeights:N});return L([k,I,V]),V},A,function(B,L){var V=L[0],F=L[1],M=L[2],j=o1(B,M,c),R={};return l!=null&&(R={bias:function(){return i1(_,j)}}),Object.assign(i||s?!i&&s?{a:function(){return j.matMul(F,!1,!1)},b:function(){return j.matMul(V,!0,!1)}}:i&&!s?{a:function(){return F.matMul(j,!1,!0)},b:function(){return V.matMul(j,!1,!1)}}:{a:function(){return F.matMul(j,!0,!0)},b:function(){return j.matMul(V,!0,!0)}}:{a:function(){return j.matMul(F,!1,!0)},b:function(){return V.matMul(j,!0,!1)}},R)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},U,[!0]).reshape(T)}}),lq=$({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,l=s===void 0?[1,1]:s,u=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(f=f||"linear",r1(H.state.gradientDepth,f)===!1){var v=Wr(t,n,r,o,a,l,u);return c!=null&&(v=Ue(v,c)),a1(v,f,h)}var g=D(t,"x","conv2d"),y=D(n,"filter","conv2d"),m=g,x=!1;g.rank===3&&(x=!0,m=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),O(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),O(y.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+y.rank+"."}),u!=null&&O(Ut(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+o+"."}),O(m.shape[3]===y.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+y.shape[2]+"."}),O(cr(r,l),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),O(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var b,w,C=xs(m.shape,y.shape,r,l,o,u);c!=null&&(b=jt(b=D(c,"bias","fused conv2d"),g)[0],He(C.outShape,b.shape)),h!=null&&(w=D(h,"prelu weights","fused conv2d"));var E={x:m,filter:y};c!=null&&(E.bias=b),h!=null&&(E.preluActivationWeights=w);var _=[y,m],N=H.runKernelFunc(function(T,k){var I=T.fusedConv2d({input:m,filter:y,convInfo:C,bias:b,activation:f,preluActivationWeights:w});return k([y,m,I]),I},E,function(T,k){var I=k,A=I[0],U=I[1],B=I[2],L=o1(T,B,f);O(Ul(l),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+l+"'"});var V={};return c!=null&&(V={bias:function(){return i1(b,L)}}),Object.assign({x:function(){return QA(U.shape,L,A,r,o)},filter:function(){return Yx(U,L,A.shape,r,o)}},V)},"FusedConv2D",{convInfo:C,activation:f},_,[!0]);return x?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),uq=$({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,l=s===void 0?[1,1]:s,u=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(r1(H.state.gradientDepth,f)===!1){var v=Np(t,n,r,o,a,l,u);return c!=null&&(v=Ue(v,c)),a1(v,f,h)}var g=D(t,"x","depthwiseConv2d"),y=D(n,"filter","depthwiseConv2d"),m=g,x=!1;g.rank===3&&(x=!0,m=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),O(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),O(y.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+y.rank+"."}),O(m.shape[3]===y.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+y.shape[2]+"."}),l==null&&(l=[1,1]),O(cr(r,l),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),u!=null&&O(Ut(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+u+" but got pad "+o+"."});var b,w,C=xs(m.shape,y.shape,r,l,o,u,!0);c!=null&&(b=jt(b=D(c,"bias","fused conv2d"),g)[0],He(C.outShape,b.shape)),h!=null&&(w=D(h,"prelu weights","fused depthwiseConv2d"));var E={x:m,filter:y};c!=null&&(E.bias=b),h!=null&&(E.preluActivationWeights=w);var _=[y,m],N=H.runKernelFunc(function(T,k){var I=T.fusedDepthwiseConv2D({input:m,filter:y,convInfo:C,bias:b,activation:f,preluActivationWeights:w});return k([y,m,I]),I},E,function(T,k){O(Ul(l),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+l+"'"});var I=k[0],A=k[1],U=k[2],B=o1(T,U,f),L={};return c!=null&&(L={bias:function(){return i1(b,B)}}),Object.assign({x:function(){return ZA(A.shape,B,I,C)},filter:function(){return JA(A,B,I.shape,C)}},L)},"FusedDepthwiseConv2D",{convInfo:C,activation:f},_,[!0]);return x?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),cq=Object.freeze({matMul:sq,conv2d:lq,depthwiseConv2d:uq}),dq=Object.freeze({image:n1,linalg:J9,losses:X9,spectral:D9,fused:cq,signal:B9,square:HG,squaredDifference:jA,conv1d:e9,conv2d:Wr,conv3d:t9,depthwiseConv2d:Np,separableConv2d:Qx,conv2dTranspose:n9,conv3dTranspose:r9,op:$,batchNormalization2d:w7,batchNormalization3d:C7,batchNormalization4d:S7,batchNormalization:E7,batchNorm:zA,batchNorm2d:_7,batchNorm3d:k7,batchNorm4d:N7,booleanMaskAsync:J7,complex:yn,real:Dr,imag:ko,concat:tn,concat1d:c8,concat2d:d8,concat3d:f8,concat4d:h8,split:Ox,matMul:Tp,dot:o9,outerProduct:i9,reverse:nd,reverse1d:a9,reverse2d:s9,reverse3d:l9,reverse4d:u9,maxPool:cn,avgPool:rd,pool:c9,maxPool3d:d9,avgPool3d:f9,slice:Vo,slice1d:h9,slice2d:p9,slice3d:nI,slice4d:m9,abs:GG,acos:qG,acosh:KG,asin:XG,asinh:YG,atan:QG,atanh:ZG,ceil:JG,clipByValue:qx,cos:e7,cosh:t7,erf:n7,exp:Sy,expm1:r7,floor:o7,log:i7,log1p:a7,logSigmoid:s7,neg:Mh,reciprocal:l7,round:u7,rsqrt:FA,sigmoid:OA,sign:c7,isNaN:d7,isInf:f7,isFinite:h7,sin:p7,sinh:m7,softplus:v7,sqrt:g7,step:y7,tan:x7,tanh:b7,all:v9,any:g9,argMax:y9,argMin:x9,logSumExp:b9,max:Rp,mean:w9,min:C9,moments:S9,sum:oI,prod:E9,equal:GA,equalStrict:$7,greater:U7,greaterEqual:qA,greaterEqualStrict:H7,greaterStrict:G7,less:q7,lessEqual:K7,lessEqualStrict:X7,lessStrict:Y7,notEqual:Q7,notEqualStrict:Z7,add:Ue,addN:P7,addStrict:A7,atan2:I7,div:Jr,divNoNan:M7,divStrict:D7,floorDiv:UA,maximum:Kx,maximumStrict:j7,minimum:HA,minimumStrict:F7,mod:O7,modStrict:L7,mul:Fn,mulStrict:B7,pow:Dh,powStrict:V7,squaredDifferenceStrict:z7,sub:on,subStrict:W7,elu:iI,leakyRelu:_9,prelu:aI,relu:It,relu6:sI,selu:k9,logicalAnd:kp,logicalNot:T7,logicalOr:WA,logicalXor:R7,where:ds,whereAsync:$A,buffer:Fe,print:C8,batchToSpaceND:oA,broadcastTo:S8,cast:E8,clone:_8,cumsum:k8,depthToSpace:N8,expandDims:Mr,eye:iA,multinomial:T8,oneHot:xy,pad:ys,pad1d:R8,pad2d:P8,pad3d:A8,pad4d:I8,rand:M8,randomNormal:D8,randomGamma:j8,randomUniform:aA,reshape:eo,spaceToBatchND:sA,squeeze:lA,stack:Cr,tile:dl,truncatedNormal:F8,unstack:nn,setdiff1dAsync:O8,fill:Oo,linspace:u8,ones:ou,range:_h,scalar:de,tensor:bn,tensor1d:Kt,tensor2d:oa,tensor3d:Fx,tensor4d:tr,tensor5d:a8,tensor6d:s8,variable:l8,zeros:Ct,onesLike:rA,zerosLike:Ye,transpose:ma,softmax:gi,logSoftmax:U8,localResponseNormalization:N9,norm:lI,gather:Xx,unsortedSegmentSum:KA,basicLSTMCell:T9,multiRNNCell:R9,movingAverage:P9,stridedSlice:A9,topk:I9,scatterND:M9,fft:Zx,ifft:jh,rfft:Jx,irfft:uI,sparseToDense:j9,gatherND:F9,diag:O9,dropout:L9,hannWindow:e1,hammingWindow:dI,frame:t1,stft:fI,inTopKAsync:V9});function re(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&O(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function cv(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var fq=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new mA(n,H),n}return co(t,e),t.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,te().get("IS_NODE")&&Sh(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},t.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return be(this,void 0,void 0,function(){return we(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?Cy(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return bh(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Fe(n.shape,n.dtype,o)},t.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return H.makeTensorFromDataId(i,r,o,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return be(this,void 0,void 0,function(){var r;return we(this,function(o){return r=wo(),n(),[2,{kernelMs:wo()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:H.keep(n.clone()),imag:H.keep(r.clone())},o},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(re(n,"slice"),hA(n.shape,r,o)){var i=pA(r,n.strides),a=Se(o);return bn(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=Fe(o,n.dtype),l=this.bufferSync(n),u=0;u<s.size;++u){var c=s.indexToLoc(u).map(function(d,f){return d+r[f]});s.values[u]=l.get.apply(l,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,o,i){re(n,"stridedSlice");var a=Bx(r,o,i);if(a.some(function(h){return h===0}))return bn([],a);for(var s=Fe(a,n.dtype),l=this.bufferSync(n),u=0;u<s.size;u++){for(var c=s.indexToLoc(u),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*i[f]+r[f];s.set.apply(s,[l.get.apply(l,d)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=Fe([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var l=new Array(n.rank).fill(0),u=n.shape.slice();u[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)l[r]=s,c[s]=this.slice(n,l,u).reshape(i);return c},t.prototype.reverse=function(n,r){re(n,"reverse");for(var o=Fe(n.shape,n.dtype),i=this.bufferSync(n),a=function(l){var u=o.indexToLoc(l),c=u.slice();r.forEach(function(d){return c[d]=n.shape[d]-1-c[d]}),o.set.apply(o,[i.get.apply(i,c)].concat(u))},s=0;s<o.size;s++)a(s);return o.toTensor()},t.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return Dr(h)}),a=n.map(function(h){return ko(h)});return yn(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var v=Se(h.shape.slice(r));return h.as2D(-1,v)}),l=$l(s.map(function(h){return h.shape}),1),u=Fe(l,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){u.set(o.readSync(h.dataId),c),c+=h.size})}else{var d=0;s.forEach(function(h){for(var v=o.readSync(h.dataId),g=0,y=0;y<h.shape[0];++y)for(var m=y*l[1]+d,x=0;x<h.shape[1];++x)u[m+x]=v[g++];d+=h.shape[1]})}var f=$l(n.map(function(h){return h.shape}),r);return bn(u,f,n[0].dtype)},t.prototype.neg=function(n){return re(n,"neg"),this.multiply(de(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,xn(n.dtype,r.dtype),function(o,i){return o+i})},t.prototype.addN=function(n){var r=this;re(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=Fe(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var l=o[s],u=0;u<a.length;u++)a[u]+=l[u];return i.toTensor()},t.prototype.softmax=function(n,r){var o=an([r],n.shape),i=this.max(n,o),a=ur(i.shape,o),s=this.subtract(n,i.reshape(a)),l=this.exp(s),u=this.sum(l,o).reshape(a);return this.realDivide(l,u)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,xn(n.dtype,r.dtype),function(o,i){return o-i})},t.prototype.pow=function(n,r){return re([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},t.prototype.batchMatMul=function(n,r,o,i){re([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],l=i?r.shape[1]:r.shape[2],u=n.shape[0],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],v=f[1],g=f[2],y=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],m=y[0],x=y[1],b=y[2],w=s*l,C=Fe([u,s,l],n.dtype),E=C.values,_=this.blockSize,N=0;N<u;N++)for(var T=0;T<s;T+=_)for(var k=0;k<l;k+=_)for(var I=0;I<a;I+=_)for(var A=Math.min(T+_,s),U=Math.min(k+_,l),B=Math.min(I+_,a),L=T;L<A;L++)for(var V=k;V<U;V++){for(var F=0,M=I;M<B;M++)F+=c[N*h+L*v+M*g]*d[M*m+V*x+N*b];E[N*w+(L*l+V)]+=F}return C.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,l=n.activation,u=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),l&&(c=cv(this,c,l,u)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,xn(n.dtype,r.dtype),function(o,i){return o*i})},t.prototype.realDivide=function(n,r){return re([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},t.prototype.floorDiv=function(n,r){return re([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},t.prototype.sum=function(n,r){re(n,"sum"),hr("sum",r,n.rank);for(var o=Pn(n.shape,r),i=o[0],a=o[1],s=Ct(i,xn(n.dtype,"int32")),l=Se(a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<u.length;++d){for(var f=d*l,h=0,v=0;v<l;++v)h+=c[f+v];u[d]=h}return s},t.prototype.prod=function(n,r){re(n,"sum");for(var o=Pn(n.shape,r),i=o[0],a=o[1],s=Ct(i,xn(n.dtype,"int32")),l=Se(a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<u.length;++d){for(var f=d*l,h=1,v=0;v<l;++v)h*=c[f+v];u[d]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,o){re(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var l=de(s,"int32"),u=GA(l,r).asType("float32").mul(n).sum(0);i.push(u)}return Cr(i)},t.prototype.argMin=function(n,r){re(n,"argMin");var o=[r];hr("argMin",o,n.rank);for(var i=Pn(n.shape,o),a=i[0],s=i[1],l=Ct(a,"int32"),u=Se(s),c=this.readSync(l.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*u,v=d[h],g=0,y=0;y<u;++y){var m=d[h+y];m<v&&(v=m,g=y)}c[f]=g}return l},t.prototype.argMax=function(n,r){re(n,"argMax");var o=[r];hr("argMax",o,n.rank);for(var i=Pn(n.shape,o),a=i[0],s=i[1],l=Ct(a,"int32"),u=Se(s),c=this.readSync(l.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*u,v=d[h],g=0,y=0;y<u;++y){var m=d[h+y];m>v&&(v=m,g=y)}c[f]=g}return l},t.prototype.cumsum=function(n,r,o,i){if(re(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=xn(n.dtype,"int32"),s=Ct(n.shape,a),l=this.readSync(s.dataId),u=this.readSync(n.dataId),c=n.shape[n.rank-1],d=i?function(y,m){return y+c-m-1}:function(y,m){return y+m},f=0;f<u.length;f+=c)for(var h=0;h<c;h++){var v=d(f,h);if(h===0)l[v]=o?0:u[v];else{var g=d(f,h-1);l[v]=o?u[g]+l[g]:u[v]+l[g]}}return s},t.prototype.equal=function(n,r){return re([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},t.prototype.notEqual=function(n,r){return re([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},t.prototype.less=function(n,r){return re([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},t.prototype.lessEqual=function(n,r){return re([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},t.prototype.greater=function(n,r){return re([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},t.prototype.greaterEqual=function(n,r){return re([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},t.prototype.logicalNot=function(n){re(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return re([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},t.prototype.logicalOr=function(n,r){return re([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},t.prototype.select=function(n,r,o){re([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),l=Ct(r.shape,xn(r.dtype,o.dtype)),u=this.readSync(l.dataId),c=0,d=n.rank===0||n.rank>1||r.rank===1?1:Se(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)i[f]===1?u[c++]=a[f]:u[c++]=s[f];return l},t.prototype.where=function(n){re([n],"where");var r=this.readSync(n.dataId);return $x(n.shape,r)},t.prototype.topk=function(n,r,o){return re(n,"topk"),SA(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){re(n,"min"),hr("min",r,n.rank);for(var o=Pn(n.shape,r),i=o[0],a=o[1],s=Ct(i,n.dtype),l=Se(a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<u.length;++d){for(var f=d*l,h=c[f],v=0;v<l;++v){var g=c[f+v];g<h&&(h=g)}u[d]=h}return s},t.prototype.minimum=function(n,r){return re([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},t.prototype.mod=function(n,r){return re([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},t.prototype.max=function(n,r){re(n,"max"),hr("max",r,n.rank);for(var o=Pn(n.shape,r),i=o[0],a=o[1],s=Ct(i,n.dtype),l=Se(a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<u.length;++d){for(var f=d*l,h=c[f],v=0;v<l;++v){var g=c[f+v];g>h&&(h=g)}u[d]=h}return s},t.prototype.maximum=function(n,r){return re([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},t.prototype.all=function(n,r){re(n,"all"),hr("all",r,n.rank);for(var o=Pn(n.shape,r),i=o[0],a=o[1],s=Ct(i,n.dtype),l=Se(a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<u.length;++d){for(var f=d*l,h=c[f],v=0;v<l;++v){var g=c[f+v];h=h&&g}u[d]=h}return s},t.prototype.any=function(n,r){re(n,"any"),hr("any",r,n.rank);for(var o=Pn(n.shape,r),i=o[0],a=o[1],s=Ct(i,n.dtype),l=Se(a),u=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<u.length;++d){for(var f=d*l,h=c[f],v=0;v<l;++v){var g=c[f+v];h=h||g}u[d]=h}return s},t.prototype.squaredDifference=function(n,r){return re([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},t.prototype.ceil=function(n){re(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.floor=function(n){re(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.sign=function(n){re(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},t.prototype.isNaN=function(n){re(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isInf=function(n){re(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isFinite=function(n){re(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.round=function(n){re(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},t.prototype.exp=function(n){re(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.expm1=function(n){re(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.log=function(n){re(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.log1p=function(n){re(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.sqrt=function(n){re(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.rsqrt=function(n){re(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.reciprocal=function(n){re(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){re(n,"relu");for(var r=Ct(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},t.prototype.relu6=function(n){re(n,"relu");for(var r=Ct(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},t.prototype.prelu=function(n,r){return re([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},t.prototype.elu=function(n){re(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){re([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var l=i[s];o[s]=l>=1?a[s]:a[s]*(l+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(n){re(n,"selu");for(var r=Hx,o=Gx,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var l=a[s];i[s]=l>=0?o*l:r*(Math.exp(l)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,r,o){re(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var l=a[s];i[s]=l>o?o:l<r?r:l}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){re(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){re(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){re(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,l=i[a]<r,u=Math.exp(i[a]),c=void 0;c=l?u:s?i[a]:Math.log(1+u),o[a]=c}return this.makeOutput(o,n.shape,"float32")},t.prototype.sin=function(n){re(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){re(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){re(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){re(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){re(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){re(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return re([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},t.prototype.sinh=function(n){re(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){re(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){re(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=hU(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){re(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){re(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){re(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){re(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),l=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*l-1.453152027)*l+1.421413741)*l-.284496736)*l+.254829592)*l*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),re(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,l=n.preluActivationWeights,u=this.conv2d(r,o,i);return a&&(u=this.add(u,a)),s&&(u=cv(this,u,s,l)),u},t.prototype.conv2d=function(n,r,o){re([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,l=o.dilationWidth,u=o.padInfo.left,c=o.padInfo.top,d=o.dataFormat==="channelsLast",f=Fe(o.outShape,n.dtype),h=n.strides[0],v=d?n.strides[1]:n.strides[2],g=d?n.strides[2]:1,y=d?1:n.strides[1],m=f.strides[0],x=d?f.strides[1]:f.strides[2],b=d?f.strides[2]:1,w=d?1:f.strides[1],C=this.readSync(n.dataId),E=this.readSync(r.dataId),_=f.values,N=0;N<o.batchSize;++N)for(var T=N*h,k=N*m,I=0;I<o.outHeight;++I)for(var A=k+I*x,U=I*o.strideHeight-c,B=0;B<i;B++){var L=U+B*s;if(!(L<0||L>=o.inHeight))for(var V=B*r.strides[0],F=T+L*v,M=0;M<o.outWidth;++M)for(var j=A+M*b,R=M*o.strideWidth-u,P=0;P<a;P++){var z=R+P*l;if(!(z<0||z>=o.inWidth))for(var G=F+z*g,q=V+P*r.strides[1],Y=0;Y<o.inChannels;++Y){for(var J=C[G+Y*y],X=0;X<o.outChannels;++X)_[j+X*w]+=J*E[q+X];q+=o.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,l=o.dilationDepth,u=o.dilationHeight,c=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,v=Fe(o.outShape,n.dtype),g=this.readSync(n.dataId),y=this.readSync(r.dataId),m=v.values,x=0;x<o.batchSize;++x)for(var b=x*n.strides[0],w=x*v.strides[0],C=0;C<o.outDepth;++C)for(var E=w+C*v.strides[1],_=C*o.strideDepth-d,N=0;N<i;N++){var T=_+N*l;if(!(T<0||T>=o.inDepth))for(var k=N*r.strides[0],I=b+T*n.strides[1],A=0;A<o.outHeight;++A)for(var U=E+A*v.strides[2],B=A*o.strideHeight-h,L=0;L<a;L++){var V=B+L*u;if(!(V<0||V>=o.inHeight))for(var F=k+L*r.strides[1],M=I+V*n.strides[2],j=0;j<o.outWidth;++j)for(var R=U+j*o.outChannels,P=j*o.strideWidth-f,z=0;z<s;z++){var G=P+z*c;if(!(G<0||G>=o.inWidth))for(var q=F+z*r.strides[2],Y=M+G*o.inChannels,J=q,X=0;X<o.inChannels;++X){for(var ee=g[Y+X],oe=0;oe<o.outChannels;++oe)m[R+oe]+=ee*y[J+oe];J+=o.outChannels}}}}return v.toTensor()},t.prototype.conv2dDerInput=function(n,r,o){re([n,r],"conv2dDerInput");for(var i=Fe(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),l=this.readSync(r.dataId),u=r.strides,c=u[0],d=u[1],f=u[2],h=o.batchSize,v=o.filterHeight,g=o.filterWidth,y=o.inChannels,m=o.inHeight,x=o.inWidth,b=o.outChannels,w=o.outHeight,C=o.outWidth,E=o.strideHeight,_=o.strideWidth,N=o.dataFormat,T=v-1-o.padInfo.top,k=g-1-o.padInfo.left,I=N==="channelsLast",A=i.strides[0],U=I?i.strides[1]:i.strides[2],B=I?i.strides[2]:1,L=I?1:i.strides[1],V=n.strides[0],F=I?n.strides[1]:n.strides[2],M=I?n.strides[2]:1,j=I?1:n.strides[1],R=0;R<h;++R)for(var P=0;P<y;++P)for(var z=0;z<m;++z)for(var G=z-T,q=Math.max(0,Math.ceil(G/E)),Y=Math.min(w,(v+G)/E),J=0;J<x;++J){for(var X=J-k,ee=Math.max(0,Math.ceil(X/_)),oe=Math.min(C,(g+X)/_),ue=0,ae=q;ae<Y;++ae)for(var ce=ae*E-G,ne=ee;ne<oe;++ne)for(var se=V*R+F*ae+M*ne,ve=c*(v-1-ce)+d*(g-1-(ne*_-X))+f*P,xe=0;xe<b;++xe)ue+=s[se+j*xe]*l[ve+xe];a[A*R+U*z+B*J+L*P]=ue}return i.toTensor()},t.prototype.conv3dDerInput=function(n,r,o){for(var i=Fe(o.inShape,"float32"),a=i.values,s=i.strides,l=s[0],u=s[1],c=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,v=h[0],g=h[1],y=h[2],m=h[3],x=this.readSync(r.dataId),b=r.strides,w=b[0],C=b[1],E=b[2],_=b[3],N=o.batchSize,T=o.filterDepth,k=o.filterHeight,I=o.filterWidth,A=o.inChannels,U=o.inDepth,B=o.inHeight,L=o.inWidth,V=o.outChannels,F=o.outDepth,M=o.outHeight,j=o.outWidth,R=o.strideDepth,P=o.strideHeight,z=o.strideWidth,G=T-1-o.padInfo.front,q=k-1-o.padInfo.top,Y=I-1-o.padInfo.left,J=0;J<N;++J)for(var X=0;X<A;++X)for(var ee=0;ee<U;++ee)for(var oe=ee-G,ue=Math.max(0,Math.ceil(oe/R)),ae=Math.min(F,(T+oe)/R),ce=0;ce<B;++ce)for(var ne=ce-q,se=Math.max(0,Math.ceil(ne/P)),ve=Math.min(M,(k+ne)/P),xe=0;xe<L;++xe){for(var Me=xe-Y,Pe=Math.max(0,Math.ceil(Me/z)),je=Math.min(j,(I+Me)/z),Le=0,$e=ue;$e<ae;++$e)for(var at=$e*R-oe,Qe=se;Qe<ve;++Qe)for(var Je=Qe*P-ne,dt=Pe;dt<je;++dt)for(var Xe=v*J+g*$e+y*Qe+m*dt,Ce=w*(T-1-at)+C*(k-1-Je)+E*(I-1-(dt*z-Me))+_*X,lt=0;lt<V;++lt)Le+=f[Xe+lt]*x[Ce+lt];a[l*J+u*ee+c*ce+d*xe+X]=Le}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,r,o){re([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,l=o.filterWidth,u=o.dataFormat==="channelsLast",c=Fe(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),v=this.bufferSync(r),g=0;g<s;++g)for(var y=Math.max(0,Math.ceil((f-g)/i)),m=Math.min(o.outHeight,(o.inHeight+f-g)/i),x=0;x<l;++x)for(var b=Math.max(0,Math.ceil((d-x)/a)),w=Math.min(o.outWidth,(o.inWidth+d-x)/a),C=0;C<o.inChannels;++C)for(var E=0;E<o.outChannels;++E){for(var _=0,N=0;N<o.batchSize;++N)for(var T=y;T<m;++T)for(var k=g+T*i-f,I=b;I<w;++I){var A=x+I*a-d;_+=u?h.get(N,k,A,C)*v.get(N,T,I,E):h.get(N,C,k,A)*v.get(N,E,T,I)}c.set(_,g,x,C,E)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,l=o.filterDepth,u=o.filterHeight,c=o.filterWidth,d=Fe(o.filterShape,"float32"),f=d.values,h=d.strides,v=h[0],g=h[1],y=h[2],m=h[3],x=this.readSync(r.dataId),b=r.strides,w=b[0],C=b[1],E=b[2],_=b[3],N=this.readSync(n.dataId),T=n.strides,k=T[0],I=T[1],A=T[2],U=T[3],B=o.padInfo.front,L=o.padInfo.left,V=o.padInfo.top,F=0;F<l;++F)for(var M=Math.max(0,Math.ceil((B-F)/i)),j=Math.min(o.outDepth,(o.inDepth+B-F)/i),R=F*v,P=0;P<u;++P)for(var z=Math.max(0,Math.ceil((V-P)/a)),G=Math.min(o.outHeight,(o.inHeight+V-P)/a),q=P*g+R,Y=0;Y<c;++Y)for(var J=Math.max(0,Math.ceil((L-Y)/s)),X=Math.min(o.outWidth,(o.inWidth+L-Y)/s),ee=Y*y+q,oe=0;oe<o.inChannels;++oe)for(var ue=oe*m+ee,ae=0;ae<o.outChannels;++ae){for(var ce=0,ne=0;ne<o.batchSize;++ne)for(var se=ne*k,ve=ne*w,xe=M;xe<j;++xe)for(var Me=(F+xe*i-B)*I+se,Pe=xe*C+ve,je=z;je<G;++je)for(var Le=(P+je*a-V)*A+Me,$e=je*E+Pe,at=J;at<X;++at){var Qe=at*_+$e;ce+=N[(Y+at*s-L)*U+Le+oe]*x[Qe+ae]}f[ue+ae]=ce}return d.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,l=n.preluActivationWeights,u=this.depthwiseConv2D(r,o,i);return a&&(u=this.add(u,a)),s&&(u=cv(this,u,s,l)),u},t.prototype.depthwiseConv2D=function(n,r,o){re([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,l=o.dilationWidth,u=o.padInfo.left,c=o.padInfo.top,d=o.outChannels/o.inChannels,f=Fe(o.outShape,n.dtype),h=this.readSync(n.dataId),v=this.readSync(r.dataId),g=f.values,y=0;y<o.batchSize;++y)for(var m=y*n.strides[0],x=y*f.strides[0],b=0;b<o.outHeight;++b)for(var w=x+b*f.strides[1],C=b*o.strideHeight-u,E=0;E<i;++E){var _=C+E*s;if(!(_<0||_>=o.inHeight))for(var N=E*r.strides[0],T=m+_*n.strides[1],k=0;k<o.outWidth;++k)for(var I=w+k*f.strides[2],A=k*o.strideWidth-c,U=0;U<a;++U){var B=A+U*l;if(!(B<0||B>=o.inWidth))for(var L=N+U*r.strides[1],V=T+B*o.inChannels,F=I,M=L,j=0;j<o.inChannels;++j){for(var R=h[V+j],P=0;P<d;++P)g[F+P]+=R*v[M+P];F+=d,M+=d}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,o){re([n,r],"depthwiseConv2DDerInput");for(var i=Fe(o.inShape,"float32"),a=i.values,s=i.strides,l=s[0],u=s[1],c=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],v=f[1],g=f[2],y=this.readSync(r.dataId),m=r.strides,x=m[0],b=m[1],w=m[2],C=o.batchSize,E=o.filterHeight,_=o.filterWidth,N=o.inChannels,T=o.inHeight,k=o.inWidth,I=o.outChannels,A=o.outHeight,U=o.outWidth,B=o.strideHeight,L=o.strideWidth,V=E-1-o.padInfo.top,F=_-1-o.padInfo.left,M=I/N,j=0;j<C;++j)for(var R=0;R<N;++R)for(var P=0;P<T;++P)for(var z=P-V,G=Math.max(0,Math.ceil(z/B)),q=Math.min(A,(E+z)/B),Y=0;Y<k;++Y){for(var J=Y-F,X=Math.max(0,Math.ceil(J/L)),ee=Math.min(U,(_+J)/L),oe=0,ue=G;ue<q;++ue)for(var ae=ue*B-z,ce=X;ce<ee;++ce)for(var ne=h*j+v*ue+g*ce,se=x*(E-1-ae)+b*(_-1-(ce*L-J))+w*R,ve=0;ve<M;++ve)oe+=d[ne+(R*M+ve)]*y[se+ve];a[l*j+u*P+c*Y+R]=oe}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){re([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,l=o.filterWidth,u=Fe(o.filterShape,"float32"),c=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),v=this.bufferSync(r),g=0;g<s;++g)for(var y=Math.max(0,Math.ceil((d-g)/i)),m=Math.min(o.outHeight,(o.inHeight+d-g)/i),x=0;x<l;++x)for(var b=Math.max(0,Math.ceil((c-x)/a)),w=Math.min(o.outWidth,(o.inWidth+c-x)/a),C=0;C<o.outChannels;++C){for(var E=Math.trunc(C/f),_=C%f,N=0,T=0;T<o.batchSize;++T)for(var k=y;k<m;++k)for(var I=g+k*i-d,A=b;A<w;++A){var U=x+A*a-c;N+=h.get(T,I,U,E)*v.get(T,k,A,C)}u.set(N,g,x,E,_)}return u.toTensor()},t.prototype.tile=function(n,r){return re(n,"tile"),CA(this.bufferSync(n),r)},t.prototype.pad=function(n,r,o){re(n,"pad");var i=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),l=Fe(i,n.dtype);o!==0&&l.values.fill(o);for(var u=0;u<n.size;u++){var c=s.indexToLoc(u),d=c.map(function(f,h){return f+a[h]});l.set.apply(l,[s.get.apply(s,c)].concat(d))}return l.toTensor()},t.prototype.transpose=function(n,r){re(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=Fe(o,n.dtype),l=this.bufferSync(n);for(i=0;i<n.size;++i){for(var u=l.indexToLoc(i),c=new Array(u.length),d=0;d<c.length;d++)c[d]=u[r[d]];var f=s.locToIndex(c);s.values[f]=a[i]}return s.toTensor()},t.prototype.gather=function(n,r,o){re([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Fe(i,n.dtype),l=this.bufferSync(n),u=0;u<s.size;++u){var c=s.indexToLoc(u),d=c.slice();d[o]=a[c[o]];var f=l.locToIndex(d);s.values[u]=l.values[f]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,o){re([n],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=kh(n.shape,r,i),s=Nh(a.length,r.length),l=Th(n.shape,r,i),u=uA(o,r.length),c=cA(l,o,r.length);return n.reshape(a).transpose(s).reshape(l).slice(u,c)},t.prototype.spaceToBatchND=function(n,r,o){re([n],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var l=n.pad(a),u=kh(l.shape,r,i,!1),c=Nh(u.length,r.length,!1),d=Th(l.shape,r,i,!1);return l.reshape(u).transpose(c).reshape(d)},t.prototype.pool=function(n,r,o){re(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,u=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(n.dataId),g=Fe(r.outShape,n.dtype),y=g.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],x=r.outShape[2]*r.outShape[3],b=r.outShape[3],w=0;w<r.batchSize;++w)for(var C=w*m,E=w*n.strides[0],_=0;_<r.inChannels;++_)for(var N=0;N<r.outHeight;++N)for(var T=N*i-d,k=Math.max(0,T),I=Math.min(r.inHeight,u+T),A=C+N*x,U=0;U<r.outWidth;++U){for(var B=U*a-f,L=Math.max(0,B),V=Math.min(r.inWidth,c+B),F=h,M=0,j=0,R=k;R<I;R+=s){for(var P=E+R*n.strides[1],z=L;z<V;z+=l){var G=v[P+z*n.strides[2]+_];o==="max"&&G>F?F=G:o==="avg"&&(M+=G,j++)}if(isNaN(F))break}y[A+U*b+_]=o==="avg"?M/j:F}return g.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var o=Fe(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,u=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var m=y*i-d,x=m;x<0;)x+=s;for(var b=Math.min(r.inHeight,u+m),w=0;w<r.outWidth;++w){for(var C=w*a-f,E=C;E<0;)E+=l;for(var _=Math.min(r.inWidth,c+C),N=Number.NEGATIVE_INFINITY,T=-1,k=x;k<b;k+=s)for(var I=k-m,A=E;A<_;A+=l){var U=A-C,B=h.get(v,k,A,g);B>N&&(N=B,T=I*c+U)}o.set(T,v,y,w,g)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(n,r,o,i){re([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,l=i.strideWidth,u=i.dilationHeight,c=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,v=d-1-i.padInfo.top,g=Fe(r.shape,"float32"),y=this.bufferSync(a),m=this.bufferSync(n),x=0;x<i.batchSize;++x)for(var b=0;b<i.inChannels;++b)for(var w=0;w<i.inHeight;++w)for(var C=0;C<i.inWidth;++C){for(var E=w-v,_=C-h,N=0,T=0;T<d;T+=u){var k=(E+T)/s;if(!(k<0||k>=i.outHeight||Math.floor(k)!==k))for(var I=0;I<f;I+=c){var A=(_+I)/l;if(!(A<0||A>=i.outWidth||Math.floor(A)!==A)){var U=d*f-1-y.get(x,k,A,b)===T*f+I?1:0;U!==0&&(N+=m.get(x,k,A,b)*U)}}}g.set(N,x,w,C,b)}return g.toTensor()},t.prototype.avgPoolBackprop=function(n,r,o){re([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,l=o.filterWidth,u=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,v=d-1-o.padInfo.top,g=Fe(r.shape,"float32"),y=1/(s*l),m=this.bufferSync(n),x=0;x<o.batchSize;++x)for(var b=0;b<o.inChannels;++b)for(var w=0;w<o.inHeight;++w)for(var C=0;C<o.inWidth;++C){for(var E=w-v,_=C-h,N=0,T=0;T<d;T+=u){var k=(E+T)/i;if(!(k<0||k>=o.outHeight||Math.floor(k)!==k))for(var I=0;I<f;I+=c){var A=(_+I)/a;A<0||A>=o.outWidth||Math.floor(A)!==A||(N+=m.get(x,k,A,b))}}g.set(N*y,x,w,C,b)}return g.toTensor()},t.prototype.pool3d=function(n,r,o){re(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,m=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=this.readSync(n.dataId),b=Fe(r.outShape,n.dtype),w=b.values,C=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[2]*r.outShape[3]*r.outShape[4],_=r.outShape[3]*r.outShape[4],N=r.outShape[4],T=0;T<r.batchSize;++T)for(var k=T*C,I=T*n.strides[0],A=0;A<r.inChannels;++A)for(var U=0;U<r.outDepth;++U){for(var B=U*i-v,L=B;L<0;)L+=l;for(var V=Math.min(r.inDepth,d+B),F=k+U*E,M=0;M<r.outHeight;++M){for(var j=M*a-g,R=j;R<0;)R+=u;for(var P=Math.min(r.inHeight,f+j),z=F+M*_,G=0;G<r.outWidth;++G){for(var q=G*s-y,Y=q;Y<0;)Y+=c;for(var J=Math.min(r.inWidth,h+q),X=z+G*N,ee=m,oe=0,ue=0,ae=L;ae<V;ae+=l){for(var ce=I+ae*n.strides[1],ne=R;ne<P;ne+=u){for(var se=ce+ne*n.strides[2],ve=Y;ve<J;ve+=c){var xe=x[se+ve*n.strides[3]+A];if(o==="max"&&xe>ee?ee=xe:o==="avg"&&(oe+=xe,ue++),isNaN(ee))break}if(isNaN(ee))break}if(isNaN(ee))break}w[X+A]=o==="avg"?oe/ue:ee}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return re(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,o){re([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,l=o.filterDepth,u=o.filterHeight,c=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,v=o.effectiveFilterDepth,g=o.effectiveFilterHeight,y=o.effectiveFilterWidth,m=v-1-o.padInfo.front,x=y-1-o.padInfo.left,b=g-1-o.padInfo.top,w=Fe(r.shape,"float32"),C=1/(l*u*c),E=this.bufferSync(n),_=0;_<o.batchSize;++_)for(var N=0;N<o.inChannels;++N)for(var T=0;T<o.inDepth;++T)for(var k=0;k<o.inHeight;++k)for(var I=0;I<o.inWidth;++I){for(var A=T-m,U=k-b,B=I-x,L=0,V=0;V<v;V+=d){var F=(A+V)/i;if(!(F<0||F>=o.outDepth||Math.floor(F)!==F))for(var M=0;M<g;M+=f){var j=(U+M)/a;if(!(j<0||j>=o.outHeight||Math.floor(j)!==j))for(var R=0;R<y;R+=h){var P=(B+R)/s;P<0||P>=o.outWidth||Math.floor(P)!==P||(L+=E.get(_,F,j,P,N))}}}w.set(L*C,_,T,k,I,N)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return re(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var o=Fe(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,m=this.bufferSync(n),x=0;x<r.batchSize;++x)for(var b=0;b<r.inChannels;++b)for(var w=0;w<r.outDepth;++w){for(var C=w*i-v,E=C;E<0;)E+=l;for(var _=Math.min(r.inDepth,d+C),N=0;N<r.outHeight;++N){for(var T=N*a-g,k=T;k<0;)k+=u;for(var I=Math.min(r.inHeight,f+T),A=0;A<r.outWidth;++A){for(var U=A*s-y,B=U;B<0;)B+=c;for(var L=Math.min(r.inWidth,h+U),V=Number.NEGATIVE_INFINITY,F=-1,M=E;M<_;M+=l)for(var j=M-C,R=k;R<I;R+=u)for(var P=R-T,z=B;z<L;z+=c){var G=z-U,q=m.get(x,M,R,z,b);q>=V&&(V=q,F=j*f*h+P*f+G)}o.set(F,x,w,N,A,b)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,o,i){re([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,l=i.strideHeight,u=i.strideWidth,c=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,v=i.effectiveFilterHeight,g=i.effectiveFilterWidth,y=h-1-i.padInfo.front,m=g-1-i.padInfo.left,x=v-1-i.padInfo.top,b=Fe(r.shape,"float32"),w=this.bufferSync(a),C=this.bufferSync(n),E=0;E<i.batchSize;++E)for(var _=0;_<i.inChannels;++_)for(var N=0;N<i.inDepth;++N)for(var T=0;T<i.inHeight;++T)for(var k=0;k<i.inWidth;++k){for(var I=N-y,A=T-x,U=k-m,B=0,L=0;L<h;L+=c){var V=(I+L)/s;if(!(V<0||V>=i.outDepth||Math.floor(V)!==V))for(var F=0;F<v;F+=d){var M=(A+F)/l;if(!(M<0||M>=i.outHeight||Math.floor(M)!==M))for(var j=0;j<g;j+=f){var R=(U+j)/u;if(!(R<0||R>=i.outWidth||Math.floor(R)!==R)){var P=h*v*g-1-w.get(E,V,M,R,_)===L*v*g+F*g+j?1:0;P!==0&&(B+=C.get(E,V,M,R,_)*P)}}}}b.set(B,E,N,T,k,_)}return b.toTensor()},t.prototype.cast=function(n,r){return yA(n,r,this)},t.prototype.reshape=function(n,r){return wy(n,r)},t.prototype.avgPool=function(n,r){return re(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,o,i){re(n,"resizeBilinear");for(var a=n.shape,s=a[0],l=a[1],u=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(Se([s,r,o,c])),h=[i&&r>1?l-1:l,i&&o>1?u-1:u],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],g=0,y=h[0]/v[0],m=h[1]/v[1],x=0;x<s;x++)for(var b=0;b<r;b++)for(var w=y*b,C=Math.floor(w),E=w-C,_=Math.min(l-1,Math.ceil(w)),N=x*n.strides[0]+C*n.strides[1],T=x*n.strides[0]+_*n.strides[1],k=0;k<o;k++)for(var I=m*k,A=Math.floor(I),U=I-A,B=Math.min(u-1,Math.ceil(I)),L=N+A*n.strides[2],V=T+A*n.strides[2],F=N+B*n.strides[2],M=T+B*n.strides[2],j=0;j<c;j++){var R=d[L+j],P=d[V+j],z=R+(d[F+j]-R)*U,G=z+(P+(d[M+j]-P)*U-z)*E;f[g++]=G}return bn(f,[s,r,o,c])},t.prototype.resizeBilinearBackprop=function(n,r,o){re([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],l=i[2],u=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*l*u),v=[o&&d>1?s-1:s,o&&f>1?l-1:l],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],y=v[0]/g[0],m=v[1]/g[1],x=this.readSync(n.dataId),b=0,w=0;w<a;w++)for(var C=w*r.strides[0],E=0;E<d;E++)for(var _=E*y,N=Math.floor(_),T=Math.min(Math.ceil(_),s-1),k=C+N*r.strides[1],I=C+T*r.strides[1],A=_-N,U=1-A,B=0;B<f;B++)for(var L=B*m,V=Math.floor(L),F=Math.min(Math.ceil(L),l-1),M=L-V,j=1-M,R=k+V*r.strides[2],P=k+F*r.strides[2],z=I+V*r.strides[2],G=I+F*r.strides[2],q=U*j,Y=U*M,J=A*j,X=A*M,ee=0;ee<u;ee++){var oe=x[b++];h[R+ee]+=oe*q,h[P+ee]+=oe*Y,h[z+ee]+=oe*J,h[G+ee]+=oe*X}return tr(h,[a,l,s,u],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,o,i){re(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],l=a[1],u=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*c),h=[i&&r>1?l-1:l,i&&o>1?u-1:u],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],g=h[0]/v[0],y=h[1]/v[1],m=0,x=0;x<s;x++)for(var b=x*n.strides[0],w=0;w<r;w++)for(var C=g*w,E=b+Math.min(l-1,i?Math.round(C):Math.floor(C))*n.strides[1],_=0;_<o;_++)for(var N=y*_,T=E+Math.min(u-1,i?Math.round(N):Math.floor(N))*n.strides[2],k=0;k<c;k++){var I=d[T+k];f[m++]=I}return bn(f,[s,r,o,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){re([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],l=i[2],u=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*l*u),v=this.readSync(n.dataId),g=[o&&d>1?s-1:s,o&&f>1?l-1:l],y=[o&&d>1?d-1:d,o&&f>1?f-1:f],m=g[0]/y[0],x=g[1]/y[1],b=1/m,w=1/x,C=2*Math.ceil(b)+2,E=2*Math.ceil(w)+2,_=0;_<a;_++)for(var N=_*r.strides[0],T=0;T<s;T++)for(var k=N+T*r.strides[1],I=Math.floor(T*b),A=Math.floor(I-C/2),U=0;U<l;U++)for(var B=k+U*r.strides[2],L=Math.floor(U*w),V=Math.floor(L-E/2),F=0;F<u;F++){for(var M=0,j=0;j<C;j++){var R=j+A;if(!(R<0||R>=d)){var P=N+R*n.strides[1],z=R*m;if(T===Math.min(s-1,o?Math.round(z):Math.floor(z)))for(var G=0;G<E;G++){var q=G+V;if(!(q<0||q>=f)){var Y=P+q*n.strides[2],J=q*x;U===Math.min(l-1,o?Math.round(J):Math.floor(J))&&(M+=v[Y+F])}}}}h[B+F]=M}return tr(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){re([n,r,o,a,s],"batchNorm");for(var l=this.readSync(n.dataId),u=this.readSync(r.dataId),c=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(l.length),v=f.length,g=d.length,y=c.length,m=u.length,x=0,b=0,w=0,C=0,E=0;E<l.length;++E)h[E]=f[x++]+(l[E]-u[b++])*d[w++]/Math.sqrt(c[C++]+i),x>=v&&(x=0),b>=m&&(b=0),w>=g&&(w=0),C>=y&&(C=0);return tr(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){re(n,"localResponseNormalization4D");var s=n.shape[3],l=s-1,u=this.readSync(n.dataId),c=n.size,d=new Float32Array(c);function f(y){for(var m=y%s,x=y-m+Math.max(0,m-r),b=y-m+Math.min(m+r,l),w=0;x<=b;x++){var C=u[x];w+=C*C}return w}for(var h=0;h<c;h++){var v=f(h),g=u[h]*Math.pow(o+i*v,-a);d[h]=g}return tr(d,n.shape)},t.prototype.LRNGrad=function(n,r,o,i,a,s,l){re(n,"LRNGrad");for(var u=n.shape[3],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),v=n.size,g=0;g<v;g++){for(var y=g%u,m=g-y+Math.max(0,y-i),x=g-y+Math.min(u,y+i+1),b=0,w=m;w<x;w++)b+=Math.pow(d[w],2);for(b=s*b+a,w=m;w<x;w++){var C=-2*s*l*d[w]*f[g]/b;g===w&&(C+=Math.pow(b,-l)),C*=c[g],h[w]+=C}}return tr(h,n.shape)},t.prototype.multinomial=function(n,r,o,i){re(n,"multinomial");for(var a=r?n:gi(n),s=a.shape[0],l=a.shape[1],u=Ct([s,o],"int32"),c=this.readSync(u.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*l,v=new Float32Array(l-1);v[0]=d[h];for(var g=1;g<v.length;++g)v[g]=v[g-1]+d[h+g];for(var y=Sp(i.toString()),m=f*o,x=0;x<o;++x){var b=y();c[m+x]=v.length;for(var w=0;w<v.length;w++)if(b<v[w]){c[m+x]=w;break}}}return u},t.prototype.oneHot=function(n,r,o,i){re(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),l=0;l<n.size;++l)s[l]>=0&&s[l]<r&&(a[l*r+s[l]]=o);return oa(a,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return re(n,"nonMaxSuppression"),zx(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=Fe(n.shape,"float32"),s=Fe(n.shape,"float32"),l=Dr(n).as2D(o,i),u=ko(n).as2D(o,i),c=0;c<o;c++)for(var d=l.slice([c,0],[1,i]),f=u.slice([c,0],[1,i]),h=yn(d,f),v=this.readSync(this.fftImpl(h,r).dataId),g=0;g<i;g++){var y=fS(v,g);a.values[c*i+g]=y.real,s.values[c*i+g]=y.imag}return yn(a.toTensor(),s.toTensor()).as2D(o,i)},t.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=yn(Dr(a).div(de(i)),ko(a).div(de(i)))),a}var s=this.readSync(n.dataId),l=function(u){for(var c=new Float32Array(u.length/2),d=new Float32Array(u.length/2),f=0;f<u.length;f+=2)c[f/2]=u[f],d[f/2]=u[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(s,i,r));return yn(l.real,l.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(m){for(var x=Math.ceil(m.length/4),b=new Float32Array(x),w=new Float32Array(x),C=0;C<m.length;C+=4)b[Math.floor(C/4)]=m[C],w[Math.floor(C/4)]=m[C+1];return{real:b,imag:w}}(i),l=yn(s.real,s.imag).as1D(),u=function(m){for(var x=Math.floor(m.length/4),b=new Float32Array(x),w=new Float32Array(x),C=2;C<m.length;C+=4)b[Math.floor(C/4)]=m[C],w[Math.floor(C/4)]=m[C+1];return{real:b,imag:w}}(i),c=yn(u.real,u.imag).as1D();l=this.fftRadix2(l,a,o),c=this.fftRadix2(c,a,o);var d=function(m,x){for(var b=new Float32Array(m/2),w=new Float32Array(m/2),C=0;C<Math.ceil(m/2);C++){var E=(x?2:-2)*Math.PI*(C/m);b[C]=Math.cos(E),w[C]=Math.sin(E)}return{real:b,imag:w}}(r,o),f=yn(d.real,d.imag).mul(c),h=l.add(f),v=l.sub(f),g=Dr(h).concat(Dr(v)),y=ko(h).concat(ko(v));return yn(g,y).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,l=0,u=0;u<r;u++){var c=G8(a*u,r,o),d=fS(n,u);s+=d.real*c.real-d.imag*c.imag,l+=d.real*c.imag+d.imag*c.real}o&&(s/=r,l/=r),H8(i,s,l,a)}return i},t.prototype.depthToSpace=function(n,r,o){O(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),O(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],l=n.shape[3],u=a*r,c=s*r,d=l/(r*r),f=this.readSync(n.dataId),h=new Float32Array(i*u*c*d),v=0,g=0;g<i;++g)for(var y=0;y<u;++y)for(var m=Math.floor(y/r),x=y%r,b=0;b<c;++b)for(var w=Math.floor(b/r),C=(x*r+b%r)*d,E=0;E<d;++E){var _=E+C+l*(w+s*(m+a*g));h[v++]=f[_]}return tr(h,[i,u,c,d])},t.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=He(n.shape,r.shape),s=Fe(a,o),l=this.readSync(n.dataId),u=this.readSync(r.dataId),c=qi(n.shape,a),d=qi(r.shape,a),f=s.values;if(c.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(l[h%l.length],u[h%u.length]);else{var v=this.bufferSync(n),g=this.bufferSync(r),y=function(m){var x=s.indexToLoc(m),b=x.slice(-n.rank);c.forEach(function(_){return b[_]=0});var w=v.locToIndex(b),C=x.slice(-r.rank);d.forEach(function(_){return C[_]=0});var E=g.locToIndex(C);f[m]=i(l[w],u[E])};for(h=0;h<f.length;++h)y(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=He(n.shape,r.shape),a=Fe(i,"float32"),s=Fe(i,"float32"),l=this.readSync(n.dataId),u=this.readSync(r.dataId),c=qi(n.shape,i),d=qi(r.shape,i),f=a.values,h=s.values;if(c.length+d.length===0)for(var v=0;v<f.length;v++){var g=v%l.length,y=v%u.length,m=o(l[2*g],l[2*g+1],u[2*y],u[2*y+1]);f[v]=m.real,h[v]=m.imag}else{var x=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(C){var E=a.indexToLoc(C),_=E.slice(-n.rank);c.forEach(function(A){return _[A]=0});var N=x.locToIndex(_),T=E.slice(-r.rank);d.forEach(function(A){return T[A]=0});var k=b.locToIndex(T),I=o(l[2*N],l[2*N+1],u[2*k],u[2*k+1]);f[C]=I.real,h[C]=I.imag};for(v=0;v<f.length;v++)w(v)}return this.complex(a.toTensor(),s.toTensor())},t.prototype.split=function(n,r,o){return wA(n,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,o,i,a,s){for(var l=n.shape,u=l[0],c=l[1],d=l[2],f=l[3],h=r.shape[0],v=i[0],g=i[1],y=Fe([h,v,g,f],"float32"),m=this.readSync(r.dataId),x=this.readSync(o.dataId),b=this.readSync(n.dataId),w=n.strides,C=y.strides,E=0;E<h;E++){var _=4*E,N=m[_],T=m[_+1],k=m[_+2],I=m[_+3],A=x[E];if(!(A>=u))for(var U=v>1?(k-N)*(c-1)/(v-1):0,B=g>1?(I-T)*(d-1)/(g-1):0,L=0;L<v;L++){var V=v>1?N*(c-1)+L*U:.5*(N+k)*(c-1);if(V<0||V>c-1)for(var F=0;F<g;F++)for(var M=0;M<f;M++){var j=M+F*C[2]+L*C[1]+E*C[0];y.values[j]=s}else if(a==="bilinear"){var R=Math.floor(V),P=Math.ceil(V),z=V-R;for(F=0;F<g;F++)if((ae=g>1?T*(d-1)+F*B:.5*(T+I)*(d-1))<0||ae>d-1)for(M=0;M<f;M++)j=M+F*C[2]+L*C[1]+E*C[0],y.values[j]=s;else{var G=Math.floor(ae),q=Math.ceil(ae),Y=ae-G;for(M=0;M<f;M++){var J=b[j=M+G*w[2]+R*w[1]+A*w[0]],X=b[j=M+q*w[2]+R*w[1]+A*w[0]],ee=b[j=M+G*w[2]+P*w[1]+A*w[0]],oe=J+(X-J)*Y,ue=ee+(b[j=M+q*w[2]+P*w[1]+A*w[0]]-ee)*Y;j=M+F*C[2]+L*C[1]+E*C[0],y.values[j]=oe+(ue-oe)*z}}}else for(F=0;F<g;++F){var ae;if((ae=g>1?T*(d-1)+F*B:.5*(T+I)*(d-1))<0||ae>d-1)for(M=0;M<f;M++)j=M+F*C[2]+L*C[1]+E*C[0],y.values[j]=s;else{var ce=Math.round(ae),ne=Math.round(V);for(M=0;M<f;M++){var se=M+ce*w[2]+ne*w[1]+A*w[0],ve=M+F*C[2]+L*C[1]+E*C[0];y.values[ve]=b[se]}}}}}return y.toTensor()},t.prototype.sparseToDense=function(n,r,o,i){var a=Rh(0,n,o),s=a.sliceRank,l=a.numUpdates,u=a.sliceSize,c=a.strides,d=a.outputSize;return this.scatter(n,r,o,d,u,l,s,c,i,!1)},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=dA(n,r),s=a[0],l=a[1],u=a[2],c=a[3];if(l===0)return bn([],s,n.dtype);for(var d=new kc([l,u],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),v=0;v<l;v++){for(var g=[],y=0,m=0;m<i;m++){var x=f[v*i+m];y+=x*c[m],g.push(x)}if(y<0||y>=n.size/u)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var b=0;b<u;b++)d.values[v*u+b]=h[y*u+b]}return d.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,o){var i=Rh(0,n,o),a=i.sliceRank,s=i.numUpdates,l=i.sliceSize,u=i.strides,c=i.outputSize,d=de(0);return this.scatter(n,r,o,c,l,s,a,u,d,!0)},t.prototype.fill=function(n,r,o){var i=xh(o=o||Qc(r),Se(n));return i.fill(r),H.makeTensor(i,n,o,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=xh(n.dtype,Se(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,o){return xA(n,r,o)},t.prototype.scatter=function(n,r,o,i,a,s,l,u,c,d){var f=[i/a,a],h=this.readSync(n.dataId),v=this.readSync(r.dataId);if(i===0)return bn([],o,r.dtype);var g=new kc(f,r.dtype);g.values.fill(this.readSync(c.dataId)[0]);for(var y=0;y<s;y++){for(var m=[],x=0,b=0;b<l;b++){var w=h[y*l+b];m.push(w),x+=w*u[b]}if(x<0||x>=i/a)throw new Error("Invalid indices: "+m+" does not index into "+o);for(var C=0;C<a;C++)d?g.values[x*a+C]+=v[y*a+C]:g.values[x*a+C]=r.rank===0?v[0]:v[y*a+C]}return g.toTensor().reshape(o)},t}(vA);H.registerBackend("cpu",function(){return new fq},1);for(var dv=0,DS=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,l=s.maxOutputSize,u=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n;re(i,"NonMaxSuppressionWithScore");var h=Wx(f.data.get(i.dataId).values,f.data.get(a.dataId).values,l,u,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;re(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var l=i[s];a[s]=l*l}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Rc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;re([o,i],Rc);var s=a.data.get(o.dataId).values,l=a.data.get(i.dataId).values,u=function(f,h,v,g,y,m){var x=He(f,h),b=x.length,w=Fo(x),C=_c(y,Se(x)),E=f.length,_=h.length,N=Fo(f),T=Fo(h),k=qi(f,x),I=qi(h,x);if(k.length+I.length===0)for(var A=0;A<C.length;++A)C[A]=m(v[A%v.length],g[A%g.length]);else{var U=function(B){var L=CU(B,b,w),V=L.slice(-E);k.forEach(function(R){return V[R]=0});var F=rS(V,E,N),M=L.slice(-_);I.forEach(function(R){return M[R]=0});var j=rS(M,_,T);C[B]=m(v[F],g[j])};for(A=0;A<C.length;++A)U(A)}return[C,x]}(o.shape,i.shape,s,l,o.dtype,function(f,h){var v=f-h;return v*v}),c=u[0],d=u[1];return{dataId:a.write(c,d,o.dtype),shape:d,dtype:o.dtype}}}];dv<DS.length;dv++)UP(DS[dv]);var Ns,hq=function(e){this.variableNames=["A"];var t=Mn(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},pq=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Mn(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var fv=0,jS=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,l=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],u=l[0],c=l[1],d=[c,u],f=[c,u,i];(s||a)&&(Ns==null&&(Ns=document.createElement("canvas").getContext("2d")),Ns.canvas.width=u,Ns.canvas.height=c,Ns.drawImage(o,0,0,u,c),o=Ns.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=gr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var v=te().getBool("WEBGL_PACK")?new pq(f):new hq(f),g=n.runWebGLProgram(v,[h],"int32");return n.disposeData(h.dataId),g}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Sh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,l=s.maxOutputSize,u=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n,h=Wx(f.readSync(i.dataId),f.readSync(a.dataId),l,u,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new Ve(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Rc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Yo("return (a - b) * (a - b);",o.shape,i.shape):new Ft("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];fv<jS.length;fv++)UP(jS[fv]);for(var hv=0,FS=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:Rc,gradFunc:function(e,t){var n=t[0],r=t[1],o=de(2);return{a:function(){return Fn(e,Fn(o,on(n,r)))},b:function(){return Fn(e,Fn(o,on(r,n)))}}}}];hv<FS.length;hv++)dU(FS[hv]);var mq=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();te().get("IS_BROWSER")&&te().setPlatform("browser",new mq);var pv,vq=function(){return require("node-fetch")},gq=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return te().global.fetch!=null?te().global.fetch(t,n):(pv==null&&(pv=vq()),pv(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();te().get("IS_NODE")&&te().setPlatform("node",new gq);var Ey={float32:4,int32:4,uint16:2,uint8:1,bool:1},Fh=4;function hI(e,t){for(var n={},r=0,o=function(s){var l=s.name,u=s.dtype,c=s.shape,d=Se(c),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var v=Ey[h.dtype],g=e.slice(r,r+d*v),y=h.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(u==="float32")f=Float32Array.from(y,function(E){return E*h.scale+h.min});else{if(u!=="int32")throw new Error("Unsupported dtype in weight '"+l+"': "+u);f=Int32Array.from(y,function(E){return Math.round(E*h.scale+h.min)})}r+=d*v}else if(u==="string"){var m=Se(s.shape);f=[];for(var x=0;x<m;x++){var b=new Uint32Array(e.slice(r,r+Fh))[0];r+=Fh;var w=new Uint8Array(e.slice(r,r+b));f.push(w),r+=b}}else{var C=Ey[u];if(g=e.slice(r,r+d*C),u==="float32")f=new Float32Array(g);else if(u==="int32")f=new Int32Array(g);else{if(u!=="bool")throw new Error("Unsupported dtype in weight '"+l+"': "+u);f=new Uint8Array(g)}r+=d*C}n[l]=bn(f,c,u)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function yq(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var _y=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function OS(e){return _y?Buffer.byteLength(e):new Blob([e]).size}function s1(e){var t=0;e.forEach(function(o){t+=o.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function LS(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function od(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:OS(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:OS(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var yr=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var a=i(t,r);a!==null&&o.push(a)}),o},e}(),hl="://",ia=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){O(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(hl)&&(t=t.slice(0,t.indexOf(hl))),O(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();O(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Pf(e){if(e.indexOf(hl)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+ia.getSchemes().join(","));return{scheme:e.split(hl)[0],path:e.split(hl)[1]}}function BS(e,t,n){return n===void 0&&(n=!1),be(this,void 0,void 0,function(){var r,o,i,a,s,l,u,c,d;return we(this,function(f){switch(f.label){case 0:return O(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),O((r=yr.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),O(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],O((i=yr.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),O(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=i[0],s=Pf(e).scheme,l=Pf(e).path,u=s===Pf(e).scheme,[4,o.load()];case 1:return c=f.sent(),n&&u?[4,ia.getManager(s).removeModel(l)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(c)];case 4:return d=f.sent(),!n||u?[3,6]:[4,ia.getManager(s).removeModel(l)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var Va="models_store",Ki="model_info_store";function pI(){if(!te().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function ky(e){var t=e.result;t.createObjectStore(Va,{keyPath:"modelPath"}),t.createObjectStore(Ki,{keyPath:"modelPath"})}var pl=function(){function e(t){if(this.indexedDB=pI(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return be(this,void 0,void 0,function(){return we(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return be(this,void 0,void 0,function(){return we(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return ky(a)},a.onsuccess=function(){var s=a.result;if(n==null){var l=s.transaction(Va,"readonly"),u=l.objectStore(Va).get(r.modelPath);u.onsuccess=function(){if(u.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(u.result.modelArtifacts)},u.onerror=function(g){return s.close(),i(u.error)},l.oncomplete=function(){return s.close()}}else{var c,d=od(n),f=s.transaction(Ki,"readwrite"),h=f.objectStore(Ki),v=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});v.onsuccess=function(){var g=(c=s.transaction(Va,"readwrite")).objectStore(Va).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});g.onsuccess=function(){return o({modelArtifactsInfo:d})},g.onerror=function(y){var m=(h=f.objectStore(Ki)).delete(r.modelPath);m.onsuccess=function(){return s.close(),i(g.error)},m.onerror=function(x){return s.close(),i(g.error)}}},v.onerror=function(g){return s.close(),i(v.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),VS=function(e){return te().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(pl.URL_SCHEME)?(t=e.slice(pl.URL_SCHEME.length),new pl(t)):null;var t};yr.registerSaveRouter(VS),yr.registerLoadRouter(VS);var xq=function(){function e(){this.indexedDB=pI()}return e.prototype.listModels=function(){return be(this,void 0,void 0,function(){var t=this;return we(this,function(n){return[2,new Promise(function(r,o){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return ky(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Ki,"readonly"),l=s.objectStore(Ki).getAll();l.onsuccess=function(){for(var u={},c=0,d=l.result;c<d.length;c++){var f=d[c];u[f.modelPath]=f.modelArtifactsInfo}r(u)},l.onerror=function(u){return a.close(),o(l.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},e.prototype.removeModel=function(t){return be(this,void 0,void 0,function(){var n=this;return we(this,function(r){var o;return t=(o=t).startsWith(pl.URL_SCHEME)?o.slice(pl.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return ky(s)},s.onsuccess=function(){var l,u=s.result,c=u.transaction(Ki,"readwrite"),d=c.objectStore(Ki),f=d.get(t);f.onsuccess=function(){if(f.result==null)return u.close(),a(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=d.delete(t),v=function(){var g=(l=u.transaction(Va,"readwrite")).objectStore(Va).delete(t);g.onsuccess=function(){return i(f.result.modelArtifactsInfo)},g.onerror=function(y){return a(f.error)}};h.onsuccess=v,h.onerror=function(g){return v(),u.close(),a(f.error)}},f.onerror=function(h){return u.close(),a(f.error)},c.oncomplete=function(){l==null?u.close():l.oncomplete=function(){return u.close()}}},s.onerror=function(l){return a(s.error)}})]})})},e}();if(te().getBool("IS_BROWSER"))try{ia.registerManager(pl.URL_SCHEME,new xq)}catch{}var ti="/",Ds="tensorflowjs_models",mI="info",bq="model_topology",wq="weight_specs",Cq="weight_data",Sq="model_metadata";function vI(e){return{info:[Ds,e,mI].join(ti),topology:[Ds,e,bq].join(ti),weightSpecs:[Ds,e,wq].join(ti),weightData:[Ds,e,Cq].join(ti),modelMetadata:[Ds,e,Sq].join(ti)}}function Eq(e){var t=e.split(ti);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(ti)}var ml=function(){function e(t){if(!te().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=vI(this.modelPath)}return e.prototype.save=function(t){return be(this,void 0,void 0,function(){var n,r,o;return we(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=od(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(_y)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),l="",u=0,c=s.length;u<c;u++)l+=String.fromCharCode(s[u]);return btoa(l)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return be(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return we(this,function(l){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(u){if(_y){var c=Buffer.from(u,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(u),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),zS=function(e){return te().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ml.URL_SCHEME)?(t=e.slice(ml.URL_SCHEME.length),new ml(t)):null;var t};yr.registerSaveRouter(zS),yr.registerLoadRouter(zS);var _q=function(){function e(){O(te().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),O(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return be(this,void 0,void 0,function(){var t,n,r,o,i,a;return we(this,function(s){for(t={},n=Ds+ti,r=ti+mI,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=Eq(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return be(this,void 0,void 0,function(){var n,r;return we(this,function(o){var i;if(t=(i=t).startsWith(ml.URL_SCHEME)?i.slice(ml.URL_SCHEME.length):i,n=vI(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(te().getBool("IS_BROWSER"))try{ia.registerManager(ml.URL_SCHEME,new _q)}catch{}var kq="model",Nq=".json",Tq=".weights.bin";function WS(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var mv=function(){function e(t){if(!te().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=kq),this.modelTopologyFileName=t+Nq,this.weightDataFileName=t+Tq}return e.prototype.save=function(t){return be(this,void 0,void 0,function(){var n,r,o,i,a,s;return we(this,function(l){switch(l.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,WS(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return l.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,WS(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:l.sent(),l.label=4;case 4:return[2,{modelArtifactsInfo:od(t)}]}})})},e.URL_SCHEME="downloads://",e}(),Rq=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return be(this,void 0,void 0,function(){var t,n,r=this;return we(this,function(o){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(l){var u=JSON.parse(l.target.result),c=u.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var d=u.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(y){return void a(y)}var h=[],v=[],g=[];d.forEach(function(y){y.paths.forEach(function(m){v.push(m),g.push(null)}),h.push.apply(h,y.weights)}),d.forEach(function(y){y.paths.forEach(function(m){var x=new FileReader;x.onload=function(b){var w=b.target.result,C=v.indexOf(m);g[C]=w,g.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:h,weightData:s1(g),format:u.format,generatedBy:u.generatedBy,convertedBy:u.convertedBy,userDefinedMetadata:u.userDefinedMetadata})},x.onerror=function(b){return a("Failed to weights data from file of path '"+m+"'.")},x.readAsArrayBuffer(f[m])})})}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(l){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],o=n.map(function(l){return LS(l.name)}),i={},a=0,s=t;a<s.length;a++)s[a].paths.forEach(function(l){var u=LS(l);if(r.indexOf(u)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+u+"'");if(r.push(u),o.indexOf(u)===-1)throw new Error("Weight file with basename '"+u+"' is not provided.");i[l]=n[o.indexOf(u)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},e}();function $S(e,t,n,r){(function(i){O(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,a){O(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),O(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),O(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(e.map(function(i){return i.then(function(a){var s=n+ ++o/e.length*(r-n);return t(s),a}),i}))}function gI(e,t){return be(this,void 0,void 0,function(){var n,r,o,i,a,s,l,u,c;return we(this,function(d){switch(d.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?te().platform.fetch:t.fetchFunc,r=e.map(function(f){return n(f,t.requestInit,{isBinary:!0})}),o=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,$S(r,t.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),l=.5,u=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=d.sent(),[3,8];case 6:return[4,$S(s,t.onProgress,l,u)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function US(e){var t=this;return function(n,r,o){return r===void 0&&(r=""),be(t,void 0,void 0,function(){var i,a,s,l,u,c,d,f,h,v;return we(this,function(g){switch(g.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],l=[],n.forEach(function(y,m){var x=0;y.weights.forEach(function(b){var w="quantization"in b?b.quantization.dtype:b.dtype,C=Ey[w]*Se(b.shape),E=function(){i[m]=!0,a[m]==null&&(a[m]=[]),a[m].push({manifestEntry:b,groupOffset:x,sizeBytes:C})};o!=null?o.forEach(function(_,N){_===b.name&&(E(),s[N]=!0)}):E(),l.push(b.name),x+=C})}),!s.every(function(y){return y}))throw u=o.filter(function(y,m){return!s[m]}),new Error("Could not find weights in manifest with names: "+u.join(", ")+`. 
Manifest JSON has weights with names: `+l.join(", ")+".");return c=i.reduce(function(y,m,x){return m&&y.push(x),y},[]),d=[],c.forEach(function(y){n[y].paths.forEach(function(m){var x=r+(r.endsWith("/")?"":"/")+m;d.push(x)})}),[4,e(d)];case 1:return f=g.sent(),h={},v=0,c.forEach(function(y){for(var m=n[y].paths.length,x=0,b=0;b<m;b++)x+=f[v+b].byteLength;for(var w=new ArrayBuffer(x),C=new Uint8Array(w),E=0,_=0;_<m;_++){var N=new Uint8Array(f[v+_]);C.set(N,E),E+=N.byteLength}a[y].forEach(function(T){var k=hI(w.slice(T.groupOffset,T.groupOffset+T.sizeBytes),[T.manifestEntry]);for(var I in k)h[I]=k[I]}),v+=m}),[2,h]}})})}}yr.registerSaveRouter(function(e){return te().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(mv.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new mv(t)}(e.slice(mv.URL_SCHEME.length)):null});var yI=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(O(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=te().platform.fetch,O(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&O(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return be(this,void 0,void 0,function(){var n,r,o,i;return we(this,function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:od(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return be(this,void 0,void 0,function(){var t,n,r,o,i,a,s,l,u,c,d,f;return we(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,l=n.format,u=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),c=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:d,userDefinedMetadata:u,generatedBy:a,convertedBy:s,format:l}]}})})},e.prototype.loadWeights=function(t){return be(this,void 0,void 0,function(){var n,r,o,i,a,s,l,u,c,d,f;return we(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(v){var g=v.lastIndexOf("/"),y=v.lastIndexOf("?"),m=v.substring(0,g),x=y>g?v.substring(y):"";return[m+"/",x]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],l=0,u=t;l<u.length;l++)c=u[l],s.push.apply(s,c.weights);return d=[],t.forEach(function(v){v.paths.forEach(function(g){d.push(a+g+i)})}),[4,gI(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,s1(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Ny(e){return e.match(yI.URL_SCHEME_REGEX)!=null}var HS=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return Ny(n)}):Ny(e))?Ty(e,{onProgress:t}):null};function Ty(e,t){return new yI(e,t)}yr.registerSaveRouter(HS),yr.registerLoadRouter(HS);var vv=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return be(this,void 0,void 0,function(){return we(this,function(t){return[2,this.modelArtifacts]})})},e}(),Pq=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return be(this,void 0,void 0,function(){return we(this,function(n){return[2,this.saveHandler(t)]})})},e}(),xI=Object.freeze({browserFiles:function(e){return new Rq(e)},browserHTTPRequest:function(e,t){return Ty(e,t)},concatenateArrayBuffers:s1,decodeWeights:hI,encodeWeights:function(e,t){return be(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return we(this,function(l){switch(l.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map(function(u){return u.name}):Object.keys(e),i=function(u){var c=o[u],d=Array.isArray(e)?e[u].tensor:e[c];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(v){return be(s,void 0,void 0,function(){var g,y,m,x,b,w,C;return we(this,function(E){switch(E.label){case 0:return[4,d.bytes()];case 1:for(g=E.sent(),y=g.reduce(function(_,N){return _+N.length},0)+Fh*g.length,m=new Uint8Array(y),x=0,b=0;b<g.length;b++)w=g[b],C=new Uint8Array(new Uint32Array([w.length]).buffer),m.set(C,x),x+=Fh,m.set(w,x),x+=w.length;return v(m),[2]}})})});r.push(h)}else r.push(d.data());t!=null&&(f.group=t),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:yq(l.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new vv(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vv({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vv({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return yr.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:od,getSaveHandlers:function(e){return yr.getSaveHandlers(e)},http:Ty,isHTTPScheme:Ny,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),be(this,void 0,void 0,function(){return we(this,function(o){return[2,US(function(i){return gI(i,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return yr.registerLoadRouter(e)},registerSaveRouter:function(e){return yr.registerSaveRouter(e)},weightsLoaderFactory:US,withSaveHandler:function(e){return new Pq(e)},copyModel:function(e,t){return be(this,void 0,void 0,function(){return we(this,function(n){return[2,BS(e,t,!1)]})})},listModels:function(){return be(this,void 0,void 0,function(){var e,t,n,r,o,i,a;return we(this,function(s){switch(s.label){case 0:e=ia.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,ia.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+hl+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return be(this,void 0,void 0,function(){return we(this,function(n){return[2,BS(e,t,!0)]})})},removeModel:function(e){return be(this,void 0,void 0,function(){var t;return we(this,function(n){return t=Pf(e),[2,ia.getManager(t.scheme).removeModel(t.path)]})})}}),Ts;$({confusionMatrix_:function(e,t,n){var r=D(e,"labels","confusionMatrix"),o=D(t,"predictions","confusionMatrix");O(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),O(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),O(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),O(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),O(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=xy(r.asType("int32"),n),a=xy(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var Aq=$({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if($P("FromPixels",H.backendName)!=null)return H.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,l,u=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=u[0],d=u[1];if(a?s=e.getContext("2d").getImageData(0,0,c,d).data:r||n?s=e.data:(i||o)&&(Ts==null&&(Ts=document.createElement("canvas").getContext("2d")),Ts.canvas.width=c,Ts.canvas.height=d,Ts.drawImage(e,0,0,c,d),s=Ts.getImageData(0,0,c,d).data),t===4)l=new Int32Array(s);else{var f=c*d;l=new Int32Array(f*t);for(var h=0;h<f;h++)for(var v=0;v<t;++v)l[h*t+v]=s[4*h+v]}return Fx(l,[d,c,t],"int32")}}),l1=Object.freeze({toPixels:function(e,t){return be(this,void 0,void 0,function(){var n,r,o,i,a,s,l,u,c,d,f,h,v,g,y,m,x,b,w,C,E,_,N;return we(this,function(T){switch(T.label){case 0:if(n=D(e,"img","toPixels"),e instanceof Pt||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=T.sent(),l=n.min(),u=n.max(),[4,Promise.all([l.data(),u.data()])];case 2:if(c=T.sent(),d=c[0],f=c[1],h=d[0],v=f[0],l.dispose(),u.dispose(),n.dtype==="float32"){if(h<0||v>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+v+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||v>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+v+"].")}for(g=n.dtype==="float32"?255:1,y=new Uint8ClampedArray(i*o*4),m=0;m<o*i;++m)x=void 0,b=void 0,w=void 0,C=void 0,a===1?(x=s[m]*g,b=s[m]*g,w=s[m]*g,C=255):a===3?(x=s[3*m]*g,b=s[3*m+1]*g,w=s[3*m+2]*g,C=255):a===4&&(x=s[4*m]*g,b=s[4*m+1]*g,w=s[4*m+2]*g,C=s[4*m+3]*g),y[(E=4*m)+0]=Math.round(x),y[E+1]=Math.round(b),y[E+2]=Math.round(w),y[E+3]=Math.round(C);return t!=null&&(t.width=i,t.height=o,_=t.getContext("2d"),N=new ImageData(y,i,o),_.putImageData(N,0,0)),n!==e&&n.dispose(),[2,y]}})})},fromPixels:Aq}),Iq=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),Mq=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function bs(e){O(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),O(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),O(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Mq.register(e)}var ws=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return co(t,e),t.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var l=o.map(function(u){return{name:u.name,tensor:s[u.name]}});this.applyGradients(l)}else this.applyGradients(s);return lr(s),r?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return $8(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&lr(this.iterations_)},t.prototype.saveIterations=function(){return be(this,void 0,void 0,function(){return we(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:de(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return we(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){return we(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return be(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},t}(Iq);Object.defineProperty(ws,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var Dq=function(e){function t(n,r,o){o===void 0&&(o=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=H.backend.epsilon()),i}return co(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=H.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:me(function(){return Ye(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:me(function(){return Ye(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var l=r.accumulatedGrads[i].variable,u=r.accumulatedUpdates[i].variable;me(function(){var c=l.mul(r.rho).add(s.square().mul(1-r.rho)),d=u.add(r.epsilon).sqrt().div(l.add(r.epsilon).sqrt()).mul(s),f=u.mul(r.rho).add(d.square().mul(1-r.rho));l.assign(c),u.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(lr(this.accumulatedGrads.map(function(n){return n.variable})),lr(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){var n;return we(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(ws);bs(Dq);var jq=function(e){function t(n,r){r===void 0&&(r=.1);var o=e.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return co(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=H.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:me(function(){return Oo(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var l=r.accumulatedGrads[i].variable;me(function(){var u=l.add(s.square());l.assign(u);var c=s.div(u.add(H.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&lr(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return we(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){return we(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(ws);bs(jq);var Fq=function(e){function t(n,r,o,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],me(function(){a.accBeta1=de(r).variable(),a.accBeta2=de(o).variable()}),i==null&&(a.epsilon=H.backend.epsilon()),a}return co(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);me(function(){var i=on(1,r.accBeta1),a=on(1,r.accBeta2);o.forEach(function(s,l){var u=H.registeredVariables[s];r.accumulatedFirstMoment[l]==null&&(r.accumulatedFirstMoment[l]={originalName:s+"/m",variable:me(function(){return Ye(u).variable(!1)})}),r.accumulatedSecondMoment[l]==null&&(r.accumulatedSecondMoment[l]={originalName:s+"/v",variable:me(function(){return Ye(u).variable(!1)})});var c=Array.isArray(n)?n[l].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[l].variable,f=r.accumulatedSecondMoment[l].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),g=h.div(i),y=v.div(a);d.assign(h),f.assign(v);var m=g.div(y.sqrt().add(r.epsilon)).mul(-r.learningRate).add(u);u.assign(m)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&lr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&lr(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){var n;return we(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){var r,o=this;return we(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),me(function(){o.accBeta1.assign(Dh(o.beta1,o.iterations_+1)),o.accBeta2.assign(Dh(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(ws);bs(Fq);var Oq=function(e){function t(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],me(function(){s.iteration=de(0).variable(),s.accBeta1=de(r).variable()}),i==null&&(s.epsilon=H.backend.epsilon()),s}return co(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);me(function(){var i=on(1,r.accBeta1),a=Jr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,l){var u=H.registeredVariables[s];r.accumulatedFirstMoment[l]==null&&(r.accumulatedFirstMoment[l]={originalName:s+"/m",variable:Ye(u).variable(!1)}),r.accumulatedWeightedInfNorm[l]==null&&(r.accumulatedWeightedInfNorm[l]={originalName:s+"/v",variable:Ye(u).variable(!1)});var c=Array.isArray(n)?n[l].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[l].variable,f=r.accumulatedWeightedInfNorm[l].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2),g=c.abs(),y=v.maximum(g);d.assign(h),f.assign(y);var m=a.div(i).mul(h.div(y.add(r.epsilon))).add(u);u.assign(m)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&lr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&lr(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return we(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){return we(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(ws);bs(Oq);var bI=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return co(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=H.registeredVariables[o];me(function(){var l=r.c.mul(a).add(s);s.assign(l)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=r8(de(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return we(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){return we(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(ws);bs(bI);var Lq=function(e){function t(n,r,o){o===void 0&&(o=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=de(i.momentum),i}return co(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=H.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:me(function(){return Ye(a).variable(!1)})});var s=r.accumulations[i].variable,l=Array.isArray(n)?n[i].tensor:n[o];l!=null&&me(function(){var u,c=r.m.mul(s).add(l);u=r.useNesterov?r.c.mul(l.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(u)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&lr(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return we(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){return we(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(bI);bs(Lq);var Bq=function(e){function t(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=H.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return co(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=H.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:me(function(){return Ye(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:me(function(){return Ye(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:me(function(){return Ye(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var l=r.accumulatedMeanSquares[i].variable,u=r.accumulatedMoments[i].variable;me(function(){var c=l.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=u.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));l.assign(c),d.assign(f),u.assign(h);var v=a.sub(h);a.assign(v)}else{var g=l.mul(r.decay).add(s.square().mul(1-r.decay));h=u.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),l.assign(g),u.assign(h),v=a.sub(h),a.assign(v)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&lr(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&lr(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&lr(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return be(this,void 0,void 0,function(){var n;return we(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return be(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(ws);bs(Bq);Pt.prototype.squaredDifference=function(e){return jA(this,e)},Z=dq;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ry=function(e,t){return Ry=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},Ry(e,t)};function De(e,t){Ry(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var In=function(){return In=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},In.apply(this,arguments)};function Ee(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):o(c.value).then(s,l)}u((r=r.apply(e,[])).next())})}function _e(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(c){u=[6,c],o=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Ku(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var vl=function(){function e(t,n){if(!ts(t)||!ts(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Ap(e,t){return e instanceof Pt&&e.shape.length===t}function Vq(e){return Ap(e,2)}function Ip(e){return Ap(e,3)}function aa(e){return Ap(e,4)}function zq(e){return e%1!==0}function GS(e){return e%2===0}function Wq(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function qS(e){return e&&e.width&&e.height}function $q(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new vl(Math.round(n*o),Math.round(r*o))}function u1(e){return e.reduce(function(t,n){return t.add(n)},new nt(0,0)).div(new nt(e.length,e.length))}function Pc(e,t,n){return Array(e).fill(0).map(function(r,o){return t+o*n})}function ts(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function KS(e){return ts(e)&&0<=e&&e<=1}var nt=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),va=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(ts),i=[r.x,r.y,r.width,r.height].every(ts);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],l=a[1],u=a[2],c=a[3];e.assertIsValidBox({x:s,y:l,width:u,height:c},"Box.constructor",n),this._x=s,this._y=l,this._width=u,this._height=c}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(ts)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new nt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new nt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new nt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new nt(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=qS(t)?t.width:t,r=qS(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new e({x:o,y:i,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,l=Math.max(o,0),u=Math.max(i,0),c=a-l,d=s-u,f=Math.min(c,t-l),h=Math.min(d,n-u);return new e({x:l,y:u,width:f,height:h}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,i=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:o,height:i})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,l=o,u=this.left,c=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>t&&(l=-f+t+o,f=t),u<1&&(l=2-u,u=1),c<1&&(l=2-c,c=1),{dy:a,edy:l,dx:i,edx:s,y:c,ey:f,x:u,ex:d,w:r,h:o}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Mp=function(e){De(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return t}(va),wI=function(){function e(t,n,r,o,i){this._imageDims=new vl(i.width,i.height),this._score=t,this._classScore=n,this._className=r,this._box=new va(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new va(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Ho=function(e){De(t,e);function t(n,r,o){return e.call(this,n,n,"",r,o)||this}return t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new t(i,a,s)},t}(wI);function Uq(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*o;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function Hq(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,l){return l<s?l:s},1/0),o=n.reduce(function(s,l){return l<s?l:s},1/0),i=t.reduce(function(s,l){return s<l?l:s},0),a=n.reduce(function(s,l){return s<l?l:s},0);return new Mp(r,o,i,a)}function Ac(e,t,n,r){r===void 0&&(r=!0);for(var o=t.map(function(s,l){return{score:s,boxIndex:l}}).sort(function(s,l){return s.score-l.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var l=o,u=[],c=0;c<l.length;c++){var d=l[c],f=e[s],h=e[d];u.push(Uq(f,h,r))}o=o.filter(function(v,g){return u[g]<=n})};o.length>0;)a();return i}function id(e,t){return me(function(){var n=t[0],r=t[1],o=t[2],i=Oo(Ku(e.shape.slice(0,3),[1]),n),a=Oo(Ku(e.shape.slice(0,3),[1]),r),s=Oo(Ku(e.shape.slice(0,3),[1]),o),l=tn([i,a,s],3);return on(e,l)})}function Gq(e,t){return t===void 0&&(t=!1),me(function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,l=function(h){var v=e.shape.slice();return v[s]=h,Oo(v,0)},u=l(a),c=i-u.shape[s],d=t&&c?l(c):null,f=[d,e,u].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return tn(f,s)})}function gv(e){return 1/(1+Math.exp(-e))}var c1=function(e){De(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{x:n,y:r,width:o,height:i},a)||this}return t}(va),qq=.5,Kq=.43,Xq=.45,Oh=function(){function e(t,n,r){r===void 0&&(r=new nt(0,0));var o=n.width,i=n.height;this._imgDims=new vl(o,i),this._shift=r,this._positions=t.map(function(a){return a.mul(new nt(o,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new nt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new nt(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new nt(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Ho?t.box.floor():new va(t);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],o=t[2],i=function(d){return o.sub(d).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/Xq),l=u1(t),u=Math.floor(Math.max(0,l.x-qq*s)),c=Math.floor(Math.max(0,l.y-Kq*s));return new c1(u,c,Math.min(s,this.imageWidth+u),Math.min(s,this.imageHeight+c))},e.prototype.alignMinBbox=function(t){var n=Hq(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),Yq=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],u1([n[3],n[4]])]},t}(Oh),Qq=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(u1)},t}(Oh),XS=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+Wq(this.distance)+")":"")},e}(),YS=function(e){De(t,e);function t(n,r){var o=e.call(this,n)||this;return o._label=r,o}return t.assertIsValidLabeledBox=function(n,r){if(va.assertIsValidBox(n,r),!ts(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(va),ef=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){De(t,e);function t(n,r,o,i){var a=e.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return t.assertIsValidPredictedBox=function(n,r){if(YS.assertIsValidLabeledBox(n,r),!KS(n.score)||!KS(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(YS);function Zq(e){return e.detection instanceof Ho}function d1(e,t){var n={detection:t};return Object.assign({},e,n)}function CI(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function SI(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(o,i){e.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function EI(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=SI();return In({Canvas:e||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:t||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function _I(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function kI(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var Xt;function Jq(){if(!Xt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Xt}function Py(e){Xt=e}function f1(){_I()&&Py(CI()),kI()&&Py(EI())}function eK(e){if(Xt||f1(),!Xt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?Xt.Canvas:t,r=e.Image,o=r===void 0?Xt.Image:r;Xt.Canvas=n,Xt.Image=o,Xt.createCanvasElement=e.createCanvasElement||function(){return new n},Xt.createImageElement=e.createImageElement||function(){return new o},Xt.ImageData=e.ImageData||Xt.ImageData,Xt.Video=e.Video||Xt.Video,Xt.fetch=e.fetch||Xt.fetch,Xt.readFile=e.readFile||Xt.readFile}var En={getEnv:Jq,setEnv:Py,initialize:f1,createBrowserEnv:CI,createFileSystem:SI,createNodejsEnv:EI,monkeyPatch:eK,isBrowser:_I,isNodejs:kI};f1();function NI(e){return!En.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function fs(e){var t=En.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=NI(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var QS;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(QS||(QS={}));function TI(e){var t=En.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function tK(e){return new Promise(function(t,n){if(e instanceof En.getEnv().Canvas||TI(e))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}e.addEventListener("load",r),e.addEventListener("error",o)})}function nK(e){return new Promise(function(t,n){if(!(e instanceof Blob))return n("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if(typeof r.result!="string")return n("bufferToImage - expected reader.result to be a string, in onload");var o=En.getEnv().createImageElement();o.onload=function(){return t(o)},o.onerror=n,o.src=r.result},r.onerror=n,r.readAsDataURL(e)})}function RI(e){var t=En.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new vl(e.naturalWidth,e.naturalHeight):e instanceof r?new vl(e.videoWidth,e.videoHeight):new vl(e.width,e.height)}function Dp(e){var t=e.width,n=e.height,r=En.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function h1(e,t){var n=En.getEnv().ImageData;if(!(e instanceof n)&&!TI(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=RI(e),o=r.width,i=r.height,a=Dp({width:o,height:i});return e instanceof n?fs(a).putImageData(e,0,0):fs(a).drawImage(e,0,0,o,i),a}function rK(e,t){return Ee(this,void 0,void 0,function(){var n,r,o,i,a,s;return _e(this,function(l){switch(l.label){case 0:return n=En.getEnv().createCanvasElement(),r=e.shape.slice(aa(e)?1:0),o=r[0],i=r[1],a=r[2],s=me(function(){return e.as3D(o,i,a).toInt()}),[4,l1.toPixels(s,n)];case 1:return l.sent(),s.dispose(),[2,n]}})})}function ZS(e){var t=En.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function oK(e,t,n){n===void 0&&(n=!1);var r=En.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=RI(e),s=t/Math.max(a.height,a.width),l=s*a.width,u=s*a.height,c=Dp({width:t,height:t}),d=e instanceof i?e:h1(e),f=Math.abs(l-u)/2,h=n&&l<u?f:0,v=n&&u<l?f:0;return fs(c).drawImage(d,h,v,l,u),c}var Lh=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(o,i){if(Ip(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(aa(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof En.getEnv().Canvas?o:h1(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Pc(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return $q({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,me(function(){var o=Pc(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof Pt){var l=aa(s)?s:s.expandDims();return l=Gq(l,n),(l.shape[1]!==t||l.shape[2]!==t)&&(l=n1.resizeBilinear(l,[t,t])),l.as3D(t,t,3)}if(s instanceof En.getEnv().Canvas)return l1.fromPixels(oK(s,t,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Cr(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,t,t,3);return i})},e}();function pn(e){return Ee(this,void 0,void 0,function(){var t,n,r;return _e(this,function(o){switch(o.label){case 0:if(e instanceof Lh)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},r=t.map(NI),r.forEach(function(i,a){if(!ZS(i)&&!Ip(i)&&!aa(i))throw typeof t[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+t[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(aa(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return ZS(i)&&tK(i)}))];case 1:return o.sent(),[2,new Lh(r,Array.isArray(e))]}})})}function p1(e,t){return Ee(this,void 0,void 0,function(){var n,r,o,i,a,s,l;return _e(this,function(u){switch(u.label){case 0:return n=En.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,pn(e)];case 1:if(o=u.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,rK(i)];case 3:a=u.sent(),u.label=4;case 4:r=a,u.label=5;case 5:return s=fs(r),l=t.map(function(c){return c instanceof Ho?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,l.map(function(c){var d=c.x,f=c.y,h=c.width,v=c.height,g=Dp({width:h,height:v});return fs(g).putImageData(s.getImageData(d,f,h,v),0,0),g})]}})})}function m1(e,t){return Ee(this,void 0,void 0,function(){return _e(this,function(n){if(!Ip(e)&&!aa(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(aa(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,me(function(){var r=e.shape.slice(aa(e)?1:0),o=r[0],i=r[1],a=r[2],s=t.map(function(u){return u instanceof Ho?u.forSize(i,o).box:u}).map(function(u){return u.clipAtImageBorders(i,o)}),l=s.map(function(u){var c=u.x,d=u.y,f=u.width,h=u.height;return nI(e.as3D(o,i,a),[d,c,0],[h,f,a])});return l})]})})}function PI(e,t){return Ee(this,void 0,void 0,function(){var n,r;return _e(this,function(o){switch(o.label){case 0:return n=En.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function js(e){return Ee(this,void 0,void 0,function(){var t,n;return _e(this,function(r){switch(r.label){case 0:return[4,PI(e)];case 1:return t=r.sent(),[4,t.blob()];case 2:if(n=r.sent(),!n.type.startsWith("image/"))throw new Error("fetchImage - expected blob type to be of type image/*, instead have: "+n.type+", for url: "+t.url);return[2,nK(n)]}})})}function iK(e){return Ee(this,void 0,void 0,function(){return _e(this,function(t){switch(t.label){case 0:return[4,PI(e)];case 1:return[2,t.sent().json()]}})})}function AI(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter(function(s){return s}),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function aK(e,t){return Ee(this,void 0,void 0,function(){var n,r,o,i;return _e(this,function(a){switch(a.label){case 0:return n=AI(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,iK(r)];case 1:return i=a.sent(),[2,xI.loadWeights(i,o)]}})})}var xi=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;return r[o]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Wl})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Wl)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;t.reassignParamFromPath(r,o.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=bn(o.dataSync());o.dispose(),t.reassignParamFromPath(r,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return Ee(this,void 0,void 0,function(){return _e(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return Ee(this,void 0,void 0,function(){var n;return _e(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,aK(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return Ee(this,void 0,void 0,function(){var n,r,o,i,a,s,l,u,c,d;return _e(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=En.getEnv().readFile,r=AI(t,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(v){return n(v).then(function(g){return g.buffer})}))},s=xI.weightsLoaderFactory(a),c=(u=JSON).parse,[4,n(o)];case 1:return l=c.apply(u,[f.sent().toString()]),[4,s(l,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+t);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof Pt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},e}();function xr(e,t,n){return me(function(){var r=Qx(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Ue(r,t.bias),r})}function yv(e,t,n){return n===void 0&&(n=!1),me(function(){var r=It(n?Ue(Wr(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):xr(e,t.conv0,[2,2])),o=xr(r,t.conv1,[1,1]),i=It(Ue(r,o)),a=xr(i,t.conv2,[1,1]);return It(Ue(r,Ue(o,a)))})}function tf(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),me(function(){var o=It(n?Ue(Wr(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):xr(e,t.conv0,r?[2,2]:[1,1])),i=xr(o,t.conv1,[1,1]),a=It(Ue(o,i)),s=xr(a,t.conv2,[1,1]),l=It(Ue(o,Ue(i,s))),u=xr(l,t.conv3,[1,1]);return It(Ue(o,Ue(i,Ue(s,u))))})}function io(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),me(function(){var o=Ue(Wr(e,t.filters,[1,1],n),t.bias);return r?It(o):o})}function bi(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function jp(e,t){return function(n,r,o,i){var a=tr(e(n*r*o*o),[o,o,n,r]),s=Kt(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function v1(e,t){return function(n,r,o){var i=oa(e(n*r),[n,r]),a=Kt(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var II=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function g1(e,t){return function(n,r,o){var i=tr(e(9*n),[3,3,n,1]),a=tr(e(n*r),[1,1,n,r]),s=Kt(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new II(i,a,s)}}function y1(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new II(n,r,o)}}function Sa(e,t){return function(n,r,o){var i=e[n];if(!Ap(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function wi(e){var t=e;function n(o){var i=t.slice(0,o);return t=t.slice(o),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function MI(e,t){var n=jp(e,t),r=g1(e,t);function o(a,s,l,u){u===void 0&&(u=!1);var c=u?n(a,s,3,l+"/conv0"):r(a,s,l+"/conv0"),d=r(s,s,l+"/conv1"),f=r(s,s,l+"/conv2");return{conv0:c,conv1:d,conv2:f}}function i(a,s,l,u){u===void 0&&(u=!1);var c=o(a,s,l,u),d=c.conv0,f=c.conv1,h=c.conv2,v=r(s,s,l+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:v}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function sK(e){var t=[],n=wi(e),r=n.extractWeights,o=n.getRemainingWeights,i=MI(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),l=i(64,128,"dense2"),u=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:l,dense3:u}}}function DI(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function jI(e,t){var n=Sa(e,t),r=DI(n),o=y1(n);function i(s,l){l===void 0&&(l=!1);var u=l?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:u,conv1:c,conv2:d}}function a(s,l){l===void 0&&(l=!1);var u=l?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:u,conv1:c,conv2:d,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function lK(e){var t=[],n=jI(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return bi(e,t),{params:r,paramMappings:t}}var FI=function(e){De(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return me(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=id(o,i).div(de(255)),s=tf(a,r.dense0,!0);return s=tf(s,r.dense1),s=tf(s,r.dense2),s=tf(s,r.dense3),s=rd(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return lK(n)},t.prototype.extractParams=function(n){return sK(n)},t}(xi);function Ro(e,t){return me(function(){return Ue(Tp(e,t.weights),t.bias)})}function uK(e,t,n){var r=[],o=wi(e),i=o.extractWeights,a=o.getRemainingWeights,s=v1(i,r),l=s(t,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:l}}}function cK(e){var t=[],n=Sa(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return bi(e,t),{params:o,paramMappings:t}}function OI(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var LI=function(e){De(t,e);function t(n,r){var o=e.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return me(function(){var i=n instanceof Lh?r.faceFeatureExtractor.forwardInput(n):n;return Ro(i.as2D(i.shape[0],-1),o.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return uK(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=OI(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),cK(i)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},t}(xi),JS=["neutral","happy","sad","angry","fearful","disgusted","surprised"],dK=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);JS.forEach(function(r,o){n[r]=t[o]})}return e.prototype.asSortedArray=function(){var t=this;return JS.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),fK=function(e){De(t,e);function t(n){return n===void 0&&(n=new FI),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return me(function(){return gi(r.runNet(n))})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(n){return Ee(this,void 0,void 0,function(){var r,o,i,a,s=this;return _e(this,function(l){switch(l.label){case 0:return[4,pn(n)];case 1:return r=l.sent(),[4,this.forwardInput(r)];case 2:return o=l.sent(),[4,Promise.all(nn(o).map(function(u){return Ee(s,void 0,void 0,function(){var c;return _e(this,function(d){switch(d.label){case 0:return[4,u.data()];case 1:return c=d.sent(),u.dispose(),[2,c]}})})}))];case 3:return i=l.sent(),o.dispose(),a=i.map(function(u){return new dK(u)}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(LI);function BI(e,t){var n={expressions:t};return Object.assign({},e,n)}function hK(e){return Zq(e)&&e.landmarks instanceof Oh&&e.unshiftedLandmarks instanceof Oh&&e.alignedRect instanceof Ho}function x1(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a=new Ho(e.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}function pK(e,t){var n=jp(e,t),r=g1(e,t);function o(a,s,l){var u=r(a,s,l+"/separable_conv0"),c=r(s,s,l+"/separable_conv1"),d=n(a,s,1,l+"/expansion_conv");return{separable_conv0:u,separable_conv1:c,expansion_conv:d}}function i(a,s){var l=r(a,a,s+"/separable_conv0"),u=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:l,separable_conv1:u,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function mK(e,t){var n=[],r=wi(e),o=r.extractWeights,i=r.getRemainingWeights,a=pK(o,n),s=a.extractConvParams,l=a.extractSeparableConvParams,u=a.extractReductionBlockParams,c=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=u(32,64,"entry_flow/reduction_block_0"),h=u(64,128,"entry_flow/reduction_block_1"),v={conv_in:d,reduction_block_0:f,reduction_block_1:h},g={};Pc(t,0,1).forEach(function(b){g["main_block_"+b]=c(128,"middle_flow/main_block_"+b)});var y=u(128,256,"exit_flow/reduction_block"),m=l(256,512,"exit_flow/separable_conv"),x={reduction_block:y,separable_conv:m};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:v,middle_flow:g,exit_flow:x}}}function vK(e,t){var n=Sa(e,t),r=DI(n),o=y1(n);function i(s){var l=o(s+"/separable_conv0"),u=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:l,separable_conv1:u,expansion_conv:c}}function a(s){var l=o(s+"/separable_conv0"),u=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:l,separable_conv1:u,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function gK(e,t){var n=[],r=vK(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,l=o("entry_flow/conv_in"),u=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),d={conv_in:l,reduction_block_0:u,reduction_block_1:c},f={};Pc(t,0,1).forEach(function(y){f["main_block_"+y]=s("middle_flow/main_block_"+y)});var h=a("exit_flow/reduction_block"),v=i("exit_flow/separable_conv"),g={reduction_block:h,separable_conv:v};return bi(e,n),{params:{entry_flow:d,middle_flow:f,exit_flow:g},paramMappings:n}}function VI(e,t,n){return Ue(Wr(e,t.filters,n,"same"),t.bias)}function xv(e,t,n){n===void 0&&(n=!0);var r=n?It(e):e;return r=xr(r,t.separable_conv0,[1,1]),r=xr(It(r),t.separable_conv1,[1,1]),r=cn(r,[3,3],[2,2],"same"),r=Ue(r,VI(e,t.expansion_conv,[2,2])),r}function yK(e,t){var n=xr(It(e),t.separable_conv0,[1,1]);return n=xr(It(n),t.separable_conv1,[1,1]),n=xr(It(n),t.separable_conv2,[1,1]),n=Ue(n,e),n}var xK=function(e){De(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return me(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=id(i,a).div(de(256)),l=It(VI(s,o.entry_flow.conv_in,[2,2]));return l=xv(l,o.entry_flow.reduction_block_0,!1),l=xv(l,o.entry_flow.reduction_block_1),Pc(r._numMainBlocks,0,1).forEach(function(u){l=yK(l,o.middle_flow["main_block_"+u])}),l=xv(l,o.exit_flow.reduction_block),l=It(xr(l,o.exit_flow.separable_conv,[1,1])),l})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return gK(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return mK(n,this._numMainBlocks)},t}(xi);function bK(e){var t=[],n=wi(e),r=n.extractWeights,o=n.getRemainingWeights,i=v1(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function wK(e){var t=[],n=Sa(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return bi(e,t),{params:o,paramMappings:t}}var Bh;(function(e){e.FEMALE="female",e.MALE="male"})(Bh||(Bh={}));var CK=function(e){De(t,e);function t(n){n===void 0&&(n=new xK(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return me(function(){var i=n instanceof Lh?r.faceFeatureExtractor.forwardInput(n):n,a=rd(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Ro(a,o.fc.age).as1D(),l=Ro(a,o.fc.gender);return{age:s,gender:l}})},t.prototype.forwardInput=function(n){var r=this;return me(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:gi(a)}})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return Ee(this,void 0,void 0,function(){var r,o,i,a,s,l,u=this;return _e(this,function(c){switch(c.label){case 0:return[4,pn(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=nn(o.age),a=nn(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return Ee(u,void 0,void 0,function(){var v,g,y,m,x;return _e(this,function(b){switch(b.label){case 0:return[4,f.data()];case 1:return v=b.sent()[0],[4,h.data()];case 2:return g=b.sent()[0],y=g>.5,m=y?Bh.MALE:Bh.FEMALE,x=y?g:1-g,f.dispose(),h.dispose(),[2,{age:v,gender:m,genderProbability:x}]}})})}))];case 3:return l=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?l:l[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return bK(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=OI(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),wK(i)},t.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(xi),zI=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var l=s.width,u=s.height,c=r/Math.max(u,l);return{width:l*c,height:u*c}}),a=i.length;return me(function(){var s=function(f,h){return Cr([Oo([68],f),Oo([68],h)],1).as2D(1,136).as1D()},l=function(f,h){var v=i[f],g=v.width,y=v.height;return h(g,y)?Math.abs(g-y)/2:0},u=function(f){return l(f,function(h,v){return h<v})},c=function(f){return l(f,function(h,v){return v<h})},d=n.mul(Oo([a,136],r)).sub(Cr(Array.from(Array(a),function(f,h){return s(u(h),c(h))}))).div(Cr(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})));return d})},t.prototype.forwardInput=function(n){var r=this;return me(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(n){return Ee(this,void 0,void 0,function(){var r,o,i,a=this;return _e(this,function(s){switch(s.label){case 0:return[4,pn(n)];case 1:return r=s.sent(),o=me(function(){return nn(a.forwardInput(r))}),[4,Promise.all(o.map(function(l,u){return Ee(a,void 0,void 0,function(){var c,d,f,h,v;return _e(this,function(g){switch(g.label){case 0:return f=(d=Array).from,[4,l.data()];case 1:return c=f.apply(d,[g.sent()]),h=c.filter(function(y,m){return GS(m)}),v=c.filter(function(y,m){return!GS(m)}),[2,new Qq(Array(68).fill(0).map(function(y,m){return new nt(h[m],v[m])}),{height:r.getInputHeight(u),width:r.getInputWidth(u)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(l){return l.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(LI),WI=function(e){De(t,e);function t(n){return n===void 0&&(n=new FI),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(zI);function SK(e){var t=[],n=jI(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return bi(e,t),{params:r,paramMappings:t}}function EK(e){var t=[],n=wi(e),r=n.extractWeights,o=n.getRemainingWeights,i=MI(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),l=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:l}}}var _K=function(e){De(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return me(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=id(o,i).div(de(255)),s=yv(a,r.dense0,!0);return s=yv(s,r.dense1),s=yv(s,r.dense2),s=rd(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return SK(n)},t.prototype.extractParams=function(n){return EK(n)},t}(xi),kK=function(e){De(t,e);function t(n){return n===void 0&&(n=new _K),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(zI);(function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(WI);function NK(e,t){return Ue(Fn(e,t.weights),t.biases)}function b1(e,t,n,r,o){o===void 0&&(o="same");var i=t.conv,a=i.filters,s=i.bias,l=Wr(e,a,n,o);return l=Ue(l,s),l=NK(l,t.scale),r?It(l):l}function TK(e,t){return b1(e,t,[1,1],!0)}function $I(e,t){return b1(e,t,[1,1],!1)}function UI(e,t){return b1(e,t,[2,2],!0,"valid")}function RK(e,t){function n(s,l,u){var c=e(s),d=c.length/(l*u*u);if(zq(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+c.length+", numFilters: "+l+", filterSize: "+u);return me(function(){return ma(tr(c,[l,d,u,u]),[2,3,1,0])})}function r(s,l,u,c){var d=n(s,l,u),f=Kt(e(l));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}function o(s,l){var u=Kt(e(s)),c=Kt(e(s));return t.push({paramPath:l+"/weights"},{paramPath:l+"/biases"}),{weights:u,biases:c}}function i(s,l,u,c){var d=r(s,l,u,c+"/conv"),f=o(l,c+"/scale");return{conv:d,scale:f}}function a(s,l,u,c,d){d===void 0&&(d=!1);var f=i((d?.5:1)*s,l,u,c+"/conv1"),h=i(s,l,u,c+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function PK(e){var t=wi(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=RK(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,l=a(4704,32,7,"conv32_down"),u=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),v=s(36864,64,3,"conv64_2"),g=s(36864,64,3,"conv64_3"),y=s(147456,128,3,"conv128_down",!0),m=s(147456,128,3,"conv128_1"),x=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),C=s(589824,256,3,"conv256_2"),E=s(589824,256,3,"conv256_down_out"),_=me(function(){return ma(oa(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var N={conv32_down:l,conv32_1:u,conv32_2:c,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:v,conv64_3:g,conv128_down:y,conv128_1:m,conv128_2:x,conv256_down:b,conv256_1:w,conv256_2:C,conv256_down_out:E,fc:_};return{params:N,paramMappings:o}}function AK(e,t){var n=Sa(e,t);function r(a){var s=n(a+"/scale/weights",1),l=n(a+"/scale/biases",1);return{weights:s,biases:l}}function o(a){var s=n(a+"/conv/filters",4),l=n(a+"/conv/bias",1),u=r(a);return{conv:{filters:s,bias:l},scale:u}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function IK(e){var t=[],n=AK(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),l=o("conv32_3"),u=o("conv64_down"),c=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),v=o("conv128_1"),g=o("conv128_2"),y=o("conv256_down"),m=o("conv256_1"),x=o("conv256_2"),b=o("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!Vq(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var C={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:l,conv64_down:u,conv64_1:c,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:v,conv128_2:g,conv256_down:y,conv256_1:m,conv256_2:x,conv256_down_out:b,fc:w};return bi(e,t),{params:C,paramMappings:t}}function mo(e,t){var n=TK(e,t.conv1);return n=$I(n,t.conv2),n=Ue(n,e),n=It(n),n}function nf(e,t){var n=UI(e,t.conv1);n=$I(n,t.conv2);var r=rd(e,2,2,"valid"),o=Ct(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=Ku(n.shape);s[1]=1;var l=Ct(s);n=tn([n,l],1);var u=Ku(n.shape);u[2]=1;var c=Ct(u);n=tn([n,c],2)}return r=i?tn([r,o],3):r,n=Ue(r,n),n=It(n),n}var MK=function(e){De(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return me(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=id(o,i).div(de(256)),s=UI(a,r.conv32_down);s=cn(s,3,2,"valid"),s=mo(s,r.conv32_1),s=mo(s,r.conv32_2),s=mo(s,r.conv32_3),s=nf(s,r.conv64_down),s=mo(s,r.conv64_1),s=mo(s,r.conv64_2),s=mo(s,r.conv64_3),s=nf(s,r.conv128_down),s=mo(s,r.conv128_1),s=mo(s,r.conv128_2),s=nf(s,r.conv256_down),s=mo(s,r.conv256_1),s=mo(s,r.conv256_2),s=nf(s,r.conv256_down_out);var l=s.mean([1,2]),u=Tp(l,r.fc);return u})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return Ee(this,void 0,void 0,function(){var r,o,i,a=this;return _e(this,function(s){switch(s.label){case 0:return[4,pn(n)];case 1:return r=s.sent(),o=me(function(){return nn(a.forwardInput(r))}),[4,Promise.all(o.map(function(l){return l.data()}))];case 2:return i=s.sent(),o.forEach(function(l){return l.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return IK(n)},t.prototype.extractParams=function(n){return PK(n)},t}(xi);function HI(e,t){var n={descriptor:t};return Object.assign({},e,n)}function GI(e,t){var n={age:t};return Object.assign({},e,n)}function qI(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var KI=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(l){return typeof l!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(l){return typeof l!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function DK(e,t){function n(l,u){var c=tr(e(9*l),[3,3,l,1]),d=Kt(e(l)),f=Kt(e(l)),h=Kt(e(l)),v=Kt(e(l));return t.push({paramPath:u+"/filters"},{paramPath:u+"/batch_norm_scale"},{paramPath:u+"/batch_norm_offset"},{paramPath:u+"/batch_norm_mean"},{paramPath:u+"/batch_norm_variance"}),{filters:c,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:v}}function r(l,u,c,d,f){var h=tr(e(l*u*c*c),[c,c,l,u]),v=Kt(e(u));return t.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:v}}function o(l,u,c,d){var f=r(l,u,c,d,!0),h=f.filters,v=f.bias;return{filters:h,batch_norm_offset:v}}function i(l,u,c){var d=n(l,c+"/depthwise_conv"),f=o(l,u,1,c+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var l=o(3,32,3,"mobilenetv1/conv_0"),u=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),v=i(256,512,"mobilenetv1/conv_6"),g=i(512,512,"mobilenetv1/conv_7"),y=i(512,512,"mobilenetv1/conv_8"),m=i(512,512,"mobilenetv1/conv_9"),x=i(512,512,"mobilenetv1/conv_10"),b=i(512,512,"mobilenetv1/conv_11"),w=i(512,1024,"mobilenetv1/conv_12"),C=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:l,conv_1:u,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:g,conv_8:y,conv_9:m,conv_10:x,conv_11:b,conv_12:w,conv_13:C}}function s(){var l=o(1024,256,1,"prediction_layer/conv_0"),u=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),v=o(256,64,1,"prediction_layer/conv_6"),g=o(64,128,3,"prediction_layer/conv_7"),y=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),x=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),C=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),E=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),_=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),N=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),T=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),k=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),I=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),A={box_encoding_predictor:y,class_predictor:m},U={box_encoding_predictor:x,class_predictor:b},B={box_encoding_predictor:w,class_predictor:C},L={box_encoding_predictor:E,class_predictor:_},V={box_encoding_predictor:N,class_predictor:T},F={box_encoding_predictor:k,class_predictor:I};return{conv_0:l,conv_1:u,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:g,box_predictor_0:A,box_predictor_1:U,box_predictor_2:B,box_predictor_3:L,box_predictor_4:V,box_predictor_5:F}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function jK(e){var t=[],n=wi(e),r=n.extractWeights,o=n.getRemainingWeights,i=DK(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,l=a(),u=s(),c=Fx(r(5118*4),[1,5118,4]),d={extra_dim:c};if(t.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:l,prediction_layer:u,output_layer:d},paramMappings:t}}function FK(e,t){var n=Sa(e,t);function r(u,c,d){var f=n(u+"/Conv2d_"+c+"_pointwise/weights",4,d+"/filters"),h=n(u+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(u){var c="mobilenetv1/conv_"+u,d="MobilenetV1/Conv2d_"+u+"_depthwise",f=c+"/depthwise_conv",h=c+"/pointwise_conv",v=n(d+"/depthwise_weights",4,f+"/filters"),g=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),y=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),m=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),x=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:v,batch_norm_scale:g,batch_norm_offset:y,batch_norm_mean:m,batch_norm_variance:x},pointwise_conv:r("MobilenetV1",u,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(u,c){var d=n(u+"/weights",4,c+"/filters"),f=n(u+"/biases",1,c+"/bias");return{filters:d,bias:f}}function s(u){var c=a("Prediction/BoxPredictor_"+u+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+u+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+u+"/ClassPredictor","prediction_layer/box_predictor_"+u+"/class_predictor");return{box_encoding_predictor:c,class_predictor:d}}function l(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:l}}function OK(e){var t=[],n=FK(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Ip(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return bi(e,t),{params:a,paramMappings:t}}function go(e,t,n){return me(function(){var r=Wr(e,t.filters,n,"same");return r=Ue(r,t.batch_norm_offset),qx(r,0,6)})}var LK=.0010000000474974513;function BK(e,t,n){return me(function(){var r=Np(e,t.filters,n,"same");return r=zA(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,LK),qx(r,0,6)})}function VK(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function zK(e,t){return me(function(){var n=null,r=go(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach(function(i,a){var s=a+1,l=VK(s);r=BK(r,i.depthwise_conv,l),r=go(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function WK(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map(function(c,d){return{score:c,boxIndex:d}}).filter(function(c){return c.score>o}).sort(function(c,d){return d.score-c.score}),l=function(c){return c<=r?1:0},u=[];return s.forEach(function(c){if(!(u.length>=a)){for(var d=c.score,f=u.length-1;f>=0;--f){var h=$K(e,c.boxIndex,u[f]);if(h!==0&&(c.score*=l(h),c.score<=o))break}d===c.score&&u.push(c.boxIndex)}}),u}function $K(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),u=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),h=(c-l)*(d-u);if(f<=0||h<=0)return 0;var v=Math.max(o,l),g=Math.max(i,u),y=Math.min(a,c),m=Math.min(s,d),x=Math.max(y-v,0)*Math.max(m-g,0);return x/(f+h-x)}function UK(e){var t=nn(ma(e,[1,0])),n=[on(t[2],t[0]),on(t[3],t[1])],r=[Ue(t[0],Jr(n[0],de(2))),Ue(t[1],Jr(n[1],de(2)))];return{sizes:n,centers:r}}function HK(e,t){var n=UK(e),r=n.sizes,o=n.centers,i=nn(ma(t,[1,0])),a=Jr(Fn(Sy(Jr(i[2],de(5))),r[0]),de(2)),s=Ue(Fn(Jr(i[0],de(10)),r[0]),o[0]),l=Jr(Fn(Sy(Jr(i[3],de(5))),r[1]),de(2)),u=Ue(Fn(Jr(i[1],de(10)),r[1]),o[1]);return ma(Cr([on(s,a),on(u,l),Ue(s,a),Ue(u,l)]),[1,0])}function GK(e,t,n){return me(function(){var r=e.shape[0],o=HK(eo(dl(n.extra_dim,[r,1,1]),[-1,4]),eo(e,[-1,4]));o=eo(o,[r,o.shape[0]/r,4]);var i=OA(Vo(t,[0,0,1],[-1,-1,-1])),a=Vo(i,[0,0,0],[-1,-1,1]);a=eo(a,[r,a.shape[1]]);var s=nn(o),l=nn(a);return{boxes:s,scores:l}})}function Rs(e,t){return me(function(){var n=e.shape[0],r=eo(io(e,t.box_encoding_predictor),[n,-1,1,4]),o=eo(io(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function qK(e,t,n){return me(function(){var r=go(e,n.conv_0,[1,1]),o=go(r,n.conv_1,[2,2]),i=go(o,n.conv_2,[1,1]),a=go(i,n.conv_3,[2,2]),s=go(a,n.conv_4,[1,1]),l=go(s,n.conv_5,[2,2]),u=go(l,n.conv_6,[1,1]),c=go(u,n.conv_7,[2,2]),d=Rs(t,n.box_predictor_0),f=Rs(e,n.box_predictor_1),h=Rs(o,n.box_predictor_2),v=Rs(a,n.box_predictor_3),g=Rs(l,n.box_predictor_4),y=Rs(c,n.box_predictor_5),m=tn([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,v.boxPredictionEncoding,g.boxPredictionEncoding,y.boxPredictionEncoding],1),x=tn([d.classPrediction,f.classPrediction,h.classPrediction,v.classPrediction,g.classPrediction,y.classPrediction],1);return{boxPredictions:m,classPredictions:x}})}var No=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),XI=function(e){De(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return me(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=on(Fn(o,de(.007843137718737125)),de(1)),a=zK(i,r.mobilenetv1),s=qK(a.out,a.conv11,r.prediction_layer),l=s.boxPredictions,u=s.classPredictions;return GK(l,u,r.output_layer)})},t.prototype.forward=function(n){return Ee(this,void 0,void 0,function(){var r;return _e(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,pn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),Ee(this,void 0,void 0,function(){var o,i,a,s,l,u,c,d,f,h,v,g,y,m,x,b,w,C,E,_,N;return _e(this,function(T){switch(T.label){case 0:return o=new No(r),i=o.maxResults,a=o.minConfidence,[4,pn(n)];case 1:for(s=T.sent(),l=this.forwardInput(s),u=l.boxes,c=l.scores,d=u[0],f=c[0],h=1;h<u.length;h++)u[h].dispose(),c[h].dispose();return y=(g=Array).from,[4,f.data()];case 2:return v=y.apply(g,[T.sent()]),m=.5,x=WK(d,v,i,m,a),b=s.getReshapedInputDimensions(0),w=s.inputSize,C=w/b.width,E=w/b.height,_=d.arraySync(),N=x.map(function(k){var I=[Math.max(0,_[k][0]),Math.min(1,_[k][2])].map(function(F){return F*E}),A=I[0],U=I[1],B=[Math.max(0,_[k][1]),Math.min(1,_[k][3])].map(function(F){return F*C}),L=B[0],V=B[1];return new Ho(v[k],new c1(L,A,V-L,U-A),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,N]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return OK(n)},t.prototype.extractParams=function(n){return jK(n)},t}(xi);(function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(XI);var KK=.4,XK=[new nt(.738768,.874946),new nt(2.42204,2.65704),new nt(4.30971,7.04493),new nt(10.246,4.59428),new nt(12.6868,11.8741)],YK=[new nt(1.603231,2.094468),new nt(6.041143,7.080126),new nt(2.882459,3.518061),new nt(4.266906,5.178857),new nt(9.041765,10.66308)],QK=[117.001,114.697,97.404],ZK="tiny_yolov2_model",JK="tiny_yolov2_separable_conv_model",rf=function(e){return typeof e=="number"};function eX(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!rf(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return rf(t.x)&&rf(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(rf)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function w1(e){return me(function(){var t=Fn(e,de(.10000000149011612));return Ue(It(on(e,t)),t)})}function _i(e,t){return me(function(){var n=ys(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Wr(n,t.conv.filters,[1,1],"valid"),n=on(n,t.bn.sub),n=Fn(n,t.bn.truediv),n=Ue(n,t.conv.bias),w1(n)})}function ki(e,t){return me(function(){var n=ys(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Qx(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ue(n,t.bias),w1(n)})}function tX(e,t){var n=jp(e,t);function r(a,s){var l=Kt(e(a)),u=Kt(e(a));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:l,truediv:u}}function o(a,s,l){var u=n(a,s,3,l+"/conv"),c=r(s,l+"/bn");return{conv:u,bn:c}}var i=g1(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function nX(e,t,n,r){var o=wi(e),i=o.extractWeights,a=o.getRemainingWeights,s=[],l=tX(i,s),u=l.extractConvParams,c=l.extractConvWithBatchNormParams,d=l.extractSeparableConvParams,f;if(t.withSeparableConvs){var h=r[0],v=r[1],g=r[2],y=r[3],m=r[4],x=r[5],b=r[6],w=r[7],C=r[8],E=t.isFirstLayerConv2d?u(h,v,3,"conv0"):d(h,v,"conv0"),_=d(v,g,"conv1"),N=d(g,y,"conv2"),T=d(y,m,"conv3"),k=d(m,x,"conv4"),I=d(x,b,"conv5"),A=w?d(b,w,"conv6"):void 0,U=C?d(w,C,"conv7"):void 0,B=u(C||w||b,5*n,1,"conv8");f={conv0:E,conv1:_,conv2:N,conv3:T,conv4:k,conv5:I,conv6:A,conv7:U,conv8:B}}else{var h=r[0],v=r[1],g=r[2],y=r[3],m=r[4],x=r[5],b=r[6],w=r[7],C=r[8],E=c(h,v,"conv0"),_=c(v,g,"conv1"),N=c(g,y,"conv2"),T=c(y,m,"conv3"),k=c(m,x,"conv4"),I=c(x,b,"conv5"),A=c(b,w,"conv6"),U=c(w,C,"conv7"),B=u(C,5*n,1,"conv8");f={conv0:E,conv1:_,conv2:N,conv3:T,conv4:k,conv5:I,conv6:A,conv7:U,conv8:B}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function rX(e,t){var n=Sa(e,t);function r(s){var l=n(s+"/sub",1),u=n(s+"/truediv",1);return{sub:l,truediv:u}}function o(s){var l=n(s+"/filters",4),u=n(s+"/bias",1);return{filters:l,bias:u}}function i(s){var l=o(s+"/conv"),u=r(s+"/bn");return{conv:l,bn:u}}var a=y1(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function oX(e,t){var n=[],r=rX(e,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var l=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:l>7?a("conv6"):void 0,conv7:l>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return bi(e,n),{params:s,paramMappings:n}}var eE;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(eE||(eE={}));var C1=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),YI=function(e){De(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return eX(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var o=_i(n,r.conv0);return o=cn(o,[2,2],[2,2],"same"),o=_i(o,r.conv1),o=cn(o,[2,2],[2,2],"same"),o=_i(o,r.conv2),o=cn(o,[2,2],[2,2],"same"),o=_i(o,r.conv3),o=cn(o,[2,2],[2,2],"same"),o=_i(o,r.conv4),o=cn(o,[2,2],[2,2],"same"),o=_i(o,r.conv5),o=cn(o,[2,2],[1,1],"same"),o=_i(o,r.conv6),o=_i(o,r.conv7),io(o,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?w1(io(n,r.conv0,"valid",!1)):ki(n,r.conv0);return o=cn(o,[2,2],[2,2],"same"),o=ki(o,r.conv1),o=cn(o,[2,2],[2,2],"same"),o=ki(o,r.conv2),o=cn(o,[2,2],[2,2],"same"),o=ki(o,r.conv3),o=cn(o,[2,2],[2,2],"same"),o=ki(o,r.conv4),o=cn(o,[2,2],[2,2],"same"),o=ki(o,r.conv5),o=cn(o,[2,2],[1,1],"same"),o=r.conv6?ki(o,r.conv6):o,o=r.conv7?ki(o,r.conv7):o,io(o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return me(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?id(a,o.config.meanRgb):a,a=a.div(de(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},t.prototype.forward=function(n,r){return Ee(this,void 0,void 0,function(){var o;return _e(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,pn(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),Ee(this,void 0,void 0,function(){var o,i,a,s,l,u,c,d,f,h,v,g,y,m,x=this;return _e(this,function(b){switch(b.label){case 0:return o=new C1(r),i=o.inputSize,a=o.scoreThreshold,[4,pn(n)];case 1:return s=b.sent(),[4,this.forwardInput(s,i)];case 2:return l=b.sent(),u=me(function(){return nn(l)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(u,s.getReshapedInputDimensions(0),a)];case 3:return d=b.sent(),l.dispose(),u.dispose(),f=d.map(function(w){return w.box}),h=d.map(function(w){return w.score}),v=d.map(function(w){return w.classScore}),g=d.map(function(w){return x.config.classes[w.label]}),y=Ac(f.map(function(w){return w.rescale(i)}),h,this.config.iouThreshold,!0),m=y.map(function(w){return new wI(h[w],v[w],g[w],f[w],c)}),[2,m]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return oX(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return nX(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,o){return Ee(this,void 0,void 0,function(){var i,a,s,l,u,c,d,f,h,v,g,y,m,x,b,w,C,E,_,N,T,k,I,A,U,B,L,V,F,M=this;return _e(this,function(j){switch(j.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),l=s/i,u=s/a,c=n.shape[1],d=this.config.anchors.length,f=me(function(){var R=n.reshape([c,c,d,M.boxEncodingSize]),P=R.slice([0,0,0,0],[c,c,d,4]),z=R.slice([0,0,0,4],[c,c,d,1]),G=M.withClassScores?gi(R.slice([0,0,0,5],[c,c,d,M.config.classes.length]),3):de(0);return[P,z,G]}),h=f[0],v=f[1],g=f[2],y=[],[4,v.array()];case 1:return m=j.sent(),[4,h.array()];case 2:x=j.sent(),b=0,j.label=3;case 3:if(!(b<c))return[3,12];w=0,j.label=4;case 4:if(!(w<c))return[3,11];C=0,j.label=5;case 5:return C<d?(E=gv(m[b][w][C][0]),!o||E>o?(_=(w+gv(x[b][w][C][0]))/c*l,N=(b+gv(x[b][w][C][1]))/c*u,T=Math.exp(x[b][w][C][2])*this.config.anchors[C].x/c*l,k=Math.exp(x[b][w][C][3])*this.config.anchors[C].y/c*u,I=_-T/2,A=N-k/2,U={row:b,col:w,anchor:C},this.withClassScores?[4,this.extractPredictedClass(g,U)]:[3,7]):[3,9]):[3,10];case 6:return F=j.sent(),[3,8];case 7:F={classScore:1,label:0},j.label=8;case 8:B=F,L=B.classScore,V=B.label,y.push(In({box:new Mp(I,A,I+T,A+k),score:E,classScore:E*L,label:V},U)),j.label=9;case 9:return C++,[3,5];case 10:return w++,[3,4];case 11:return b++,[3,3];case 12:return h.dispose(),v.dispose(),g.dispose(),[2,y]}})})},t.prototype.extractPredictedClass=function(n,r){return Ee(this,void 0,void 0,function(){var o,i,a,s;return _e(this,function(l){switch(l.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=l.sent(),[2,Array(this.config.classes.length).fill(0).map(function(u,c){return s[o][i][a][c]}).map(function(u,c){return{classScore:u,label:c}}).reduce(function(u,c){return u.classScore>c.classScore?u:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(xi),iX=function(e){De(t,e);function t(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:KK,classes:["face"]},n?{anchors:YK,meanRgb:QK}:{anchors:XK,withClassScores:!0});return r=e.call(this,o)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return Ee(this,void 0,void 0,function(){var o;return _e(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Ho(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?JK:ZK},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(YI),QI=function(e){De(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(C1),ad=function(){function e(){}return e.prototype.then=function(t){return Ee(this,void 0,void 0,function(){var n;return _e(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return Ee(this,void 0,void 0,function(){return _e(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Fp(e,t,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),Ee(this,void 0,void 0,function(){var i,a,s,l,u;return _e(this,function(c){switch(c.label){case 0:return i=e.map(function(d){return hK(d)?o(d):d.detection}),s=r,s?[3,5]:t instanceof Pt?[4,m1(t,i)]:[3,2];case 1:return l=c.sent(),[3,4];case 2:return[4,p1(t,i)];case 3:l=c.sent(),c.label=4;case 4:s=l,c.label=5;case 5:return a=s,[4,n(a)];case 6:return u=c.sent(),a.forEach(function(d){return d instanceof Pt&&d.dispose()}),[2,u]}})})}function S1(e,t,n,r,o){return Ee(this,void 0,void 0,function(){var i=this;return _e(this,function(a){return[2,Fp([e],t,function(s){return Ee(i,void 0,void 0,function(){return _e(this,function(l){return[2,n(s[0])]})})},r,o)]})})}function aX(e){return me(function(){return Cr(nn(e,3).reverse(),3)})}var of=2,Vh=12;function sX(e,t){var n=jp(e,t),r=v1(e,t);function o(u,c){var d=Kt(e(u));return t.push({paramPath:c}),d}function i(u,c,d){d===void 0&&(d=!1);var f=n(u[0],u[1],3,c+"/conv1"),h=o(u[1],c+"/prelu1_alpha"),v=n(u[1],u[2],3,c+"/conv2"),g=o(u[2],c+"/prelu2_alpha"),y=n(u[2],u[3],d?2:3,c+"/conv3"),m=o(u[3],c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:v,prelu2_alpha:g,conv3:y,prelu3_alpha:m}}function a(){var u=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return In(In({},u),{conv4_1:c,conv4_2:d})}function s(){var u=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return In(In({},u),{fc1:c,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function l(){var u=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),v=r(256,2,"onet/fc2_1"),g=r(256,4,"onet/fc2_2"),y=r(256,10,"onet/fc2_3");return In(In({},u),{conv4:c,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:v,fc2_2:g,fc2_3:y})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:l}}function lX(e){var t=wi(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=sX(n,o),a=i.extractPNetParams,s=i.extractRNetParams,l=i.extractONetParams,u=a(),c=s(),d=l();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:u,rnet:c,onet:d},paramMappings:o}}function uX(e,t){var n=Sa(e,t);function r(c){var d=n(c+"/weights",4,c+"/filters"),f=n(c+"/bias",1);return{filters:d,bias:f}}function o(c){var d=n(c+"/weights",2),f=n(c+"/bias",1);return{weights:d,bias:f}}function i(c){return n(c,1)}function a(c){var d=r(c+"/conv1"),f=i(c+"/prelu1_alpha"),h=r(c+"/conv2"),v=i(c+"/prelu2_alpha"),g=r(c+"/conv3"),y=i(c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:v,conv3:g,prelu3_alpha:y}}function s(){var c=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return In(In({},c),{conv4_1:d,conv4_2:f})}function l(){var c=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),v=o("rnet/fc2_2");return In(In({},c),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:v})}function u(){var c=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),v=i("onet/prelu5_alpha"),g=o("onet/fc2_1"),y=o("onet/fc2_2"),m=o("onet/fc2_3");return In(In({},c),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:v,fc2_1:g,fc2_2:y,fc2_3:m})}return{extractPNetParams:s,extractRNetParams:l,extractONetParams:u}}function cX(e){var t=[],n=uX(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),l=i();return bi(e,t),{params:{pnet:a,rnet:s,onet:l},paramMappings:t}}function Ay(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function dX(e,t,n){for(var r=n[0],o=n[1],i=Vh/e,a=[],s=Math.min(r,o)*i,l=0;s>=12;)a.push(i*Math.pow(t,l)),s=s*t,l+=1;return a}var E1=function(e){De(t,e);function t(n,r,o,i){return e.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return t}(va);function ZI(e){return me(function(){return Fn(on(e,de(127.5)),de(.0078125))})}function gl(e,t){return me(function(){return Ue(It(e),Fn(t,Mh(It(Mh(e)))))})}function _1(e,t,n){return n===void 0&&(n=!1),me(function(){var r=io(e,t.conv1,"valid");return r=gl(r,t.prelu1_alpha),r=cn(r,n?[2,2]:[3,3],[2,2],"same"),r=io(r,t.conv2,"valid"),r=gl(r,t.prelu2_alpha),r=n?r:cn(r,[3,3],[2,2],"valid"),r=io(r,t.conv3,"valid"),r=gl(r,t.prelu3_alpha),r})}function fX(e,t){return me(function(){var n=_1(e,t,!0),r=io(n,t.conv4_1,"valid"),o=Mr(Rp(r,3),3),i=gi(on(r,o),3),a=io(n,t.conv4_2,"valid");return{prob:i,regions:a}})}function hX(e,t){return me(function(){var n=Ay(t,e.shape.slice(1)),r=n.height,o=n.width,i=n1.resizeBilinear(e,[r,o]),a=ZI(i);return ma(a,[0,2,1,3])})}function pX(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new nt(s,a));var l=o.map(function(u){var c=new Mp(Math.round((u.y*of+1)/n),Math.round((u.x*of+1)/n),Math.round((u.y*of+Vh)/n),Math.round((u.x*of+Vh)/n)),d=i[u.y][u.x],f=t.arraySync(),h=new E1(f[u.y][u.x][0],f[u.y][u.x][1],f[u.y][u.x][2],f[u.y][u.x][3]);return{cell:c,score:d,region:h}});return l}function mX(e,t,n,r,o){o.stage1=[];var i=t.map(function(f){return me(function(){var h={scale:f},v=hX(e,f),g=Date.now(),y=fX(v,r),m=y.prob,x=y.regions;h.pnet=Date.now()-g;var b=nn(nn(m,3)[1])[0],w=nn(x)[0];return{scoresTensor:b,regionsTensor:w,scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,v=f.regionsTensor,g=f.scale,y=f.statsForScale,m=pX(h,v,g,n);if(h.dispose(),v.dispose(),!m.length)return o.stage1.push(y),[];var x=Date.now(),b=Ac(m.map(function(w){return w.cell}),m.map(function(w){return w.score}),.5);return y.nms=Date.now()-x,y.numBoxes=b.length,o.stage1.push(y),b.map(function(w){return m[w]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),l=[],u=[];if(s.length>0){var c=Date.now(),d=Ac(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,u=d.map(function(f){return s[f].score}),l=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,v=f.region;return new Mp(h.left+v.left*h.width,h.top+v.top*h.height,h.right+v.right*h.width,h.bottom+v.bottom*h.height).toSquare().round()})}return{boxes:l,scores:u}}function JI(e,t,n){var r=n.width,o=n.height;return Ee(this,void 0,void 0,function(){var i,a,s,l=this;return _e(this,function(u){switch(u.label){case 0:return i=fs(e),[4,Promise.all(t.map(function(c){return Ee(l,void 0,void 0,function(){var d,f,h,v,g,y,m,x;return _e(this,function(b){return d=c.padAtBorders(e.height,e.width),f=d.y,h=d.ey,v=d.x,g=d.ex,y=v-1,m=f-1,x=i.getImageData(y,m,g-y,h-m),[2,En.isNodejs()?h1(x):createImageBitmap(x)]})})}))];case 1:return a=u.sent(),s=[],a.forEach(function(c){var d=Dp({width:r,height:o}),f=fs(d);f.drawImage(c,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,v=[],g=0;g<h.length;g+=4)v.push(h[g+2]),v.push(h[g+1]),v.push(h[g]);s.push(v)}),[2,s.map(function(c){var d=me(function(){var f=ma(tr(c,[1,r,o,3]),[0,2,1,3]).toFloat();return ZI(f)});return d})]}})})}function vX(e,t){return me(function(){var n=_1(e,t),r=eo(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Ro(r,t.fc1),i=gl(o,t.prelu4_alpha),a=Ro(i,t.fc2_1),s=Mr(Rp(a,1),1),l=gi(on(a,s),1),u=Ro(i,t.fc2_2),c=nn(l,1)[1];return{scores:c,regions:u}})}function gX(e,t,n,r,o){return Ee(this,void 0,void 0,function(){var i,a,s,l,u,c,d,f,h,v,g,y,m,x;return _e(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,JI(e,t,{width:24,height:24})];case 1:return a=b.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(w){var C=vX(w,r);return w.dispose(),C}),o.stage2_rnet=Date.now()-i,l=s.length>1?tn(s.map(function(w){return w.scores})):s[0].scores,d=(c=Array).from,[4,l.data()];case 2:return u=d.apply(c,[b.sent()]),l.dispose(),f=u.map(function(w,C){return{score:w,idx:C}}).filter(function(w){return w.score>n}).map(function(w){var C=w.idx;return C}),h=f.map(function(w){return t[w]}),v=f.map(function(w){return u[w]}),g=[],y=[],h.length>0&&(i=Date.now(),m=Ac(h,v,.7),o.stage2_nms=Date.now()-i,x=m.map(function(w){var C=s[f[w]].regions.arraySync();return new E1(C[0][0],C[0][1],C[0][2],C[0][3])}),y=m.map(function(w){return v[w]}),g=m.map(function(w,C){return h[w].calibrate(x[C])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:g,scores:y}]}})})}function yX(e,t){return me(function(){var n=_1(e,t);n=cn(n,[2,2],[2,2],"same"),n=io(n,t.conv4,"valid"),n=gl(n,t.prelu4_alpha);var r=eo(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Ro(r,t.fc1),i=gl(o,t.prelu5_alpha),a=Ro(i,t.fc2_1),s=Mr(Rp(a,1),1),l=gi(on(a,s),1),u=Ro(i,t.fc2_2),c=Ro(i,t.fc2_3),d=nn(l,1)[1];return{scores:d,regions:u,points:c}})}function xX(e,t,n,r,o){return Ee(this,void 0,void 0,function(){var i,a,s,l,u,c,d,f,h,v,g,y,m,x,b;return _e(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,JI(e,t,{width:48,height:48})];case 1:return a=w.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(C){var E=yX(C,r);return C.dispose(),E}),o.stage3_onet=Date.now()-i,l=s.length>1?tn(s.map(function(C){return C.scores})):s[0].scores,d=(c=Array).from,[4,l.data()];case 2:return u=d.apply(c,[w.sent()]),l.dispose(),f=u.map(function(C,E){return{score:C,idx:E}}).filter(function(C){return C.score>n}).map(function(C){var E=C.idx;return E}),h=f.map(function(C){var E=s[C].regions.arraySync();return new E1(E[0][0],E[0][1],E[0][2],E[0][3])}),v=f.map(function(C,E){return t[C].calibrate(h[E])}),g=f.map(function(C){return u[C]}),y=[],m=[],x=[],v.length>0&&(i=Date.now(),b=Ac(v,g,.7,!1),o.stage3_nms=Date.now()-i,y=b.map(function(C){return v[C]}),m=b.map(function(C){return g[C]}),x=b.map(function(C,E){return Array(5).fill(0).map(function(_,N){var T=s[C].points.arraySync();return new nt(T[0][N]*(y[E].width+1)+y[E].left,T[0][N+5]*(y[E].height+1)+y[E].top)})})),s.forEach(function(C){C.regions.dispose(),C.scores.dispose(),C.points.dispose()}),[2,{boxes:y,scores:m,points:x}]}})})}var bX=function(e){De(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return Ee(this,void 0,void 0,function(){return _e(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return Ee(this,void 0,void 0,function(){return _e(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),Ee(this,void 0,void 0,function(){var o,i,a,s,l,u,c,d,f,h,v,g,y,m,x,b,w,C,E,_,N;return _e(this,function(T){switch(T.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),l=me(function(){return aX(Mr(l1.fromPixels(i)).toFloat())}),u=function(k){return l.dispose(),a.total=Date.now()-s,k},c=l.shape.slice(1),d=c[0],f=c[1],h=new KI(r),v=h.minFaceSize,g=h.scaleFactor,y=h.maxNumScales,m=h.scoreThresholds,x=h.scaleSteps,b=(x||dX(v,g,[d,f])).filter(function(k){var I=Ay(k,[d,f]);return Math.min(I.width,I.height)>Vh}).slice(0,y),a.scales=b,a.pyramid=b.map(function(k){return Ay(k,[d,f])}),w=Date.now(),[4,mX(l,b,m[0],o.pnet,a)];case 1:return C=T.sent(),a.total_stage1=Date.now()-w,C.boxes.length?(a.stage2_numInputBoxes=C.boxes.length,w=Date.now(),[4,gX(i,C.boxes,m[1],o.rnet,a)]):[2,u({results:[],stats:a})];case 2:return E=T.sent(),a.total_stage2=Date.now()-w,E.boxes.length?(a.stage3_numInputBoxes=E.boxes.length,w=Date.now(),[4,xX(i,E.boxes,m[2],o.onet,a)]):[2,u({results:[],stats:a})];case 3:return _=T.sent(),a.total_stage3=Date.now()-w,N=_.boxes.map(function(k,I){return x1(d1({},new Ho(_.scores[I],new c1(k.left/f,k.top/d,k.width/f,k.height/d),{height:d,width:f})),new Yq(_.points[I].map(function(A){return A.sub(new nt(k.left,k.top)).div(new nt(k.width,k.height))}),{width:k.width,height:k.height}))}),[2,u({results:N,stats:a})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),Ee(this,void 0,void 0,function(){var o;return _e(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,pn(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),Ee(this,void 0,void 0,function(){var o;return _e(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,pn(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return cX(n)},t.prototype.extractParams=function(n){return lX(n)},t}(xi),wX=.4,CX=[new nt(1.603231,2.094468),new nt(6.041143,7.080126),new nt(2.882459,3.518061),new nt(4.266906,5.178857),new nt(9.041765,10.66308)],SX=[117.001,114.697,97.404],EX=function(e){De(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:wX,classes:["face"],anchors:CX,meanRgb:SX,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return Ee(this,void 0,void 0,function(){var o;return _e(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Ho(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(YI),On={ssdMobilenetv1:new XI,tinyFaceDetector:new EX,tinyYolov2:new iX,mtcnn:new bX,faceLandmark68Net:new WI,faceLandmark68TinyNet:new kK,faceRecognitionNet:new MK,faceExpressionNet:new fK,ageGenderNet:new CK},eM=function(e){De(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(ad),k1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r,o=this;return _e(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Fp(n,this.input,function(a){return Ee(o,void 0,void 0,function(){return _e(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(l){return On.faceExpressionNet.predictExpressions(l)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return BI(a,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new P1(this,this.input)},t}(eM),N1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r;return _e(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,S1(n,this.input,function(i){return On.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,BI(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new A1(this,this.input)},t}(eM),T1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new I1(this,this.input)},t.prototype.withFaceDescriptors=function(){return new D1(this,this.input)},t}(k1),R1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new M1(this,this.input)},t.prototype.withFaceDescriptor=function(){return new j1(this,this.input)},t}(N1),tM=function(e){De(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(ad),P1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r,o=this;return _e(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Fp(n,this.input,function(a){return Ee(o,void 0,void 0,function(){return _e(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(l){return On.ageGenderNet.predictAgeAndGender(l)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var l=r[s],u=l.age,c=l.gender,d=l.genderProbability;return GI(qI(a,c,d),u)})]}})})},t.prototype.withFaceExpressions=function(){return new k1(this,this.input)},t}(tM),A1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r,o,i,a;return _e(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,S1(n,this.input,function(l){return On.ageGenderNet.predictAgeAndGender(l)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,GI(qI(n,i,a),o)]}})})},t.prototype.withFaceExpressions=function(){return new N1(this,this.input)},t}(tM),I1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new T1(this,this.input)},t.prototype.withFaceDescriptors=function(){return new D1(this,this.input)},t}(P1),M1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new R1(this,this.input)},t.prototype.withFaceDescriptor=function(){return new j1(this,this.input)},t}(A1),nM=function(e){De(t,e);function t(n,r){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o}return t}(ad),D1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r;return _e(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Fp(n,this.input,function(i){return Promise.all(i.map(function(a){return On.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return HI(n[a],i)})]}})})},t.prototype.withFaceExpressions=function(){return new T1(this,this.input)},t.prototype.withAgeAndGender=function(){return new I1(this,this.input)},t}(nM),j1=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r;return _e(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,S1(n,this.input,function(i){return On.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,HI(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new R1(this,this.input)},t.prototype.withAgeAndGender=function(){return new M1(this,this.input)},t}(nM),rM=function(e){De(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?On.faceLandmark68TinyNet:On.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(ad),_X=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return _e(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return n=l.sent(),r=n.map(function(u){return u.detection}),this.input instanceof Pt?[4,m1(this.input,r)]:[3,3];case 2:return i=l.sent(),[3,5];case 3:return[4,p1(this.input,r)];case 4:i=l.sent(),l.label=5;case 5:return o=i,[4,Promise.all(o.map(function(u){return s.landmarkNet.detectLandmarks(u)}))];case 6:return a=l.sent(),o.forEach(function(u){return u instanceof Pt&&u.dispose()}),[2,n.map(function(u,c){return x1(u,a[c])})]}})})},t.prototype.withFaceExpressions=function(){return new T1(this,this.input)},t.prototype.withAgeAndGender=function(){return new I1(this,this.input)},t.prototype.withFaceDescriptors=function(){return new D1(this,this.input)},t}(rM),kX=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r,o,i,a;return _e(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof Pt?[4,m1(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,p1(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(l){return l instanceof Pt&&l.dispose()}),[2,x1(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new R1(this,this.input)},t.prototype.withAgeAndGender=function(){return new M1(this,this.input)},t.prototype.withFaceDescriptor=function(){return new j1(this,this.input)},t}(rM),oM=function(e){De(t,e);function t(n,r){r===void 0&&(r=new No);var o=e.call(this)||this;return o.input=n,o.options=r,o}return t}(ad),NX=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r,o,i;return _e(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof KI?[4,On.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof QI?function(s){return On.tinyFaceDetector.locateFaces(s,o)}:o instanceof No?function(s){return On.ssdMobilenetv1.locateFaces(s,o)}:o instanceof C1?function(s){return On.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return Ee(n,void 0,void 0,function(){var o;return _e(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return d1({},a)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new _X(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new k1(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new P1(this.runAndExtendWithFaceDetections(),this.input)},t}(oM),TX=function(e){De(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return Ee(this,void 0,void 0,function(){var n,r;return _e(this,function(o){switch(o.label){case 0:return[4,new NX(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return Ee(n,void 0,void 0,function(){var o;return _e(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?d1({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new kX(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new N1(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new A1(this.runAndExtendWithFaceDetection(),this.input)},t}(oM);function Aa(e,t){return t===void 0&&(t=new No),new TX(e,t)}function iM(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof ef)return a;if(a instanceof Float32Array)return new ef(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new ef(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return iM(r,t)}).reduce(function(r,o){return r+o},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new XS(i,n.computeMeanDistance(t,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new XS("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return ef.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();const RX=()=>{const e=S.useCallback(c=>new Promise(d=>{const f=new Image;f.onload=()=>{const h=document.createElement("canvas"),v=h.getContext("2d");if(!v){d({brightness:.5,contrast:.5,sharpness:.5,overallQuality:50,issues:[],suggestions:[]});return}h.width=f.width,h.height=f.height,v.drawImage(f,0,0);const y=v.getImageData(0,0,h.width,h.height).data,m=[],x=[];let b=0,w=0;const C=[];let E=0,_=0;for(let R=0;R<y.length;R+=4){const P=y[R],z=y[R+1],G=y[R+2],q=.299*P+.587*z+.114*G;b+=q,C.push(q),w++,q<50&&E++,q>200&&_++}const N=b/w/255,T=E/w,k=_/w;N<.3?(m.push("Imagem muito escura"),x.push("Aumente a iluminao do ambiente")):N>.7&&(m.push("Imagem muito clara"),x.push("Reduza a iluminao direta")),(T>.3||k>.3)&&(m.push("Iluminao irregular"),x.push("Use iluminao uniforme"));let I=0;const A=b/w;for(const R of C)I+=Math.pow(R-A,2);const U=Math.sqrt(I/w),B=Math.min(U/80,1);let L=0;const V=h.width;for(let R=1;R<h.height-1;R++)for(let P=1;P<V-1;P++){const z=(R*V+P)*4,G=y[z],q=y[z-4],Y=y[z+4],J=y[z-V*4],X=y[z+V*4],ee=Math.abs(4*G-q-Y-J-X);L+=ee}const F=Math.min(L/(w*50),1);F<.3&&(m.push("Imagem desfocada"),x.push("Segure o dispositivo firmemente"));const j=(1-Math.abs(N-.5)*2)*30+B*35+F*35;d({brightness:N,contrast:B,sharpness:F,overallQuality:Math.min(100,Math.max(0,j)),issues:m,suggestions:x})},f.onerror=()=>{d({brightness:.5,contrast:.5,sharpness:.5,overallQuality:50,issues:[],suggestions:[]})},f.src=c}),[]),t=S.useCallback((c,d=2)=>new Promise(f=>{const h=new Image;h.onload=()=>{const v=document.createElement("canvas"),g=v.getContext("2d");if(!g){f(c);return}v.width=h.width,v.height=h.height,g.drawImage(h,0,0);const y=g.getImageData(0,0,v.width,v.height),m=y.data,x=new Array(256).fill(0);for(let k=0;k<m.length;k+=4){const I=Math.round(.299*m[k]+.587*m[k+1]+.114*m[k+2]);x[I]++}const b=m.length/4,w=d*b/256;let C=0;for(let k=0;k<256;k++)x[k]>w&&(C+=x[k]-w,x[k]=w);const E=C/256;for(let k=0;k<256;k++)x[k]+=E;const _=new Array(256).fill(0);_[0]=x[0];for(let k=1;k<256;k++)_[k]=_[k-1]+x[k];const N=_.find(k=>k>0)||0,T=_[255];for(let k=0;k<m.length;k+=4){const I=Math.round(.299*m[k]+.587*m[k+1]+.114*m[k+2]),A=Math.round((_[I]-N)/(T-N)*255),U=I>0?A/I:1,B=Math.max(.5,Math.min(2,U));m[k]=Math.min(255,Math.max(0,m[k]*B)),m[k+1]=Math.min(255,Math.max(0,m[k+1]*B)),m[k+2]=Math.min(255,Math.max(0,m[k+2]*B))}g.putImageData(y,0,0),f(v.toDataURL("image/jpeg",.95))},h.onerror=()=>f(c),h.src=c}),[]),n=S.useCallback(c=>new Promise(d=>{const f=new Image;f.onload=()=>{const h=document.createElement("canvas"),v=h.getContext("2d");if(!v){d(c);return}h.width=f.width,h.height=f.height,v.drawImage(f,0,0);const g=v.getImageData(0,0,h.width,h.height),y=g.data,m=Math.floor(h.width*.25),x=Math.floor(h.width*.75),b=Math.floor(h.height*.2),w=Math.floor(h.height*.8);let C=0,E=0;for(let I=b;I<w;I++)for(let A=m;A<x;A++){const U=(I*h.width+A)*4,B=.299*y[U]+.587*y[U+1]+.114*y[U+2];C+=B,E++}const T=130/(C/E),k=Math.max(.6,Math.min(1.8,T));for(let I=0;I<y.length;I+=4)y[I]=Math.min(255,Math.max(0,y[I]*k)),y[I+1]=Math.min(255,Math.max(0,y[I+1]*k)),y[I+2]=Math.min(255,Math.max(0,y[I+2]*k));v.putImageData(g,0,0),d(h.toDataURL("image/jpeg",.95))},f.onerror=()=>d(c),f.src=c}),[]),r=S.useCallback((c,d=1.2)=>new Promise(f=>{const h=new Image;h.onload=()=>{const v=document.createElement("canvas"),g=v.getContext("2d");if(!g){f(c);return}v.width=h.width,v.height=h.height,g.drawImage(h,0,0);const y=g.getImageData(0,0,v.width,v.height),m=y.data;let x=0,b=0,w=0;const C=m.length/4;for(let T=0;T<m.length;T+=4)x+=m[T],b+=m[T+1],w+=m[T+2];const E=x/C,_=b/C,N=w/C;for(let T=0;T<m.length;T+=4)m[T]=Math.min(255,Math.max(0,E+(m[T]-E)*d)),m[T+1]=Math.min(255,Math.max(0,_+(m[T+1]-_)*d)),m[T+2]=Math.min(255,Math.max(0,N+(m[T+2]-N)*d));g.putImageData(y,0,0),f(v.toDataURL("image/jpeg",.95))},h.onerror=()=>f(c),h.src=c}),[]),o=S.useCallback((c,d=3,f=30)=>new Promise(h=>{const v=new Image;v.onload=()=>{const g=document.createElement("canvas"),y=g.getContext("2d");if(!y){h(c);return}g.width=v.width,g.height=v.height,y.drawImage(v,0,0);const m=y.getImageData(0,0,g.width,g.height),x=m.data,b=new Uint8ClampedArray(x),w=Math.ceil(d*2);for(let C=w;C<g.height-w;C++)for(let E=w;E<g.width-w;E++){const _=(C*g.width+E)*4,N=b[_],T=b[_+1],k=b[_+2];let I=0,A=0,U=0,B=0;for(let L=-w;L<=w;L++)for(let V=-w;V<=w;V++){const F=((C+L)*g.width+(E+V))*4,M=b[F],j=b[F+1],R=b[F+2],P=Math.sqrt(V*V+L*L),z=Math.sqrt(Math.pow(M-N,2)+Math.pow(j-T,2)+Math.pow(R-k,2)),G=Math.exp(-P*P/(2*d*d))*Math.exp(-z*z/(2*f*f));I+=M*G,A+=j*G,U+=R*G,B+=G}x[_]=I/B,x[_+1]=A/B,x[_+2]=U/B}y.putImageData(m,0,0),h(g.toDataURL("image/jpeg",.95))},v.onerror=()=>h(c),v.src=c}),[]),i=S.useCallback(c=>new Promise(d=>{const f=new Image;f.onload=()=>{const h=document.createElement("canvas"),v=h.getContext("2d");if(!v){d(c);return}h.width=f.width,h.height=f.height,v.drawImage(f,0,0);const g=v.getImageData(0,0,h.width,h.height),y=g.data;for(let m=0;m<y.length;m+=4){const x=y[m],b=y[m+1],w=y[m+2],C=Math.max(x,b,w),E=Math.min(x,b,w);if(C>230&&C-E<30){const _=180/C;y[m]=x*_,y[m+1]=b*_,y[m+2]=w*_}else if(C>245){const _=230/C;y[m]=Math.min(255,x*_),y[m+1]=Math.min(255,b*_),y[m+2]=Math.min(255,w*_)}}v.putImageData(g,0,0),d(h.toDataURL("image/jpeg",.95))},f.onerror=()=>d(c),f.src=c}),[]),a=S.useCallback((c,d=.5)=>new Promise(f=>{const h=new Image;h.onload=()=>{const v=document.createElement("canvas"),g=v.getContext("2d");if(!g){f(c);return}v.width=h.width,v.height=h.height,g.drawImage(h,0,0);const y=g.getImageData(0,0,v.width,v.height),m=y.data,x=new Uint8ClampedArray(m),b=[[0,-1,0],[-1,5+d,-1],[0,-1,0]];for(let w=1;w<v.height-1;w++)for(let C=1;C<v.width-1;C++)for(let E=0;E<3;E++){let _=0;for(let T=-1;T<=1;T++)for(let k=-1;k<=1;k++){const I=((w+T)*v.width+(C+k))*4+E;_+=x[I]*b[T+1][k+1]}const N=(w*v.width+C)*4+E;m[N]=Math.min(255,Math.max(0,_))}g.putImageData(y,0,0),f(v.toDataURL("image/jpeg",.95))},h.onerror=()=>f(c),h.src=c}),[]),s=S.useCallback(async c=>{let d=await t(c,2);return d=await n(d),d=await r(d,1.15),d},[t,n,r]),l=S.useCallback(async c=>{let d=await i(c);return d=await o(d,2,25),d=await t(d,2.5),d=await n(d),d=await r(d,1.3),d=await a(d,.3),d},[i,o,t,n,r,a]),u=S.useCallback((c,d,f=.3)=>new Promise(h=>{const v=new Image;v.onload=()=>{const g=document.createElement("canvas"),y=g.getContext("2d");if(!y){h(c);return}const m=d.width*f,x=d.height*f,b=Math.max(0,d.x-m),w=Math.max(0,d.y-x),C=Math.min(v.width-b,d.width+m*2),E=Math.min(v.height-w,d.height+x*2),_=Math.max(C,E);g.width=224,g.height=224,y.drawImage(v,b,w,_,_,0,0,224,224),h(g.toDataURL("image/jpeg",.95))},v.onerror=()=>h(c),v.src=c}),[]);return{analyzeImageQuality:e,adaptiveHistogramEqualization:t,normalizeIllumination:n,enhanceContrast:r,bilateralFilter:o,removeGlare:i,sharpen:a,preprocessSelfie:s,preprocessDocument:l,createFaceCrop:u}},aM=[{x:30.2946+8,y:51.6963},{x:65.5318+8,y:51.5014},{x:48.0252+8,y:71.7366},{x:33.5493+8,y:92.3655},{x:62.7299+8,y:92.2041}],PX=aM.map(e=>({x:e.x*2,y:e.y*2})),AX=()=>{const e=S.useCallback(s=>{const l=s.getLeftEye(),u=s.getRightEye(),c=s.getNose(),d=s.getMouth(),f={x:l.reduce((m,x)=>m+x.x,0)/l.length,y:l.reduce((m,x)=>m+x.y,0)/l.length},h={x:u.reduce((m,x)=>m+x.x,0)/u.length,y:u.reduce((m,x)=>m+x.y,0)/u.length},v=c[3]||c[Math.floor(c.length/2)],g=d[0],y=d[6];return[f,h,{x:v.x,y:v.y},{x:g.x,y:g.y},{x:y.x,y:y.y}]},[]),t=S.useCallback((s,l)=>{const u=s.length;let c=0,d=0,f=0,h=0;for(let k=0;k<u;k++)c+=s[k].x,d+=s[k].y,f+=l[k].x,h+=l[k].y;c/=u,d/=u,f/=u,h/=u;let v=0,g=0,y=0,m=0,x=0;for(let k=0;k<u;k++){const I=s[k].x-c,A=s[k].y-d,U=l[k].x-f,B=l[k].y-h;v+=I*I+A*A,g+=U*I,y+=U*A,m+=B*I,x+=B*A}const b=g+x,w=m-y,C=Math.sqrt(b*b+w*w)/v,E=b/Math.sqrt(b*b+w*w),_=w/Math.sqrt(b*b+w*w),N=f-C*(E*c-_*d),T=h-C*(_*c+E*d);return{scale:C,rotation:Math.atan2(_,E),m:[C*E,-C*_,N,C*_,C*E,T]}},[]),n=S.useCallback((s,l,u=224)=>new Promise(c=>{const d=new Image;d.onload=()=>{const f=document.createElement("canvas"),h=f.getContext("2d");if(!h){c(s);return}f.width=u,f.height=u;const[v,g,y,m,x,b]=l,w=v*x-g*m,C=x/w,E=-g/w,_=(g*b-y*x)/w,N=-m/w,T=v/w,k=(y*m-v*b)/w;h.setTransform(C,N,E,T,_,k),h.drawImage(d,0,0),h.setTransform(1,0,0,1,0,0),c(f.toDataURL("image/jpeg",.95))},d.onerror=()=>c(s),d.src=s}),[]),r=S.useCallback(async(s,l,u=224)=>{const c=e(l),f=t(c,u===224?PX:aM);return new Promise(h=>{const v=new Image;v.onload=()=>{const g=document.createElement("canvas"),y=g.getContext("2d");if(!y){h(s);return}g.width=u,g.height=u;const[m,x,b,w,C,E]=f.m;y.setTransform(m,w,x,C,b,E),y.drawImage(v,0,0),y.setTransform(1,0,0,1,0,0),h(g.toDataURL("image/jpeg",.95))},v.onerror=()=>h(s),v.src=s})},[e,t]),o=S.useCallback(async(s,l,u=.2,c=224)=>new Promise(d=>{const f=new Image;f.onload=async()=>{const h=document.createElement("canvas"),v=h.getContext("2d");if(!v){d(s);return}const g=l.detection.box,y=g.width*u,m=g.height*u,x=Math.max(0,g.x-y),b=Math.max(0,g.y-m),w=Math.min(f.width-x,g.width+2*y),C=Math.min(f.height-b,g.height+2*m);h.width=c,h.height=c,v.drawImage(f,x,b,w,C,0,0,c,c);const E=h.toDataURL("image/jpeg",.95);l.landmarks.positions.map(T=>({x:(T.x-x)/w*c,y:(T.y-b)/C*c}));const _=await js(E),N=await Aa(_,new No({minConfidence:.3})).withFaceLandmarks();if(N){const T=await r(E,N.landmarks,c);d(T)}else d(E)},f.onerror=()=>d(s),f.src=s}),[r]),i=S.useCallback(s=>{const l=s.getLeftEye(),u=s.getRightEye(),c={x:l.reduce((f,h)=>f+h.x,0)/l.length,y:l.reduce((f,h)=>f+h.y,0)/l.length},d={x:u.reduce((f,h)=>f+h.x,0)/u.length,y:u.reduce((f,h)=>f+h.y,0)/u.length};return Math.atan2(d.y-c.y,d.x-c.x)},[]),a=S.useCallback((s,l,u,c)=>new Promise(d=>{const f=new Image;f.onload=()=>{const h=document.createElement("canvas"),v=h.getContext("2d");if(!v){d(s);return}h.width=f.width,h.height=f.height,v.translate(u,c),v.rotate(-l),v.translate(-u,-c),v.drawImage(f,0,0),d(h.toDataURL("image/jpeg",.95))},f.onerror=()=>d(s),f.src=s}),[]);return{get5PointLandmarks:e,getSimilarityTransform:t,warpAffine:n,alignFace:r,extractAlignedFace:o,calculateEyeAngle:i,rotateToAlignEyes:a}};class IX{constructor(t=.2,n=2.5){Yn(this,"margin");Yn(this,"decayFactor");this.margin=t,this.decayFactor=n}euclideanDistance(t,n){let r=0;for(let o=0;o<t.length;o++){const i=t[o]-n[o];r+=i*i}return Math.sqrt(r)}compare(t,n){const r=this.euclideanDistance(t,n),o=Math.exp(-r*this.decayFactor)*100,i=this.margin*2,a=r<i;let s;return r<.3?s="high":r<.5?s="medium":s="low",{distance:r,similarity:o,matched:a,confidence:s}}}class MX{constructor(t=64,n=.5){Yn(this,"scale");Yn(this,"margin");this.scale=t,this.margin=n}normalize(t){let n=0;for(let o=0;o<t.length;o++)n+=t[o]*t[o];n=Math.sqrt(n);const r=new Float32Array(t.length);for(let o=0;o<t.length;o++)r[o]=t[o]/(n||1);return r}calculateAngle(t,n){const r=this.normalize(t),o=this.normalize(n);let i=0;for(let s=0;s<r.length;s++)i+=r[s]*o[s];i=Math.max(-1,Math.min(1,i));const a=Math.acos(i);return{angle:a,angleDegrees:a*(180/Math.PI),cosine:i}}compare(t,n){const{angle:r,cosine:o}=this.calculateAngle(t,n),i=r+this.margin,a=Math.cos(i),s=this.scale*a,l=1/(1+Math.exp(-s/10))*100,u=Math.cos(this.margin*1.5),c=o>u;let d;return o>.85?d="high":o>.7?d="medium":d="low",{angle:r*(180/Math.PI),cosine:o,similarity:l,matched:c,confidence:d}}}class DX{constructor(t=64,n=.35){Yn(this,"scale");Yn(this,"margin");this.scale=t,this.margin=n}normalize(t){let n=0;for(let o=0;o<t.length;o++)n+=t[o]*t[o];n=Math.sqrt(n);const r=new Float32Array(t.length);for(let o=0;o<t.length;o++)r[o]=t[o]/(n||1);return r}compare(t,n){const r=this.normalize(t),o=this.normalize(n);let i=0;for(let f=0;f<r.length;f++)i+=r[f]*o[f];const a=i-this.margin,s=this.scale*a,l=1/(1+Math.exp(-s/10))*100,u=.5+this.margin,c=i>u;let d;return i>.9?d="high":i>.75?d="medium":d="low",{cosine:i,similarity:l,matched:c,confidence:d}}}class jX{constructor(t=64,n=1.35){Yn(this,"scale");Yn(this,"margin");this.scale=t,this.margin=n}normalize(t){let n=0;for(let o=0;o<t.length;o++)n+=t[o]*t[o];n=Math.sqrt(n);const r=new Float32Array(t.length);for(let o=0;o<t.length;o++)r[o]=t[o]/(n||1);return r}compare(t,n){const r=this.normalize(t),o=this.normalize(n);let i=0;for(let v=0;v<r.length;v++)i+=r[v]*o[v];const s=Math.acos(Math.max(-1,Math.min(1,i)))*this.margin,l=Math.cos(s),u=this.scale*l,c=1/(1+Math.exp(-u/10))*100,d=Math.cos(Math.PI/4*this.margin),f=i>d;let h;return i>.85?h="high":i>.7?h="medium":h="low",{cosine:i,similarity:c,matched:f,confidence:h}}}class FX{constructor(){Yn(this,"tripletLoss");Yn(this,"arcface");Yn(this,"cosface");Yn(this,"sphereface");Yn(this,"weights");this.tripletLoss=new IX(.2,2.5),this.arcface=new MX(64,.5),this.cosface=new DX(64,.35),this.sphereface=new jX(64,1.35),this.weights={triplet:.2,arcface:.4,cosface:.25,sphereface:.15}}compare(t,n){const r=this.tripletLoss.compare(t,n),o=this.arcface.compare(t,n),i=this.cosface.compare(t,n),a=this.sphereface.compare(t,n),s=r.similarity*this.weights.triplet+o.similarity*this.weights.arcface+i.similarity*this.weights.cosface+a.similarity*this.weights.sphereface,l=[r.matched,o.matched,i.matched,a.matched].filter(Boolean).length,u=[r.similarity,o.similarity,i.similarity,a.similarity],c=s,d=u.reduce((y,m)=>y+Math.pow(m-c,2),0)/u.length,f=Math.sqrt(d);let h;f<8&&s>75&&l>=3?h="high":f<15&&s>60&&l>=2?h="medium":h="low";let v;h==="high"?v=70:h==="medium"?v=60:v=50;const g=s>=v&&l>=2&&h!=="low";return console.log("Scores individuais:",{triplet:r.similarity,arcface:o.similarity,cosface:i.similarity,sphereface:a.similarity}),console.log("Score ponderado:",s),console.log("Votos:",l,"/4"),console.log("Varincia:",d),console.log("Threshold usado:",v),{passed:g,score:Math.round(s),confidence:h,algorithms:{triplet:{score:Math.round(r.similarity),matched:r.matched,confidence:r.confidence,distance:r.distance},arcface:{score:Math.round(o.similarity),matched:o.matched,confidence:o.confidence,angle:Math.round(o.angle),cosine:o.cosine},cosface:{score:Math.round(i.similarity),matched:i.matched,confidence:i.confidence,cosine:i.cosine},sphereface:{score:Math.round(a.similarity),matched:a.matched,confidence:a.confidence,cosine:a.cosine}},stats:{weightedScore:Math.round(s),votes:l,variance:Math.round(d),stdDev:Math.round(f),threshold:v,agreementCount:l,adaptiveThreshold:v}}}compareDetailed(t,n){return{ensemble:this.compare(t,n)}}adjustWeightsForQuality(t,n){const r=n!==void 0?(t+n)/2:t;r<40?this.weights={triplet:.15,arcface:.55,cosface:.2,sphereface:.1}:r<70?this.weights={triplet:.18,arcface:.45,cosface:.25,sphereface:.12}:this.weights={triplet:.2,arcface:.4,cosface:.25,sphereface:.15},console.log("Pesos ajustados para qualidade",r,":",this.weights)}verifyNormalization(t){const n=Math.sqrt(t.reduce((r,o)=>r+o*o,0));return console.log("Norma do embedding:",n),n}}const af="https://cdn.jsdelivr.net/npm/@vladmandic/face-api@1.7.12/model",F1=()=>{const[e,t]=S.useState(!1),[n,r]=S.useState(!0),[o,i]=S.useState(null),a=S.useRef(null),{preprocessSelfie:s,preprocessDocument:l,analyzeImageQuality:u}=RX(),{extractAlignedFace:c,alignFace:d,calculateEyeAngle:f,rotateToAlignEyes:h}=AX(),v=S.useCallback(async()=>{try{r(!0),i(null),await Promise.all([On.ssdMobilenetv1.loadFromUri(af),On.tinyFaceDetector.loadFromUri(af),On.faceLandmark68Net.loadFromUri(af),On.faceRecognitionNet.loadFromUri(af)]),t(!0),console.log("Face detection models loaded successfully")}catch(L){console.error("Error loading face detection models:",L),i("Erro ao carregar modelos de deteco facial")}finally{r(!1)}},[]);S.useEffect(()=>(v(),()=>{a.current&&clearInterval(a.current)}),[v]);const g=S.useCallback(()=>new No({minConfidence:.5,maxResults:1}),[]),y=S.useCallback(async L=>{if(!e)return{detected:!1,centered:!1,goodLighting:!1,lookingAtCamera:!1,quality:0,message:"Carregando modelos..."};try{const V=await Aa(L,g()).withFaceLandmarks();if(!V)return{detected:!1,centered:!1,goodLighting:!1,lookingAtCamera:!1,quality:0,message:"Posicione seu rosto no centro da tela"};const{box:F}=V.detection,M=L.videoWidth,j=L.videoHeight,R=F.x+F.width/2,P=F.y+F.height/2,z=Math.abs(R-M/2)<M*.1,G=Math.abs(P-j/2)<j*.12,q=z&&G,Y=F.width*F.height,J=M*j,X=Y/J,ee=X>.1&&X<.4,oe=V.detection.score>.8,ue=V.landmarks,ae=ue.getLeftEye(),ce=ue.getRightEye(),se=Math.abs(ae.reduce((Me,Pe)=>Me+Pe.y,0)/ae.length-ce.reduce((Me,Pe)=>Me+Pe.y,0)/ce.length)<10;let ve=V.detection.score*100;q||(ve-=30),ee||(ve-=25),se||(ve-=20),ve=Math.max(0,Math.min(100,ve));let xe="";return q?ee?oe?se?xe="Perfeito! Mantenha a posio":xe="Olhe diretamente para a cmera":xe="Melhore a iluminao":xe=X<.1?"Aproxime-se mais da cmera":"Afaste-se um pouco":!z&&R<M/2?xe="Mova para a direita":z?!G&&P<j/2?xe="Mova para baixo":xe="Mova para cima":xe="Mova para a esquerda",{detected:!0,centered:q,goodLighting:oe,lookingAtCamera:se,quality:ve,message:xe}}catch(V){return console.error("Face detection error:",V),{detected:!1,centered:!1,goodLighting:!1,lookingAtCamera:!1,quality:0,message:"Erro na deteco. Tente novamente."}}},[e,g]),m=S.useCallback((L,V)=>{let F=0,M=0,j=0;for(let R=0;R<L.length;R++)F+=L[R]*V[R],M+=L[R]*L[R],j+=V[R]*V[R];return F/(Math.sqrt(M)*Math.sqrt(j))},[]),x=S.useCallback((L,V)=>{const F=P=>{let z=0;for(let q=0;q<P.length;q++)z+=P[q]*P[q];z=Math.sqrt(z);const G=new Float32Array(P.length);for(let q=0;q<P.length;q++)G[q]=P[q]/z;return G},M=F(L),j=F(V);let R=0;for(let P=0;P<M.length;P++){const z=M[P]-j[P];R+=z*z}return Math.sqrt(R)},[]),b=S.useCallback(async(L,V,F,M)=>{const j=async(G,q)=>new Promise(Y=>{const J=new Image;J.onload=()=>{const X=document.createElement("canvas"),ee=X.getContext("2d");if(!ee){Y([]);return}const oe=q.positions,ue=oe.map(Ce=>Ce.x),ae=oe.map(Ce=>Ce.y),ce=Math.min(...ue),ne=Math.max(...ue),se=Math.min(...ae),ve=Math.max(...ae),xe=ne-ce,Me=ve-se,Pe=.1,je=Math.max(0,ce-xe*Pe),Le=Math.max(0,se-Me*Pe),$e=Math.min(J.width-je,xe*(1+2*Pe)),at=Math.min(J.height-Le,Me*(1+2*Pe));X.width=100,X.height=100,ee.drawImage(J,je,Le,$e,at,0,0,100,100);const Je=ee.getImageData(0,0,100,100).data,dt=new Array(256).fill(0);for(let Ce=0;Ce<Je.length;Ce+=4){const lt=Math.round(.299*Je[Ce]+.587*Je[Ce+1]+.114*Je[Ce+2]);dt[lt]++}const Xe=100*100;for(let Ce=0;Ce<256;Ce++)dt[Ce]/=Xe;Y(dt)},J.onerror=()=>Y([]),J.src=G}),[R,P]=await Promise.all([j(L,F),j(V,M)]);if(R.length===0||P.length===0)return .5;let z=0;for(let G=0;G<256;G++)z+=Math.sqrt(R[G]*P[G]);return Math.min(1,z)},[]),w=S.useCallback((L,V)=>{const F=L.positions,M=V.positions;if(F.length!==M.length)return 0;const j=[36,37,38,39,40,41,42,43,44,45,46,47,27,28,29,30,31,32,33,34,35],R=J=>{const X=J.map(ne=>ne.x),ee=J.map(ne=>ne.y),oe=Math.max(...X)-Math.min(...X),ue=Math.max(...ee)-Math.min(...ee),ae=(Math.max(...X)+Math.min(...X))/2,ce=(Math.max(...ee)+Math.min(...ee))/2;return J.map(ne=>({x:(ne.x-ae)/oe,y:(ne.y-ce)/ue}))},P=R(F),z=R(M);let G=0,q=0;for(let J=0;J<P.length;J++){const X=P[J].x-z[J].x,ee=P[J].y-z[J].y,oe=Math.sqrt(X*X+ee*ee),ue=j.includes(J)?2:1;G+=oe*ue,q+=ue}const Y=G/q;return Math.max(0,Math.min(1,1-Y*5))},[]),C=S.useCallback((L,V)=>{const F=M=>{const j=M.getJawOutline(),R=M.getLeftEye(),P=M.getRightEye(),z=M.getNose(),G=M.getMouth(),q=M.getLeftEyeBrow(),Y=M.getRightEyeBrow(),J={x:R.reduce((Le,$e)=>Le+$e.x,0)/R.length,y:R.reduce((Le,$e)=>Le+$e.y,0)/R.length},X={x:P.reduce((Le,$e)=>Le+$e.x,0)/P.length,y:P.reduce((Le,$e)=>Le+$e.y,0)/P.length},ee=Math.sqrt(Math.pow(X.x-J.x,2)+Math.pow(X.y-J.y,2)),oe=Math.abs(j[j.length-1].x-j[0].x),ue=Math.abs(j[8].y-(q[2].y+Y[2].y)/2),ae=Math.abs(z[z.length-1].x-z[0].x),ce=Math.abs(z[6].y-z[0].y),ne=Math.abs(G[6].x-G[0].x),se=Math.abs(z[3].y-(J.y+X.y)/2),ve=Math.abs(G[3].y-z[6].y),xe=Math.abs(R[3].x-R[0].x),Me=Math.abs(P[3].x-P[0].x),Pe=Math.abs(G[3].y-z[6].y),je=Math.abs(j[8].y-G[9].y);return{faceWidthRatio:oe/ee,faceHeightRatio:ue/ee,noseWidthRatio:ae/ee,noseLengthRatio:ce/ee,mouthWidthRatio:ne/ee,eyeNoseRatio:se/ee,noseMouthRatio:ve/ee,leftEyeRatio:xe/ee,rightEyeRatio:Me/ee,philtrumRatio:Pe/ee,chinRatio:je/ee}};try{const M=F(L),j=F(V),R=Object.keys(M).map(q=>{const Y=q;return Math.abs(M[Y]-j[Y])}),P=R.reduce((q,Y)=>q+Y,0)/R.length;return .5+Math.max(0,Math.min(1,1-P*1.5))*.5}catch(M){return console.error("Structural similarity error:",M),.65}},[]),E=S.useCallback(async(L,V,F,M)=>{const j=async(Y,J)=>new Promise(X=>{const ee=new Image;ee.onload=()=>{const oe=document.createElement("canvas"),ue=oe.getContext("2d");if(!ue){X([]);return}const ae=J.positions,ce=ae.map(ze=>ze.x),ne=ae.map(ze=>ze.y),se=Math.min(...ce),ve=Math.max(...ce),xe=Math.min(...ne),Me=Math.max(...ne),Pe=ve-se,je=Me-xe,Le=.05,$e=Math.max(0,se-Pe*Le),at=Math.max(0,xe-je*Le),Qe=Math.min(ee.width-$e,Pe*(1+2*Le)),Je=Math.min(ee.height-at,je*(1+2*Le));oe.width=64,oe.height=64,ue.drawImage(ee,$e,at,Qe,Je,0,0,64,64);const Xe=ue.getImageData(0,0,64,64).data,Ce=[];for(let ze=0;ze<Xe.length;ze+=4)Ce.push(.299*Xe[ze]+.587*Xe[ze+1]+.114*Xe[ze+2]);const lt=[],zt=new Array(256).fill(0);for(let ze=1;ze<63;ze++)for(let rt=1;rt<63;rt++){const sn=ze*64+rt,ft=Ce[sn];let ln=0;const Wt=[Ce[(ze-1)*64+(rt-1)],Ce[(ze-1)*64+rt],Ce[(ze-1)*64+(rt+1)],Ce[ze*64+(rt+1)],Ce[(ze+1)*64+(rt+1)],Ce[(ze+1)*64+rt],Ce[(ze+1)*64+(rt-1)],Ce[ze*64+(rt-1)]];for(let kr=0;kr<8;kr++)Wt[kr]>=ft&&(ln|=1<<kr);zt[ln]++}const Ht=62*62;for(let ze=0;ze<256;ze++)lt.push(zt[ze]/Ht);const _t=8;for(let ze=0;ze<8;ze++)for(let rt=0;rt<8;rt++){let sn=0;for(let ft=ze*_t;ft<(ze+1)*_t;ft++)for(let ln=rt*_t;ln<(rt+1)*_t;ln++){const Wt=ft*64+ln;if(ln>0&&ln<63&&ft>0&&ft<63){const kr=Ce[Wt+1]-Ce[Wt-1],Go=Ce[Wt+64]-Ce[Wt-64];sn+=Math.sqrt(kr*kr+Go*Go)}}lt.push(sn/(_t*_t*255))}X(lt)},ee.onerror=()=>X([]),ee.src=Y}),[R,P]=await Promise.all([j(L,F),j(V,M)]);if(R.length===0||P.length===0||R.length!==P.length)return .5;let z=0;for(let Y=0;Y<R.length;Y++){const J=R[Y]+P[Y];J>0&&(z+=Math.pow(R[Y]-P[Y],2)/J)}return .5+Math.exp(-z/2)*.5},[]),_=S.useCallback(L=>{const M=100/(1+Math.exp(18*(L-.4)));return Math.max(0,Math.min(100,M))},[]),N=S.useCallback((L,V=2)=>new Promise(F=>{const M=new Image;M.onload=()=>{const j=document.createElement("canvas"),R=j.getContext("2d");if(!R){F(L);return}j.width=Math.min(M.width*V,2e3),j.height=Math.min(M.height*V,2e3),R.imageSmoothingEnabled=!0,R.imageSmoothingQuality="high",R.drawImage(M,0,0,j.width,j.height),F(j.toDataURL("image/jpeg",.98))},M.onerror=()=>F(L),M.src=L}),[]),T=S.useCallback(async L=>{const V=[{minConfidence:.5,inputSize:416},{minConfidence:.4,inputSize:512},{minConfidence:.3,inputSize:320},{minConfidence:.2,inputSize:416}];for(const F of V){const M=new No({minConfidence:F.minConfidence,maxResults:1});let j=await Aa(L,M).withFaceLandmarks().withFaceDescriptor();if(j&&j.detection.score>.5)return console.log(`SSD detection success (conf=${F.minConfidence}):`,j.detection.score),j;const R=new QI({inputSize:F.inputSize,scoreThreshold:F.minConfidence});if(j=await Aa(L,R).withFaceLandmarks().withFaceDescriptor(),j&&j.detection.score>.4)return console.log(`Tiny detection success (size=${F.inputSize}):`,j.detection.score),j}return null},[]),k=S.useCallback(async(L,V)=>{try{const F=f(V.landmarks),M=V.landmarks.getLeftEye(),j=V.landmarks.getRightEye(),R=(M[0].x+j[3].x)/2,P=(M[0].y+j[3].y)/2;let z=L;Math.abs(F)>.02&&(z=await h(L,F,R,P));const G=await c(z,V,.25,224),q=await js(G),Y=await Aa(q,new No({minConfidence:.2})).withFaceLandmarks().withFaceDescriptor();if(Y&&Y.detection.score>.3)return{descriptor:Y.descriptor,score:Y.detection.score}}catch(F){console.error("Aligned face extraction error:",F)}return null},[f,h,c]),I=S.useCallback(async(L,V)=>{const F=[],M=await js(L),j=await Aa(M,new No({minConfidence:.2})).withFaceLandmarks().withFaceDescriptor();j&&j.detection.score>.4&&F.push({descriptor:j.descriptor,score:j.detection.score});const R=await k(L,V);R&&F.push(R);const P=[.15,.3,.4];for(const z of P)try{const G=await c(L,V,z,224),q=await js(G),Y=await Aa(q,new No({minConfidence:.2})).withFaceLandmarks().withFaceDescriptor();Y&&Y.detection.score>.4&&F.push({descriptor:Y.descriptor,score:Y.detection.score})}catch{}return F},[c,k]),A=S.useCallback((L,V)=>{let F=1/0,M=1/0,j=-1;for(const R of L)for(const P of V){const z=iM(R.descriptor,P.descriptor),G=x(R.descriptor,P.descriptor),q=m(R.descriptor,P.descriptor),Y=(R.score+P.score)/2;z/Y<F/.9&&z<F&&(F=z,M=G,j=q)}return{euclidean:F===1/0?1:F,l2Normalized:M===1/0?2:M,cosine:j===-1?0:j}},[m,x]),U=S.useCallback(async(L,V)=>{if(!e)throw new Error("Models not loaded");console.log("=== Starting Advanced Face Comparison ===");try{const[F,M]=await Promise.all([u(L),u(V)]);if(console.log("Quality:",{selfie:F.overallQuality,document:M.overallQuality}),F.overallQuality<15)throw new Error("Qualidade da selfie muito baixa. Tire outra foto com melhor iluminao.");if(M.overallQuality<10)throw new Error("Qualidade do documento muito baixa. Posicione melhor e evite reflexos.");const[j,R]=await Promise.all([s(L),l(V)]),P=await N(R,3.5),[z,G]=await Promise.all([js(j),js(P)]),[q,Y]=await Promise.all([T(z),T(G)]);if(!q)throw new Error("No foi possvel detectar rosto na selfie. Posicione-se melhor.");if(!Y)throw new Error("No foi possvel detectar rosto no documento. Verifique se a foto est visvel.");console.log("Detection scores:",{selfie:q.detection.score,document:Y.detection.score});const[J,X]=await Promise.all([I(j,q),I(P,Y)]);J.length===0&&J.push({descriptor:q.descriptor,score:q.detection.score}),X.length===0&&X.push({descriptor:Y.descriptor,score:Y.detection.score}),console.log("Descriptors:",{selfie:J.length,document:X.length});const ee=A(J,X);console.log("Best match:",ee);const oe=new FX,ue=(F.overallQuality+M.overallQuality)/2;oe.adjustWeightsForQuality(ue);const ae=J.reduce((Ht,_t)=>Ht.score>_t.score?Ht:_t),ce=X.reduce((Ht,_t)=>Ht.score>_t.score?Ht:_t),ne=oe.compareDetailed(ae.descriptor,ce.descriptor);console.log("Ensemble result:",ne.ensemble);const se=_(ee.euclidean),ve=Math.max(0,ee.cosine)*100,xe=w(q.landmarks,Y.landmarks)*100,Me=C(q.landmarks,Y.landmarks)*100,[Pe,je]=await Promise.all([E(j,P,q.landmarks,Y.landmarks),b(j,P,q.landmarks,Y.landmarks)]),Le={euclideanScore:se,cosineScore:ve,landmarkScore:xe,structuralScore:Me,textureScore:Pe*100,histogramScore:je*100,euclideanDistance:ee.euclidean,cosineDistance:1-ee.cosine,tripletScore:ne.ensemble.algorithms.triplet.score,arcfaceScore:ne.ensemble.algorithms.arcface.score,cosfaceScore:ne.ensemble.algorithms.cosface.score,spherefaceScore:ne.ensemble.algorithms.sphereface.score,ensembleScore:ne.ensemble.score},$e=se*.35+ve*.2+xe*.15+Me*.12+Pe*100*.09+je*100*.09,at=$e*.45+ne.ensemble.score*.55;let Qe,Je,dt=20;const Xe=ee.euclidean,Ce=ee.cosine,lt=ne.ensemble.passed,zt=ne.ensemble.stats.agreementCount;return console.log("ULTRA PERMISSIVE mode (threshold 20%):",{euclidean:Xe,cosine:Ce,ensemblePassed:lt,agreementCount:zt,finalScore:at}),at>=20?(Qe=!0,at>=80?Je="high":at>=50?Je="medium":Je="low"):(Qe=!1,Je="low"),(lt||zt>=1)&&(Qe=!0,zt>=3?Je="high":zt>=2&&(Je="medium")),console.log("=== Final Result (threshold 20%) ===",{euclidean:Xe.toFixed(4),cosine:Ce.toFixed(4),euclideanScore:se.toFixed(1),cosineScore:ve.toFixed(1),landmarkScore:xe.toFixed(1),structuralScore:Me.toFixed(1),textureScore:(Pe*100).toFixed(1),histogramScore:(je*100).toFixed(1),originalScore:$e.toFixed(1),ensembleScore:ne.ensemble.score,ensemblePassed:lt,agreementCount:zt,finalScore:at.toFixed(1),passed:Qe,confidence:Je,requiredScore:dt}),{similarity:Math.round(at),distance:Xe,confidence:Je,passed:Qe,metrics:Le,requiredScore:Math.round(dt),selfieQuality:Math.round(F.overallQuality),documentQuality:Math.round(M.overallQuality),ensembleResult:ne.ensemble}}catch(F){throw console.error("Face comparison error:",F),F}},[e,u,s,l,N,T,I,A,_,w,C,E,b]),B=S.useCallback(async(L,V)=>(await U(L,V)).similarity,[U]);return{isModelLoaded:e,isLoading:n,error:o,detectFace:y,compareFaces:B,compareFacesAdvanced:U,getDetectorOptions:g}},OX=Object.freeze(Object.defineProperty({__proto__:null,useFaceDetection:F1},Symbol.toStringTag,{value:"Module"}));let Ru;console.warn("Supabase not configured - using mock client"),Ru={from:()=>({insert:()=>({select:()=>({single:()=>Promise.resolve({data:null,error:null})})}),select:()=>({eq:()=>({single:()=>Promise.resolve({data:null,error:null})}),order:()=>({limit:()=>Promise.resolve({data:[],error:null})})})}),auth:{getSession:()=>Promise.resolve({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})}};const LX=()=>{const e=S.useCallback(async(o,i)=>{var a,s,l,u,c,d,f,h,v,g,y,m,x;try{const{data:b,error:w}=await Ru.from("face_verifications").insert({passed:o.passed,confidence:o.confidence||"low",similarity_score:o.score,required_score:o.requiredScore||0,selfie_quality:o.selfieQuality,document_quality:o.documentQuality,euclidean_score:(a=o.metrics)==null?void 0:a.euclidean,cosine_score:(s=o.metrics)==null?void 0:s.cosine,landmark_score:(l=o.metrics)==null?void 0:l.landmarks,structural_score:(u=o.metrics)==null?void 0:u.structural,texture_score:(c=o.metrics)==null?void 0:c.texture,histogram_score:(d=o.metrics)==null?void 0:d.histogram,triplet_score:(f=o.metrics)==null?void 0:f.tripletScore,arcface_score:(h=o.metrics)==null?void 0:h.arcfaceScore,cosface_score:(v=o.metrics)==null?void 0:v.cosfaceScore,sphereface_score:(g=o.metrics)==null?void 0:g.spherefaceScore,ensemble_score:(y=o.metrics)==null?void 0:y.ensembleScore,euclidean_distance:(m=o.metrics)==null?void 0:m.euclideanDistance,cosine_distance:(x=o.metrics)==null?void 0:x.cosineDistance,agreement_count:o.ensembleAgreement,adaptive_threshold:o.adaptiveThreshold,device_info:i||navigator.userAgent}).select("id").single();return w?(console.error("Error saving verification:",w),null):(console.log("Verification saved with ID:",b.id),{id:b.id})}catch(b){return console.error("Failed to save verification:",b),null}},[]),t=S.useCallback(async o=>{try{const{data:i,error:a}=await Ru.from("face_verifications").select("*").eq("id",o).single();return a?(console.error("Error fetching verification:",a),null):i}catch(i){return console.error("Failed to fetch verification:",i),null}},[]),n=S.useCallback(async(o=10)=>{try{const{data:i,error:a}=await Ru.from("face_verifications").select("*").order("created_at",{ascending:!1}).limit(o);return a?(console.error("Error fetching verifications:",a),[]):i}catch(i){return console.error("Failed to fetch verifications:",i),[]}},[]),r=S.useCallback(async()=>{try{const{data:o,error:i}=await Ru.from("face_verifications").select("passed, similarity_score");if(i||!o)return{total:0,passed:0,failed:0,avgScore:0};const a=o.length,s=o.filter(c=>c.passed).length,l=a-s,u=a>0?o.reduce((c,d)=>c+(d.similarity_score||0),0)/a:0;return{total:a,passed:s,failed:l,avgScore:Math.round(u)}}catch(o){return console.error("Failed to get stats:",o),{total:0,passed:0,failed:0,avgScore:0}}},[]);return{saveVerification:e,getVerification:t,getRecentVerifications:n,getVerificationStats:r}},tE=[{id:"selfie",label:"Selfie",icon:sp},{id:"document",label:"Documento",icon:oo},{id:"processing",label:"Anlise",icon:rN},{id:"result",label:"Resultado",icon:ca}],BX={welcome:-1,selfie:0,document:1,processing:2,result:3},VX=({currentStep:e,primaryColor:t="#2c3e50"})=>{const n=BX[e];return e==="welcome"?null:p.jsx("div",{className:"w-full py-4 px-6",children:p.jsx("div",{className:"flex items-center justify-between max-w-md mx-auto",children:tE.map((r,o)=>{const i=r.icon,a=o<n,s=o===n;return p.jsxs("div",{className:"flex items-center",children:[p.jsxs("div",{className:"flex flex-col items-center",children:[p.jsxs(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:o*.1},className:"relative w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300",style:{backgroundColor:a||s?t:"#e5e5e5",color:a||s?"white":"#666",boxShadow:s?`0 0 0 4px ${t}40`:"none"},children:[a?p.jsx(ro,{className:"w-5 h-5"}):p.jsx(i,{className:"w-5 h-5"}),s&&p.jsx(he.div,{className:"absolute inset-0 rounded-full bg-primary/30",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0}})]}),p.jsx("span",{className:`
                  mt-2 text-xs font-medium transition-colors
                  ${s?"text-foreground":"text-muted-foreground"}
                `,children:r.label})]}),o<tE.length-1&&p.jsx("div",{className:"w-8 sm:w-12 h-0.5 mx-2 -mt-6",children:p.jsx(he.div,{className:"h-full bg-muted rounded-full overflow-hidden",initial:{opacity:0},animate:{opacity:1},children:p.jsx(he.div,{className:"h-full bg-accent",initial:{width:0},animate:{width:a?"100%":"0%"},transition:{duration:.5,delay:.2}})})})]},r.id)})})})},zX=({logoUrl:e="",logoSize:t="medium",logoPosition:n="center",backgroundImage:r="",backgroundColor:o="#ffffff",onContinue:i})=>{const a=()=>{switch(t){case"small":return"100px";case"large":return"280px";default:return"200px"}},s=()=>n==="left"?{marginRight:"auto",marginLeft:"40px"}:n==="right"?{marginLeft:"auto",marginRight:"40px"}:{margin:"0 auto"};return p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center min-h-screen w-full",style:{backgroundColor:o,backgroundImage:r?`url(${r})`:void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed"},children:[r&&p.jsx("div",{className:"absolute inset-0 bg-black/40",style:{zIndex:1}}),p.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center h-full gap-8 px-6 py-12",style:{width:"100%",maxWidth:"600px"},children:[e&&p.jsx(he.div,{initial:{scale:0,opacity:0,rotateX:-90},animate:{scale:1,opacity:1,rotateX:0},transition:{delay:.2,duration:.8,type:"spring"},style:{...s(),width:"100%",display:"flex",flexDirection:"column",alignItems:n==="center"?"center":"flex-start"},children:p.jsx("img",{src:e,alt:"Logo da Empresa",style:{maxWidth:a(),height:"auto",maxHeight:"400px",filter:r?"drop-shadow(0 4px 12px rgba(0,0,0,0.3))":"none"}})}),p.jsx(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.6},className:"mt-auto",children:p.jsxs(Ie,{onClick:i,size:"lg",className:"gap-2 px-8 py-6 text-lg font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all",children:["Continuar",p.jsx(Vu,{className:"w-5 h-5"})]})})]})]})},WX=[{icon:sp,title:"Tire uma selfie",description:"Posicione seu rosto na rea indicada"},{icon:oo,title:"Fotografe seu documento",description:"CNH, RG ou outro documento com foto"},{icon:ca,title:"Verificao automtica",description:"Comparamos sua foto com o documento"}],$X=({onStart:e,primaryColor:t="#2c3e50",secondaryColor:n="#d9534f",textColor:r="#000000",backgroundColor:o="#ffffff",welcomeText:i="",instructionText:a="",securityText:s="Suas informaes so processadas de forma segura e criptografada",logoUrl:l="",logoSize:u="medium"})=>p.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"min-h-[80vh] px-6 py-8 flex items-center justify-center w-full",style:{backgroundColor:o},children:p.jsxs("div",{className:"flex flex-col items-center w-full",children:[l&&p.jsx(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"mb-8",children:p.jsx("img",{src:l,alt:"Logo",style:{maxWidth:u==="small"?"80px":u==="large"?"150px":"120px",height:"auto"}})}),p.jsx(he.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},style:{color:r,textShadow:"0 2px 4px rgba(0,0,0,0.3)",fontSize:"32px",fontWeight:"bold",textAlign:"center",marginBottom:"12px"},children:i||"Verificao de Identidade"}),p.jsx(he.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},style:{color:r,textShadow:"0 2px 4px rgba(0,0,0,0.3)",textAlign:"center",maxWidth:"400px",marginBottom:"40px"},children:a||"Processo seguro e rpido para confirmar sua identidade atravs de reconhecimento facial."}),p.jsx("div",{className:"w-full max-w-sm space-y-4 mb-10",children:WX.map((c,d)=>{const f=c.icon;return p.jsxs(he.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.4+d*.1},className:"flex items-start gap-4 p-4 rounded-xl bg-white/90 border border-white/20 shadow-sm",children:[p.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:`${t}20`},children:p.jsx(f,{className:"w-5 h-5",style:{color:t}})}),p.jsxs("div",{children:[p.jsx("h3",{style:{fontWeight:"bold",color:r,margin:"0"},children:c.title}),p.jsx("p",{style:{fontSize:"14px",color:r,opacity:.9,margin:"4px 0 0 0"},children:c.description})]})]},c.title)})}),p.jsx(he.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.7},className:"w-full max-w-md flex justify-center",children:p.jsxs(Ie,{onClick:e,size:"lg",className:"h-20 px-12 text-xl font-bold shadow-2xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105",style:{backgroundColor:t,color:"white"},onMouseEnter:c=>{c.currentTarget.style.opacity="0.9"},onMouseLeave:c=>{c.currentTarget.style.opacity="1"},children:["Iniciar Verificao",p.jsx(Vu,{className:"ml-3 w-6 h-6"})]})}),p.jsx(he.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mt-6 text-xs text-center max-w-xs",style:{textShadow:"0 2px 4px rgba(0,0,0,0.3)",color:t},children:s})]})}),sM=(e={})=>{const{facingMode:t="user"}=e,n=S.useRef(null),r=S.useRef(null),[o,i]=S.useState(!1),[a,s]=S.useState(null),[l,u]=S.useState(null),[c,d]=S.useState(!1),f=S.useRef(!0),h=S.useCallback(async()=>{if(c){console.log("Camera already initializing");return}r.current&&(console.log("Stopping existing stream before restart"),r.current.getTracks().forEach(y=>y.stop()),r.current=null),d(!0),s(null),i(!1);try{if(console.log("Checking camera support..."),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("NotSupportedError");let y;try{console.log("Requesting camera with high quality constraints..."),y=await navigator.mediaDevices.getUserMedia({video:{facingMode:t,width:{ideal:1920,min:1280},height:{ideal:1080,min:720},frameRate:{ideal:30}},audio:!1})}catch{console.log("High quality constraints failed, trying medium constraints...");try{y=await navigator.mediaDevices.getUserMedia({video:{facingMode:t,width:{ideal:1280},height:{ideal:720}},audio:!1})}catch{console.log("Medium constraints failed, trying basic constraints..."),y=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}}if(console.log("Camera stream obtained:",y.id),console.log("Video tracks:",y.getVideoTracks().length),!f.current){console.log("Component unmounted, stopping stream"),y.getTracks().forEach(C=>C.stop());return}r.current=y,u(!0);const m=n.current;if(!m)throw console.error("Video element not found in ref"),new Error("VideoElementNotFound");console.log("Attaching stream to video element..."),m.pause(),m.srcObject=null,m.srcObject=y;const x=()=>{console.log("Video can play event fired")},b=()=>{console.log("Video is now playing"),console.log("Video dimensions:",m.videoWidth,"x",m.videoHeight),f.current&&(i(!0),d(!1))},w=C=>{console.error("Video element error:",C)};m.addEventListener("canplay",x),m.addEventListener("playing",b),m.addEventListener("error",w),console.log("Attempting to play video...");try{await m.play(),console.log("Play promise resolved")}catch(C){console.error("Play error:",C),f.current&&(i(!0),d(!1))}}catch(y){if(console.error("Camera error:",y),!f.current)return;u(!1),d(!1),r.current&&(r.current.getTracks().forEach(m=>m.stop()),r.current=null),y instanceof Error?y.name==="NotAllowedError"||y.message.includes("Permission")?s("Permisso de cmera negada. Clique no cone de cmera na barra de endereo para permitir."):y.name==="NotFoundError"?s("Nenhuma cmera encontrada no dispositivo."):y.name==="NotSupportedError"||y.message==="NotSupportedError"?s("Seu navegador no suporta acesso  cmera. Use Chrome, Firefox ou Safari."):y.name==="NotReadableError"?s("A cmera est em uso por outro aplicativo. Feche outros programas e tente novamente."):y.message==="VideoElementNotFound"?s("Erro interno: elemento de vdeo no encontrado. Recarregue a pgina."):s(`Erro ao acessar a cmera: ${y.message}`):s("Erro desconhecido ao acessar a cmera.")}},[t,c]),v=S.useCallback(()=>{console.log("Stopping camera..."),r.current&&(r.current.getTracks().forEach(y=>{y.stop(),console.log("Track stopped:",y.kind,y.label)}),r.current=null),n.current&&(n.current.pause(),n.current.srcObject=null),i(!1),d(!1)},[]),g=S.useCallback(()=>{const y=n.current;if(!y||!o)return console.log("Cannot capture: video not ready",{hasVideo:!!y,isReady:o}),null;if(y.videoWidth===0||y.videoHeight===0)return console.log("Cannot capture: video has no dimensions"),null;console.log("Capturing image:",y.videoWidth,"x",y.videoHeight);const m=document.createElement("canvas");m.width=y.videoWidth,m.height=y.videoHeight;const x=m.getContext("2d");if(!x)return null;t==="user"&&(x.translate(m.width,0),x.scale(-1,1)),x.drawImage(y,0,0),x.setTransform(1,0,0,1,0,0),x.font="14px sans-serif",x.fillStyle="rgba(255, 255, 255, 0.7)",x.textAlign="right";const b=new Date().toLocaleString("pt-BR");return x.fillText(b,m.width-10,m.height-10),console.log("Image captured successfully"),m.toDataURL("image/jpeg",.98)},[o,t]);return S.useEffect(()=>(f.current=!0,()=>{f.current=!1,v()}),[v]),{videoRef:n,isReady:o,isInitializing:c,error:a,hasPermission:l,startCamera:h,stopCamera:v,captureImage:g}},UX=({detectionResult:e,isCapturing:t})=>{const n=(e==null?void 0:e.detected)&&(e==null?void 0:e.centered)&&(e==null?void 0:e.goodLighting)&&(e==null?void 0:e.quality)>=70;return p.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[p.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{paddingBottom:"10%"},children:p.jsxs(he.div,{className:`
            relative w-56 h-72 sm:w-64 sm:h-80
            rounded-[50%] border-4 transition-colors duration-300
            ${n?"border-accent shadow-[0_0_40px_rgba(20,184,166,0.4)]":e!=null&&e.detected?"border-warning":"border-muted-foreground/50"}
          `,animate:n?{scale:[1,1.02,1]}:{},transition:{duration:1,repeat:1/0},children:[!n&&(e==null?void 0:e.detected)&&p.jsx(he.div,{className:"absolute inset-x-0 h-1 bg-gradient-to-r from-transparent via-accent to-transparent rounded-full",animate:{top:["0%","100%","0%"]},transition:{duration:2,repeat:1/0,ease:"linear"}}),n&&p.jsx(he.div,{className:"absolute -inset-2 rounded-[50%] border-2 border-accent",animate:{scale:[1,1.1],opacity:[.8,0]},transition:{duration:1.5,repeat:1/0}})]})}),p.jsxs("div",{className:"absolute bottom-24 left-0 right-0 flex flex-col items-center gap-3 px-6",children:[p.jsx(he.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`
            px-6 py-3 rounded-full backdrop-blur-md
            ${n?"bg-accent/90 text-accent-foreground":"bg-card/90 text-foreground"}
          `,children:p.jsx("p",{className:"text-sm font-medium text-center",children:(e==null?void 0:e.message)||"Posicione seu rosto na rea indicada"})},e==null?void 0:e.message),(e==null?void 0:e.detected)&&p.jsxs(he.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-card/80 backdrop-blur-sm",children:[p.jsx("span",{className:"text-xs text-muted-foreground",children:"Qualidade:"}),p.jsx("div",{className:"w-20 h-2 rounded-full bg-muted overflow-hidden",children:p.jsx(he.div,{className:`h-full rounded-full ${e.quality>=70?"bg-accent":e.quality>=40?"bg-warning":"bg-destructive"}`,initial:{width:0},animate:{width:`${e.quality}%`},transition:{duration:.3}})}),p.jsxs("span",{className:"text-xs font-medium text-foreground",children:[Math.round(e.quality),"%"]})]})]}),t&&p.jsx(he.div,{initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:.3},className:"absolute inset-0 bg-accent/20"})]})},HX=({onCapture:e,onBack:t,primaryColor:n="#2c3e50",logoUrl:r="",logoSize:o="medium"})=>{const{videoRef:i,isReady:a,isInitializing:s,error:l,startCamera:u,stopCamera:c,captureImage:d}=sM({facingMode:"user"}),{isModelLoaded:f,isLoading:h,detectFace:v}=F1(),[g,y]=S.useState(null),[m,x]=S.useState(null),[b,w]=S.useState(!1),[C,E]=S.useState(!1),[_,N]=S.useState(!1),T=S.useRef(null),k=S.useRef(null);S.useEffect(()=>{_||(console.log("SelfieCapture mounted, starting camera immediately..."),N(!0),u())},[_,u]),S.useEffect(()=>()=>{console.log("SelfieCapture unmounting, cleaning up..."),T.current&&clearInterval(T.current),k.current&&clearTimeout(k.current)},[]),S.useEffect(()=>{if(!(!a||!f||m))return console.log("Starting face detection interval"),T.current=setInterval(async()=>{const V=i.current;if(V&&V.readyState>=2&&V.videoWidth>0)try{const F=await v(V);y(F);const M=F.detected&&F.centered&&F.goodLighting&&F.quality>=75;M&&!C?(E(!0),k.current=setTimeout(()=>{I()},1500)):!M&&C&&(E(!1),k.current&&clearTimeout(k.current))}catch(F){console.error("Face detection error:",F)}},250),()=>{T.current&&(clearInterval(T.current),T.current=null)}},[a,f,m,C,i,v]);const I=S.useCallback(()=>{w(!0),setTimeout(()=>{const V=d();V?(x(V),c()):console.log("Failed to capture image"),w(!1)},100)},[d,c]),A=S.useCallback(()=>{x(null),y(null),E(!1),u()},[u]),U=S.useCallback(()=>{m&&e(m)},[m,e]),B=S.useCallback(()=>{console.log("Retrying camera..."),c(),N(!1),setTimeout(()=>{N(!0),u()},300)},[u,c]);if(l)return p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center min-h-[80vh] px-6 py-8",children:[p.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mb-6",children:p.jsx(Uc,{className:"w-8 h-8 text-destructive"})}),p.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Erro na Cmera"}),p.jsx("p",{className:"text-muted-foreground text-center mb-6 max-w-sm",children:l}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx(Ie,{onClick:t,variant:"outline",children:"Voltar"}),p.jsxs(Ie,{onClick:B,children:[p.jsx(th,{className:"w-4 h-4 mr-2"}),"Tentar Novamente"]})]})]});const L=s||!a&&!m;return p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col h-full min-h-[80vh]",children:[r&&p.jsx(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"flex justify-center py-4",children:p.jsx("img",{src:r,alt:"Logo",style:{maxWidth:o==="small"?"80px":o==="large"?"150px":"120px",height:"auto"}})}),p.jsx("div",{className:"flex-1 relative bg-foreground/5 overflow-hidden min-h-[400px]",children:p.jsx(Cc,{mode:"wait",children:m?p.jsxs(he.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"absolute inset-0",children:[p.jsx("img",{src:m,alt:"Captured selfie",className:"w-full h-full object-cover",style:{transform:"scaleX(-1)"}}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-foreground/5",children:p.jsx(he.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"w-20 h-20 rounded-full bg-accent flex items-center justify-center shadow-lg",children:p.jsx(ro,{className:"w-10 h-10 text-accent-foreground"})})})]},"preview"):p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:[p.jsx("video",{ref:i,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",style:{transform:"scaleX(-1)",display:a?"block":"none"}}),L&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background",children:p.jsxs("div",{className:"flex flex-col items-center gap-4",children:[p.jsx(hc,{className:"w-10 h-10 text-primary animate-spin"}),p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:s?"Acessando cmera...":"Iniciando cmera..."}),p.jsx("p",{className:"text-xs text-muted-foreground max-w-xs",children:s?"Aguarde a permisso ser processada":"Preparando visualizao"})]}),p.jsxs(Ie,{variant:"outline",size:"sm",onClick:B,className:"mt-2",children:[p.jsx(th,{className:"w-4 h-4 mr-2"}),"Reiniciar Cmera"]})]})}),a&&h&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80",children:p.jsxs("div",{className:"flex flex-col items-center gap-3",children:[p.jsx(hc,{className:"w-8 h-8 text-primary animate-spin"}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando deteco facial..."})]})}),a&&f&&p.jsx(UX,{detectionResult:g,isCapturing:b})]},"camera")})}),p.jsx("div",{className:"p-6 bg-card border-t border-border",children:p.jsx(Cc,{mode:"wait",children:m?p.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex gap-4",children:[p.jsxs(Ie,{variant:"outline",size:"lg",onClick:A,className:"flex-1 h-14",children:[p.jsx(D0,{className:"w-5 h-5 mr-2"}),"Tirar Outra"]}),p.jsxs(Ie,{size:"lg",onClick:U,className:"flex-1 h-14 bg-accent hover:bg-accent-light text-accent-foreground",children:[p.jsx(ro,{className:"w-5 h-5 mr-2"}),"Confirmar"]})]},"confirm"):p.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[p.jsx("p",{className:"text-center text-sm text-muted-foreground mb-4",children:a?C?"Capturando automaticamente...":"Posicione seu rosto e aguarde a captura automtica":"Aguardando cmera..."}),p.jsxs(Ie,{size:"lg",onClick:I,disabled:!a,className:"w-full h-14 bg-primary hover:bg-primary-light text-primary-foreground",children:[p.jsx(sp,{className:"w-5 h-5 mr-2"}),a?"Capturar Agora":"Aguardando..."]})]},"capture")})})]})},GX=({detectionResult:e,isCapturing:t})=>{const n=(e==null?void 0:e.detected)&&(e==null?void 0:e.fullyVisible)&&(e==null?void 0:e.goodFocus)&&(e==null?void 0:e.quality)>=70;return p.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[p.jsxs("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[p.jsx("defs",{children:p.jsxs("mask",{id:"docMask",children:[p.jsx("rect",{width:"100",height:"100",fill:"white"}),p.jsx("rect",{x:"10",y:"25",width:"80",height:"50",rx:"2",fill:"black"})]})}),p.jsx("rect",{width:"100",height:"100",fill:"rgba(0, 0, 0, 0.6)",mask:"url(#docMask)"})]}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center px-6",children:p.jsxs(he.div,{className:`
            relative w-full max-w-sm aspect-[1.6/1] rounded-lg
            border-4 transition-colors duration-300
            ${n?"border-accent shadow-[0_0_40px_rgba(20,184,166,0.4)]":e!=null&&e.detected?"border-warning":"border-muted-foreground/50"}
          `,animate:n?{scale:[1,1.01,1]}:{},transition:{duration:1,repeat:1/0},children:[p.jsx("div",{className:"absolute -top-1 -left-1 w-6 h-6 border-t-4 border-l-4 border-current rounded-tl-md"}),p.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 border-t-4 border-r-4 border-current rounded-tr-md"}),p.jsx("div",{className:"absolute -bottom-1 -left-1 w-6 h-6 border-b-4 border-l-4 border-current rounded-bl-md"}),p.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 border-b-4 border-r-4 border-current rounded-br-md"}),!n&&p.jsx(he.div,{className:"absolute inset-x-2 h-0.5 bg-gradient-to-r from-transparent via-accent to-transparent",animate:{top:["10%","90%","10%"]},transition:{duration:2,repeat:1/0,ease:"linear"}}),n&&p.jsx(he.div,{className:"absolute -inset-2 rounded-lg border-2 border-accent",animate:{scale:[1,1.05],opacity:[.8,0]},transition:{duration:1.5,repeat:1/0}}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:p.jsx("p",{className:"text-muted-foreground/50 text-sm font-medium text-center px-4",children:"Posicione o documento aqui"})})]})}),p.jsxs("div",{className:"absolute bottom-24 left-0 right-0 flex flex-col items-center gap-3 px-6",children:[p.jsx(he.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`
            px-6 py-3 rounded-full backdrop-blur-md
            ${n?"bg-accent/90 text-accent-foreground":"bg-card/90 text-foreground"}
          `,children:p.jsx("p",{className:"text-sm font-medium text-center",children:(e==null?void 0:e.message)||"Posicione o documento dentro da moldura"})},e==null?void 0:e.message),(e==null?void 0:e.detected)&&p.jsxs(he.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-card/80 backdrop-blur-sm",children:[p.jsx("span",{className:"text-xs text-muted-foreground",children:"Qualidade:"}),p.jsx("div",{className:"w-20 h-2 rounded-full bg-muted overflow-hidden",children:p.jsx(he.div,{className:`h-full rounded-full ${e.quality>=70?"bg-accent":e.quality>=40?"bg-warning":"bg-destructive"}`,initial:{width:0},animate:{width:`${e.quality}%`},transition:{duration:.3}})}),p.jsxs("span",{className:"text-xs font-medium text-foreground",children:[Math.round(e.quality),"%"]})]})]}),t&&p.jsx(he.div,{initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:.3},className:"absolute inset-0 bg-accent/20"})]})},qX=[{type:"CNH",label:"CNH",icon:g3},{type:"RG",label:"RG",icon:oo},{type:"RNE",label:"RNE",icon:oo},{type:"PASSPORT",label:"Passaporte",icon:oo}],KX=({onCapture:e,onBack:t,primaryColor:n="#2c3e50",logoUrl:r="",logoSize:o="medium"})=>{const{videoRef:i,isReady:a,isInitializing:s,error:l,startCamera:u,stopCamera:c,captureImage:d}=sM({facingMode:"environment"}),[f,h]=S.useState(null),[v,g]=S.useState(null),[y,m]=S.useState(null),[x,b]=S.useState(!1),[w,C]=S.useState(!1),E=S.useRef(null),[_,N]=S.useState(!1),T=S.useRef(null);S.useEffect(()=>{f&&!_&&(console.log("DocumentCapture: Starting camera for",f),N(!0),u())},[f,_,u]),S.useEffect(()=>()=>{console.log("DocumentCapture: Cleaning up..."),c(),T.current&&clearInterval(T.current),E.current&&clearTimeout(E.current)},[c]),S.useEffect(()=>{if(!(!a||y||!f))return console.log("DocumentCapture: Starting detection interval"),T.current=setInterval(()=>{const L=60+Math.random()*40,V=L>65,F={detected:V,fullyVisible:V&&L>70,goodFocus:V&&L>75,noGlare:V&&L>68,quality:L,message:V?L>=75?"Perfeito! Capturando...":L>=70?"Ajuste levemente o ngulo":"Aproxime o documento":"Posicione o documento na moldura"};g(F);const M=F.detected&&F.fullyVisible&&F.goodFocus&&F.quality>=75;M&&!w?(console.log("DocumentCapture: Conditions ideal, starting auto-capture..."),C(!0),E.current=setTimeout(()=>{k()},1500)):!M&&w&&(console.log("DocumentCapture: Conditions no longer ideal, canceling auto-capture"),C(!1),E.current&&clearTimeout(E.current))},500),()=>{T.current&&(clearInterval(T.current),T.current=null)}},[a,y,f,w]);const k=S.useCallback(()=>{b(!0),setTimeout(()=>{const L=d();L?(m(L),c()):console.log("DocumentCapture: Failed to capture image"),b(!1)},100)},[d,c]),I=S.useCallback(()=>{m(null),g(null),C(!1),u()},[u]),A=S.useCallback(()=>{y&&f&&e(y,f)},[y,f,e]),U=S.useCallback(()=>{console.log("DocumentCapture: Retrying camera..."),c(),N(!1),setTimeout(()=>{N(!0),u()},300)},[u,c]);if(!f)return p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center min-h-[80vh] px-6 py-8",children:[p.jsx(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center mb-6",children:p.jsx(oo,{className:"w-8 h-8 text-primary"})}),p.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Selecione o Documento"}),p.jsx("p",{className:"text-muted-foreground text-center mb-8",children:"Escolha o tipo de documento que voc vai fotografar"}),p.jsx("div",{className:"grid grid-cols-2 gap-4 w-full max-w-sm",children:qX.map((L,V)=>{const F=L.icon;return p.jsxs(he.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:V*.1},onClick:()=>h(L.type),className:"flex flex-col items-center gap-3 p-6 rounded-xl bg-card border border-border hover:border-primary hover:bg-primary/5 transition-all duration-200",children:[p.jsx("div",{className:"w-12 h-12 rounded-lg bg-muted flex items-center justify-center",children:p.jsx(F,{className:"w-6 h-6 text-muted-foreground"})}),p.jsx("span",{className:"font-medium text-foreground",children:L.label})]},L.type)})}),p.jsx(Ie,{variant:"ghost",onClick:t,className:"mt-8",children:"Voltar"})]});if(l)return p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center min-h-[80vh] px-6 py-8",children:[p.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mb-6",children:p.jsx(Uc,{className:"w-8 h-8 text-destructive"})}),p.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Erro na Cmera"}),p.jsx("p",{className:"text-muted-foreground text-center mb-6 max-w-sm",children:l}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx(Ie,{onClick:()=>h(null),variant:"outline",children:"Voltar"}),p.jsxs(Ie,{onClick:U,children:[p.jsx(th,{className:"w-4 h-4 mr-2"}),"Tentar Novamente"]})]})]});const B=s||!a&&!y;return p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col h-full min-h-[80vh]",children:[r&&f&&p.jsx(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"flex justify-center py-4",children:p.jsx("img",{src:r,alt:"Logo",style:{maxWidth:o==="small"?"80px":o==="large"?"150px":"120px",height:"auto"}})}),p.jsx("div",{className:"absolute top-4 left-4 z-10",children:p.jsxs(he.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center gap-2 px-3 py-2 rounded-full bg-card/90 backdrop-blur-sm border border-border",children:[p.jsx(oo,{className:"w-4 h-4 text-muted-foreground"}),p.jsx("span",{className:"text-sm font-medium text-foreground",children:f})]})}),p.jsx("div",{className:"flex-1 relative bg-foreground/5 overflow-hidden min-h-[400px]",children:p.jsx(Cc,{mode:"wait",children:y?p.jsxs(he.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"absolute inset-0",children:[p.jsx("img",{src:y,alt:"Captured document",className:"w-full h-full object-cover"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-foreground/5",children:p.jsx(he.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"w-20 h-20 rounded-full bg-accent flex items-center justify-center shadow-lg",children:p.jsx(ro,{className:"w-10 h-10 text-accent-foreground"})})})]},"preview"):p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:[p.jsx("video",{ref:i,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",style:{display:a?"block":"none"}}),B&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background",children:p.jsxs("div",{className:"flex flex-col items-center gap-4",children:[p.jsx(hc,{className:"w-10 h-10 text-primary animate-spin"}),p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:s?"Acessando cmera traseira...":"Iniciando cmera..."}),p.jsx("p",{className:"text-xs text-muted-foreground max-w-xs",children:s?"Permita o acesso  cmera quando solicitado":"Preparando visualizao"})]}),p.jsxs(Ie,{variant:"outline",size:"sm",onClick:U,className:"mt-2",children:[p.jsx(th,{className:"w-4 h-4 mr-2"}),"Reiniciar Cmera"]})]})}),a&&p.jsx(GX,{detectionResult:v,isCapturing:x})]},"camera")})}),p.jsx("div",{className:"p-6 bg-card border-t border-border",children:p.jsx(Cc,{mode:"wait",children:y?p.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex gap-4",children:[p.jsxs(Ie,{variant:"outline",size:"lg",onClick:I,className:"flex-1 h-14",children:[p.jsx(D0,{className:"w-5 h-5 mr-2"}),"Tirar Outra"]}),p.jsxs(Ie,{size:"lg",onClick:A,className:"flex-1 h-14 bg-accent hover:bg-accent-light text-accent-foreground",children:[p.jsx(ro,{className:"w-5 h-5 mr-2"}),"Confirmar"]})]},"confirm"):p.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[p.jsx("p",{className:"text-center text-sm text-muted-foreground mb-4",children:a?w?"Capturando automaticamente...":"Posicione o documento e aguarde a captura automtica":"Aguardando cmera..."}),p.jsxs(Ie,{size:"lg",onClick:k,disabled:!a,className:"w-full h-14 bg-primary hover:bg-primary-light text-primary-foreground",children:[p.jsx(sp,{className:"w-5 h-5 mr-2"}),a?"Capturar Documento":"Aguardando..."]})]},"capture")})})]})},XX=[{id:"preprocess",label:"Pr-processando imagens...",icon:nh},{id:"detect",label:"Detectando faces...",icon:il},{id:"compare",label:"Comparando caractersticas...",icon:ca}],YX=({selfieImage:e,documentImage:t,onComplete:n,primaryColor:r="#2c3e50",logoUrl:o="",logoSize:i="medium"})=>{const[a,s]=S.useState(0),[l,u]=S.useState(0),[c,d]=S.useState("Iniciando anlise...");return S.useEffect(()=>{(async()=>{try{s(0),d("Normalizando iluminao e contraste...");const h=setInterval(()=>{u(g=>Math.min(g+1,95))},100),{useFaceDetection:v}=await ET(async()=>{const{useFaceDetection:g}=await Promise.resolve().then(()=>OX);return{useFaceDetection:g}},void 0);setTimeout(()=>{s(1),d("Analisando faces com SsdMobilenetv1...")},1500),setTimeout(()=>{s(2),d("Calculando mtricas de similaridade...")},3e3),setTimeout(()=>{clearInterval(h),u(100),n(null)},4500)}catch(h){console.error("Processing error:",h),n(null,h instanceof Error?h.message:"Erro no processamento")}})()},[n]),p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center min-h-[80vh] px-6 py-8",children:[o&&p.jsx(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"mb-8",children:p.jsx("img",{src:o,alt:"Logo",style:{maxWidth:i==="small"?"80px":i==="large"?"150px":"120px",height:"auto"}})}),p.jsxs("div",{className:"flex items-center gap-4 mb-10",children:[p.jsxs(he.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"relative",children:[p.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden border-4 border-card shadow-lg",children:p.jsx("img",{src:e,alt:"Selfie",className:"w-full h-full object-cover",style:{transform:"scaleX(-1)"}})}),p.jsx(he.div,{className:"absolute -inset-1 rounded-full border-2 border-accent",animate:{scale:[1,1.2],opacity:[.5,0]},transition:{duration:1.5,repeat:1/0}})]}),p.jsxs(he.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.2},className:"flex flex-col items-center gap-1",children:[p.jsx("div",{className:"w-12 h-0.5 bg-accent"}),p.jsx(nh,{className:"w-6 h-6 text-accent animate-pulse"}),p.jsx("div",{className:"w-12 h-0.5 bg-accent"})]}),p.jsxs(he.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"relative",children:[p.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden border-4 border-card shadow-lg",children:p.jsx("img",{src:t,alt:"Document",className:"w-full h-full object-cover"})}),p.jsx(he.div,{className:"absolute -inset-1 rounded-lg border-2 border-accent",animate:{scale:[1,1.1],opacity:[.5,0]},transition:{duration:1.5,repeat:1/0,delay:.5}})]})]}),p.jsx(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},className:"relative mb-8",children:p.jsxs("div",{className:"w-32 h-32 rounded-full bg-primary/10 flex items-center justify-center",children:[p.jsx(he.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},className:"w-24 h-24 rounded-full border-4 border-transparent border-t-accent border-r-accent/50"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:p.jsxs("span",{className:"text-2xl font-bold text-foreground",children:[l,"%"]})})]})}),p.jsx(he.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-sm text-muted-foreground text-center mb-6 max-w-xs",children:c},c),p.jsx("div",{className:"w-full max-w-xs space-y-3",children:XX.map((f,h)=>{const v=f.icon,g=h===a,y=h<a;return p.jsxs(he.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+h*.1},className:`
                flex items-center gap-3 p-3 rounded-lg transition-all duration-300
                ${g?"bg-accent/10":y?"bg-muted/50":"bg-transparent"}
              `,children:[p.jsx("div",{className:`
                w-8 h-8 rounded-full flex items-center justify-center transition-colors
                ${y?"bg-accent text-accent-foreground":g?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}
              `,children:y?p.jsx(ca,{className:"w-4 h-4"}):p.jsx(v,{className:`w-4 h-4 ${g?"animate-pulse":""}`})}),p.jsx("span",{className:`
                text-sm transition-colors
                ${g?"text-foreground font-medium":"text-muted-foreground"}
              `,children:f.label})]},f.id)})}),p.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"mt-8 p-3 bg-muted/30 rounded-lg max-w-xs",children:p.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Usando ",p.jsx("span",{className:"font-medium text-foreground",children:"SsdMobilenetv1"})," com comparao multi-mtrica (caractersticas + landmarks + estrutura)"]})})]})},Ps=({label:e,value:t,icon:n})=>{const r=o=>o>=70?"bg-accent":o>=50?"bg-yellow-500":"bg-destructive";return p.jsxs("div",{className:"space-y-1",children:[p.jsxs("div",{className:"flex justify-between items-center text-sm",children:[p.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[n,p.jsx("span",{children:e})]}),p.jsxs("span",{className:"font-semibold text-foreground",children:[t,"%"]})]}),p.jsx("div",{className:"w-full bg-muted rounded-full h-2 overflow-hidden",children:p.jsx(he.div,{initial:{width:0},animate:{width:`${t}%`},transition:{duration:.8,ease:"easeOut"},className:`h-2 rounded-full ${r(t)}`})})]})},sf=({name:e,description:t,result:n,isPrimary:r})=>{var s;const o=l=>l?"text-accent":"text-destructive",i=l=>l?"bg-accent/10":"bg-destructive/10",a=l=>{switch(l){case"high":return"Alta";case"medium":return"Mdia";case"low":return"Baixa";default:return l}};return p.jsxs("div",{className:`p-3 rounded-lg border ${r?"border-primary/30 bg-primary/5":"border-border bg-card"}`,children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[r&&p.jsx(E3,{className:"w-4 h-4 text-primary"}),p.jsx("span",{className:"font-medium text-foreground text-sm",children:e})]}),p.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${i(n.matched)} ${o(n.matched)}`,children:n.matched?" Aprovado":" Reprovado"})]}),p.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:t}),p.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Score:"}),p.jsxs("p",{className:"font-semibold text-foreground",children:[n.score,"%"]})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Confiana:"}),p.jsx("p",{className:"font-semibold text-foreground",children:a(n.confidence)})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:n.angle!==void 0?"ngulo:":n.cosine!==void 0?"Cosseno:":"Distncia:"}),p.jsx("p",{className:"font-semibold text-foreground",children:n.angle!==void 0?`${n.angle.toFixed(1)}`:n.cosine!==void 0?n.cosine.toFixed(3):((s=n.distance)==null?void 0:s.toFixed(3))||"-"})]})]})]})},QX=({result:e})=>{const t=o=>{switch(o){case"high":return"text-accent";case"medium":return"text-yellow-500";case"low":return"text-destructive";default:return"text-muted-foreground"}},n=o=>{switch(o){case"high":return p.jsx(ca,{className:"w-5 h-5"});case"medium":return p.jsx(Uc,{className:"w-5 h-5"});case"low":return p.jsx(nN,{className:"w-5 h-5"});default:return null}},r=o=>{switch(o){case"high":return"Alta";case"medium":return"Mdia";case"low":return"Baixa";default:return o}};return p.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-card rounded-xl border border-border p-5 space-y-5",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h3",{className:"font-semibold text-foreground",children:"Detalhes da Anlise"}),p.jsxs("div",{className:`flex items-center gap-2 ${t(e.confidence)}`,children:[n(e.confidence),p.jsxs("span",{className:"text-sm font-medium",children:["Confiana ",r(e.confidence)]})]})]}),p.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-sm text-muted-foreground",children:"Score Final"}),p.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[e.score,"%"]})]}),p.jsxs("div",{className:"text-right",children:[p.jsx("p",{className:"text-sm text-muted-foreground",children:"Requerido"}),p.jsxs("p",{className:"text-xl font-semibold text-muted-foreground",children:[e.requiredScore,"%"]})]})]}),e.algorithms&&p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(rN,{className:"w-4 h-4 text-primary"}),p.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Anlise por Algoritmo"})]}),p.jsxs("div",{className:"grid gap-2",children:[p.jsx(sf,{name:"ArcFace",description:"Margem Angular (SOTA - 99.8% LFW)",result:e.algorithms.arcface,isPrimary:!0}),p.jsx(sf,{name:"TripletLoss",description:"Google FaceNet - Distncia Euclidiana",result:e.algorithms.triplet}),p.jsx(sf,{name:"CosFace",description:"Margem Cosseno - Discriminao Linear",result:e.algorithms.cosface}),p.jsx(sf,{name:"SphereFace",description:"Angular Softmax - Espao Hipersfrico",result:e.algorithms.sphereface})]})]}),e.ensembleStats&&p.jsxs("div",{className:"p-3 bg-primary/5 rounded-lg border border-primary/10",children:[p.jsxs("h4",{className:"text-sm font-medium text-foreground mb-2 flex items-center gap-2",children:[p.jsx(il,{className:"w-4 h-4"}),"Estatsticas do Ensemble"]}),p.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Score Ponderado:"}),p.jsxs("p",{className:"font-semibold text-foreground",children:[e.ensembleStats.weightedScore,"%"]})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Algoritmos Aprovados:"}),p.jsxs("p",{className:"font-semibold text-foreground",children:[e.ensembleStats.votes,"/4"]})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Varincia:"}),p.jsx("p",{className:"font-semibold text-foreground",children:e.ensembleStats.variance})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Threshold Usado:"}),p.jsxs("p",{className:"font-semibold text-foreground",children:[e.ensembleStats.threshold,"%"]})]})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Mtricas de Comparao"}),p.jsxs("div",{className:"space-y-4",children:[p.jsx(Ps,{label:"Caractersticas Faciais",value:e.metrics.euclidean,icon:p.jsx(nh,{className:"w-4 h-4"})}),p.jsx(Ps,{label:"Similaridade Cosseno",value:e.metrics.cosine,icon:p.jsx(yg,{className:"w-4 h-4"})}),p.jsx(Ps,{label:"Pontos de Referncia",value:e.metrics.landmarks,icon:p.jsx(il,{className:"w-4 h-4"})}),p.jsx(Ps,{label:"Propores Estruturais",value:e.metrics.structural,icon:p.jsx(il,{className:"w-4 h-4"})}),e.metrics.texture!==void 0&&p.jsx(Ps,{label:"Textura Facial",value:e.metrics.texture,icon:p.jsx(nh,{className:"w-4 h-4"})}),e.metrics.histogram!==void 0&&p.jsx(Ps,{label:"Histograma",value:e.metrics.histogram,icon:p.jsx(yg,{className:"w-4 h-4"})})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Qualidade das Imagens"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg text-center",children:[p.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Selfie"}),p.jsxs("p",{className:"text-lg font-semibold text-foreground",children:[e.selfieQuality,"%"]})]}),p.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg text-center",children:[p.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Documento"}),p.jsxs("p",{className:"text-lg font-semibold text-foreground",children:[e.documentQuality,"%"]})]})]})]}),p.jsx("div",{className:"p-3 bg-primary/5 rounded-lg border border-primary/10",children:p.jsxs("p",{className:"text-xs text-muted-foreground leading-relaxed",children:[p.jsx("span",{className:"font-medium text-foreground",children:"Como funciona:"})," Utilizamos 4 algoritmos avanados de reconhecimento facial (ArcFace 40%, TripletLoss 20%, CosFace 25%, SphereFace 15%) em conjunto com pr-processamento CLAHE e normalizao de iluminao. O threshold  ajustado dinamicamente baseado na qualidade das imagens e consenso entre algoritmos."]})})]})},ZX=({session:e,verificationResult:t,onRetry:n,onComplete:r,primaryColor:o="#2c3e50",textColor:i="#000000",logoUrl:a="",logoSize:s="medium"})=>{var f,h;const l=e.status==="approved",u=e.similarityScore||0,c=(t==null?void 0:t.requiredScore)||55,d=()=>{var x;const v={id:e.id,date:(x=e.completedAt)==null?void 0:x.toISOString(),status:e.status,documentType:e.documentType,similarityScore:u.toFixed(2),requiredScore:c,confidence:t==null?void 0:t.confidence,metrics:t==null?void 0:t.metrics,imageQuality:{selfie:t==null?void 0:t.selfieQuality,document:t==null?void 0:t.documentQuality}},g=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),y=URL.createObjectURL(g),m=document.createElement("a");m.href=y,m.download=`verification-${e.id}.json`,m.click(),URL.revokeObjectURL(y)};return p.jsxs(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center min-h-[80vh] px-6 py-8",children:[a&&p.jsx(he.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"mb-8",children:p.jsx("img",{src:a,alt:"Logo",style:{maxWidth:s==="small"?"80px":s==="large"?"150px":"120px",height:"auto"}})}),p.jsxs(he.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:`
          relative w-28 h-28 rounded-full flex items-center justify-center mb-8
          ${l?"bg-accent/10":"bg-destructive/10"}
        `,children:[l?p.jsx(ca,{className:"w-16 h-16 text-accent"}):p.jsx(nN,{className:"w-16 h-16 text-destructive"}),p.jsx(he.div,{className:`absolute inset-0 rounded-full border-4 ${l?"border-accent":"border-destructive"}`,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.4}}),l&&p.jsx(he.div,{className:"absolute -inset-2 rounded-full border-2 border-accent",animate:{scale:[1,1.2],opacity:[.5,0]},transition:{duration:2,repeat:1/0}})]}),p.jsx(he.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},style:{fontSize:"24px",fontWeight:"bold",marginBottom:"8px",color:l?o:"#ef4444"},children:l?"Verificao Aprovada!":"Verificao No Aprovada"}),p.jsx(he.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},style:{color:i,textAlign:"center",maxWidth:"400px",marginBottom:"32px",opacity:.9},children:l?"Sua identidade foi verificada com sucesso. Todas as anlises foram concludas.":"No foi possvel verificar sua identidade. Tente novamente com melhor iluminao."}),p.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.55},className:"w-full max-w-2xl bg-primary/5 rounded-xl border border-primary/20 p-6 mb-6",children:[p.jsxs("h3",{className:"text-lg font-semibold text-foreground mb-4 flex items-center gap-2",children:[p.jsx(il,{className:"w-5 h-5 text-primary"}),"O que foi Analisado"]}),p.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"p-3 bg-background rounded-lg text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-accent mb-1",children:""}),p.jsx("p",{className:"text-sm font-medium text-foreground",children:"Caractersticas Faciais"})]}),p.jsxs("div",{className:"p-3 bg-background rounded-lg text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-accent mb-1",children:""}),p.jsx("p",{className:"text-sm font-medium text-foreground",children:"Pontos de Referncia"})]}),p.jsxs("div",{className:"p-3 bg-background rounded-lg text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-accent mb-1",children:""}),p.jsx("p",{className:"text-sm font-medium text-foreground",children:"Estrutura Facial"})]}),p.jsxs("div",{className:"p-3 bg-background rounded-lg text-center",children:[p.jsx("div",{className:"text-2xl font-bold text-accent mb-1",children:""}),p.jsx("p",{className:"text-sm font-medium text-foreground",children:"Textura Facial"})]})]}),p.jsx("p",{className:"text-xs text-muted-foreground mt-4",children:"Anlise realizada usando 4 algoritmos avanados: ArcFace, TripletLoss, CosFace e SphereFace"})]}),t&&p.jsx("div",{className:"w-full max-w-2xl mb-6",children:p.jsx(QX,{result:t})}),p.jsx(he.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},className:"w-full max-w-sm bg-muted/50 rounded-xl p-4 mb-8",children:p.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"ID da Sesso"}),p.jsxs("p",{className:"font-medium text-foreground truncate",children:[e.id.slice(0,15),"..."]})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Documento"}),p.jsx("p",{className:"font-medium text-foreground",children:e.documentType})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Data"}),p.jsx("p",{className:"font-medium text-foreground",children:(f=e.completedAt)==null?void 0:f.toLocaleDateString("pt-BR")})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-muted-foreground",children:"Hora"}),p.jsx("p",{className:"font-medium text-foreground",children:(h=e.completedAt)==null?void 0:h.toLocaleTimeString("pt-BR")})]})]})}),p.jsx(he.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.7},className:"w-full max-w-sm space-y-3",children:l?p.jsxs(p.Fragment,{children:[p.jsxs(Ie,{size:"lg",onClick:r,className:"w-full h-14 bg-accent hover:bg-accent-light text-accent-foreground",children:[p.jsx(ca,{className:"w-5 h-5 mr-2"}),"Concluir"]}),p.jsxs(Ie,{variant:"outline",size:"lg",onClick:d,className:"w-full h-14",children:[p.jsx(M0,{className:"w-5 h-5 mr-2"}),"Baixar Relatrio"]})]}):p.jsxs(p.Fragment,{children:[p.jsxs(Ie,{size:"lg",onClick:n,className:"w-full h-14 bg-primary hover:bg-primary-light text-primary-foreground",children:[p.jsx(D0,{className:"w-5 h-5 mr-2"}),"Tentar Novamente"]}),p.jsx(Ie,{variant:"ghost",size:"lg",onClick:r,className:"w-full h-14 text-muted-foreground",children:"Cancelar"})]})})]})},Iy=({primaryColor:e="#2c3e50",secondaryColor:t="#d9534f",fontFamily:n="Arial, sans-serif",fontSize:r="16px",logoUrl:o="",logoSize:i="medium",logoPosition:a="center",footerText:s="Verificao de Identidade Segura",welcomeText:l="",instructionText:u="",securityText:c="Suas informaes so processadas de forma segura e criptografada",backgroundImage:d="",backgroundColor:f="#ffffff",iconUrl:h="",passLogoProps:v,onComplete:g,textColor:y="#000000",headerBackgroundColor:m="#2c3e50",headerLogoUrl:x="",headerCompanyName:b=""}={})=>{const{session:w,currentStep:C,startSession:E,saveSelfie:_,saveDocument:N,completeVerification:T,resetSession:k,goToStep:I}=sU(),{compareFacesAdvanced:A}=F1(),{saveVerification:U}=LX(),[B,L]=S.useState(null),[V,F]=S.useState(null),[M,j]=S.useState(null),[R,P]=S.useState(!!(o||d)),z=S.useCallback(()=>{E(),I("selfie")},[E,I]),G=S.useCallback(()=>{P(!1),z()},[z]),q=S.useCallback(oe=>{L(oe),_(oe),sessionStorage.setItem("verification_selfie",oe),I("document")},[_,I]),Y=S.useCallback((oe,ue)=>{F(oe),N(oe,ue),sessionStorage.setItem("verification_document",oe),I("processing")},[N,I]),J=S.useCallback(async(oe,ue)=>{var ae,ce;if(ue){xm.error(ue),I("document");return}if(!B||!V){xm.error("Imagens no disponveis"),I("selfie");return}try{console.log("Starting advanced face comparison...");const ne=await A(B,V),se={passed:ne.passed,score:ne.similarity,confidence:ne.confidence,requiredScore:ne.requiredScore,metrics:{euclidean:Math.round(ne.metrics.euclideanScore),cosine:Math.round(ne.metrics.cosineScore),landmarks:Math.round(ne.metrics.landmarkScore),structural:Math.round(ne.metrics.structuralScore),texture:Math.round(ne.metrics.textureScore),histogram:Math.round(ne.metrics.histogramScore),euclideanDistance:ne.metrics.euclideanDistance,cosineDistance:ne.metrics.cosineDistance,tripletScore:ne.metrics.tripletScore,arcfaceScore:ne.metrics.arcfaceScore,cosfaceScore:ne.metrics.cosfaceScore,spherefaceScore:ne.metrics.spherefaceScore,ensembleScore:ne.metrics.ensembleScore},selfieQuality:ne.selfieQuality,documentQuality:ne.documentQuality,ensembleAgreement:(ae=ne.ensembleResult)==null?void 0:ae.stats.agreementCount,adaptiveThreshold:(ce=ne.ensembleResult)==null?void 0:ce.stats.adaptiveThreshold},ve=await U(se);ve&&console.log("Verification saved to database:",ve.id),j(se),T(ne.similarity,ne.passed,se),I("result"),g&&ne.passed&&setTimeout(()=>{g(se)},2e3)}catch(ne){console.error("Face comparison failed:",ne),xm.error(ne instanceof Error?ne.message:"Erro na comparao facial"),I("document")}},[B,V,A,T,I,U]),X=S.useCallback(()=>{L(null),F(null),j(null),k(),z()},[k,z]),ee=S.useCallback(()=>{L(null),F(null),j(null),k()},[k]);return p.jsxs(p.Fragment,{children:[R&&(o||d)&&p.jsx(zX,{logoUrl:o,logoSize:i,logoPosition:a,backgroundImage:d,onContinue:G}),!R&&p.jsxs("div",{className:"min-h-screen flex flex-col",style:{fontFamily:n,fontSize:r,color:y,backgroundColor:f},children:[(x||b)&&p.jsxs("div",{style:{backgroundColor:m,padding:"20px",display:"flex",alignItems:"center",gap:"15px",position:"sticky",top:0,zIndex:100},children:[x&&p.jsx("img",{src:x,alt:"Header Logo",style:{height:"40px",maxWidth:"100px"}}),b&&p.jsx("span",{style:{color:"white",fontSize:"18px",fontWeight:"bold"},children:b})]}),p.jsx(VX,{currentStep:C,primaryColor:e}),o&&p.jsx("div",{style:{textAlign:a,padding:"20px",marginBottom:"20px"},children:p.jsx("img",{src:o,alt:"Logo",style:{maxWidth:i==="small"?"100px":i==="large"?"300px":"200px",height:"auto"}})}),p.jsx("div",{className:"flex-1",children:p.jsxs(Cc,{mode:"wait",children:[C==="welcome"&&p.jsx($X,{onStart:z,primaryColor:e,secondaryColor:t,textColor:y,backgroundColor:f,backgroundImage:d,welcomeText:l,instructionText:u,securityText:c,iconUrl:h},"welcome"),C==="selfie"&&p.jsx(HX,{onCapture:q,onBack:()=>I("welcome"),primaryColor:e,logoUrl:o,logoSize:i},"selfie"),C==="document"&&p.jsx(KX,{onCapture:Y,onBack:()=>I("selfie"),primaryColor:e,logoUrl:o,logoSize:i},"document"),C==="processing"&&B&&V&&p.jsx(YX,{selfieImage:B,documentImage:V,onComplete:J,primaryColor:e,logoUrl:o,logoSize:i},"processing"),C==="result"&&w&&p.jsx(ZX,{session:w,verificationResult:M,onRetry:X,onComplete:ee,primaryColor:e,textColor:y,logoUrl:o,logoSize:i},"result")]})}),s&&p.jsx("div",{style:{marginTop:"20px",paddingTop:"15px",borderTop:`1px solid ${e}`,fontSize:"12px",color:"#666",textAlign:"center",padding:"20px"},children:s})]})]})};function JX(e){const t=S.useRef({value:e,previous:e});return S.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Op="Checkbox",[eY,IY]=Kl(Op),[tY,O1]=eY(Op);function nY(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:o,disabled:i,form:a,name:s,onCheckedChange:l,required:u,value:c="on",internal_do_not_use_render:d}=e,[f,h]=R0({prop:n,defaultProp:o??!1,onChange:l,caller:Op}),[v,g]=S.useState(null),[y,m]=S.useState(null),x=S.useRef(!1),b=v?!!a||!!v.closest("form"):!0,w={checked:f,disabled:i,setChecked:h,control:v,setControl:g,name:s,form:a,value:c,hasConsumerStoppedPropagationRef:x,required:u,defaultChecked:sa(o)?!1:o,isFormControl:b,bubbleInput:y,setBubbleInput:m};return p.jsx(tY,{scope:t,...w,children:rY(d)?d(w):r})}var lM="CheckboxTrigger",uM=S.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},o)=>{const{control:i,value:a,disabled:s,checked:l,required:u,setControl:c,setChecked:d,hasConsumerStoppedPropagationRef:f,isFormControl:h,bubbleInput:v}=O1(lM,e),g=Sn(o,c),y=S.useRef(l);return S.useEffect(()=>{const m=i==null?void 0:i.form;if(m){const x=()=>d(y.current);return m.addEventListener("reset",x),()=>m.removeEventListener("reset",x)}},[i,d]),p.jsx(Tt.button,{type:"button",role:"checkbox","aria-checked":sa(l)?"mixed":l,"aria-required":u,"data-state":pM(l),"data-disabled":s?"":void 0,disabled:s,value:a,...r,ref:g,onKeyDown:pt(t,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:pt(n,m=>{d(x=>sa(x)?!0:!x),v&&h&&(f.current=m.isPropagationStopped(),f.current||m.stopPropagation())})})});uM.displayName=lM;var L1=S.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:o,defaultChecked:i,required:a,disabled:s,value:l,onCheckedChange:u,form:c,...d}=e;return p.jsx(nY,{__scopeCheckbox:n,checked:o,defaultChecked:i,disabled:s,required:a,onCheckedChange:u,name:r,form:c,value:l,internal_do_not_use_render:({isFormControl:f})=>p.jsxs(p.Fragment,{children:[p.jsx(uM,{...d,ref:t,__scopeCheckbox:n}),f&&p.jsx(hM,{__scopeCheckbox:n})]})})});L1.displayName=Op;var cM="CheckboxIndicator",dM=S.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...o}=e,i=O1(cM,n);return p.jsx(ms,{present:r||sa(i.checked)||i.checked===!0,children:p.jsx(Tt.span,{"data-state":pM(i.checked),"data-disabled":i.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...e.style}})})});dM.displayName=cM;var fM="CheckboxBubbleInput",hM=S.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:o,checked:i,defaultChecked:a,required:s,disabled:l,name:u,value:c,form:d,bubbleInput:f,setBubbleInput:h}=O1(fM,e),v=Sn(n,h),g=JX(i),y=TN(r);S.useEffect(()=>{const x=f;if(!x)return;const b=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(b,"checked").set,E=!o.current;if(g!==i&&C){const _=new Event("click",{bubbles:E});x.indeterminate=sa(i),C.call(x,sa(i)?!1:i),x.dispatchEvent(_)}},[f,g,i,o]);const m=S.useRef(sa(i)?!1:i);return p.jsx(Tt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??m.current,required:s,disabled:l,name:u,value:c,form:d,...t,tabIndex:-1,ref:v,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});hM.displayName=fM;function rY(e){return typeof e=="function"}function sa(e){return e==="indeterminate"}function pM(e){return sa(e)?"indeterminate":e?"checked":"unchecked"}const mM=S.forwardRef(({className:e,...t},n)=>p.jsx(L1,{ref:n,className:Et("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:p.jsx(dM,{className:Et("flex items-center justify-center text-current"),children:p.jsx(ro,{className:"h-4 w-4"})})}));mM.displayName=L1.displayName;const oY=({clientData:e,selfiePhoto:t,documentPhoto:n,currentStep:r=2})=>{const{contractData:o,setContractData:i,setCurrentStep:a}=Gc(),{toast:s}=Wc(),[l,u]=S.useState(!1),[c,d]=S.useState(!1),[f,h]=S.useState(!1),v=S.useRef(null),g=()=>{if(v.current){const{scrollTop:E,scrollHeight:_,clientHeight:N}=v.current;E+N>=_-50&&u(!0)}},y=E=>{switch(E){case"left":return"text-align: left;";case"right":return"text-align: right;";default:return"text-align: center;"}},m=E=>{switch(E){case"small":return"max-width: 100px;";case"large":return"max-width: 300px;";default:return"max-width: 200px;"}},x=E=>{const _=new Date,N=(e==null?void 0:e.protocol_number)||(o==null?void 0:o.protocol_number)||h5(),T=(e==null?void 0:e.primary_color)||"#1351B4",k=(e==null?void 0:e.text_color)||"#333333",I=(e==null?void 0:e.font_family)||"Arial, sans-serif",A=(e==null?void 0:e.font_size)||"16px",U=e==null?void 0:e.logo_url,B=(e==null?void 0:e.logo_size)||"medium",L=(e==null?void 0:e.logo_position)||"center",V=(e==null?void 0:e.company_name)||"Sua Empresa",F=e==null?void 0:e.footer_text,M=ht.clauses.map(q=>`
      <h3 style="font-weight: bold !important; margin-top: 25px !important; margin-bottom: 10px !important; color: ${k} !important; font-family: ${I} !important;">${q.title}</h3>
      <p style="text-align: justify !important; line-height: 1.6 !important; font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;">${q.content}</p>
    `).join(""),j=(e==null?void 0:e.client_name)||"N/A",R=e?wT(e.client_cpf):"N/A",P=(e==null?void 0:e.client_email)||"N/A",z=e!=null&&e.client_phone?CT(e.client_phone):"",G=`
      <div style="margin-top: 50px !important; padding-top: 30px !important; border-top: 2px solid ${T} !important;">
        <h2 style="color: ${k} !important; font-weight: bold !important; margin-bottom: 20px !important; font-family: ${I} !important;">${ht.signature.title}</h2>
        <p style="margin-bottom: 8px !important; font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;">${ht.signature.signedText} <strong>${ST(_)}</strong></p>
        <p style="margin-bottom: 8px !important; font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;"><strong>${ht.signature.authMethod}</strong> Reconhecimento Facial</p>
        <p style="margin-bottom: 30px !important; font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;"><strong>${ht.signature.securityLevel}</strong> Verificado com Segurana</p>
        
        <div style="margin-top: 30px !important; padding: 30px !important; border: 2px solid ${T} !important; text-align: center !important; max-width: 400px !important; margin-left: auto !important; margin-right: auto !important; background-color: #fafafa !important;">
          <p style="font-family: 'Brush Script MT', 'Segoe Script', 'Bradley Hand', cursive !important; font-size: 32px !important; color: ${T} !important; margin: 0 0 10px 0 !important; line-height: 1.2 !important;">${j}</p>
          <div style="border-bottom: 2px solid ${T} !important; width: 250px !important; margin: 0 auto 15px auto !important;"></div>
          <p style="margin: 0 !important; font-weight: bold !important; font-size: 14px !important; font-family: ${I} !important; color: ${k} !important;">${j}</p>
          <p style="margin: 5px 0 !important; color: ${k} !important; font-size: 13px !important; font-family: ${I} !important;">CPF: ${R}</p>
        </div>
      </div>
    `;return{html:`
        <div style="font-family: ${I} !important; padding: 40px !important; max-width: 800px !important; margin: 0 auto !important; color: ${k} !important;">
          <header style="text-align: center !important; margin-bottom: 40px !important; border-bottom: 3px solid ${T} !important; padding-bottom: 20px !important;">
            ${U?`<div style="${y(L)} margin-bottom: 20px !important;"><img src="${U}" alt="${V}" style="${m(B)} height: auto !important;" /></div>`:""}
            <h1 style="color: ${T} !important; margin: 0 !important; font-family: ${I} !important; font-size: 28px !important;">${ht.title}</h1>
            <p style="color: ${k} !important; margin-top: 10px !important; font-family: ${I} !important;">Protocolo: <strong>${N}</strong></p>
          </header>
          
          <section style="margin-bottom: 30px !important;">
            <h2 style="color: ${k} !important; border-bottom: 2px solid ${T} !important; padding-bottom: 10px !important; font-family: ${I} !important;">${ht.contractorSection}</h2>
            <p style="font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;"><strong>Nome:</strong> ${j}</p>
            <p style="font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;"><strong>CPF:</strong> ${R}</p>
            <p style="font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;"><strong>Email:</strong> ${P}</p>
            ${z?`<p style="font-family: ${I} !important; font-size: ${A} !important; color: ${k} !important;"><strong>Telefone:</strong> ${z}</p>`:""}
          </section>
          
          <section style="margin-bottom: 30px !important;">
            <h2 style="color: ${k} !important; border-bottom: 2px solid ${T} !important; padding-bottom: 10px !important; font-family: ${I} !important;">${ht.clausesSection}</h2>
            ${M}
          </section>
          
          ${G}
          
          ${F?`<footer style="margin-top: 50px !important; padding-top: 20px !important; border-top: 1px solid #ddd !important; text-align: center !important; color: ${k} !important; font-family: ${I} !important; font-size: 12px !important; opacity: 0.8 !important;">${F}</footer>`:""}
        </div>
      `,protocol:N}},b=async()=>{if(!l||!c){s({title:ht.toastScrollTitle,description:ht.toastScrollDescription,variant:"destructive"});return}if(!e){s({title:"Erro",description:"Dados do contrato nao encontrados.",variant:"destructive"});return}h(!0);try{const{html:E,protocol:_}=x(),N=new Date().toISOString();await zu("POST",`/api/contracts/${e.id}/finalize`,{selfie_photo:t,document_photo:n,signed_contract_html:E,status:"signed"}),await zu("POST","/api/signature-logs",{contract_id:e.id,ip_address:"0.0.0.0",user_agent:navigator.userAgent,timestamp:N,signature_valid:!0}),await zu("POST","/api/audit-trail",{contract_id:e.id,action:"signed",metadata:{signed_via:"facial_recognition"}}),i({id:e.id,protocol_number:_,signed_at:N,contract_html:E}),s({title:ht.toastSuccessTitle,description:ht.toastSuccessDescription}),a(3)}catch(E){console.error("Error signing contract:",E),s({title:ht.toastErrorTitle,description:ht.toastErrorDescription,variant:"destructive"})}finally{h(!1)}},{html:w,protocol:C}=x();return e!=null&&e.progress_title,e!=null&&e.progress_subtitle,e!=null&&e.progress_step1_title,e!=null&&e.progress_step1_description,e!=null&&e.progress_step2_title,e!=null&&e.progress_step2_description,e!=null&&e.progress_button_text,e!=null&&e.progress_card_color,e!=null&&e.progress_button_color,e!=null&&e.progress_text_color,e!=null&&e.progress_font_family,e!=null&&e.progress_font_size,p.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8 animate-fade-in",children:[(e==null?void 0:e.logo_url)&&p.jsx("div",{style:{textAlign:(e==null?void 0:e.logo_position)||"center",marginBottom:"24px"},children:p.jsx("img",{src:e.logo_url,alt:"Logo",style:{maxWidth:(e==null?void 0:e.logo_size)==="small"?"100px":(e==null?void 0:e.logo_size)==="large"?"300px":"200px",height:"auto"}})}),p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2","data-testid":"text-contract-title",children:ht.pageTitle}),p.jsxs("p",{className:"text-muted-foreground",children:["Protocolo: ",p.jsx("span",{className:"font-mono font-semibold text-primary","data-testid":"text-protocol",children:C})]})]}),p.jsxs("div",{className:"glass-card mb-6",children:[p.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-border",children:[p.jsx(oo,{className:"w-5 h-5 text-primary"}),p.jsx("span",{className:"font-medium text-foreground",children:ht.title})]}),p.jsx("div",{ref:v,onScroll:g,className:"h-96 overflow-y-auto p-4 bg-white",dangerouslySetInnerHTML:{__html:w},"data-testid":"contract-viewer"}),!l&&p.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-warning/10 border-t border-warning/20",children:[p.jsx(Uc,{className:"w-4 h-4 text-warning"}),p.jsx("span",{className:"text-sm text-warning",children:ht.scrollWarning})]})]}),p.jsx("div",{className:"glass-card p-4 mb-6",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx(mM,{id:"agreement",checked:c,onCheckedChange:E=>d(E),disabled:!l,className:"mt-0.5","data-testid":"checkbox-agreement"}),p.jsx("label",{htmlFor:"agreement",className:`text-sm ${l?"text-foreground cursor-pointer":"text-muted-foreground"}`,children:ht.agreementText})]})}),p.jsxs("div",{className:"flex justify-between gap-2 flex-wrap",children:[p.jsxs(Ie,{variant:"outline",onClick:()=>a(1),className:"gap-2","data-testid":"button-back",children:[p.jsx(v3,{className:"w-4 h-4"}),"Voltar"]}),p.jsx(Ie,{onClick:b,disabled:!l||!c||f,className:"gap-2 h-12 px-6","data-testid":"button-sign",children:f?p.jsxs(p.Fragment,{children:[p.jsx(hc,{className:"w-4 h-4 animate-spin"}),ht.signButtonLoading]}):p.jsxs(p.Fragment,{children:[p.jsx(oN,{className:"w-4 h-4"}),ht.signButton]})})]})]})};var B1={};(function e(t,n,r,o){var i=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",s=function(){if(!t.OffscreenCanvas)return!1;try{var R=new OffscreenCanvas(1,1),P=R.getContext("2d");P.fillRect(0,0,1,1);var z=R.transferToImageBitmap();P.createPattern(z,"no-repeat")}catch{return!1}return!0}();function l(){}function u(R){var P=n.exports.Promise,z=P!==void 0?P:t.Promise;return typeof z=="function"?new z(R):(R(l,l),null)}var c=function(R,P){return{transform:function(z){if(R)return z;if(P.has(z))return P.get(z);var G=new OffscreenCanvas(z.width,z.height),q=G.getContext("2d");return q.drawImage(z,0,0),P.set(z,G),G},clear:function(){P.clear()}}}(s,new Map),d=function(){var R=Math.floor(16.666666666666668),P,z,G={},q=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(P=function(Y){var J=Math.random();return G[J]=requestAnimationFrame(function X(ee){q===ee||q+R-1<ee?(q=ee,delete G[J],Y()):G[J]=requestAnimationFrame(X)}),J},z=function(Y){G[Y]&&cancelAnimationFrame(G[Y])}):(P=function(Y){return setTimeout(Y,R)},z=function(Y){return clearTimeout(Y)}),{frame:P,cancel:z}}(),f=function(){var R,P,z={};function G(q){function Y(J,X){q.postMessage({options:J||{},callback:X})}q.init=function(X){var ee=X.transferControlToOffscreen();q.postMessage({canvas:ee},[ee])},q.fire=function(X,ee,oe){if(P)return Y(X,null),P;var ue=Math.random().toString(36).slice(2);return P=u(function(ae){function ce(ne){ne.data.callback===ue&&(delete z[ue],q.removeEventListener("message",ce),P=null,c.clear(),oe(),ae())}q.addEventListener("message",ce),Y(X,ue),z[ue]=ce.bind(null,{data:{callback:ue}})}),P},q.reset=function(){q.postMessage({reset:!0});for(var X in z)z[X](),delete z[X]}}return function(){if(R)return R;if(!r&&i){var q=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{R=new Worker(URL.createObjectURL(new Blob([q])))}catch(Y){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",Y),null}G(R)}return R}}(),h={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function v(R,P){return P?P(R):R}function g(R){return R!=null}function y(R,P,z){return v(R&&g(R[P])?R[P]:h[P],z)}function m(R){return R<0?0:Math.floor(R)}function x(R,P){return Math.floor(Math.random()*(P-R))+R}function b(R){return parseInt(R,16)}function w(R){return R.map(C)}function C(R){var P=String(R).replace(/[^0-9a-f]/gi,"");return P.length<6&&(P=P[0]+P[0]+P[1]+P[1]+P[2]+P[2]),{r:b(P.substring(0,2)),g:b(P.substring(2,4)),b:b(P.substring(4,6))}}function E(R){var P=y(R,"origin",Object);return P.x=y(P,"x",Number),P.y=y(P,"y",Number),P}function _(R){R.width=document.documentElement.clientWidth,R.height=document.documentElement.clientHeight}function N(R){var P=R.getBoundingClientRect();R.width=P.width,R.height=P.height}function T(R){var P=document.createElement("canvas");return P.style.position="fixed",P.style.top="0px",P.style.left="0px",P.style.pointerEvents="none",P.style.zIndex=R,P}function k(R,P,z,G,q,Y,J,X,ee){R.save(),R.translate(P,z),R.rotate(Y),R.scale(G,q),R.arc(0,0,1,J,X,ee),R.restore()}function I(R){var P=R.angle*(Math.PI/180),z=R.spread*(Math.PI/180);return{x:R.x,y:R.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:R.startVelocity*.5+Math.random()*R.startVelocity,angle2D:-P+(.5*z-Math.random()*z),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:R.color,shape:R.shape,tick:0,totalTicks:R.ticks,decay:R.decay,drift:R.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:R.gravity*3,ovalScalar:.6,scalar:R.scalar,flat:R.flat}}function A(R,P){P.x+=Math.cos(P.angle2D)*P.velocity+P.drift,P.y+=Math.sin(P.angle2D)*P.velocity+P.gravity,P.velocity*=P.decay,P.flat?(P.wobble=0,P.wobbleX=P.x+10*P.scalar,P.wobbleY=P.y+10*P.scalar,P.tiltSin=0,P.tiltCos=0,P.random=1):(P.wobble+=P.wobbleSpeed,P.wobbleX=P.x+10*P.scalar*Math.cos(P.wobble),P.wobbleY=P.y+10*P.scalar*Math.sin(P.wobble),P.tiltAngle+=.1,P.tiltSin=Math.sin(P.tiltAngle),P.tiltCos=Math.cos(P.tiltAngle),P.random=Math.random()+2);var z=P.tick++/P.totalTicks,G=P.x+P.random*P.tiltCos,q=P.y+P.random*P.tiltSin,Y=P.wobbleX+P.random*P.tiltCos,J=P.wobbleY+P.random*P.tiltSin;if(R.fillStyle="rgba("+P.color.r+", "+P.color.g+", "+P.color.b+", "+(1-z)+")",R.beginPath(),a&&P.shape.type==="path"&&typeof P.shape.path=="string"&&Array.isArray(P.shape.matrix))R.fill(F(P.shape.path,P.shape.matrix,P.x,P.y,Math.abs(Y-G)*.1,Math.abs(J-q)*.1,Math.PI/10*P.wobble));else if(P.shape.type==="bitmap"){var X=Math.PI/10*P.wobble,ee=Math.abs(Y-G)*.1,oe=Math.abs(J-q)*.1,ue=P.shape.bitmap.width*P.scalar,ae=P.shape.bitmap.height*P.scalar,ce=new DOMMatrix([Math.cos(X)*ee,Math.sin(X)*ee,-Math.sin(X)*oe,Math.cos(X)*oe,P.x,P.y]);ce.multiplySelf(new DOMMatrix(P.shape.matrix));var ne=R.createPattern(c.transform(P.shape.bitmap),"no-repeat");ne.setTransform(ce),R.globalAlpha=1-z,R.fillStyle=ne,R.fillRect(P.x-ue/2,P.y-ae/2,ue,ae),R.globalAlpha=1}else if(P.shape==="circle")R.ellipse?R.ellipse(P.x,P.y,Math.abs(Y-G)*P.ovalScalar,Math.abs(J-q)*P.ovalScalar,Math.PI/10*P.wobble,0,2*Math.PI):k(R,P.x,P.y,Math.abs(Y-G)*P.ovalScalar,Math.abs(J-q)*P.ovalScalar,Math.PI/10*P.wobble,0,2*Math.PI);else if(P.shape==="star")for(var se=Math.PI/2*3,ve=4*P.scalar,xe=8*P.scalar,Me=P.x,Pe=P.y,je=5,Le=Math.PI/je;je--;)Me=P.x+Math.cos(se)*xe,Pe=P.y+Math.sin(se)*xe,R.lineTo(Me,Pe),se+=Le,Me=P.x+Math.cos(se)*ve,Pe=P.y+Math.sin(se)*ve,R.lineTo(Me,Pe),se+=Le;else R.moveTo(Math.floor(P.x),Math.floor(P.y)),R.lineTo(Math.floor(P.wobbleX),Math.floor(q)),R.lineTo(Math.floor(Y),Math.floor(J)),R.lineTo(Math.floor(G),Math.floor(P.wobbleY));return R.closePath(),R.fill(),P.tick<P.totalTicks}function U(R,P,z,G,q){var Y=P.slice(),J=R.getContext("2d"),X,ee,oe=u(function(ue){function ae(){X=ee=null,J.clearRect(0,0,G.width,G.height),c.clear(),q(),ue()}function ce(){r&&!(G.width===o.width&&G.height===o.height)&&(G.width=R.width=o.width,G.height=R.height=o.height),!G.width&&!G.height&&(z(R),G.width=R.width,G.height=R.height),J.clearRect(0,0,G.width,G.height),Y=Y.filter(function(ne){return A(J,ne)}),Y.length?X=d.frame(ce):ae()}X=d.frame(ce),ee=ae});return{addFettis:function(ue){return Y=Y.concat(ue),oe},canvas:R,promise:oe,reset:function(){X&&d.cancel(X),ee&&ee()}}}function B(R,P){var z=!R,G=!!y(P||{},"resize"),q=!1,Y=y(P,"disableForReducedMotion",Boolean),J=i&&!!y(P||{},"useWorker"),X=J?f():null,ee=z?_:N,oe=R&&X?!!R.__confetti_initialized:!1,ue=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ae;function ce(se,ve,xe){for(var Me=y(se,"particleCount",m),Pe=y(se,"angle",Number),je=y(se,"spread",Number),Le=y(se,"startVelocity",Number),$e=y(se,"decay",Number),at=y(se,"gravity",Number),Qe=y(se,"drift",Number),Je=y(se,"colors",w),dt=y(se,"ticks",Number),Xe=y(se,"shapes"),Ce=y(se,"scalar"),lt=!!y(se,"flat"),zt=E(se),Ht=Me,_t=[],ze=R.width*zt.x,rt=R.height*zt.y;Ht--;)_t.push(I({x:ze,y:rt,angle:Pe,spread:je,startVelocity:Le,color:Je[Ht%Je.length],shape:Xe[x(0,Xe.length)],ticks:dt,decay:$e,gravity:at,drift:Qe,scalar:Ce,flat:lt}));return ae?ae.addFettis(_t):(ae=U(R,_t,ee,ve,xe),ae.promise)}function ne(se){var ve=Y||y(se,"disableForReducedMotion",Boolean),xe=y(se,"zIndex",Number);if(ve&&ue)return u(function(Le){Le()});z&&ae?R=ae.canvas:z&&!R&&(R=T(xe),document.body.appendChild(R)),G&&!oe&&ee(R);var Me={width:R.width,height:R.height};X&&!oe&&X.init(R),oe=!0,X&&(R.__confetti_initialized=!0);function Pe(){if(X){var Le={getBoundingClientRect:function(){if(!z)return R.getBoundingClientRect()}};ee(Le),X.postMessage({resize:{width:Le.width,height:Le.height}});return}Me.width=Me.height=null}function je(){ae=null,G&&(q=!1,t.removeEventListener("resize",Pe)),z&&R&&(document.body.contains(R)&&document.body.removeChild(R),R=null,oe=!1)}return G&&!q&&(q=!0,t.addEventListener("resize",Pe,!1)),X?X.fire(se,Me,je):ce(se,Me,je)}return ne.reset=function(){X&&X.reset(),ae&&ae.reset()},ne}var L;function V(){return L||(L=B(null,{useWorker:!0,resize:!0})),L}function F(R,P,z,G,q,Y,J){var X=new Path2D(R),ee=new Path2D;ee.addPath(X,new DOMMatrix(P));var oe=new Path2D;return oe.addPath(ee,new DOMMatrix([Math.cos(J)*q,Math.sin(J)*q,-Math.sin(J)*Y,Math.cos(J)*Y,z,G])),oe}function M(R){if(!a)throw new Error("path confetti are not supported in this browser");var P,z;typeof R=="string"?P=R:(P=R.path,z=R.matrix);var G=new Path2D(P),q=document.createElement("canvas"),Y=q.getContext("2d");if(!z){for(var J=1e3,X=J,ee=J,oe=0,ue=0,ae,ce,ne=0;ne<J;ne+=2)for(var se=0;se<J;se+=2)Y.isPointInPath(G,ne,se,"nonzero")&&(X=Math.min(X,ne),ee=Math.min(ee,se),oe=Math.max(oe,ne),ue=Math.max(ue,se));ae=oe-X,ce=ue-ee;var ve=10,xe=Math.min(ve/ae,ve/ce);z=[xe,0,0,xe,-Math.round(ae/2+X)*xe,-Math.round(ce/2+ee)*xe]}return{type:"path",path:P,matrix:z}}function j(R){var P,z=1,G="#000000",q='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof R=="string"?P=R:(P=R.text,z="scalar"in R?R.scalar:z,q="fontFamily"in R?R.fontFamily:q,G="color"in R?R.color:G);var Y=10*z,J=""+Y+"px "+q,X=new OffscreenCanvas(Y,Y),ee=X.getContext("2d");ee.font=J;var oe=ee.measureText(P),ue=Math.ceil(oe.actualBoundingBoxRight+oe.actualBoundingBoxLeft),ae=Math.ceil(oe.actualBoundingBoxAscent+oe.actualBoundingBoxDescent),ce=2,ne=oe.actualBoundingBoxLeft+ce,se=oe.actualBoundingBoxAscent+ce;ue+=ce+ce,ae+=ce+ce,X=new OffscreenCanvas(ue,ae),ee=X.getContext("2d"),ee.font=J,ee.fillStyle=G,ee.fillText(P,ne,se);var ve=1/z;return{type:"bitmap",bitmap:X.transferToImageBitmap(),matrix:[ve,0,0,ve,-ue*ve/2,-ae*ve/2]}}n.exports=function(){return V().apply(this,arguments)},n.exports.reset=function(){V().reset()},n.exports.create=B,n.exports.shapeFromPath=M,n.exports.shapeFromText=j})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),B1,!1);const vM=B1.exports;B1.exports.create;const iY=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],aY=(e={})=>{const{setCurrentStep:t,setAddressData:n,govbrData:r}=Gc(),{toast:o}=Wc(),[i,a]=S.useState(!1),[s,l]=S.useState({street:"",number:"",neighborhood:"",city:"",state:"",zipcode:"",complement:""}),u=e.client_name||"Nova Revendedora",c=e.parabens_title||`Parabns, ${u}! `,d=e.parabens_subtitle||"Bem-vinda  famlia de revendedoras!",f=e.parabens_description||"Sua maleta de produtos chegar em breve. Preencha seu endereo para receb-la.",h=e.parabens_card_color||"#dbeafe",v=e.parabens_background_color||"#f0fdf4",g=e.parabens_button_color||"#22c55e",y=e.parabens_text_color||"#1e40af",m=e.parabens_font_family||"Arial, sans-serif",x=e.parabens_form_title||"Endereo para Entrega",b=e.parabens_button_text||"Confirmar Endereo e Continuar";S.useEffect(()=>{vM({particleCount:100,spread:70,origin:{y:.6},colors:["#22c55e","#3b82f6","#1351B4"]})},[]);const w=E=>{const{name:_,value:N}=E.target;l(T=>({...T,[_]:N}))},C=async E=>{if(E.preventDefault(),!s.street||!s.number||!s.neighborhood||!s.city||!s.state||!s.zipcode){o({title:"Campos obrigatrios",description:"Por favor, preencha todos os campos obrigatrios.",variant:"destructive"});return}a(!0);try{n({street:s.street,number:s.number,neighborhood:s.neighborhood,city:s.city,state:s.state,zipcode:s.zipcode,complement:s.complement}),o({title:"Endereo registrado!",description:"Sua maleta ser enviada para o endereo fornecido."}),t(4)}catch(_){console.error("Erro ao salvar endereo:",_),o({title:"Erro",description:"Ocorreu um erro ao salvar seu endereo.",variant:"destructive"})}finally{a(!1)}};return p.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center px-4 py-8",style:{fontFamily:m,backgroundColor:v},children:p.jsxs("div",{className:"max-w-2xl w-full",children:[p.jsxs("div",{className:"text-center mb-12",children:[p.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-green-100 rounded-full flex items-center justify-center",children:p.jsx(gg,{className:"w-14 h-14 text-green-600"})}),p.jsx("h1",{className:"text-4xl font-bold mb-4",style:{color:y},children:c}),p.jsx("p",{className:"text-xl mb-2",style:{color:y},children:d}),p.jsx("p",{style:{color:y},children:f})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[p.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-green-200",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx(N3,{className:"w-6 h-6 text-green-600 mt-1 flex-shrink-0"}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Entrega Gratuita"}),p.jsx("p",{className:"text-sm text-gray-600",children:"Sua maleta ser entregue sem custos adicionais no endereo informado."})]})]})}),p.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-blue-200",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx(w3,{className:"w-6 h-6 text-blue-600 mt-1 flex-shrink-0"}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Receba em Casa"}),p.jsx("p",{className:"text-sm text-gray-600",children:"Voc receber um rastreamento de entrega por email."})]})]})})]}),p.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",style:{backgroundColor:h},children:[p.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:y},children:x}),p.jsxs("form",{onSubmit:C,className:"space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"md:col-span-2",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rua *"}),p.jsx(fe,{type:"text",name:"street",value:s.street,onChange:w,placeholder:"Nome da rua",className:"w-full"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nmero *"}),p.jsx(fe,{type:"text",name:"number",value:s.number,onChange:w,placeholder:"Nmero",className:"w-full"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Complemento"}),p.jsx(fe,{type:"text",name:"complement",value:s.complement,onChange:w,placeholder:"Apto, bloco, etc (opcional)",className:"w-full"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bairro *"}),p.jsx(fe,{type:"text",name:"neighborhood",value:s.neighborhood,onChange:w,placeholder:"Seu bairro",className:"w-full"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade *"}),p.jsx(fe,{type:"text",name:"city",value:s.city,onChange:w,placeholder:"Nome da cidade",className:"w-full"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado *"}),p.jsxs("select",{name:"state",value:s.state,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[p.jsx("option",{value:"",children:"Selecione"}),iY.map(E=>p.jsx("option",{value:E,children:E},E))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP *"}),p.jsx(fe,{type:"text",name:"zipcode",value:s.zipcode,onChange:w,placeholder:"00000-000",className:"w-full"})]}),p.jsx(Ie,{type:"submit",disabled:i,className:"w-full h-12 text-white font-bold text-lg mt-6",style:{backgroundColor:g},children:i?"Salvando...":b})]})]}),p.jsxs("div",{className:"mt-8 text-center text-gray-600 text-sm",children:[p.jsxs("p",{children:["Dados do cliente: ",p.jsx("strong",{children:r==null?void 0:r.nome})]}),p.jsx("p",{children:"Voc poder atualizar este endereo a qualquer momento no painel de revendedora."})]})]})})},sY="/assets/luxury_jewelry_store_e7290e08-sCfqCZeV.jpg",lY="/assets/professional_busines_a0c2523c-DH6LBC88.jpg",uY="/assets/golden_trophy_award__62627ba6-CrtBWr_f.jpg",cY=()=>{const{setCurrentStep:e,contractData:t}=Gc(),n=(t==null?void 0:t.google_play_url)||"https://play.google.com/store",r=(t==null?void 0:t.app_store_url)||"https://www.apple.com/app-store/",o=[{icon:p.jsx(S3,{className:"w-8 h-8 text-amber-600"}),title:"Sua Boutique Digital Exclusive",description:"Transforme seu smartphone em uma vitrine de alto luxo. Acesse nosso catlogo completo de semijoias premium com design exclusivo e qualidade impecvel.",image:sY,points:["Catlogo em tempo real","Preos exclusivos de revenda","Fotos profissionais para compartilhar"]},{icon:p.jsx(yg,{className:"w-8 h-8 text-emerald-600"}),title:"Gesto de Alta Performance",description:"Tenha o controle total do seu imprio. Acompanhe lucros, datas de recebimento e histrico de vendas com transparncia absoluta e relatrios detalhados.",image:lY,points:["Previso de ganhos","Controle de estoque","Relatrios financeiros dirios"]},{icon:p.jsx(k3,{className:"w-8 h-8 text-amber-500"}),title:"Clube de Elite & Reconhecimento",description:"Voc no  apenas uma revendedora,  parte de um ecossistema de sucesso. Participe de rankings nacionais, ganhe viagens, bnus e prmios de luxo.",image:uY,points:["Rankings de performance","Metas com prmios reais","Comunidade VIP de suporte"]}];return p.jsx("div",{className:"min-h-screen bg-neutral-50 font-sans selection:bg-amber-100 selection:text-amber-900",children:p.jsxs("div",{className:"max-w-6xl mx-auto py-16 px-4 sm:px-6 lg:px-8 space-y-20",children:[p.jsxs("div",{className:"text-center space-y-10 max-w-4xl mx-auto",children:[p.jsxs("div",{className:"space-y-6",children:[p.jsx("div",{className:"inline-flex items-center justify-center p-5 bg-amber-50 rounded-full mb-2 border border-amber-100 shadow-sm",children:p.jsx(iN,{className:"w-10 h-10 text-amber-700"})}),p.jsxs("h1",{className:"text-5xl md:text-7xl font-serif font-medium text-neutral-900 tracking-tight leading-[1.1]",children:["Ative seu Negcio ",p.jsx("br",{}),p.jsx("span",{className:"italic text-amber-700 underline decoration-amber-200 underline-offset-8",children:"Baixe o Aplicativo"})]}),p.jsx("p",{className:"text-2xl text-neutral-500 font-light leading-relaxed max-w-2xl mx-auto",children:"Seu contrato foi assinado! Agora, o passo final e obrigatrio para ativar sua loja e receber sua maleta  baixar nosso aplicativo oficial."})]}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center pt-6",children:[p.jsx(Ie,{className:"bg-black text-white hover:bg-neutral-800 h-24 px-12 rounded-[2rem] flex items-center gap-6 shadow-[0_20px_50px_rgba(0,0,0,0.2)] transition-all hover:-translate-y-2 active:scale-95 w-full sm:w-auto border-2 border-neutral-800",onClick:()=>window.open(n,"_blank"),children:p.jsxs("div",{className:"text-left",children:[p.jsx("div",{className:"text-xs uppercase font-black tracking-[0.2em] text-neutral-500 mb-1",children:"Disponvel no"}),p.jsx("div",{className:"text-3xl font-bold",children:"Google Play"})]})}),p.jsx(Ie,{className:"bg-black text-white hover:bg-neutral-800 h-24 px-12 rounded-[2rem] flex items-center gap-6 shadow-[0_20px_50px_rgba(0,0,0,0.2)] transition-all hover:-translate-y-2 active:scale-95 w-full sm:w-auto border-2 border-neutral-800",onClick:()=>window.open(r,"_blank"),children:p.jsxs("div",{className:"text-left",children:[p.jsx("div",{className:"text-xs uppercase font-black tracking-[0.2em] text-neutral-500 mb-1",children:"Disponvel na"}),p.jsx("div",{className:"text-3xl font-bold",children:"App Store"})]})})]}),p.jsx("div",{className:"pt-4",children:p.jsxs("p",{className:"text-amber-600 font-medium flex items-center justify-center gap-2 animate-pulse",children:[p.jsx(Vu,{className:"w-5 h-5 rotate-90"}),"Arraste para ver o que te espera no app",p.jsx(Vu,{className:"w-5 h-5 rotate-90"})]})})]}),p.jsx("div",{className:"space-y-32",children:o.map((i,a)=>p.jsxs("div",{className:`flex flex-col lg:items-center gap-12 lg:gap-20 ${a%2===1?"lg:flex-row-reverse":"lg:flex-row"}`,children:[p.jsx("div",{className:"flex-1 group",children:p.jsxs("div",{className:"relative overflow-hidden rounded-3xl shadow-2xl transition-all duration-700 group-hover:scale-[1.02]",children:[p.jsx("img",{src:i.image,alt:i.title,className:"w-full h-[400px] object-cover filter brightness-95 group-hover:brightness-100 transition-all duration-700"}),p.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-60"})]})}),p.jsxs("div",{className:"flex-1 space-y-8",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"p-3 bg-white rounded-2xl shadow-sm border border-neutral-100",children:i.icon}),p.jsx("h3",{className:"text-3xl font-serif font-medium text-neutral-900",children:i.title})]}),p.jsx("p",{className:"text-lg text-neutral-500 leading-relaxed font-light",children:i.description})]}),p.jsx("ul",{className:"space-y-3",children:i.points.map((s,l)=>p.jsxs("li",{className:"flex items-center gap-3 text-neutral-700 font-light",children:[p.jsx(tN,{className:"w-5 h-5 text-emerald-500 flex-shrink-0"}),s]},l))})]})]},a))}),p.jsxs("div",{className:"relative overflow-hidden bg-neutral-900 rounded-[3rem] p-12 md:p-20 text-white text-center shadow-2xl mt-24",children:[p.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-amber-500/20 via-transparent to-transparent"}),p.jsxs("div",{className:"relative z-10 space-y-10 max-w-2xl mx-auto",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsx("h2",{className:"text-3xl md:text-4xl font-serif font-medium leading-tight",children:"Prepare-se para o Brilho"}),p.jsx("p",{className:"text-neutral-400 font-light text-lg",children:"Baixe agora o seu centro de comando e comece a faturar hoje mesmo."})]}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[p.jsx(Ie,{variant:"outline",className:"bg-white text-black hover:bg-neutral-100 h-20 px-10 rounded-2xl flex items-center gap-4 border-none shadow-xl transition-transform hover:-translate-y-1",onClick:()=>window.open(n,"_blank"),children:p.jsxs("div",{className:"text-left",children:[p.jsx("div",{className:"text-[10px] uppercase font-bold tracking-widest text-neutral-400",children:"Download via"}),p.jsx("div",{className:"text-2xl font-bold",children:"Google Play"})]})}),p.jsx(Ie,{variant:"outline",className:"bg-white text-black hover:bg-neutral-100 h-20 px-10 rounded-2xl flex items-center gap-4 border-none shadow-xl transition-transform hover:-translate-y-1",onClick:()=>window.open(r,"_blank"),children:p.jsxs("div",{className:"text-left",children:[p.jsx("div",{className:"text-[10px] uppercase font-bold tracking-widest text-neutral-400",children:"Download via"}),p.jsx("div",{className:"text-2xl font-bold",children:"App Store"})]})})]})]})]}),p.jsx("div",{className:"text-center py-10",children:p.jsxs(Ie,{variant:"ghost",className:"text-neutral-400 hover:text-amber-700 transition-colors flex items-center gap-2 mx-auto font-light tracking-wide",onClick:()=>e(5),children:["Acessar painel web ",p.jsx(Vu,{className:"w-4 h-4"})]})})]})})},dY=()=>{const{govbrData:e,contractData:t,resetFlow:n}=Gc(),{toast:r}=Wc();S.useEffect(()=>{vM({particleCount:100,spread:70,origin:{y:.6},colors:["#1351B4","#168821","#FFCD07"]})},[]);const o=()=>{navigator.clipboard.writeText((t==null?void 0:t.protocol_number)||""),r({title:"Copiado!",description:"Nmero do protocolo copiado para a rea de transferncia."})},i=()=>{if(!(t!=null&&t.contract_html)){r({title:"Erro",description:"Contrato no encontrado.",variant:"destructive"});return}const s=`
      <!DOCTYPE html>
      <html lang="pt-BR">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Contrato - ${t.protocol_number}</title>
        <style>
          @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
          }
        </style>
      </head>
      <body>
        ${t.contract_html}
      </body>
      </html>
    `,l=new Blob([s],{type:"text/html"}),u=URL.createObjectURL(l),c=document.createElement("a");c.href=u,c.download=`contrato-${t.protocol_number}.html`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(u),r({title:"Download concludo",description:"O contrato foi baixado. Abra o arquivo e use Ctrl+P para imprimir como PDF."})},a=()=>{n()};return p.jsxs("div",{className:"max-w-xl mx-auto px-4 py-8 animate-fade-in",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("div",{className:"w-24 h-24 rounded-full bg-success/10 flex items-center justify-center mx-auto mb-6 animate-scale-in",children:p.jsx(ca,{className:"w-14 h-14 text-success"})}),p.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:Fd.title}),p.jsx("p",{className:"text-muted-foreground",children:Fd.subtitle})]}),p.jsxs("div",{className:"glass-card p-6 mb-6",children:[p.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Detalhes do Contrato"}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border",children:[p.jsx("span",{className:"text-muted-foreground",children:"Contratante"}),p.jsx("span",{className:"font-medium text-foreground",children:(e==null?void 0:e.nome)||"N/A"})]}),p.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border",children:[p.jsx("span",{className:"text-muted-foreground",children:"CPF"}),p.jsx("span",{className:"font-medium text-foreground",children:(e==null?void 0:e.cpf)||"N/A"})]}),p.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border",children:[p.jsx("span",{className:"text-muted-foreground",children:"Data da Assinatura"}),p.jsx("span",{className:"font-medium text-foreground",children:t!=null&&t.signed_at?ST(t.signed_at):"-"})]}),p.jsxs("div",{className:"flex justify-between items-center py-2",children:[p.jsx("span",{className:"text-muted-foreground",children:"Protocolo"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"font-mono font-semibold text-primary",children:t==null?void 0:t.protocol_number}),p.jsx("button",{onClick:o,className:"p-1 hover:bg-muted rounded transition-colors",children:p.jsx(vg,{className:"w-4 h-4 text-muted-foreground"})})]})]})]})]}),p.jsxs("div",{className:"glass-card p-6 mb-6 border-2 border-success/30 bg-success/5",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[p.jsx("div",{className:"w-10 h-10 rounded-full bg-success/20 flex items-center justify-center",children:p.jsx(oN,{className:"w-5 h-5 text-success"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-foreground",children:"Assinatura Digital Registrada"}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Autenticado via GOV.BR"})]}),p.jsx(C3,{className:"w-6 h-6 text-success ml-auto"})]}),p.jsxs("div",{className:"bg-background rounded-lg p-4 text-center border border-border",children:[p.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Assinado digitalmente por:"}),p.jsx("p",{className:"font-semibold text-lg text-foreground",children:(e==null?void 0:e.nome)||"N/A"}),p.jsxs("p",{className:"text-sm text-muted-foreground",children:["CPF: ",(e==null?void 0:e.cpf)||"N/A"]}),p.jsxs("p",{className:"text-xs text-primary mt-2",children:["Nvel de segurana: ",(e==null?void 0:e.nivel_conta)||"Prata"]})]})]}),(e==null?void 0:e.email)&&p.jsxs("div",{className:"bg-primary/5 rounded-xl p-4 mb-6 flex items-start gap-3",children:[p.jsx(b3,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-sm text-foreground font-medium",children:"Email enviado!"}),p.jsxs("p",{className:"text-sm text-muted-foreground",children:[Fd.instruction," (",p.jsx("strong",{children:e.email}),")"]})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs(Ie,{onClick:i,className:"w-full h-12 gap-2",children:[p.jsx(M0,{className:"w-5 h-5"}),"Baixar Contrato"]}),p.jsxs(Ie,{variant:"outline",onClick:a,className:"w-full h-12 gap-2",children:[p.jsx(x3,{className:"w-5 h-5"}),Fd.finalButton]})]}),p.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-8",children:["Dvidas? Entre em contato atravs do email"," ",p.jsx("a",{href:`mailto:${Ia.contactEmail}`,className:"text-primary hover:underline",children:Ia.contactEmail})]})]})},fY=({currentStep:e,contract:t})=>{const n=t.progress_title||"Assinatura Digital",r=t.progress_subtitle||"Conclua os passos abaixo para desbloquear sua maleta digital. Super rpido!",o=t.progress_step1_title||"1. Reconhecimento Facial",i=t.progress_step1_description||"Tire uma selfie para validar sua identidade atravs de reconhecimento facial",a=t.progress_step2_title||"2. Assinar Contrato",s=t.progress_step2_description||"Assine digitalmente o contrato para confirmar seu compromisso",l=t.progress_step3_title||"3. Baixar Aplicativo",u=t.progress_step3_description||"Baixe o app oficial para ativar sua loja e receber sua maleta",c=t.progress_button_text||"Complete os passos acima",d=t.progress_card_color||"#dbeafe",f=t.progress_button_color||"#22c55e",h=t.progress_text_color||"#1e40af",v=t.progress_font_family||"Arial, sans-serif";t.progress_font_size;const g=e>=2,y=e>=3,m=e>=4,x=e>=4;return p.jsxs("div",{className:"fixed bottom-8 left-2 rounded-lg space-y-1 max-w-xs shadow-lg",style:{backgroundColor:d,fontFamily:v,padding:"8px",zIndex:40,border:`1px solid ${f}20`},children:[p.jsx("h2",{className:"text-sm font-bold leading-tight",style:{color:h,marginBottom:"2px"},children:n}),p.jsx("p",{className:"text-xs leading-snug",style:{color:h,fontSize:"11px",marginBottom:"4px"},children:r}),p.jsxs("div",{className:"space-y-1",children:[p.jsxs("div",{className:"flex items-start gap-2 p-1.5 rounded border transition-all",style:{borderColor:f,backgroundColor:g?"rgba(34, 197, 94, 0.15)":"rgba(255, 255, 255, 0.1)",borderWidth:"1px",boxShadow:"none"},children:[p.jsx("div",{className:"flex-shrink-0",children:p.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:f,animation:g?"none":"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite",flexShrink:0},children:g?p.jsx(ro,{size:14}):"1"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-semibold text-xs leading-none",style:{color:h,fontSize:"11px",textDecoration:g?"line-through":"none"},children:o}),p.jsx("p",{className:"text-xs opacity-70 leading-tight mt-0.5",style:{color:h,fontSize:"10px"},children:i})]})]}),p.jsxs("div",{className:"flex items-start gap-2 p-1.5 rounded border transition-all",style:{borderColor:f,backgroundColor:y?"rgba(34, 197, 94, 0.15)":e===2?"rgba(255, 255, 255, 0.15)":"rgba(255, 255, 255, 0.1)",borderWidth:"1px",boxShadow:"none"},children:[p.jsx("div",{className:"flex-shrink-0",children:p.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:f,animation:e===2?"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite":"none",flexShrink:0},children:y?p.jsx(ro,{size:14}):"2"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-semibold text-xs leading-none",style:{color:h,fontSize:"11px",textDecoration:y?"line-through":"none",opacity:e>=2?1:.6},children:a}),p.jsx("p",{className:"text-xs opacity-70 leading-tight mt-0.5",style:{color:h,fontSize:"10px"},children:s})]})]}),p.jsxs("div",{className:"flex items-start gap-2 p-1.5 rounded border transition-all",style:{borderColor:f,backgroundColor:m?"rgba(34, 197, 94, 0.15)":e===3?"rgba(255, 255, 255, 0.15)":"rgba(255, 255, 255, 0.1)",borderWidth:"1px",boxShadow:"none"},children:[p.jsx("div",{className:"flex-shrink-0",children:p.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:f,animation:e===3?"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite":"none",flexShrink:0},children:m?p.jsx(ro,{size:14}):"3"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-semibold text-xs leading-none",style:{color:h,fontSize:"11px",textDecoration:m?"line-through":"none",opacity:e>=3?1:.6},children:l}),p.jsx("p",{className:"text-xs opacity-70 leading-tight mt-0.5",style:{color:h,fontSize:"10px"},children:u})]})]})]}),p.jsx("button",{className:"w-full py-1.5 text-white font-bold rounded text-xs transition-all",style:{backgroundColor:f,fontFamily:v,fontSize:"11px",opacity:x?1:.5,cursor:x?"pointer":"not-allowed",marginTop:"4px"},disabled:!x,children:x?" Completo!":c})]})},hY=({contract:e})=>{const{currentStep:t,setCurrentStep:n,setContractData:r}=Gc(),[o,i]=S.useState(!1);S.useState(!1);const[a,s]=S.useState(null),[l,u]=S.useState(null),[c,d]=S.useState(null);S.useEffect(()=>{r({id:e.id,protocol_number:e.protocol_number||void 0,contract_html:e.contract_html,app_store_url:e.app_store_url,google_play_url:e.google_play_url}),n(1)},[e,r,n]);const f=g=>{s(g);const y=window.sessionStorage,m=y.getItem("verification_selfie"),x=y.getItem("verification_document");m&&u(m),x&&d(x),i(!0),n(2)},h=()=>p.jsx(p.Fragment,{children:v()}),v=()=>{switch(t){case 1:return p.jsx(Iy,{primaryColor:e.verification_primary_color||e.primary_color,textColor:e.verification_text_color||e.text_color,fontFamily:e.verification_font_family||e.font_family,fontSize:e.verification_font_size||e.font_size,logoUrl:e.verification_logo_url||e.logo_url,logoSize:e.verification_logo_size||e.logo_size||"medium",logoPosition:e.verification_logo_position||e.logo_position||"center",footerText:e.verification_footer_text||e.footer_text,welcomeText:e.verification_welcome_text,instructionText:e.verification_instructions,securityText:e.verification_security_text,backgroundImage:e.verification_background_image,backgroundColor:e.verification_background_color||"#ffffff",headerBackgroundColor:e.verification_header_background_color,headerLogoUrl:e.verification_header_logo_url,headerCompanyName:e.verification_header_company_name,onComplete:f,passLogoProps:{logoUrl:e.verification_logo_url||e.logo_url||"",logoSize:e.verification_logo_size||e.logo_size||"medium",logoPosition:e.verification_logo_position||e.logo_position||"center"}});case 2:return p.jsx(oY,{clientData:{id:e.id,client_name:e.client_name,client_cpf:e.client_cpf,client_email:e.client_email,client_phone:e.client_phone,contract_html:e.contract_html,protocol_number:e.protocol_number,logo_url:e.logo_url,logo_size:e.logo_size,logo_position:e.logo_position,primary_color:e.primary_color,text_color:e.text_color,font_family:e.font_family,font_size:e.font_size,company_name:e.company_name,footer_text:e.footer_text,progress_title:e.progress_title,progress_subtitle:e.progress_subtitle,progress_step1_title:e.progress_step1_title,progress_step1_description:e.progress_step1_description,progress_step2_title:e.progress_step2_title,progress_step2_description:e.progress_step2_description,progress_button_text:e.progress_button_text,progress_card_color:e.progress_card_color,progress_button_color:e.progress_button_color,progress_text_color:e.progress_text_color,progress_font_family:e.progress_font_family,progress_font_size:e.progress_font_size},selfiePhoto:l,documentPhoto:c,currentStep:t});case 3:return p.jsx(aY,{client_name:e.client_name,parabens_title:e.parabens_title,parabens_subtitle:e.parabens_subtitle,parabens_description:e.parabens_description,parabens_card_color:e.parabens_card_color,parabens_background_color:e.parabens_background_color,parabens_button_color:e.parabens_button_color,parabens_text_color:e.parabens_text_color,parabens_font_family:e.parabens_font_family,parabens_form_title:e.parabens_form_title,parabens_button_text:e.parabens_button_text});case 4:return p.jsx(cY,{});case 5:return p.jsx(dY,{});default:return p.jsx(Iy,{primaryColor:e.verification_primary_color||e.primary_color,textColor:e.verification_text_color||e.text_color,fontFamily:e.verification_font_family||e.font_family,fontSize:e.verification_font_size||e.font_size,logoUrl:e.verification_logo_url||e.logo_url,logoSize:e.verification_logo_size||e.logo_size||"medium",logoPosition:e.verification_logo_position||e.logo_position||"center",footerText:e.verification_footer_text||e.footer_text,welcomeText:e.verification_welcome_text,instructionText:e.verification_instructions,securityText:e.verification_security_text,backgroundImage:e.verification_background_image,backgroundColor:e.verification_background_color||"#ffffff",headerBackgroundColor:e.verification_header_background_color,headerLogoUrl:e.verification_header_logo_url,headerCompanyName:e.verification_header_company_name,onComplete:f,passLogoProps:{logoUrl:e.verification_logo_url||e.logo_url||"",logoSize:e.verification_logo_size||e.logo_size||"medium",logoPosition:e.verification_logo_position||e.logo_position||"center"}})}};return e.progress_card_color||e.maleta_card_color,e.progress_button_color||e.maleta_button_color,e.progress_text_color||e.maleta_text_color,e.progress_title,e.progress_subtitle,e.progress_step1_title,e.progress_step1_description,e.progress_step2_title,e.progress_step2_description,e.progress_step3_title,e.progress_step3_description,e.progress_button_text,e.progress_font_family,e.progress_font_size,p.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[p.jsx("main",{className:"flex-1 overflow-y-auto",children:h()}),p.jsx(fY,{currentStep:t,contract:e})]})},pY=()=>{const{token:e}=BB(),[t,n]=S.useState(null),[r,o]=S.useState(!0),[i,a]=S.useState(null);return S.useEffect(()=>{(async()=>{if(!e){a("Token invlido"),o(!1);return}try{const l=await fetch(`/api/contracts/${e}`);if(!l.ok){l.status===404?a("Contrato no encontrado"):a("Erro ao buscar contrato"),o(!1);return}const u=await l.json();n(u),o(!1)}catch(l){console.error("Error fetching contract:",l),a("Erro ao carregar contrato"),o(!1)}})()},[e]),r?p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:p.jsx(ut,{className:"w-full max-w-md mx-4",children:p.jsxs(xt,{className:"flex items-center gap-4",children:[p.jsx("div",{className:"animate-spin",children:p.jsx(hc,{className:"w-6 h-6 text-primary"})}),p.jsxs("div",{children:[p.jsx(bt,{children:"Carregando contrato..."}),p.jsx(wt,{children:"Por favor aguarde"})]})]})})}):i?p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:p.jsx(ut,{className:"w-full max-w-md mx-4",children:p.jsx(xt,{children:p.jsxs("div",{className:"flex items-center gap-3",children:[i.includes("no encontrado")?p.jsx(Hw,{className:"w-8 h-8 text-destructive"}):p.jsx(Uc,{className:"w-8 h-8 text-destructive"}),p.jsxs("div",{children:[p.jsx(bt,{className:"text-destructive",children:"Erro"}),p.jsx(wt,{children:i})]})]})})})}):t?p.jsx(TV,{children:p.jsx(hY,{contract:t})}):p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:p.jsx(ut,{className:"w-full max-w-md mx-4",children:p.jsx(xt,{children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(Hw,{className:"w-8 h-8 text-destructive"}),p.jsxs("div",{children:[p.jsx(bt,{className:"text-destructive",children:"Contrato no encontrado"}),p.jsx(wt,{children:"Token invlido ou contrato removido"})]})]})})})})},mY=()=>p.jsx(Iy,{}),vY=()=>{const e=Q0();return S.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),p.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:p.jsxs("div",{className:"text-center",children:[p.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),p.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),p.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},gY=()=>p.jsx(XL,{client:bT,children:p.jsxs(NL,{children:[p.jsx(u4,{}),p.jsx(z4,{}),p.jsx(r5,{children:p.jsxs(e5,{children:[p.jsx(Nu,{path:"/",element:p.jsx(NV,{})}),p.jsx(Nu,{path:"/c/:token",element:p.jsx(pY,{})}),p.jsx(Nu,{path:"/facial-recognition",element:p.jsx(mY,{})}),p.jsx(Nu,{path:"*",element:p.jsx(vY,{})})]})})]})});kk(document.getElementById("root")).render(p.jsx(gY,{}));export{ET as _,fE as a,xY as c,bY as g};
